@model dynamic

@if (Model != null)
{


        if (Model.Success == true)
        {
            <div class="col-lg-12">
                <div class="backtoresult">
                    <a href="#" id="back-to-results" role="button" title="Back to Results"><span class="prev-btn"></span>Back To Results</a>
                </div>
                <div class="job-holder">
                    <div class="job-topbar">
                        <a href="/save-job" title="Save job">Save Job</a>
                        <a href="/share-job" title="share job">Share Job</a>
                    </div>
                    <div class="job-header">
                        <h1 class="page-title"><small>Apply for this position:</small>@Model.Job.Title</h1>
                        <div class="highlight">Tag goes here</div>
                    </div>
                    <dl class="sc-job-meta-group clearfix">
                        <dt class="sc-job-meta-name meta-cat hidden">Director</dt>
                        <dd class="sc-job-meta-value meta-cat">
                            <span class="jn_ico icon-time">icon</span>Director
                        </dd>
                        <dt class="sc-job-meta-name meta-location hidden">Location</dt>
                        <dd class="sc-job-meta-value meta-location">
                            <a href="" title="Jobs in Sydney">
                                <span class="jn_ico icon-pin">icon</span>Sydney
                            </a>
                        </dd>
                        <dt class="sc-job-meta-name meta-salary hidden">Salary</dt>
                        <dd class="sc-job-meta-value meta-salary">
                            <span class="jn_ico icon-value">icon</span>65,000 - 75,000 per annum
                        </dd>
                        <dt class="sc-job-meta-name meta-worktype hidden">Worktype</dt>
                        <dd class="sc-job-meta-value meta-worktype">
                            <span class="jn_ico icon-time">icon</span>Permanent
                        </dd>
                    </dl>
                </div>
            </div>
            
        }
        else
        {
        foreach (var message in @Model.Messages)
        {
        <div>@message</div>
        }
        }
       


    
}


<script type="text/javascript">
    $(document).ready(function () {
        @{
                var serializer = new System.Web.Script.Serialization.JavaScriptSerializer();
                var json = serializer.Serialize(Model);
          }

        var previousUrl = new URL(document.referrer);
        var urlPath = previousUrl.pathname + previousUrl.search
        $("#back-to-results").attr("href", urlPath);

       // Show the 'Apply' button only to Member type users
        $("#apply-job").hide();
        var model = @Html.Raw(json);
        if (model != null && model != "undefined" && model.Success == true) {
            var roles = JSON.parse('@Html.Raw(@ViewBag.Roles)');
            var userName = @Html.Raw(Json.Encode(@ViewBag.UserName));
            if (userName !== "Anonymous" && roles !== 'undefined' && roles.length > 0) {
                for (var role of roles) {
                    if (role === "Administrators") {
                        $("#apply-job").show();
                        break;
                    }
                }

            }
        }
    });
</script>


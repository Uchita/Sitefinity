
USE [MiniJXT]
GO
SET QUOTED_IDENTIFIER ON 
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.GlobalLocation_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.GlobalLocation_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.GlobalLocation_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the GlobalLocation table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.GlobalLocation_Get_List

AS


				
				SELECT
					[LocationID],
					[LocationName],
					[CountryID],
					[Valid],
					[Sequence]
				FROM
					[dbo].[GlobalLocation]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.GlobalLocation_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.GlobalLocation_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.GlobalLocation_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the GlobalLocation table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.GlobalLocation_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [LocationID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([LocationID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [LocationID]'
				SET @SQL = @SQL + ' FROM [dbo].[GlobalLocation]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[LocationID], O.[LocationName], O.[CountryID], O.[Valid], O.[Sequence]
				FROM
				    [dbo].[GlobalLocation] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[LocationID] = PageIndex.[LocationID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[GlobalLocation]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.GlobalLocation_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.GlobalLocation_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.GlobalLocation_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the GlobalLocation table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.GlobalLocation_Insert
(

	@LocationId int    OUTPUT,

	@LocationName nvarchar (1020)  ,

	@CountryId int   ,

	@Valid bit   ,

	@Sequence int   
)
AS


				
				INSERT INTO [dbo].[GlobalLocation]
					(
					[LocationName]
					,[CountryID]
					,[Valid]
					,[Sequence]
					)
				VALUES
					(
					@LocationName
					,@CountryId
					,@Valid
					,@Sequence
					)
				
				-- Get the identity value
				SET @LocationId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.GlobalLocation_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.GlobalLocation_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.GlobalLocation_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the GlobalLocation table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.GlobalLocation_Update
(

	@LocationId int   ,

	@LocationName nvarchar (1020)  ,

	@CountryId int   ,

	@Valid bit   ,

	@Sequence int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[GlobalLocation]
				SET
					[LocationName] = @LocationName
					,[CountryID] = @CountryId
					,[Valid] = @Valid
					,[Sequence] = @Sequence
				WHERE
[LocationID] = @LocationId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.GlobalLocation_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.GlobalLocation_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.GlobalLocation_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the GlobalLocation table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.GlobalLocation_Delete
(

	@LocationId int   
)
AS


				DELETE FROM [dbo].[GlobalLocation] WITH (ROWLOCK) 
				WHERE
					[LocationID] = @LocationId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.GlobalLocation_GetByCountryId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.GlobalLocation_GetByCountryId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.GlobalLocation_GetByCountryId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the GlobalLocation table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.GlobalLocation_GetByCountryId
(

	@CountryId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[LocationID],
					[LocationName],
					[CountryID],
					[Valid],
					[Sequence]
				FROM
					[dbo].[GlobalLocation]
				WHERE
					[CountryID] = @CountryId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.GlobalLocation_GetByLocationId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.GlobalLocation_GetByLocationId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.GlobalLocation_GetByLocationId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the GlobalLocation table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.GlobalLocation_GetByLocationId
(

	@LocationId int   
)
AS


				SELECT
					[LocationID],
					[LocationName],
					[CountryID],
					[Valid],
					[Sequence]
				FROM
					[dbo].[GlobalLocation]
				WHERE
					[LocationID] = @LocationId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.GlobalLocation_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.GlobalLocation_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.GlobalLocation_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the GlobalLocation table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.GlobalLocation_Find
(

	@SearchUsingOR bit   = null ,

	@LocationId int   = null ,

	@LocationName nvarchar (1020)  = null ,

	@CountryId int   = null ,

	@Valid bit   = null ,

	@Sequence int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [LocationID]
	, [LocationName]
	, [CountryID]
	, [Valid]
	, [Sequence]
    FROM
	[dbo].[GlobalLocation]
    WHERE 
	 ([LocationID] = @LocationId OR @LocationId IS NULL)
	AND ([LocationName] = @LocationName OR @LocationName IS NULL)
	AND ([CountryID] = @CountryId OR @CountryId IS NULL)
	AND ([Valid] = @Valid OR @Valid IS NULL)
	AND ([Sequence] = @Sequence OR @Sequence IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [LocationID]
	, [LocationName]
	, [CountryID]
	, [Valid]
	, [Sequence]
    FROM
	[dbo].[GlobalLocation]
    WHERE 
	 ([LocationID] = @LocationId AND @LocationId is not null)
	OR ([LocationName] = @LocationName AND @LocationName is not null)
	OR ([CountryID] = @CountryId AND @CountryId is not null)
	OR ([Valid] = @Valid AND @Valid is not null)
	OR ([Sequence] = @Sequence AND @Sequence is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteWebPartTypes_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteWebPartTypes_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteWebPartTypes_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the SiteWebPartTypes table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteWebPartTypes_Get_List

AS


				
				SELECT
					[SiteWebPartTypeID],
					[SiteWebPartName]
				FROM
					[dbo].[SiteWebPartTypes]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteWebPartTypes_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteWebPartTypes_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteWebPartTypes_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the SiteWebPartTypes table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteWebPartTypes_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [SiteWebPartTypeID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([SiteWebPartTypeID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [SiteWebPartTypeID]'
				SET @SQL = @SQL + ' FROM [dbo].[SiteWebPartTypes]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[SiteWebPartTypeID], O.[SiteWebPartName]
				FROM
				    [dbo].[SiteWebPartTypes] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[SiteWebPartTypeID] = PageIndex.[SiteWebPartTypeID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[SiteWebPartTypes]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteWebPartTypes_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteWebPartTypes_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteWebPartTypes_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the SiteWebPartTypes table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteWebPartTypes_Insert
(

	@SiteWebPartTypeId int    OUTPUT,

	@SiteWebPartName varchar (255)  
)
AS


				
				INSERT INTO [dbo].[SiteWebPartTypes]
					(
					[SiteWebPartName]
					)
				VALUES
					(
					@SiteWebPartName
					)
				
				-- Get the identity value
				SET @SiteWebPartTypeId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteWebPartTypes_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteWebPartTypes_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteWebPartTypes_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the SiteWebPartTypes table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteWebPartTypes_Update
(

	@SiteWebPartTypeId int   ,

	@SiteWebPartName varchar (255)  
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[SiteWebPartTypes]
				SET
					[SiteWebPartName] = @SiteWebPartName
				WHERE
[SiteWebPartTypeID] = @SiteWebPartTypeId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteWebPartTypes_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteWebPartTypes_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteWebPartTypes_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the SiteWebPartTypes table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteWebPartTypes_Delete
(

	@SiteWebPartTypeId int   
)
AS


				DELETE FROM [dbo].[SiteWebPartTypes] WITH (ROWLOCK) 
				WHERE
					[SiteWebPartTypeID] = @SiteWebPartTypeId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteWebPartTypes_GetBySiteWebPartTypeId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteWebPartTypes_GetBySiteWebPartTypeId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteWebPartTypes_GetBySiteWebPartTypeId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteWebPartTypes table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteWebPartTypes_GetBySiteWebPartTypeId
(

	@SiteWebPartTypeId int   
)
AS


				SELECT
					[SiteWebPartTypeID],
					[SiteWebPartName]
				FROM
					[dbo].[SiteWebPartTypes]
				WHERE
					[SiteWebPartTypeID] = @SiteWebPartTypeId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteWebPartTypes_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteWebPartTypes_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteWebPartTypes_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the SiteWebPartTypes table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteWebPartTypes_Find
(

	@SearchUsingOR bit   = null ,

	@SiteWebPartTypeId int   = null ,

	@SiteWebPartName varchar (255)  = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [SiteWebPartTypeID]
	, [SiteWebPartName]
    FROM
	[dbo].[SiteWebPartTypes]
    WHERE 
	 ([SiteWebPartTypeID] = @SiteWebPartTypeId OR @SiteWebPartTypeId IS NULL)
	AND ([SiteWebPartName] = @SiteWebPartName OR @SiteWebPartName IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [SiteWebPartTypeID]
	, [SiteWebPartName]
    FROM
	[dbo].[SiteWebPartTypes]
    WHERE 
	 ([SiteWebPartTypeID] = @SiteWebPartTypeId AND @SiteWebPartTypeId is not null)
	OR ([SiteWebPartName] = @SiteWebPartName AND @SiteWebPartName is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.GlobalArea_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.GlobalArea_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.GlobalArea_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the GlobalArea table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.GlobalArea_Get_List

AS


				
				SELECT
					[AreaID],
					[AreaName],
					[LocationID],
					[Valid],
					[Sequence]
				FROM
					[dbo].[GlobalArea]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.GlobalArea_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.GlobalArea_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.GlobalArea_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the GlobalArea table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.GlobalArea_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [AreaID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([AreaID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [AreaID]'
				SET @SQL = @SQL + ' FROM [dbo].[GlobalArea]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[AreaID], O.[AreaName], O.[LocationID], O.[Valid], O.[Sequence]
				FROM
				    [dbo].[GlobalArea] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[AreaID] = PageIndex.[AreaID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[GlobalArea]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.GlobalArea_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.GlobalArea_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.GlobalArea_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the GlobalArea table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.GlobalArea_Insert
(

	@AreaId int    OUTPUT,

	@AreaName nvarchar (1020)  ,

	@LocationId int   ,

	@Valid bit   ,

	@Sequence int   
)
AS


				
				INSERT INTO [dbo].[GlobalArea]
					(
					[AreaName]
					,[LocationID]
					,[Valid]
					,[Sequence]
					)
				VALUES
					(
					@AreaName
					,@LocationId
					,@Valid
					,@Sequence
					)
				
				-- Get the identity value
				SET @AreaId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.GlobalArea_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.GlobalArea_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.GlobalArea_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the GlobalArea table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.GlobalArea_Update
(

	@AreaId int   ,

	@AreaName nvarchar (1020)  ,

	@LocationId int   ,

	@Valid bit   ,

	@Sequence int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[GlobalArea]
				SET
					[AreaName] = @AreaName
					,[LocationID] = @LocationId
					,[Valid] = @Valid
					,[Sequence] = @Sequence
				WHERE
[AreaID] = @AreaId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.GlobalArea_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.GlobalArea_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.GlobalArea_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the GlobalArea table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.GlobalArea_Delete
(

	@AreaId int   
)
AS


				DELETE FROM [dbo].[GlobalArea] WITH (ROWLOCK) 
				WHERE
					[AreaID] = @AreaId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.GlobalArea_GetByLocationId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.GlobalArea_GetByLocationId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.GlobalArea_GetByLocationId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the GlobalArea table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.GlobalArea_GetByLocationId
(

	@LocationId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[AreaID],
					[AreaName],
					[LocationID],
					[Valid],
					[Sequence]
				FROM
					[dbo].[GlobalArea]
				WHERE
					[LocationID] = @LocationId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.GlobalArea_GetByAreaId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.GlobalArea_GetByAreaId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.GlobalArea_GetByAreaId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the GlobalArea table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.GlobalArea_GetByAreaId
(

	@AreaId int   
)
AS


				SELECT
					[AreaID],
					[AreaName],
					[LocationID],
					[Valid],
					[Sequence]
				FROM
					[dbo].[GlobalArea]
				WHERE
					[AreaID] = @AreaId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.GlobalArea_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.GlobalArea_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.GlobalArea_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the GlobalArea table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.GlobalArea_Find
(

	@SearchUsingOR bit   = null ,

	@AreaId int   = null ,

	@AreaName nvarchar (1020)  = null ,

	@LocationId int   = null ,

	@Valid bit   = null ,

	@Sequence int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [AreaID]
	, [AreaName]
	, [LocationID]
	, [Valid]
	, [Sequence]
    FROM
	[dbo].[GlobalArea]
    WHERE 
	 ([AreaID] = @AreaId OR @AreaId IS NULL)
	AND ([AreaName] = @AreaName OR @AreaName IS NULL)
	AND ([LocationID] = @LocationId OR @LocationId IS NULL)
	AND ([Valid] = @Valid OR @Valid IS NULL)
	AND ([Sequence] = @Sequence OR @Sequence IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [AreaID]
	, [AreaName]
	, [LocationID]
	, [Valid]
	, [Sequence]
    FROM
	[dbo].[GlobalArea]
    WHERE 
	 ([AreaID] = @AreaId AND @AreaId is not null)
	OR ([AreaName] = @AreaName AND @AreaName is not null)
	OR ([LocationID] = @LocationId AND @LocationId is not null)
	OR ([Valid] = @Valid AND @Valid is not null)
	OR ([Sequence] = @Sequence AND @Sequence is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobCustomQuestionnaire_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobCustomQuestionnaire_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobCustomQuestionnaire_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the JobCustomQuestionnaire table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobCustomQuestionnaire_Get_List

AS


				
				SELECT
					[JobCustomQuestionnaireID],
					[JobID],
					[FormXML]
				FROM
					[dbo].[JobCustomQuestionnaire]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobCustomQuestionnaire_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobCustomQuestionnaire_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobCustomQuestionnaire_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the JobCustomQuestionnaire table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobCustomQuestionnaire_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [JobCustomQuestionnaireID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([JobCustomQuestionnaireID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [JobCustomQuestionnaireID]'
				SET @SQL = @SQL + ' FROM [dbo].[JobCustomQuestionnaire]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[JobCustomQuestionnaireID], O.[JobID], O.[FormXML]
				FROM
				    [dbo].[JobCustomQuestionnaire] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[JobCustomQuestionnaireID] = PageIndex.[JobCustomQuestionnaireID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[JobCustomQuestionnaire]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobCustomQuestionnaire_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobCustomQuestionnaire_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobCustomQuestionnaire_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the JobCustomQuestionnaire table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobCustomQuestionnaire_Insert
(

	@JobCustomQuestionnaireId int    OUTPUT,

	@JobId int   ,

	@FormXml nvarchar (MAX)  
)
AS


				
				INSERT INTO [dbo].[JobCustomQuestionnaire]
					(
					[JobID]
					,[FormXML]
					)
				VALUES
					(
					@JobId
					,@FormXml
					)
				
				-- Get the identity value
				SET @JobCustomQuestionnaireId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobCustomQuestionnaire_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobCustomQuestionnaire_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobCustomQuestionnaire_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the JobCustomQuestionnaire table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobCustomQuestionnaire_Update
(

	@JobCustomQuestionnaireId int   ,

	@JobId int   ,

	@FormXml nvarchar (MAX)  
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[JobCustomQuestionnaire]
				SET
					[JobID] = @JobId
					,[FormXML] = @FormXml
				WHERE
[JobCustomQuestionnaireID] = @JobCustomQuestionnaireId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobCustomQuestionnaire_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobCustomQuestionnaire_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobCustomQuestionnaire_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the JobCustomQuestionnaire table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobCustomQuestionnaire_Delete
(

	@JobCustomQuestionnaireId int   
)
AS


				DELETE FROM [dbo].[JobCustomQuestionnaire] WITH (ROWLOCK) 
				WHERE
					[JobCustomQuestionnaireID] = @JobCustomQuestionnaireId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobCustomQuestionnaire_GetByJobCustomQuestionnaireId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobCustomQuestionnaire_GetByJobCustomQuestionnaireId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobCustomQuestionnaire_GetByJobCustomQuestionnaireId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobCustomQuestionnaire table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobCustomQuestionnaire_GetByJobCustomQuestionnaireId
(

	@JobCustomQuestionnaireId int   
)
AS


				SELECT
					[JobCustomQuestionnaireID],
					[JobID],
					[FormXML]
				FROM
					[dbo].[JobCustomQuestionnaire]
				WHERE
					[JobCustomQuestionnaireID] = @JobCustomQuestionnaireId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobCustomQuestionnaire_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobCustomQuestionnaire_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobCustomQuestionnaire_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the JobCustomQuestionnaire table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobCustomQuestionnaire_Find
(

	@SearchUsingOR bit   = null ,

	@JobCustomQuestionnaireId int   = null ,

	@JobId int   = null ,

	@FormXml nvarchar (MAX)  = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [JobCustomQuestionnaireID]
	, [JobID]
	, [FormXML]
    FROM
	[dbo].[JobCustomQuestionnaire]
    WHERE 
	 ([JobCustomQuestionnaireID] = @JobCustomQuestionnaireId OR @JobCustomQuestionnaireId IS NULL)
	AND ([JobID] = @JobId OR @JobId IS NULL)
	AND ([FormXML] = @FormXml OR @FormXml IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [JobCustomQuestionnaireID]
	, [JobID]
	, [FormXML]
    FROM
	[dbo].[JobCustomQuestionnaire]
    WHERE 
	 ([JobCustomQuestionnaireID] = @JobCustomQuestionnaireId AND @JobCustomQuestionnaireId is not null)
	OR ([JobID] = @JobId AND @JobId is not null)
	OR ([FormXML] = @FormXml AND @FormXml is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.EmailFormats_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.EmailFormats_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.EmailFormats_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the EmailFormats table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.EmailFormats_Get_List

AS


				
				SELECT
					[EmailFormatID],
					[EmailFormatName]
				FROM
					[dbo].[EmailFormats]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.EmailFormats_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.EmailFormats_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.EmailFormats_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the EmailFormats table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.EmailFormats_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [EmailFormatID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([EmailFormatID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [EmailFormatID]'
				SET @SQL = @SQL + ' FROM [dbo].[EmailFormats]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[EmailFormatID], O.[EmailFormatName]
				FROM
				    [dbo].[EmailFormats] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[EmailFormatID] = PageIndex.[EmailFormatID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[EmailFormats]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.EmailFormats_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.EmailFormats_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.EmailFormats_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the EmailFormats table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.EmailFormats_Insert
(

	@EmailFormatId int    OUTPUT,

	@EmailFormatName varchar (255)  
)
AS


				
				INSERT INTO [dbo].[EmailFormats]
					(
					[EmailFormatName]
					)
				VALUES
					(
					@EmailFormatName
					)
				
				-- Get the identity value
				SET @EmailFormatId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.EmailFormats_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.EmailFormats_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.EmailFormats_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the EmailFormats table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.EmailFormats_Update
(

	@EmailFormatId int   ,

	@EmailFormatName varchar (255)  
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[EmailFormats]
				SET
					[EmailFormatName] = @EmailFormatName
				WHERE
[EmailFormatID] = @EmailFormatId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.EmailFormats_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.EmailFormats_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.EmailFormats_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the EmailFormats table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.EmailFormats_Delete
(

	@EmailFormatId int   
)
AS


				DELETE FROM [dbo].[EmailFormats] WITH (ROWLOCK) 
				WHERE
					[EmailFormatID] = @EmailFormatId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.EmailFormats_GetByEmailFormatId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.EmailFormats_GetByEmailFormatId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.EmailFormats_GetByEmailFormatId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the EmailFormats table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.EmailFormats_GetByEmailFormatId
(

	@EmailFormatId int   
)
AS


				SELECT
					[EmailFormatID],
					[EmailFormatName]
				FROM
					[dbo].[EmailFormats]
				WHERE
					[EmailFormatID] = @EmailFormatId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.EmailFormats_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.EmailFormats_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.EmailFormats_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the EmailFormats table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.EmailFormats_Find
(

	@SearchUsingOR bit   = null ,

	@EmailFormatId int   = null ,

	@EmailFormatName varchar (255)  = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [EmailFormatID]
	, [EmailFormatName]
    FROM
	[dbo].[EmailFormats]
    WHERE 
	 ([EmailFormatID] = @EmailFormatId OR @EmailFormatId IS NULL)
	AND ([EmailFormatName] = @EmailFormatName OR @EmailFormatName IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [EmailFormatID]
	, [EmailFormatName]
    FROM
	[dbo].[EmailFormats]
    WHERE 
	 ([EmailFormatID] = @EmailFormatId AND @EmailFormatId is not null)
	OR ([EmailFormatName] = @EmailFormatName AND @EmailFormatName is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.FileTypes_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.FileTypes_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.FileTypes_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the FileTypes table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.FileTypes_Get_List

AS


				
				SELECT
					[FileTypeID],
					[FileTypeName],
					[FileTypeExtension]
				FROM
					[dbo].[FileTypes]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.FileTypes_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.FileTypes_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.FileTypes_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the FileTypes table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.FileTypes_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [FileTypeID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([FileTypeID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [FileTypeID]'
				SET @SQL = @SQL + ' FROM [dbo].[FileTypes]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[FileTypeID], O.[FileTypeName], O.[FileTypeExtension]
				FROM
				    [dbo].[FileTypes] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[FileTypeID] = PageIndex.[FileTypeID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[FileTypes]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.FileTypes_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.FileTypes_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.FileTypes_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the FileTypes table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.FileTypes_Insert
(

	@FileTypeId int    OUTPUT,

	@FileTypeName varchar (255)  ,

	@FileTypeExtension varchar (255)  
)
AS


				
				INSERT INTO [dbo].[FileTypes]
					(
					[FileTypeName]
					,[FileTypeExtension]
					)
				VALUES
					(
					@FileTypeName
					,@FileTypeExtension
					)
				
				-- Get the identity value
				SET @FileTypeId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.FileTypes_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.FileTypes_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.FileTypes_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the FileTypes table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.FileTypes_Update
(

	@FileTypeId int   ,

	@FileTypeName varchar (255)  ,

	@FileTypeExtension varchar (255)  
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[FileTypes]
				SET
					[FileTypeName] = @FileTypeName
					,[FileTypeExtension] = @FileTypeExtension
				WHERE
[FileTypeID] = @FileTypeId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.FileTypes_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.FileTypes_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.FileTypes_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the FileTypes table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.FileTypes_Delete
(

	@FileTypeId int   
)
AS


				DELETE FROM [dbo].[FileTypes] WITH (ROWLOCK) 
				WHERE
					[FileTypeID] = @FileTypeId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.FileTypes_GetByFileTypeId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.FileTypes_GetByFileTypeId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.FileTypes_GetByFileTypeId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the FileTypes table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.FileTypes_GetByFileTypeId
(

	@FileTypeId int   
)
AS


				SELECT
					[FileTypeID],
					[FileTypeName],
					[FileTypeExtension]
				FROM
					[dbo].[FileTypes]
				WHERE
					[FileTypeID] = @FileTypeId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.FileTypes_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.FileTypes_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.FileTypes_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the FileTypes table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.FileTypes_Find
(

	@SearchUsingOR bit   = null ,

	@FileTypeId int   = null ,

	@FileTypeName varchar (255)  = null ,

	@FileTypeExtension varchar (255)  = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [FileTypeID]
	, [FileTypeName]
	, [FileTypeExtension]
    FROM
	[dbo].[FileTypes]
    WHERE 
	 ([FileTypeID] = @FileTypeId OR @FileTypeId IS NULL)
	AND ([FileTypeName] = @FileTypeName OR @FileTypeName IS NULL)
	AND ([FileTypeExtension] = @FileTypeExtension OR @FileTypeExtension IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [FileTypeID]
	, [FileTypeName]
	, [FileTypeExtension]
    FROM
	[dbo].[FileTypes]
    WHERE 
	 ([FileTypeID] = @FileTypeId AND @FileTypeId is not null)
	OR ([FileTypeName] = @FileTypeName AND @FileTypeName is not null)
	OR ([FileTypeExtension] = @FileTypeExtension AND @FileTypeExtension is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdminRoles_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdminRoles_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdminRoles_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the AdminRoles table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdminRoles_Get_List

AS


				
				SELECT
					[AdminRoleID],
					[RoleName]
				FROM
					[dbo].[AdminRoles]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdminRoles_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdminRoles_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdminRoles_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the AdminRoles table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdminRoles_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [AdminRoleID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([AdminRoleID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [AdminRoleID]'
				SET @SQL = @SQL + ' FROM [dbo].[AdminRoles]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[AdminRoleID], O.[RoleName]
				FROM
				    [dbo].[AdminRoles] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[AdminRoleID] = PageIndex.[AdminRoleID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[AdminRoles]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdminRoles_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdminRoles_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdminRoles_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the AdminRoles table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdminRoles_Insert
(

	@AdminRoleId int    OUTPUT,

	@RoleName varchar (255)  
)
AS


				
				INSERT INTO [dbo].[AdminRoles]
					(
					[RoleName]
					)
				VALUES
					(
					@RoleName
					)
				
				-- Get the identity value
				SET @AdminRoleId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdminRoles_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdminRoles_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdminRoles_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the AdminRoles table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdminRoles_Update
(

	@AdminRoleId int   ,

	@RoleName varchar (255)  
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[AdminRoles]
				SET
					[RoleName] = @RoleName
				WHERE
[AdminRoleID] = @AdminRoleId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdminRoles_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdminRoles_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdminRoles_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the AdminRoles table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdminRoles_Delete
(

	@AdminRoleId int   
)
AS


				DELETE FROM [dbo].[AdminRoles] WITH (ROWLOCK) 
				WHERE
					[AdminRoleID] = @AdminRoleId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdminRoles_GetByAdminRoleId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdminRoles_GetByAdminRoleId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdminRoles_GetByAdminRoleId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the AdminRoles table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdminRoles_GetByAdminRoleId
(

	@AdminRoleId int   
)
AS


				SELECT
					[AdminRoleID],
					[RoleName]
				FROM
					[dbo].[AdminRoles]
				WHERE
					[AdminRoleID] = @AdminRoleId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdminRoles_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdminRoles_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdminRoles_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the AdminRoles table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdminRoles_Find
(

	@SearchUsingOR bit   = null ,

	@AdminRoleId int   = null ,

	@RoleName varchar (255)  = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [AdminRoleID]
	, [RoleName]
    FROM
	[dbo].[AdminRoles]
    WHERE 
	 ([AdminRoleID] = @AdminRoleId OR @AdminRoleId IS NULL)
	AND ([RoleName] = @RoleName OR @RoleName IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [AdminRoleID]
	, [RoleName]
    FROM
	[dbo].[AdminRoles]
    WHERE 
	 ([AdminRoleID] = @AdminRoleId AND @AdminRoleId is not null)
	OR ([RoleName] = @RoleName AND @RoleName is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.ExceptionTable_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.ExceptionTable_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.ExceptionTable_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the ExceptionTable table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.ExceptionTable_Get_List

AS


				
				SELECT
					[ExceptionID],
					[DateEntered],
					[ExceptionApplicationSource],
					[ClientIPAddress],
					[HostIPAddress],
					[ExceptionUrl],
					[ExceptionMessage],
					[ExceptionStackTrace],
					[ErrorParamsMessage]
				FROM
					[dbo].[ExceptionTable]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.ExceptionTable_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.ExceptionTable_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.ExceptionTable_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the ExceptionTable table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.ExceptionTable_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [ExceptionID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([ExceptionID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [ExceptionID]'
				SET @SQL = @SQL + ' FROM [dbo].[ExceptionTable]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[ExceptionID], O.[DateEntered], O.[ExceptionApplicationSource], O.[ClientIPAddress], O.[HostIPAddress], O.[ExceptionUrl], O.[ExceptionMessage], O.[ExceptionStackTrace], O.[ErrorParamsMessage]
				FROM
				    [dbo].[ExceptionTable] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[ExceptionID] = PageIndex.[ExceptionID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[ExceptionTable]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.ExceptionTable_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.ExceptionTable_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.ExceptionTable_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the ExceptionTable table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.ExceptionTable_Insert
(

	@ExceptionId int    OUTPUT,

	@DateEntered datetime   ,

	@ExceptionApplicationSource varchar (500)  ,

	@ClientIpAddress varchar (255)  ,

	@HostIpAddress varchar (255)  ,

	@ExceptionUrl varchar (4000)  ,

	@ExceptionMessage text   ,

	@ExceptionStackTrace text   ,

	@ErrorParamsMessage text   
)
AS


				
				INSERT INTO [dbo].[ExceptionTable]
					(
					[DateEntered]
					,[ExceptionApplicationSource]
					,[ClientIPAddress]
					,[HostIPAddress]
					,[ExceptionUrl]
					,[ExceptionMessage]
					,[ExceptionStackTrace]
					,[ErrorParamsMessage]
					)
				VALUES
					(
					@DateEntered
					,@ExceptionApplicationSource
					,@ClientIpAddress
					,@HostIpAddress
					,@ExceptionUrl
					,@ExceptionMessage
					,@ExceptionStackTrace
					,@ErrorParamsMessage
					)
				
				-- Get the identity value
				SET @ExceptionId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.ExceptionTable_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.ExceptionTable_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.ExceptionTable_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the ExceptionTable table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.ExceptionTable_Update
(

	@ExceptionId int   ,

	@DateEntered datetime   ,

	@ExceptionApplicationSource varchar (500)  ,

	@ClientIpAddress varchar (255)  ,

	@HostIpAddress varchar (255)  ,

	@ExceptionUrl varchar (4000)  ,

	@ExceptionMessage text   ,

	@ExceptionStackTrace text   ,

	@ErrorParamsMessage text   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[ExceptionTable]
				SET
					[DateEntered] = @DateEntered
					,[ExceptionApplicationSource] = @ExceptionApplicationSource
					,[ClientIPAddress] = @ClientIpAddress
					,[HostIPAddress] = @HostIpAddress
					,[ExceptionUrl] = @ExceptionUrl
					,[ExceptionMessage] = @ExceptionMessage
					,[ExceptionStackTrace] = @ExceptionStackTrace
					,[ErrorParamsMessage] = @ErrorParamsMessage
				WHERE
[ExceptionID] = @ExceptionId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.ExceptionTable_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.ExceptionTable_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.ExceptionTable_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the ExceptionTable table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.ExceptionTable_Delete
(

	@ExceptionId int   
)
AS


				DELETE FROM [dbo].[ExceptionTable] WITH (ROWLOCK) 
				WHERE
					[ExceptionID] = @ExceptionId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.ExceptionTable_GetByExceptionId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.ExceptionTable_GetByExceptionId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.ExceptionTable_GetByExceptionId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the ExceptionTable table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.ExceptionTable_GetByExceptionId
(

	@ExceptionId int   
)
AS


				SELECT
					[ExceptionID],
					[DateEntered],
					[ExceptionApplicationSource],
					[ClientIPAddress],
					[HostIPAddress],
					[ExceptionUrl],
					[ExceptionMessage],
					[ExceptionStackTrace],
					[ErrorParamsMessage]
				FROM
					[dbo].[ExceptionTable]
				WHERE
					[ExceptionID] = @ExceptionId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.ExceptionTable_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.ExceptionTable_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.ExceptionTable_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the ExceptionTable table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.ExceptionTable_Find
(

	@SearchUsingOR bit   = null ,

	@ExceptionId int   = null ,

	@DateEntered datetime   = null ,

	@ExceptionApplicationSource varchar (500)  = null ,

	@ClientIpAddress varchar (255)  = null ,

	@HostIpAddress varchar (255)  = null ,

	@ExceptionUrl varchar (4000)  = null ,

	@ExceptionMessage text   = null ,

	@ExceptionStackTrace text   = null ,

	@ErrorParamsMessage text   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [ExceptionID]
	, [DateEntered]
	, [ExceptionApplicationSource]
	, [ClientIPAddress]
	, [HostIPAddress]
	, [ExceptionUrl]
	, [ExceptionMessage]
	, [ExceptionStackTrace]
	, [ErrorParamsMessage]
    FROM
	[dbo].[ExceptionTable]
    WHERE 
	 ([ExceptionID] = @ExceptionId OR @ExceptionId IS NULL)
	AND ([DateEntered] = @DateEntered OR @DateEntered IS NULL)
	AND ([ExceptionApplicationSource] = @ExceptionApplicationSource OR @ExceptionApplicationSource IS NULL)
	AND ([ClientIPAddress] = @ClientIpAddress OR @ClientIpAddress IS NULL)
	AND ([HostIPAddress] = @HostIpAddress OR @HostIpAddress IS NULL)
	AND ([ExceptionUrl] = @ExceptionUrl OR @ExceptionUrl IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [ExceptionID]
	, [DateEntered]
	, [ExceptionApplicationSource]
	, [ClientIPAddress]
	, [HostIPAddress]
	, [ExceptionUrl]
	, [ExceptionMessage]
	, [ExceptionStackTrace]
	, [ErrorParamsMessage]
    FROM
	[dbo].[ExceptionTable]
    WHERE 
	 ([ExceptionID] = @ExceptionId AND @ExceptionId is not null)
	OR ([DateEntered] = @DateEntered AND @DateEntered is not null)
	OR ([ExceptionApplicationSource] = @ExceptionApplicationSource AND @ExceptionApplicationSource is not null)
	OR ([ClientIPAddress] = @ClientIpAddress AND @ClientIpAddress is not null)
	OR ([HostIPAddress] = @HostIpAddress AND @HostIpAddress is not null)
	OR ([ExceptionUrl] = @ExceptionUrl AND @ExceptionUrl is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Languages_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Languages_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Languages_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the Languages table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Languages_Get_List

AS


				
				SELECT
					[LanguageID],
					[LanguageName],
					[CharSetMetaTag]
				FROM
					[dbo].[Languages]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Languages_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Languages_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Languages_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the Languages table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Languages_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [LanguageID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([LanguageID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [LanguageID]'
				SET @SQL = @SQL + ' FROM [dbo].[Languages]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[LanguageID], O.[LanguageName], O.[CharSetMetaTag]
				FROM
				    [dbo].[Languages] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[LanguageID] = PageIndex.[LanguageID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[Languages]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Languages_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Languages_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Languages_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the Languages table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Languages_Insert
(

	@LanguageId int    OUTPUT,

	@LanguageName varchar (255)  ,

	@CharSetMetaTag varchar (255)  
)
AS


				
				INSERT INTO [dbo].[Languages]
					(
					[LanguageName]
					,[CharSetMetaTag]
					)
				VALUES
					(
					@LanguageName
					,@CharSetMetaTag
					)
				
				-- Get the identity value
				SET @LanguageId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Languages_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Languages_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Languages_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the Languages table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Languages_Update
(

	@LanguageId int   ,

	@LanguageName varchar (255)  ,

	@CharSetMetaTag varchar (255)  
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[Languages]
				SET
					[LanguageName] = @LanguageName
					,[CharSetMetaTag] = @CharSetMetaTag
				WHERE
[LanguageID] = @LanguageId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Languages_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Languages_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Languages_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the Languages table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Languages_Delete
(

	@LanguageId int   
)
AS


				DELETE FROM [dbo].[Languages] WITH (ROWLOCK) 
				WHERE
					[LanguageID] = @LanguageId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Languages_GetByLanguageId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Languages_GetByLanguageId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Languages_GetByLanguageId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Languages table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Languages_GetByLanguageId
(

	@LanguageId int   
)
AS


				SELECT
					[LanguageID],
					[LanguageName],
					[CharSetMetaTag]
				FROM
					[dbo].[Languages]
				WHERE
					[LanguageID] = @LanguageId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Languages_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Languages_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Languages_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the Languages table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Languages_Find
(

	@SearchUsingOR bit   = null ,

	@LanguageId int   = null ,

	@LanguageName varchar (255)  = null ,

	@CharSetMetaTag varchar (255)  = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [LanguageID]
	, [LanguageName]
	, [CharSetMetaTag]
    FROM
	[dbo].[Languages]
    WHERE 
	 ([LanguageID] = @LanguageId OR @LanguageId IS NULL)
	AND ([LanguageName] = @LanguageName OR @LanguageName IS NULL)
	AND ([CharSetMetaTag] = @CharSetMetaTag OR @CharSetMetaTag IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [LanguageID]
	, [LanguageName]
	, [CharSetMetaTag]
    FROM
	[dbo].[Languages]
    WHERE 
	 ([LanguageID] = @LanguageId AND @LanguageId is not null)
	OR ([LanguageName] = @LanguageName AND @LanguageName is not null)
	OR ([CharSetMetaTag] = @CharSetMetaTag AND @CharSetMetaTag is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SalaryType_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SalaryType_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SalaryType_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the SalaryType table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SalaryType_Get_List

AS


				
				SELECT
					[SalaryTypeID],
					[SalaryTypeName],
					[Valid]
				FROM
					[dbo].[SalaryType]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SalaryType_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SalaryType_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SalaryType_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the SalaryType table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SalaryType_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [SalaryTypeID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([SalaryTypeID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [SalaryTypeID]'
				SET @SQL = @SQL + ' FROM [dbo].[SalaryType]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[SalaryTypeID], O.[SalaryTypeName], O.[Valid]
				FROM
				    [dbo].[SalaryType] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[SalaryTypeID] = PageIndex.[SalaryTypeID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[SalaryType]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SalaryType_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SalaryType_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SalaryType_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the SalaryType table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SalaryType_Insert
(

	@SalaryTypeId int    OUTPUT,

	@SalaryTypeName varchar (255)  ,

	@Valid bit   
)
AS


				
				INSERT INTO [dbo].[SalaryType]
					(
					[SalaryTypeName]
					,[Valid]
					)
				VALUES
					(
					@SalaryTypeName
					,@Valid
					)
				
				-- Get the identity value
				SET @SalaryTypeId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SalaryType_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SalaryType_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SalaryType_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the SalaryType table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SalaryType_Update
(

	@SalaryTypeId int   ,

	@SalaryTypeName varchar (255)  ,

	@Valid bit   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[SalaryType]
				SET
					[SalaryTypeName] = @SalaryTypeName
					,[Valid] = @Valid
				WHERE
[SalaryTypeID] = @SalaryTypeId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SalaryType_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SalaryType_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SalaryType_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the SalaryType table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SalaryType_Delete
(

	@SalaryTypeId int   
)
AS


				DELETE FROM [dbo].[SalaryType] WITH (ROWLOCK) 
				WHERE
					[SalaryTypeID] = @SalaryTypeId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SalaryType_GetBySalaryTypeId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SalaryType_GetBySalaryTypeId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SalaryType_GetBySalaryTypeId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SalaryType table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SalaryType_GetBySalaryTypeId
(

	@SalaryTypeId int   
)
AS


				SELECT
					[SalaryTypeID],
					[SalaryTypeName],
					[Valid]
				FROM
					[dbo].[SalaryType]
				WHERE
					[SalaryTypeID] = @SalaryTypeId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SalaryType_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SalaryType_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SalaryType_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the SalaryType table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SalaryType_Find
(

	@SearchUsingOR bit   = null ,

	@SalaryTypeId int   = null ,

	@SalaryTypeName varchar (255)  = null ,

	@Valid bit   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [SalaryTypeID]
	, [SalaryTypeName]
	, [Valid]
    FROM
	[dbo].[SalaryType]
    WHERE 
	 ([SalaryTypeID] = @SalaryTypeId OR @SalaryTypeId IS NULL)
	AND ([SalaryTypeName] = @SalaryTypeName OR @SalaryTypeName IS NULL)
	AND ([Valid] = @Valid OR @Valid IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [SalaryTypeID]
	, [SalaryTypeName]
	, [Valid]
    FROM
	[dbo].[SalaryType]
    WHERE 
	 ([SalaryTypeID] = @SalaryTypeId AND @SalaryTypeId is not null)
	OR ([SalaryTypeName] = @SalaryTypeName AND @SalaryTypeName is not null)
	OR ([Valid] = @Valid AND @Valid is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Location_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Location_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Location_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the Location table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Location_Get_List

AS


				
				SELECT
					[LocationID],
					[LocationName],
					[Valid],
					[Sequence],
					[CountryID]
				FROM
					[dbo].[Location]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Location_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Location_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Location_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the Location table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Location_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [LocationID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([LocationID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [LocationID]'
				SET @SQL = @SQL + ' FROM [dbo].[Location]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[LocationID], O.[LocationName], O.[Valid], O.[Sequence], O.[CountryID]
				FROM
				    [dbo].[Location] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[LocationID] = PageIndex.[LocationID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[Location]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Location_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Location_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Location_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the Location table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Location_Insert
(

	@LocationId int    OUTPUT,

	@LocationName nvarchar (1020)  ,

	@Valid bit   ,

	@Sequence int   ,

	@CountryId int   
)
AS


				
				INSERT INTO [dbo].[Location]
					(
					[LocationName]
					,[Valid]
					,[Sequence]
					,[CountryID]
					)
				VALUES
					(
					@LocationName
					,@Valid
					,@Sequence
					,@CountryId
					)
				
				-- Get the identity value
				SET @LocationId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Location_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Location_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Location_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the Location table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Location_Update
(

	@LocationId int   ,

	@LocationName nvarchar (1020)  ,

	@Valid bit   ,

	@Sequence int   ,

	@CountryId int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[Location]
				SET
					[LocationName] = @LocationName
					,[Valid] = @Valid
					,[Sequence] = @Sequence
					,[CountryID] = @CountryId
				WHERE
[LocationID] = @LocationId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Location_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Location_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Location_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the Location table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Location_Delete
(

	@LocationId int   
)
AS


				DELETE FROM [dbo].[Location] WITH (ROWLOCK) 
				WHERE
					[LocationID] = @LocationId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Location_GetByCountryId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Location_GetByCountryId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Location_GetByCountryId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Location table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Location_GetByCountryId
(

	@CountryId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[LocationID],
					[LocationName],
					[Valid],
					[Sequence],
					[CountryID]
				FROM
					[dbo].[Location]
				WHERE
					[CountryID] = @CountryId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Location_GetByLocationId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Location_GetByLocationId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Location_GetByLocationId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Location table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Location_GetByLocationId
(

	@LocationId int   
)
AS


				SELECT
					[LocationID],
					[LocationName],
					[Valid],
					[Sequence],
					[CountryID]
				FROM
					[dbo].[Location]
				WHERE
					[LocationID] = @LocationId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Location_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Location_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Location_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the Location table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Location_Find
(

	@SearchUsingOR bit   = null ,

	@LocationId int   = null ,

	@LocationName nvarchar (1020)  = null ,

	@Valid bit   = null ,

	@Sequence int   = null ,

	@CountryId int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [LocationID]
	, [LocationName]
	, [Valid]
	, [Sequence]
	, [CountryID]
    FROM
	[dbo].[Location]
    WHERE 
	 ([LocationID] = @LocationId OR @LocationId IS NULL)
	AND ([LocationName] = @LocationName OR @LocationName IS NULL)
	AND ([Valid] = @Valid OR @Valid IS NULL)
	AND ([Sequence] = @Sequence OR @Sequence IS NULL)
	AND ([CountryID] = @CountryId OR @CountryId IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [LocationID]
	, [LocationName]
	, [Valid]
	, [Sequence]
	, [CountryID]
    FROM
	[dbo].[Location]
    WHERE 
	 ([LocationID] = @LocationId AND @LocationId is not null)
	OR ([LocationName] = @LocationName AND @LocationName is not null)
	OR ([Valid] = @Valid AND @Valid is not null)
	OR ([Sequence] = @Sequence AND @Sequence is not null)
	OR ([CountryID] = @CountryId AND @CountryId is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Salary_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Salary_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Salary_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the Salary table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Salary_Get_List

AS


				
				SELECT
					[SalaryID],
					[SalaryTypeID],
					[CurrencyID],
					[Amount],
					[SalaryDisplay],
					[IsFrom]
				FROM
					[dbo].[Salary]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Salary_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Salary_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Salary_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the Salary table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Salary_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [SalaryID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([SalaryID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [SalaryID]'
				SET @SQL = @SQL + ' FROM [dbo].[Salary]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[SalaryID], O.[SalaryTypeID], O.[CurrencyID], O.[Amount], O.[SalaryDisplay], O.[IsFrom]
				FROM
				    [dbo].[Salary] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[SalaryID] = PageIndex.[SalaryID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[Salary]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Salary_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Salary_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Salary_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the Salary table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Salary_Insert
(

	@SalaryId int    OUTPUT,

	@SalaryTypeId int   ,

	@CurrencyId int   ,

	@Amount numeric (15, 2)  ,

	@SalaryDisplay varchar (100)  ,

	@IsFrom bit   
)
AS


				
				INSERT INTO [dbo].[Salary]
					(
					[SalaryTypeID]
					,[CurrencyID]
					,[Amount]
					,[SalaryDisplay]
					,[IsFrom]
					)
				VALUES
					(
					@SalaryTypeId
					,@CurrencyId
					,@Amount
					,@SalaryDisplay
					,@IsFrom
					)
				
				-- Get the identity value
				SET @SalaryId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Salary_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Salary_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Salary_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the Salary table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Salary_Update
(

	@SalaryId int   ,

	@SalaryTypeId int   ,

	@CurrencyId int   ,

	@Amount numeric (15, 2)  ,

	@SalaryDisplay varchar (100)  ,

	@IsFrom bit   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[Salary]
				SET
					[SalaryTypeID] = @SalaryTypeId
					,[CurrencyID] = @CurrencyId
					,[Amount] = @Amount
					,[SalaryDisplay] = @SalaryDisplay
					,[IsFrom] = @IsFrom
				WHERE
[SalaryID] = @SalaryId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Salary_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Salary_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Salary_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the Salary table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Salary_Delete
(

	@SalaryId int   
)
AS


				DELETE FROM [dbo].[Salary] WITH (ROWLOCK) 
				WHERE
					[SalaryID] = @SalaryId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Salary_GetByCurrencyId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Salary_GetByCurrencyId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Salary_GetByCurrencyId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Salary table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Salary_GetByCurrencyId
(

	@CurrencyId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[SalaryID],
					[SalaryTypeID],
					[CurrencyID],
					[Amount],
					[SalaryDisplay],
					[IsFrom]
				FROM
					[dbo].[Salary]
				WHERE
					[CurrencyID] = @CurrencyId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Salary_GetBySalaryTypeId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Salary_GetBySalaryTypeId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Salary_GetBySalaryTypeId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Salary table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Salary_GetBySalaryTypeId
(

	@SalaryTypeId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[SalaryID],
					[SalaryTypeID],
					[CurrencyID],
					[Amount],
					[SalaryDisplay],
					[IsFrom]
				FROM
					[dbo].[Salary]
				WHERE
					[SalaryTypeID] = @SalaryTypeId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Salary_GetBySalaryId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Salary_GetBySalaryId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Salary_GetBySalaryId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Salary table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Salary_GetBySalaryId
(

	@SalaryId int   
)
AS


				SELECT
					[SalaryID],
					[SalaryTypeID],
					[CurrencyID],
					[Amount],
					[SalaryDisplay],
					[IsFrom]
				FROM
					[dbo].[Salary]
				WHERE
					[SalaryID] = @SalaryId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Salary_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Salary_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Salary_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the Salary table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Salary_Find
(

	@SearchUsingOR bit   = null ,

	@SalaryId int   = null ,

	@SalaryTypeId int   = null ,

	@CurrencyId int   = null ,

	@Amount numeric (15, 2)  = null ,

	@SalaryDisplay varchar (100)  = null ,

	@IsFrom bit   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [SalaryID]
	, [SalaryTypeID]
	, [CurrencyID]
	, [Amount]
	, [SalaryDisplay]
	, [IsFrom]
    FROM
	[dbo].[Salary]
    WHERE 
	 ([SalaryID] = @SalaryId OR @SalaryId IS NULL)
	AND ([SalaryTypeID] = @SalaryTypeId OR @SalaryTypeId IS NULL)
	AND ([CurrencyID] = @CurrencyId OR @CurrencyId IS NULL)
	AND ([Amount] = @Amount OR @Amount IS NULL)
	AND ([SalaryDisplay] = @SalaryDisplay OR @SalaryDisplay IS NULL)
	AND ([IsFrom] = @IsFrom OR @IsFrom IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [SalaryID]
	, [SalaryTypeID]
	, [CurrencyID]
	, [Amount]
	, [SalaryDisplay]
	, [IsFrom]
    FROM
	[dbo].[Salary]
    WHERE 
	 ([SalaryID] = @SalaryId AND @SalaryId is not null)
	OR ([SalaryTypeID] = @SalaryTypeId AND @SalaryTypeId is not null)
	OR ([CurrencyID] = @CurrencyId AND @CurrencyId is not null)
	OR ([Amount] = @Amount AND @Amount is not null)
	OR ([SalaryDisplay] = @SalaryDisplay AND @SalaryDisplay is not null)
	OR ([IsFrom] = @IsFrom AND @IsFrom is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteSummary_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteSummary_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteSummary_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the SiteSummary table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteSummary_Get_List

AS


				
				SELECT
					[SiteSummaryID],
					[SiteID],
					[Title],
					[Description],
					[ModifiedBy],
					[URL],
					[TimeStamp],
					[Valid],
					[ShowPlatformNotification],
					[PlatformNotificationText],
					[LastModifiedDate],
					[LastModifiedBy]
				FROM
					[dbo].[SiteSummary]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteSummary_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteSummary_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteSummary_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the SiteSummary table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteSummary_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [SiteSummaryID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([SiteSummaryID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [SiteSummaryID]'
				SET @SQL = @SQL + ' FROM [dbo].[SiteSummary]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[SiteSummaryID], O.[SiteID], O.[Title], O.[Description], O.[ModifiedBy], O.[URL], O.[TimeStamp], O.[Valid], O.[ShowPlatformNotification], O.[PlatformNotificationText], O.[LastModifiedDate], O.[LastModifiedBy]
				FROM
				    [dbo].[SiteSummary] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[SiteSummaryID] = PageIndex.[SiteSummaryID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[SiteSummary]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteSummary_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteSummary_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteSummary_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the SiteSummary table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteSummary_Insert
(

	@SiteSummaryId int    OUTPUT,

	@SiteId int   ,

	@Title nvarchar (500)  ,

	@Description nvarchar (2000)  ,

	@ModifiedBy varchar (100)  ,

	@Url varchar (250)  ,

	@TimeStamp datetime   ,

	@Valid int   ,

	@ShowPlatformNotification bit   ,

	@PlatformNotificationText nvarchar (2000)  ,

	@LastModifiedDate datetime   ,

	@LastModifiedBy int   
)
AS


				
				INSERT INTO [dbo].[SiteSummary]
					(
					[SiteID]
					,[Title]
					,[Description]
					,[ModifiedBy]
					,[URL]
					,[TimeStamp]
					,[Valid]
					,[ShowPlatformNotification]
					,[PlatformNotificationText]
					,[LastModifiedDate]
					,[LastModifiedBy]
					)
				VALUES
					(
					@SiteId
					,@Title
					,@Description
					,@ModifiedBy
					,@Url
					,@TimeStamp
					,@Valid
					,@ShowPlatformNotification
					,@PlatformNotificationText
					,@LastModifiedDate
					,@LastModifiedBy
					)
				
				-- Get the identity value
				SET @SiteSummaryId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteSummary_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteSummary_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteSummary_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the SiteSummary table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteSummary_Update
(

	@SiteSummaryId int   ,

	@SiteId int   ,

	@Title nvarchar (500)  ,

	@Description nvarchar (2000)  ,

	@ModifiedBy varchar (100)  ,

	@Url varchar (250)  ,

	@TimeStamp datetime   ,

	@Valid int   ,

	@ShowPlatformNotification bit   ,

	@PlatformNotificationText nvarchar (2000)  ,

	@LastModifiedDate datetime   ,

	@LastModifiedBy int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[SiteSummary]
				SET
					[SiteID] = @SiteId
					,[Title] = @Title
					,[Description] = @Description
					,[ModifiedBy] = @ModifiedBy
					,[URL] = @Url
					,[TimeStamp] = @TimeStamp
					,[Valid] = @Valid
					,[ShowPlatformNotification] = @ShowPlatformNotification
					,[PlatformNotificationText] = @PlatformNotificationText
					,[LastModifiedDate] = @LastModifiedDate
					,[LastModifiedBy] = @LastModifiedBy
				WHERE
[SiteSummaryID] = @SiteSummaryId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteSummary_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteSummary_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteSummary_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the SiteSummary table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteSummary_Delete
(

	@SiteSummaryId int   
)
AS


				DELETE FROM [dbo].[SiteSummary] WITH (ROWLOCK) 
				WHERE
					[SiteSummaryID] = @SiteSummaryId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteSummary_GetBySiteSummaryId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteSummary_GetBySiteSummaryId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteSummary_GetBySiteSummaryId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteSummary table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteSummary_GetBySiteSummaryId
(

	@SiteSummaryId int   
)
AS


				SELECT
					[SiteSummaryID],
					[SiteID],
					[Title],
					[Description],
					[ModifiedBy],
					[URL],
					[TimeStamp],
					[Valid],
					[ShowPlatformNotification],
					[PlatformNotificationText],
					[LastModifiedDate],
					[LastModifiedBy]
				FROM
					[dbo].[SiteSummary]
				WHERE
					[SiteSummaryID] = @SiteSummaryId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteSummary_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteSummary_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteSummary_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the SiteSummary table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteSummary_Find
(

	@SearchUsingOR bit   = null ,

	@SiteSummaryId int   = null ,

	@SiteId int   = null ,

	@Title nvarchar (500)  = null ,

	@Description nvarchar (2000)  = null ,

	@ModifiedBy varchar (100)  = null ,

	@Url varchar (250)  = null ,

	@TimeStamp datetime   = null ,

	@Valid int   = null ,

	@ShowPlatformNotification bit   = null ,

	@PlatformNotificationText nvarchar (2000)  = null ,

	@LastModifiedDate datetime   = null ,

	@LastModifiedBy int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [SiteSummaryID]
	, [SiteID]
	, [Title]
	, [Description]
	, [ModifiedBy]
	, [URL]
	, [TimeStamp]
	, [Valid]
	, [ShowPlatformNotification]
	, [PlatformNotificationText]
	, [LastModifiedDate]
	, [LastModifiedBy]
    FROM
	[dbo].[SiteSummary]
    WHERE 
	 ([SiteSummaryID] = @SiteSummaryId OR @SiteSummaryId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([Title] = @Title OR @Title IS NULL)
	AND ([Description] = @Description OR @Description IS NULL)
	AND ([ModifiedBy] = @ModifiedBy OR @ModifiedBy IS NULL)
	AND ([URL] = @Url OR @Url IS NULL)
	AND ([TimeStamp] = @TimeStamp OR @TimeStamp IS NULL)
	AND ([Valid] = @Valid OR @Valid IS NULL)
	AND ([ShowPlatformNotification] = @ShowPlatformNotification OR @ShowPlatformNotification IS NULL)
	AND ([PlatformNotificationText] = @PlatformNotificationText OR @PlatformNotificationText IS NULL)
	AND ([LastModifiedDate] = @LastModifiedDate OR @LastModifiedDate IS NULL)
	AND ([LastModifiedBy] = @LastModifiedBy OR @LastModifiedBy IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [SiteSummaryID]
	, [SiteID]
	, [Title]
	, [Description]
	, [ModifiedBy]
	, [URL]
	, [TimeStamp]
	, [Valid]
	, [ShowPlatformNotification]
	, [PlatformNotificationText]
	, [LastModifiedDate]
	, [LastModifiedBy]
    FROM
	[dbo].[SiteSummary]
    WHERE 
	 ([SiteSummaryID] = @SiteSummaryId AND @SiteSummaryId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([Title] = @Title AND @Title is not null)
	OR ([Description] = @Description AND @Description is not null)
	OR ([ModifiedBy] = @ModifiedBy AND @ModifiedBy is not null)
	OR ([URL] = @Url AND @Url is not null)
	OR ([TimeStamp] = @TimeStamp AND @TimeStamp is not null)
	OR ([Valid] = @Valid AND @Valid is not null)
	OR ([ShowPlatformNotification] = @ShowPlatformNotification AND @ShowPlatformNotification is not null)
	OR ([PlatformNotificationText] = @PlatformNotificationText AND @PlatformNotificationText is not null)
	OR ([LastModifiedDate] = @LastModifiedDate AND @LastModifiedDate is not null)
	OR ([LastModifiedBy] = @LastModifiedBy AND @LastModifiedBy is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberFileTypes_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberFileTypes_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberFileTypes_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the MemberFileTypes table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberFileTypes_Get_List

AS


				
				SELECT
					[MemberFileTypeID],
					[MemberFileTypeName],
					[MemberFileExtensions]
				FROM
					[dbo].[MemberFileTypes]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberFileTypes_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberFileTypes_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberFileTypes_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the MemberFileTypes table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberFileTypes_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [MemberFileTypeID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([MemberFileTypeID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [MemberFileTypeID]'
				SET @SQL = @SQL + ' FROM [dbo].[MemberFileTypes]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[MemberFileTypeID], O.[MemberFileTypeName], O.[MemberFileExtensions]
				FROM
				    [dbo].[MemberFileTypes] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[MemberFileTypeID] = PageIndex.[MemberFileTypeID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[MemberFileTypes]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberFileTypes_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberFileTypes_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberFileTypes_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the MemberFileTypes table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberFileTypes_Insert
(

	@MemberFileTypeId int    OUTPUT,

	@MemberFileTypeName varchar (255)  ,

	@MemberFileExtensions varchar (255)  
)
AS


				
				INSERT INTO [dbo].[MemberFileTypes]
					(
					[MemberFileTypeName]
					,[MemberFileExtensions]
					)
				VALUES
					(
					@MemberFileTypeName
					,@MemberFileExtensions
					)
				
				-- Get the identity value
				SET @MemberFileTypeId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberFileTypes_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberFileTypes_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberFileTypes_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the MemberFileTypes table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberFileTypes_Update
(

	@MemberFileTypeId int   ,

	@MemberFileTypeName varchar (255)  ,

	@MemberFileExtensions varchar (255)  
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[MemberFileTypes]
				SET
					[MemberFileTypeName] = @MemberFileTypeName
					,[MemberFileExtensions] = @MemberFileExtensions
				WHERE
[MemberFileTypeID] = @MemberFileTypeId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberFileTypes_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberFileTypes_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberFileTypes_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the MemberFileTypes table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberFileTypes_Delete
(

	@MemberFileTypeId int   
)
AS


				DELETE FROM [dbo].[MemberFileTypes] WITH (ROWLOCK) 
				WHERE
					[MemberFileTypeID] = @MemberFileTypeId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberFileTypes_GetByMemberFileTypeId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberFileTypes_GetByMemberFileTypeId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberFileTypes_GetByMemberFileTypeId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the MemberFileTypes table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberFileTypes_GetByMemberFileTypeId
(

	@MemberFileTypeId int   
)
AS


				SELECT
					[MemberFileTypeID],
					[MemberFileTypeName],
					[MemberFileExtensions]
				FROM
					[dbo].[MemberFileTypes]
				WHERE
					[MemberFileTypeID] = @MemberFileTypeId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberFileTypes_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberFileTypes_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberFileTypes_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the MemberFileTypes table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberFileTypes_Find
(

	@SearchUsingOR bit   = null ,

	@MemberFileTypeId int   = null ,

	@MemberFileTypeName varchar (255)  = null ,

	@MemberFileExtensions varchar (255)  = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [MemberFileTypeID]
	, [MemberFileTypeName]
	, [MemberFileExtensions]
    FROM
	[dbo].[MemberFileTypes]
    WHERE 
	 ([MemberFileTypeID] = @MemberFileTypeId OR @MemberFileTypeId IS NULL)
	AND ([MemberFileTypeName] = @MemberFileTypeName OR @MemberFileTypeName IS NULL)
	AND ([MemberFileExtensions] = @MemberFileExtensions OR @MemberFileExtensions IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [MemberFileTypeID]
	, [MemberFileTypeName]
	, [MemberFileExtensions]
    FROM
	[dbo].[MemberFileTypes]
    WHERE 
	 ([MemberFileTypeID] = @MemberFileTypeId AND @MemberFileTypeId is not null)
	OR ([MemberFileTypeName] = @MemberFileTypeName AND @MemberFileTypeName is not null)
	OR ([MemberFileExtensions] = @MemberFileExtensions AND @MemberFileExtensions is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.NewsType_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.NewsType_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.NewsType_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the NewsType table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.NewsType_Get_List

AS


				
				SELECT
					[NewsTypeID],
					[NewsTypeName],
					[SiteID],
					[NewsTypeParentID],
					[GlobalTemplate],
					[Sequence],
					[ImageURL],
					[CustomXML],
					[LastModifiedBy],
					[LastModifiedDate]
				FROM
					[dbo].[NewsType]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.NewsType_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.NewsType_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.NewsType_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the NewsType table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.NewsType_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [NewsTypeID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([NewsTypeID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [NewsTypeID]'
				SET @SQL = @SQL + ' FROM [dbo].[NewsType]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[NewsTypeID], O.[NewsTypeName], O.[SiteID], O.[NewsTypeParentID], O.[GlobalTemplate], O.[Sequence], O.[ImageURL], O.[CustomXML], O.[LastModifiedBy], O.[LastModifiedDate]
				FROM
				    [dbo].[NewsType] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[NewsTypeID] = PageIndex.[NewsTypeID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[NewsType]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.NewsType_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.NewsType_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.NewsType_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the NewsType table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.NewsType_Insert
(

	@NewsTypeId int    OUTPUT,

	@NewsTypeName nvarchar (510)  ,

	@SiteId int   ,

	@NewsTypeParentId int   ,

	@GlobalTemplate bit   ,

	@Sequence int   ,

	@ImageUrl varchar (255)  ,

	@CustomXml nvarchar (MAX)  ,

	@LastModifiedBy int   ,

	@LastModifiedDate datetime   
)
AS


				
				INSERT INTO [dbo].[NewsType]
					(
					[NewsTypeName]
					,[SiteID]
					,[NewsTypeParentID]
					,[GlobalTemplate]
					,[Sequence]
					,[ImageURL]
					,[CustomXML]
					,[LastModifiedBy]
					,[LastModifiedDate]
					)
				VALUES
					(
					@NewsTypeName
					,@SiteId
					,@NewsTypeParentId
					,@GlobalTemplate
					,@Sequence
					,@ImageUrl
					,@CustomXml
					,@LastModifiedBy
					,@LastModifiedDate
					)
				
				-- Get the identity value
				SET @NewsTypeId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.NewsType_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.NewsType_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.NewsType_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the NewsType table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.NewsType_Update
(

	@NewsTypeId int   ,

	@NewsTypeName nvarchar (510)  ,

	@SiteId int   ,

	@NewsTypeParentId int   ,

	@GlobalTemplate bit   ,

	@Sequence int   ,

	@ImageUrl varchar (255)  ,

	@CustomXml nvarchar (MAX)  ,

	@LastModifiedBy int   ,

	@LastModifiedDate datetime   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[NewsType]
				SET
					[NewsTypeName] = @NewsTypeName
					,[SiteID] = @SiteId
					,[NewsTypeParentID] = @NewsTypeParentId
					,[GlobalTemplate] = @GlobalTemplate
					,[Sequence] = @Sequence
					,[ImageURL] = @ImageUrl
					,[CustomXML] = @CustomXml
					,[LastModifiedBy] = @LastModifiedBy
					,[LastModifiedDate] = @LastModifiedDate
				WHERE
[NewsTypeID] = @NewsTypeId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.NewsType_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.NewsType_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.NewsType_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the NewsType table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.NewsType_Delete
(

	@NewsTypeId int   
)
AS


				DELETE FROM [dbo].[NewsType] WITH (ROWLOCK) 
				WHERE
					[NewsTypeID] = @NewsTypeId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.NewsType_GetByNewsTypeId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.NewsType_GetByNewsTypeId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.NewsType_GetByNewsTypeId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the NewsType table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.NewsType_GetByNewsTypeId
(

	@NewsTypeId int   
)
AS


				SELECT
					[NewsTypeID],
					[NewsTypeName],
					[SiteID],
					[NewsTypeParentID],
					[GlobalTemplate],
					[Sequence],
					[ImageURL],
					[CustomXML],
					[LastModifiedBy],
					[LastModifiedDate]
				FROM
					[dbo].[NewsType]
				WHERE
					[NewsTypeID] = @NewsTypeId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.NewsType_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.NewsType_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.NewsType_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the NewsType table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.NewsType_Find
(

	@SearchUsingOR bit   = null ,

	@NewsTypeId int   = null ,

	@NewsTypeName nvarchar (510)  = null ,

	@SiteId int   = null ,

	@NewsTypeParentId int   = null ,

	@GlobalTemplate bit   = null ,

	@Sequence int   = null ,

	@ImageUrl varchar (255)  = null ,

	@CustomXml nvarchar (MAX)  = null ,

	@LastModifiedBy int   = null ,

	@LastModifiedDate datetime   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [NewsTypeID]
	, [NewsTypeName]
	, [SiteID]
	, [NewsTypeParentID]
	, [GlobalTemplate]
	, [Sequence]
	, [ImageURL]
	, [CustomXML]
	, [LastModifiedBy]
	, [LastModifiedDate]
    FROM
	[dbo].[NewsType]
    WHERE 
	 ([NewsTypeID] = @NewsTypeId OR @NewsTypeId IS NULL)
	AND ([NewsTypeName] = @NewsTypeName OR @NewsTypeName IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([NewsTypeParentID] = @NewsTypeParentId OR @NewsTypeParentId IS NULL)
	AND ([GlobalTemplate] = @GlobalTemplate OR @GlobalTemplate IS NULL)
	AND ([Sequence] = @Sequence OR @Sequence IS NULL)
	AND ([ImageURL] = @ImageUrl OR @ImageUrl IS NULL)
	AND ([CustomXML] = @CustomXml OR @CustomXml IS NULL)
	AND ([LastModifiedBy] = @LastModifiedBy OR @LastModifiedBy IS NULL)
	AND ([LastModifiedDate] = @LastModifiedDate OR @LastModifiedDate IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [NewsTypeID]
	, [NewsTypeName]
	, [SiteID]
	, [NewsTypeParentID]
	, [GlobalTemplate]
	, [Sequence]
	, [ImageURL]
	, [CustomXML]
	, [LastModifiedBy]
	, [LastModifiedDate]
    FROM
	[dbo].[NewsType]
    WHERE 
	 ([NewsTypeID] = @NewsTypeId AND @NewsTypeId is not null)
	OR ([NewsTypeName] = @NewsTypeName AND @NewsTypeName is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([NewsTypeParentID] = @NewsTypeParentId AND @NewsTypeParentId is not null)
	OR ([GlobalTemplate] = @GlobalTemplate AND @GlobalTemplate is not null)
	OR ([Sequence] = @Sequence AND @Sequence is not null)
	OR ([ImageURL] = @ImageUrl AND @ImageUrl is not null)
	OR ([CustomXML] = @CustomXml AND @CustomXml is not null)
	OR ([LastModifiedBy] = @LastModifiedBy AND @LastModifiedBy is not null)
	OR ([LastModifiedDate] = @LastModifiedDate AND @LastModifiedDate is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPageRevisions_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPageRevisions_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPageRevisions_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the DynamicPageRevisions table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPageRevisions_Get_List

AS


				
				SELECT
					[DynamicPageRevisionID],
					[DynamicPageID],
					[SiteID],
					[LanguageID],
					[ParentDynamicPageID],
					[PageName],
					[PageTitle],
					[PageContent],
					[DynamicPageWebPartTemplateID],
					[HyperLink],
					[Valid],
					[OpenInNewWindow],
					[Sequence],
					[FullScreen],
					[OnTopNav],
					[OnLeftNav],
					[OnBottomNav],
					[OnSiteMap],
					[Searchable],
					[MetaKeywords],
					[MetaDescription],
					[PageFriendlyName],
					[LastModified],
					[LastModifiedBy],
					[SearchField],
					[SourceID],
					[Secured],
					[CustomUrl],
					[MetaTitle],
					[GenerateBreadcrumb],
					[Status],
					[Visible],
					[PublishOn],
					[MappingID],
					[Comment],
					[PageLog]
				FROM
					[dbo].[DynamicPageRevisions]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPageRevisions_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPageRevisions_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPageRevisions_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the DynamicPageRevisions table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPageRevisions_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [DynamicPageRevisionID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([DynamicPageRevisionID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [DynamicPageRevisionID]'
				SET @SQL = @SQL + ' FROM [dbo].[DynamicPageRevisions]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[DynamicPageRevisionID], O.[DynamicPageID], O.[SiteID], O.[LanguageID], O.[ParentDynamicPageID], O.[PageName], O.[PageTitle], O.[PageContent], O.[DynamicPageWebPartTemplateID], O.[HyperLink], O.[Valid], O.[OpenInNewWindow], O.[Sequence], O.[FullScreen], O.[OnTopNav], O.[OnLeftNav], O.[OnBottomNav], O.[OnSiteMap], O.[Searchable], O.[MetaKeywords], O.[MetaDescription], O.[PageFriendlyName], O.[LastModified], O.[LastModifiedBy], O.[SearchField], O.[SourceID], O.[Secured], O.[CustomUrl], O.[MetaTitle], O.[GenerateBreadcrumb], O.[Status], O.[Visible], O.[PublishOn], O.[MappingID], O.[Comment], O.[PageLog]
				FROM
				    [dbo].[DynamicPageRevisions] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[DynamicPageRevisionID] = PageIndex.[DynamicPageRevisionID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[DynamicPageRevisions]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPageRevisions_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPageRevisions_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPageRevisions_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the DynamicPageRevisions table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPageRevisions_Insert
(

	@DynamicPageRevisionId int    OUTPUT,

	@DynamicPageId int   ,

	@SiteId int   ,

	@LanguageId int   ,

	@ParentDynamicPageId int   ,

	@PageName varchar (255)  ,

	@PageTitle nvarchar (510)  ,

	@PageContent ntext   ,

	@DynamicPageWebPartTemplateId int   ,

	@HyperLink varchar (255)  ,

	@Valid bit   ,

	@OpenInNewWindow bit   ,

	@Sequence int   ,

	@FullScreen bit   ,

	@OnTopNav bit   ,

	@OnLeftNav bit   ,

	@OnBottomNav bit   ,

	@OnSiteMap bit   ,

	@Searchable bit   ,

	@MetaKeywords nvarchar (510)  ,

	@MetaDescription nvarchar (1024)  ,

	@PageFriendlyName varchar (255)  ,

	@LastModified datetime   ,

	@LastModifiedBy int   ,

	@SearchField nvarchar (MAX)  ,

	@SourceId int   ,

	@Secured bit   ,

	@CustomUrl varchar (512)  ,

	@MetaTitle nvarchar (510)  ,

	@GenerateBreadcrumb bit   ,

	@Status int   ,

	@Visible bit   ,

	@PublishOn datetime   ,

	@MappingId uniqueidentifier   ,

	@Comment nvarchar (2000)  ,

	@PageLog nvarchar (2000)  
)
AS


				
				INSERT INTO [dbo].[DynamicPageRevisions]
					(
					[DynamicPageID]
					,[SiteID]
					,[LanguageID]
					,[ParentDynamicPageID]
					,[PageName]
					,[PageTitle]
					,[PageContent]
					,[DynamicPageWebPartTemplateID]
					,[HyperLink]
					,[Valid]
					,[OpenInNewWindow]
					,[Sequence]
					,[FullScreen]
					,[OnTopNav]
					,[OnLeftNav]
					,[OnBottomNav]
					,[OnSiteMap]
					,[Searchable]
					,[MetaKeywords]
					,[MetaDescription]
					,[PageFriendlyName]
					,[LastModified]
					,[LastModifiedBy]
					,[SearchField]
					,[SourceID]
					,[Secured]
					,[CustomUrl]
					,[MetaTitle]
					,[GenerateBreadcrumb]
					,[Status]
					,[Visible]
					,[PublishOn]
					,[MappingID]
					,[Comment]
					,[PageLog]
					)
				VALUES
					(
					@DynamicPageId
					,@SiteId
					,@LanguageId
					,@ParentDynamicPageId
					,@PageName
					,@PageTitle
					,@PageContent
					,@DynamicPageWebPartTemplateId
					,@HyperLink
					,@Valid
					,@OpenInNewWindow
					,@Sequence
					,@FullScreen
					,@OnTopNav
					,@OnLeftNav
					,@OnBottomNav
					,@OnSiteMap
					,@Searchable
					,@MetaKeywords
					,@MetaDescription
					,@PageFriendlyName
					,@LastModified
					,@LastModifiedBy
					,@SearchField
					,@SourceId
					,@Secured
					,@CustomUrl
					,@MetaTitle
					,@GenerateBreadcrumb
					,@Status
					,@Visible
					,@PublishOn
					,@MappingId
					,@Comment
					,@PageLog
					)
				
				-- Get the identity value
				SET @DynamicPageRevisionId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPageRevisions_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPageRevisions_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPageRevisions_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the DynamicPageRevisions table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPageRevisions_Update
(

	@DynamicPageRevisionId int   ,

	@DynamicPageId int   ,

	@SiteId int   ,

	@LanguageId int   ,

	@ParentDynamicPageId int   ,

	@PageName varchar (255)  ,

	@PageTitle nvarchar (510)  ,

	@PageContent ntext   ,

	@DynamicPageWebPartTemplateId int   ,

	@HyperLink varchar (255)  ,

	@Valid bit   ,

	@OpenInNewWindow bit   ,

	@Sequence int   ,

	@FullScreen bit   ,

	@OnTopNav bit   ,

	@OnLeftNav bit   ,

	@OnBottomNav bit   ,

	@OnSiteMap bit   ,

	@Searchable bit   ,

	@MetaKeywords nvarchar (510)  ,

	@MetaDescription nvarchar (1024)  ,

	@PageFriendlyName varchar (255)  ,

	@LastModified datetime   ,

	@LastModifiedBy int   ,

	@SearchField nvarchar (MAX)  ,

	@SourceId int   ,

	@Secured bit   ,

	@CustomUrl varchar (512)  ,

	@MetaTitle nvarchar (510)  ,

	@GenerateBreadcrumb bit   ,

	@Status int   ,

	@Visible bit   ,

	@PublishOn datetime   ,

	@MappingId uniqueidentifier   ,

	@Comment nvarchar (2000)  ,

	@PageLog nvarchar (2000)  
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[DynamicPageRevisions]
				SET
					[DynamicPageID] = @DynamicPageId
					,[SiteID] = @SiteId
					,[LanguageID] = @LanguageId
					,[ParentDynamicPageID] = @ParentDynamicPageId
					,[PageName] = @PageName
					,[PageTitle] = @PageTitle
					,[PageContent] = @PageContent
					,[DynamicPageWebPartTemplateID] = @DynamicPageWebPartTemplateId
					,[HyperLink] = @HyperLink
					,[Valid] = @Valid
					,[OpenInNewWindow] = @OpenInNewWindow
					,[Sequence] = @Sequence
					,[FullScreen] = @FullScreen
					,[OnTopNav] = @OnTopNav
					,[OnLeftNav] = @OnLeftNav
					,[OnBottomNav] = @OnBottomNav
					,[OnSiteMap] = @OnSiteMap
					,[Searchable] = @Searchable
					,[MetaKeywords] = @MetaKeywords
					,[MetaDescription] = @MetaDescription
					,[PageFriendlyName] = @PageFriendlyName
					,[LastModified] = @LastModified
					,[LastModifiedBy] = @LastModifiedBy
					,[SearchField] = @SearchField
					,[SourceID] = @SourceId
					,[Secured] = @Secured
					,[CustomUrl] = @CustomUrl
					,[MetaTitle] = @MetaTitle
					,[GenerateBreadcrumb] = @GenerateBreadcrumb
					,[Status] = @Status
					,[Visible] = @Visible
					,[PublishOn] = @PublishOn
					,[MappingID] = @MappingId
					,[Comment] = @Comment
					,[PageLog] = @PageLog
				WHERE
[DynamicPageRevisionID] = @DynamicPageRevisionId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPageRevisions_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPageRevisions_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPageRevisions_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the DynamicPageRevisions table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPageRevisions_Delete
(

	@DynamicPageRevisionId int   
)
AS


				DELETE FROM [dbo].[DynamicPageRevisions] WITH (ROWLOCK) 
				WHERE
					[DynamicPageRevisionID] = @DynamicPageRevisionId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPageRevisions_GetByDynamicPageRevisionId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPageRevisions_GetByDynamicPageRevisionId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPageRevisions_GetByDynamicPageRevisionId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the DynamicPageRevisions table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPageRevisions_GetByDynamicPageRevisionId
(

	@DynamicPageRevisionId int   
)
AS


				SELECT
					[DynamicPageRevisionID],
					[DynamicPageID],
					[SiteID],
					[LanguageID],
					[ParentDynamicPageID],
					[PageName],
					[PageTitle],
					[PageContent],
					[DynamicPageWebPartTemplateID],
					[HyperLink],
					[Valid],
					[OpenInNewWindow],
					[Sequence],
					[FullScreen],
					[OnTopNav],
					[OnLeftNav],
					[OnBottomNav],
					[OnSiteMap],
					[Searchable],
					[MetaKeywords],
					[MetaDescription],
					[PageFriendlyName],
					[LastModified],
					[LastModifiedBy],
					[SearchField],
					[SourceID],
					[Secured],
					[CustomUrl],
					[MetaTitle],
					[GenerateBreadcrumb],
					[Status],
					[Visible],
					[PublishOn],
					[MappingID],
					[Comment],
					[PageLog]
				FROM
					[dbo].[DynamicPageRevisions]
				WHERE
					[DynamicPageRevisionID] = @DynamicPageRevisionId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPageRevisions_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPageRevisions_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPageRevisions_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the DynamicPageRevisions table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPageRevisions_Find
(

	@SearchUsingOR bit   = null ,

	@DynamicPageRevisionId int   = null ,

	@DynamicPageId int   = null ,

	@SiteId int   = null ,

	@LanguageId int   = null ,

	@ParentDynamicPageId int   = null ,

	@PageName varchar (255)  = null ,

	@PageTitle nvarchar (510)  = null ,

	@PageContent ntext   = null ,

	@DynamicPageWebPartTemplateId int   = null ,

	@HyperLink varchar (255)  = null ,

	@Valid bit   = null ,

	@OpenInNewWindow bit   = null ,

	@Sequence int   = null ,

	@FullScreen bit   = null ,

	@OnTopNav bit   = null ,

	@OnLeftNav bit   = null ,

	@OnBottomNav bit   = null ,

	@OnSiteMap bit   = null ,

	@Searchable bit   = null ,

	@MetaKeywords nvarchar (510)  = null ,

	@MetaDescription nvarchar (1024)  = null ,

	@PageFriendlyName varchar (255)  = null ,

	@LastModified datetime   = null ,

	@LastModifiedBy int   = null ,

	@SearchField nvarchar (MAX)  = null ,

	@SourceId int   = null ,

	@Secured bit   = null ,

	@CustomUrl varchar (512)  = null ,

	@MetaTitle nvarchar (510)  = null ,

	@GenerateBreadcrumb bit   = null ,

	@Status int   = null ,

	@Visible bit   = null ,

	@PublishOn datetime   = null ,

	@MappingId uniqueidentifier   = null ,

	@Comment nvarchar (2000)  = null ,

	@PageLog nvarchar (2000)  = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [DynamicPageRevisionID]
	, [DynamicPageID]
	, [SiteID]
	, [LanguageID]
	, [ParentDynamicPageID]
	, [PageName]
	, [PageTitle]
	, [PageContent]
	, [DynamicPageWebPartTemplateID]
	, [HyperLink]
	, [Valid]
	, [OpenInNewWindow]
	, [Sequence]
	, [FullScreen]
	, [OnTopNav]
	, [OnLeftNav]
	, [OnBottomNav]
	, [OnSiteMap]
	, [Searchable]
	, [MetaKeywords]
	, [MetaDescription]
	, [PageFriendlyName]
	, [LastModified]
	, [LastModifiedBy]
	, [SearchField]
	, [SourceID]
	, [Secured]
	, [CustomUrl]
	, [MetaTitle]
	, [GenerateBreadcrumb]
	, [Status]
	, [Visible]
	, [PublishOn]
	, [MappingID]
	, [Comment]
	, [PageLog]
    FROM
	[dbo].[DynamicPageRevisions]
    WHERE 
	 ([DynamicPageRevisionID] = @DynamicPageRevisionId OR @DynamicPageRevisionId IS NULL)
	AND ([DynamicPageID] = @DynamicPageId OR @DynamicPageId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([LanguageID] = @LanguageId OR @LanguageId IS NULL)
	AND ([ParentDynamicPageID] = @ParentDynamicPageId OR @ParentDynamicPageId IS NULL)
	AND ([PageName] = @PageName OR @PageName IS NULL)
	AND ([PageTitle] = @PageTitle OR @PageTitle IS NULL)
	AND ([DynamicPageWebPartTemplateID] = @DynamicPageWebPartTemplateId OR @DynamicPageWebPartTemplateId IS NULL)
	AND ([HyperLink] = @HyperLink OR @HyperLink IS NULL)
	AND ([Valid] = @Valid OR @Valid IS NULL)
	AND ([OpenInNewWindow] = @OpenInNewWindow OR @OpenInNewWindow IS NULL)
	AND ([Sequence] = @Sequence OR @Sequence IS NULL)
	AND ([FullScreen] = @FullScreen OR @FullScreen IS NULL)
	AND ([OnTopNav] = @OnTopNav OR @OnTopNav IS NULL)
	AND ([OnLeftNav] = @OnLeftNav OR @OnLeftNav IS NULL)
	AND ([OnBottomNav] = @OnBottomNav OR @OnBottomNav IS NULL)
	AND ([OnSiteMap] = @OnSiteMap OR @OnSiteMap IS NULL)
	AND ([Searchable] = @Searchable OR @Searchable IS NULL)
	AND ([MetaKeywords] = @MetaKeywords OR @MetaKeywords IS NULL)
	AND ([MetaDescription] = @MetaDescription OR @MetaDescription IS NULL)
	AND ([PageFriendlyName] = @PageFriendlyName OR @PageFriendlyName IS NULL)
	AND ([LastModified] = @LastModified OR @LastModified IS NULL)
	AND ([LastModifiedBy] = @LastModifiedBy OR @LastModifiedBy IS NULL)
	AND ([SearchField] = @SearchField OR @SearchField IS NULL)
	AND ([SourceID] = @SourceId OR @SourceId IS NULL)
	AND ([Secured] = @Secured OR @Secured IS NULL)
	AND ([CustomUrl] = @CustomUrl OR @CustomUrl IS NULL)
	AND ([MetaTitle] = @MetaTitle OR @MetaTitle IS NULL)
	AND ([GenerateBreadcrumb] = @GenerateBreadcrumb OR @GenerateBreadcrumb IS NULL)
	AND ([Status] = @Status OR @Status IS NULL)
	AND ([Visible] = @Visible OR @Visible IS NULL)
	AND ([PublishOn] = @PublishOn OR @PublishOn IS NULL)
	AND ([MappingID] = @MappingId OR @MappingId IS NULL)
	AND ([Comment] = @Comment OR @Comment IS NULL)
	AND ([PageLog] = @PageLog OR @PageLog IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [DynamicPageRevisionID]
	, [DynamicPageID]
	, [SiteID]
	, [LanguageID]
	, [ParentDynamicPageID]
	, [PageName]
	, [PageTitle]
	, [PageContent]
	, [DynamicPageWebPartTemplateID]
	, [HyperLink]
	, [Valid]
	, [OpenInNewWindow]
	, [Sequence]
	, [FullScreen]
	, [OnTopNav]
	, [OnLeftNav]
	, [OnBottomNav]
	, [OnSiteMap]
	, [Searchable]
	, [MetaKeywords]
	, [MetaDescription]
	, [PageFriendlyName]
	, [LastModified]
	, [LastModifiedBy]
	, [SearchField]
	, [SourceID]
	, [Secured]
	, [CustomUrl]
	, [MetaTitle]
	, [GenerateBreadcrumb]
	, [Status]
	, [Visible]
	, [PublishOn]
	, [MappingID]
	, [Comment]
	, [PageLog]
    FROM
	[dbo].[DynamicPageRevisions]
    WHERE 
	 ([DynamicPageRevisionID] = @DynamicPageRevisionId AND @DynamicPageRevisionId is not null)
	OR ([DynamicPageID] = @DynamicPageId AND @DynamicPageId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([LanguageID] = @LanguageId AND @LanguageId is not null)
	OR ([ParentDynamicPageID] = @ParentDynamicPageId AND @ParentDynamicPageId is not null)
	OR ([PageName] = @PageName AND @PageName is not null)
	OR ([PageTitle] = @PageTitle AND @PageTitle is not null)
	OR ([DynamicPageWebPartTemplateID] = @DynamicPageWebPartTemplateId AND @DynamicPageWebPartTemplateId is not null)
	OR ([HyperLink] = @HyperLink AND @HyperLink is not null)
	OR ([Valid] = @Valid AND @Valid is not null)
	OR ([OpenInNewWindow] = @OpenInNewWindow AND @OpenInNewWindow is not null)
	OR ([Sequence] = @Sequence AND @Sequence is not null)
	OR ([FullScreen] = @FullScreen AND @FullScreen is not null)
	OR ([OnTopNav] = @OnTopNav AND @OnTopNav is not null)
	OR ([OnLeftNav] = @OnLeftNav AND @OnLeftNav is not null)
	OR ([OnBottomNav] = @OnBottomNav AND @OnBottomNav is not null)
	OR ([OnSiteMap] = @OnSiteMap AND @OnSiteMap is not null)
	OR ([Searchable] = @Searchable AND @Searchable is not null)
	OR ([MetaKeywords] = @MetaKeywords AND @MetaKeywords is not null)
	OR ([MetaDescription] = @MetaDescription AND @MetaDescription is not null)
	OR ([PageFriendlyName] = @PageFriendlyName AND @PageFriendlyName is not null)
	OR ([LastModified] = @LastModified AND @LastModified is not null)
	OR ([LastModifiedBy] = @LastModifiedBy AND @LastModifiedBy is not null)
	OR ([SearchField] = @SearchField AND @SearchField is not null)
	OR ([SourceID] = @SourceId AND @SourceId is not null)
	OR ([Secured] = @Secured AND @Secured is not null)
	OR ([CustomUrl] = @CustomUrl AND @CustomUrl is not null)
	OR ([MetaTitle] = @MetaTitle AND @MetaTitle is not null)
	OR ([GenerateBreadcrumb] = @GenerateBreadcrumb AND @GenerateBreadcrumb is not null)
	OR ([Status] = @Status AND @Status is not null)
	OR ([Visible] = @Visible AND @Visible is not null)
	OR ([PublishOn] = @PublishOn AND @PublishOn is not null)
	OR ([MappingID] = @MappingId AND @MappingId is not null)
	OR ([Comment] = @Comment AND @Comment is not null)
	OR ([PageLog] = @PageLog AND @PageLog is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.NewsIndustry_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.NewsIndustry_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.NewsIndustry_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the NewsIndustry table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.NewsIndustry_Get_List

AS


				
				SELECT
					[NewsIndustryID],
					[NewsIndustryName],
					[SiteID],
					[NewsIndustryParentID],
					[GlobalTemplate],
					[Sequence],
					[CustomXML],
					[LastModifiedBy],
					[LastModifiedDate]
				FROM
					[dbo].[NewsIndustry]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.NewsIndustry_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.NewsIndustry_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.NewsIndustry_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the NewsIndustry table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.NewsIndustry_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [NewsIndustryID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([NewsIndustryID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [NewsIndustryID]'
				SET @SQL = @SQL + ' FROM [dbo].[NewsIndustry]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[NewsIndustryID], O.[NewsIndustryName], O.[SiteID], O.[NewsIndustryParentID], O.[GlobalTemplate], O.[Sequence], O.[CustomXML], O.[LastModifiedBy], O.[LastModifiedDate]
				FROM
				    [dbo].[NewsIndustry] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[NewsIndustryID] = PageIndex.[NewsIndustryID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[NewsIndustry]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.NewsIndustry_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.NewsIndustry_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.NewsIndustry_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the NewsIndustry table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.NewsIndustry_Insert
(

	@NewsIndustryId int    OUTPUT,

	@NewsIndustryName nvarchar (510)  ,

	@SiteId int   ,

	@NewsIndustryParentId int   ,

	@GlobalTemplate bit   ,

	@Sequence int   ,

	@CustomXml nvarchar (MAX)  ,

	@LastModifiedBy int   ,

	@LastModifiedDate datetime   
)
AS


				
				INSERT INTO [dbo].[NewsIndustry]
					(
					[NewsIndustryName]
					,[SiteID]
					,[NewsIndustryParentID]
					,[GlobalTemplate]
					,[Sequence]
					,[CustomXML]
					,[LastModifiedBy]
					,[LastModifiedDate]
					)
				VALUES
					(
					@NewsIndustryName
					,@SiteId
					,@NewsIndustryParentId
					,@GlobalTemplate
					,@Sequence
					,@CustomXml
					,@LastModifiedBy
					,@LastModifiedDate
					)
				
				-- Get the identity value
				SET @NewsIndustryId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.NewsIndustry_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.NewsIndustry_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.NewsIndustry_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the NewsIndustry table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.NewsIndustry_Update
(

	@NewsIndustryId int   ,

	@NewsIndustryName nvarchar (510)  ,

	@SiteId int   ,

	@NewsIndustryParentId int   ,

	@GlobalTemplate bit   ,

	@Sequence int   ,

	@CustomXml nvarchar (MAX)  ,

	@LastModifiedBy int   ,

	@LastModifiedDate datetime   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[NewsIndustry]
				SET
					[NewsIndustryName] = @NewsIndustryName
					,[SiteID] = @SiteId
					,[NewsIndustryParentID] = @NewsIndustryParentId
					,[GlobalTemplate] = @GlobalTemplate
					,[Sequence] = @Sequence
					,[CustomXML] = @CustomXml
					,[LastModifiedBy] = @LastModifiedBy
					,[LastModifiedDate] = @LastModifiedDate
				WHERE
[NewsIndustryID] = @NewsIndustryId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.NewsIndustry_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.NewsIndustry_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.NewsIndustry_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the NewsIndustry table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.NewsIndustry_Delete
(

	@NewsIndustryId int   
)
AS


				DELETE FROM [dbo].[NewsIndustry] WITH (ROWLOCK) 
				WHERE
					[NewsIndustryID] = @NewsIndustryId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.NewsIndustry_GetByNewsIndustryId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.NewsIndustry_GetByNewsIndustryId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.NewsIndustry_GetByNewsIndustryId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the NewsIndustry table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.NewsIndustry_GetByNewsIndustryId
(

	@NewsIndustryId int   
)
AS


				SELECT
					[NewsIndustryID],
					[NewsIndustryName],
					[SiteID],
					[NewsIndustryParentID],
					[GlobalTemplate],
					[Sequence],
					[CustomXML],
					[LastModifiedBy],
					[LastModifiedDate]
				FROM
					[dbo].[NewsIndustry]
				WHERE
					[NewsIndustryID] = @NewsIndustryId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.NewsIndustry_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.NewsIndustry_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.NewsIndustry_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the NewsIndustry table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.NewsIndustry_Find
(

	@SearchUsingOR bit   = null ,

	@NewsIndustryId int   = null ,

	@NewsIndustryName nvarchar (510)  = null ,

	@SiteId int   = null ,

	@NewsIndustryParentId int   = null ,

	@GlobalTemplate bit   = null ,

	@Sequence int   = null ,

	@CustomXml nvarchar (MAX)  = null ,

	@LastModifiedBy int   = null ,

	@LastModifiedDate datetime   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [NewsIndustryID]
	, [NewsIndustryName]
	, [SiteID]
	, [NewsIndustryParentID]
	, [GlobalTemplate]
	, [Sequence]
	, [CustomXML]
	, [LastModifiedBy]
	, [LastModifiedDate]
    FROM
	[dbo].[NewsIndustry]
    WHERE 
	 ([NewsIndustryID] = @NewsIndustryId OR @NewsIndustryId IS NULL)
	AND ([NewsIndustryName] = @NewsIndustryName OR @NewsIndustryName IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([NewsIndustryParentID] = @NewsIndustryParentId OR @NewsIndustryParentId IS NULL)
	AND ([GlobalTemplate] = @GlobalTemplate OR @GlobalTemplate IS NULL)
	AND ([Sequence] = @Sequence OR @Sequence IS NULL)
	AND ([CustomXML] = @CustomXml OR @CustomXml IS NULL)
	AND ([LastModifiedBy] = @LastModifiedBy OR @LastModifiedBy IS NULL)
	AND ([LastModifiedDate] = @LastModifiedDate OR @LastModifiedDate IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [NewsIndustryID]
	, [NewsIndustryName]
	, [SiteID]
	, [NewsIndustryParentID]
	, [GlobalTemplate]
	, [Sequence]
	, [CustomXML]
	, [LastModifiedBy]
	, [LastModifiedDate]
    FROM
	[dbo].[NewsIndustry]
    WHERE 
	 ([NewsIndustryID] = @NewsIndustryId AND @NewsIndustryId is not null)
	OR ([NewsIndustryName] = @NewsIndustryName AND @NewsIndustryName is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([NewsIndustryParentID] = @NewsIndustryParentId AND @NewsIndustryParentId is not null)
	OR ([GlobalTemplate] = @GlobalTemplate AND @GlobalTemplate is not null)
	OR ([Sequence] = @Sequence AND @Sequence is not null)
	OR ([CustomXML] = @CustomXml AND @CustomXml is not null)
	OR ([LastModifiedBy] = @LastModifiedBy AND @LastModifiedBy is not null)
	OR ([LastModifiedDate] = @LastModifiedDate AND @LastModifiedDate is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserBusinessType_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserBusinessType_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserBusinessType_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the AdvertiserBusinessType table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserBusinessType_Get_List

AS


				
				SELECT
					[AdvertiserBusinessTypeID],
					[AdvertiserBusinessTypeName],
					[SiteID],
					[BusinessTypeParentID],
					[GlobalTemplate],
					[LastModifiedBy],
					[LastModifiedDate],
					[Sequence]
				FROM
					[dbo].[AdvertiserBusinessType]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserBusinessType_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserBusinessType_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserBusinessType_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the AdvertiserBusinessType table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserBusinessType_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [AdvertiserBusinessTypeID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([AdvertiserBusinessTypeID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [AdvertiserBusinessTypeID]'
				SET @SQL = @SQL + ' FROM [dbo].[AdvertiserBusinessType]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[AdvertiserBusinessTypeID], O.[AdvertiserBusinessTypeName], O.[SiteID], O.[BusinessTypeParentID], O.[GlobalTemplate], O.[LastModifiedBy], O.[LastModifiedDate], O.[Sequence]
				FROM
				    [dbo].[AdvertiserBusinessType] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[AdvertiserBusinessTypeID] = PageIndex.[AdvertiserBusinessTypeID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[AdvertiserBusinessType]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserBusinessType_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserBusinessType_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserBusinessType_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the AdvertiserBusinessType table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserBusinessType_Insert
(

	@AdvertiserBusinessTypeId int    OUTPUT,

	@AdvertiserBusinessTypeName varchar (255)  ,

	@SiteId int   ,

	@BusinessTypeParentId int   ,

	@GlobalTemplate bit   ,

	@LastModifiedBy int   ,

	@LastModifiedDate datetime   ,

	@Sequence int   
)
AS


				
				INSERT INTO [dbo].[AdvertiserBusinessType]
					(
					[AdvertiserBusinessTypeName]
					,[SiteID]
					,[BusinessTypeParentID]
					,[GlobalTemplate]
					,[LastModifiedBy]
					,[LastModifiedDate]
					,[Sequence]
					)
				VALUES
					(
					@AdvertiserBusinessTypeName
					,@SiteId
					,@BusinessTypeParentId
					,@GlobalTemplate
					,@LastModifiedBy
					,@LastModifiedDate
					,@Sequence
					)
				
				-- Get the identity value
				SET @AdvertiserBusinessTypeId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserBusinessType_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserBusinessType_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserBusinessType_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the AdvertiserBusinessType table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserBusinessType_Update
(

	@AdvertiserBusinessTypeId int   ,

	@AdvertiserBusinessTypeName varchar (255)  ,

	@SiteId int   ,

	@BusinessTypeParentId int   ,

	@GlobalTemplate bit   ,

	@LastModifiedBy int   ,

	@LastModifiedDate datetime   ,

	@Sequence int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[AdvertiserBusinessType]
				SET
					[AdvertiserBusinessTypeName] = @AdvertiserBusinessTypeName
					,[SiteID] = @SiteId
					,[BusinessTypeParentID] = @BusinessTypeParentId
					,[GlobalTemplate] = @GlobalTemplate
					,[LastModifiedBy] = @LastModifiedBy
					,[LastModifiedDate] = @LastModifiedDate
					,[Sequence] = @Sequence
				WHERE
[AdvertiserBusinessTypeID] = @AdvertiserBusinessTypeId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserBusinessType_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserBusinessType_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserBusinessType_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the AdvertiserBusinessType table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserBusinessType_Delete
(

	@AdvertiserBusinessTypeId int   
)
AS


				DELETE FROM [dbo].[AdvertiserBusinessType] WITH (ROWLOCK) 
				WHERE
					[AdvertiserBusinessTypeID] = @AdvertiserBusinessTypeId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserBusinessType_GetByAdvertiserBusinessTypeId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserBusinessType_GetByAdvertiserBusinessTypeId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserBusinessType_GetByAdvertiserBusinessTypeId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the AdvertiserBusinessType table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserBusinessType_GetByAdvertiserBusinessTypeId
(

	@AdvertiserBusinessTypeId int   
)
AS


				SELECT
					[AdvertiserBusinessTypeID],
					[AdvertiserBusinessTypeName],
					[SiteID],
					[BusinessTypeParentID],
					[GlobalTemplate],
					[LastModifiedBy],
					[LastModifiedDate],
					[Sequence]
				FROM
					[dbo].[AdvertiserBusinessType]
				WHERE
					[AdvertiserBusinessTypeID] = @AdvertiserBusinessTypeId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserBusinessType_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserBusinessType_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserBusinessType_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the AdvertiserBusinessType table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserBusinessType_Find
(

	@SearchUsingOR bit   = null ,

	@AdvertiserBusinessTypeId int   = null ,

	@AdvertiserBusinessTypeName varchar (255)  = null ,

	@SiteId int   = null ,

	@BusinessTypeParentId int   = null ,

	@GlobalTemplate bit   = null ,

	@LastModifiedBy int   = null ,

	@LastModifiedDate datetime   = null ,

	@Sequence int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [AdvertiserBusinessTypeID]
	, [AdvertiserBusinessTypeName]
	, [SiteID]
	, [BusinessTypeParentID]
	, [GlobalTemplate]
	, [LastModifiedBy]
	, [LastModifiedDate]
	, [Sequence]
    FROM
	[dbo].[AdvertiserBusinessType]
    WHERE 
	 ([AdvertiserBusinessTypeID] = @AdvertiserBusinessTypeId OR @AdvertiserBusinessTypeId IS NULL)
	AND ([AdvertiserBusinessTypeName] = @AdvertiserBusinessTypeName OR @AdvertiserBusinessTypeName IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([BusinessTypeParentID] = @BusinessTypeParentId OR @BusinessTypeParentId IS NULL)
	AND ([GlobalTemplate] = @GlobalTemplate OR @GlobalTemplate IS NULL)
	AND ([LastModifiedBy] = @LastModifiedBy OR @LastModifiedBy IS NULL)
	AND ([LastModifiedDate] = @LastModifiedDate OR @LastModifiedDate IS NULL)
	AND ([Sequence] = @Sequence OR @Sequence IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [AdvertiserBusinessTypeID]
	, [AdvertiserBusinessTypeName]
	, [SiteID]
	, [BusinessTypeParentID]
	, [GlobalTemplate]
	, [LastModifiedBy]
	, [LastModifiedDate]
	, [Sequence]
    FROM
	[dbo].[AdvertiserBusinessType]
    WHERE 
	 ([AdvertiserBusinessTypeID] = @AdvertiserBusinessTypeId AND @AdvertiserBusinessTypeId is not null)
	OR ([AdvertiserBusinessTypeName] = @AdvertiserBusinessTypeName AND @AdvertiserBusinessTypeName is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([BusinessTypeParentID] = @BusinessTypeParentId AND @BusinessTypeParentId is not null)
	OR ([GlobalTemplate] = @GlobalTemplate AND @GlobalTemplate is not null)
	OR ([LastModifiedBy] = @LastModifiedBy AND @LastModifiedBy is not null)
	OR ([LastModifiedDate] = @LastModifiedDate AND @LastModifiedDate is not null)
	OR ([Sequence] = @Sequence AND @Sequence is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Sites_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Sites_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Sites_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the Sites table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Sites_Get_List

AS


				
				SELECT
					[SiteID],
					[SiteName],
					[SiteURL],
					[SiteDescription],
					[SiteAdminLogo],
					[LastModified],
					[LastModifiedBy],
					[Live],
					[MobileEnabled],
					[MobileUrl],
					[SiteAdminLogoUrl]
				FROM
					[dbo].[Sites]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Sites_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Sites_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Sites_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the Sites table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Sites_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [SiteID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([SiteID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [SiteID]'
				SET @SQL = @SQL + ' FROM [dbo].[Sites]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[SiteID], O.[SiteName], O.[SiteURL], O.[SiteDescription], O.[SiteAdminLogo], O.[LastModified], O.[LastModifiedBy], O.[Live], O.[MobileEnabled], O.[MobileUrl], O.[SiteAdminLogoUrl]
				FROM
				    [dbo].[Sites] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[SiteID] = PageIndex.[SiteID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[Sites]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Sites_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Sites_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Sites_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the Sites table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Sites_Insert
(

	@SiteId int    OUTPUT,

	@SiteName varchar (255)  ,

	@SiteUrl varchar (500)  ,

	@SiteDescription varchar (MAX)  ,

	@SiteAdminLogo image   ,

	@LastModified datetime   ,

	@LastModifiedBy int   ,

	@Live bit   ,

	@MobileEnabled bit   ,

	@MobileUrl varchar (255)  ,

	@SiteAdminLogoUrl nvarchar (1000)  
)
AS


				
				INSERT INTO [dbo].[Sites]
					(
					[SiteName]
					,[SiteURL]
					,[SiteDescription]
					,[SiteAdminLogo]
					,[LastModified]
					,[LastModifiedBy]
					,[Live]
					,[MobileEnabled]
					,[MobileUrl]
					,[SiteAdminLogoUrl]
					)
				VALUES
					(
					@SiteName
					,@SiteUrl
					,@SiteDescription
					,@SiteAdminLogo
					,@LastModified
					,@LastModifiedBy
					,@Live
					,@MobileEnabled
					,@MobileUrl
					,@SiteAdminLogoUrl
					)
				
				-- Get the identity value
				SET @SiteId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Sites_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Sites_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Sites_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the Sites table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Sites_Update
(

	@SiteId int   ,

	@SiteName varchar (255)  ,

	@SiteUrl varchar (500)  ,

	@SiteDescription varchar (MAX)  ,

	@SiteAdminLogo image   ,

	@LastModified datetime   ,

	@LastModifiedBy int   ,

	@Live bit   ,

	@MobileEnabled bit   ,

	@MobileUrl varchar (255)  ,

	@SiteAdminLogoUrl nvarchar (1000)  
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[Sites]
				SET
					[SiteName] = @SiteName
					,[SiteURL] = @SiteUrl
					,[SiteDescription] = @SiteDescription
					,[SiteAdminLogo] = @SiteAdminLogo
					,[LastModified] = @LastModified
					,[LastModifiedBy] = @LastModifiedBy
					,[Live] = @Live
					,[MobileEnabled] = @MobileEnabled
					,[MobileUrl] = @MobileUrl
					,[SiteAdminLogoUrl] = @SiteAdminLogoUrl
				WHERE
[SiteID] = @SiteId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Sites_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Sites_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Sites_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the Sites table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Sites_Delete
(

	@SiteId int   
)
AS


				DELETE FROM [dbo].[Sites] WITH (ROWLOCK) 
				WHERE
					[SiteID] = @SiteId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Sites_GetByLastModifiedBy procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Sites_GetByLastModifiedBy') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Sites_GetByLastModifiedBy
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Sites table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Sites_GetByLastModifiedBy
(

	@LastModifiedBy int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[SiteID],
					[SiteName],
					[SiteURL],
					[SiteDescription],
					[SiteAdminLogo],
					[LastModified],
					[LastModifiedBy],
					[Live],
					[MobileEnabled],
					[MobileUrl],
					[SiteAdminLogoUrl]
				FROM
					[dbo].[Sites]
				WHERE
					[LastModifiedBy] = @LastModifiedBy
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Sites_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Sites_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Sites_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Sites table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Sites_GetBySiteId
(

	@SiteId int   
)
AS


				SELECT
					[SiteID],
					[SiteName],
					[SiteURL],
					[SiteDescription],
					[SiteAdminLogo],
					[LastModified],
					[LastModifiedBy],
					[Live],
					[MobileEnabled],
					[MobileUrl],
					[SiteAdminLogoUrl]
				FROM
					[dbo].[Sites]
				WHERE
					[SiteID] = @SiteId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Sites_GetByMobileUrl procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Sites_GetByMobileUrl') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Sites_GetByMobileUrl
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Sites table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Sites_GetByMobileUrl
(

	@MobileUrl varchar (255)  
)
AS


				SELECT
					[SiteID],
					[SiteName],
					[SiteURL],
					[SiteDescription],
					[SiteAdminLogo],
					[LastModified],
					[LastModifiedBy],
					[Live],
					[MobileEnabled],
					[MobileUrl],
					[SiteAdminLogoUrl]
				FROM
					[dbo].[Sites]
				WHERE
					[MobileUrl] = @MobileUrl
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Sites_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Sites_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Sites_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the Sites table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Sites_Find
(

	@SearchUsingOR bit   = null ,

	@SiteId int   = null ,

	@SiteName varchar (255)  = null ,

	@SiteUrl varchar (500)  = null ,

	@SiteDescription varchar (MAX)  = null ,

	@SiteAdminLogo image   = null ,

	@LastModified datetime   = null ,

	@LastModifiedBy int   = null ,

	@Live bit   = null ,

	@MobileEnabled bit   = null ,

	@MobileUrl varchar (255)  = null ,

	@SiteAdminLogoUrl nvarchar (1000)  = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [SiteID]
	, [SiteName]
	, [SiteURL]
	, [SiteDescription]
	, [SiteAdminLogo]
	, [LastModified]
	, [LastModifiedBy]
	, [Live]
	, [MobileEnabled]
	, [MobileUrl]
	, [SiteAdminLogoUrl]
    FROM
	[dbo].[Sites]
    WHERE 
	 ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([SiteName] = @SiteName OR @SiteName IS NULL)
	AND ([SiteURL] = @SiteUrl OR @SiteUrl IS NULL)
	AND ([SiteDescription] = @SiteDescription OR @SiteDescription IS NULL)
	AND ([LastModified] = @LastModified OR @LastModified IS NULL)
	AND ([LastModifiedBy] = @LastModifiedBy OR @LastModifiedBy IS NULL)
	AND ([Live] = @Live OR @Live IS NULL)
	AND ([MobileEnabled] = @MobileEnabled OR @MobileEnabled IS NULL)
	AND ([MobileUrl] = @MobileUrl OR @MobileUrl IS NULL)
	AND ([SiteAdminLogoUrl] = @SiteAdminLogoUrl OR @SiteAdminLogoUrl IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [SiteID]
	, [SiteName]
	, [SiteURL]
	, [SiteDescription]
	, [SiteAdminLogo]
	, [LastModified]
	, [LastModifiedBy]
	, [Live]
	, [MobileEnabled]
	, [MobileUrl]
	, [SiteAdminLogoUrl]
    FROM
	[dbo].[Sites]
    WHERE 
	 ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([SiteName] = @SiteName AND @SiteName is not null)
	OR ([SiteURL] = @SiteUrl AND @SiteUrl is not null)
	OR ([SiteDescription] = @SiteDescription AND @SiteDescription is not null)
	OR ([LastModified] = @LastModified AND @LastModified is not null)
	OR ([LastModifiedBy] = @LastModifiedBy AND @LastModifiedBy is not null)
	OR ([Live] = @Live AND @Live is not null)
	OR ([MobileEnabled] = @MobileEnabled AND @MobileEnabled is not null)
	OR ([MobileUrl] = @MobileUrl AND @MobileUrl is not null)
	OR ([SiteAdminLogoUrl] = @SiteAdminLogoUrl AND @SiteAdminLogoUrl is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdminUsers_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdminUsers_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdminUsers_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the AdminUsers table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdminUsers_Get_List

AS


				
				SELECT
					[AdminUserID],
					[AdminRoleID],
					[SiteID],
					[UserName],
					[UserPassword],
					[FirstName],
					[Surname],
					[Email],
					[LoginAttempts],
					[LastAttemptDate],
					[Status]
				FROM
					[dbo].[AdminUsers]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdminUsers_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdminUsers_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdminUsers_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the AdminUsers table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdminUsers_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [AdminUserID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([AdminUserID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [AdminUserID]'
				SET @SQL = @SQL + ' FROM [dbo].[AdminUsers]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[AdminUserID], O.[AdminRoleID], O.[SiteID], O.[UserName], O.[UserPassword], O.[FirstName], O.[Surname], O.[Email], O.[LoginAttempts], O.[LastAttemptDate], O.[Status]
				FROM
				    [dbo].[AdminUsers] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[AdminUserID] = PageIndex.[AdminUserID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[AdminUsers]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdminUsers_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdminUsers_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdminUsers_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the AdminUsers table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdminUsers_Insert
(

	@AdminUserId int    OUTPUT,

	@AdminRoleId int   ,

	@SiteId int   ,

	@UserName varchar (255)  ,

	@UserPassword varchar (255)  ,

	@FirstName nvarchar (500)  ,

	@Surname nvarchar (500)  ,

	@Email varchar (255)  ,

	@LoginAttempts int   ,

	@LastAttemptDate datetime   ,

	@Status int   
)
AS


				
				INSERT INTO [dbo].[AdminUsers]
					(
					[AdminRoleID]
					,[SiteID]
					,[UserName]
					,[UserPassword]
					,[FirstName]
					,[Surname]
					,[Email]
					,[LoginAttempts]
					,[LastAttemptDate]
					,[Status]
					)
				VALUES
					(
					@AdminRoleId
					,@SiteId
					,@UserName
					,@UserPassword
					,@FirstName
					,@Surname
					,@Email
					,@LoginAttempts
					,@LastAttemptDate
					,@Status
					)
				
				-- Get the identity value
				SET @AdminUserId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdminUsers_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdminUsers_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdminUsers_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the AdminUsers table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdminUsers_Update
(

	@AdminUserId int   ,

	@AdminRoleId int   ,

	@SiteId int   ,

	@UserName varchar (255)  ,

	@UserPassword varchar (255)  ,

	@FirstName nvarchar (500)  ,

	@Surname nvarchar (500)  ,

	@Email varchar (255)  ,

	@LoginAttempts int   ,

	@LastAttemptDate datetime   ,

	@Status int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[AdminUsers]
				SET
					[AdminRoleID] = @AdminRoleId
					,[SiteID] = @SiteId
					,[UserName] = @UserName
					,[UserPassword] = @UserPassword
					,[FirstName] = @FirstName
					,[Surname] = @Surname
					,[Email] = @Email
					,[LoginAttempts] = @LoginAttempts
					,[LastAttemptDate] = @LastAttemptDate
					,[Status] = @Status
				WHERE
[AdminUserID] = @AdminUserId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdminUsers_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdminUsers_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdminUsers_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the AdminUsers table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdminUsers_Delete
(

	@AdminUserId int   
)
AS


				DELETE FROM [dbo].[AdminUsers] WITH (ROWLOCK) 
				WHERE
					[AdminUserID] = @AdminUserId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdminUsers_GetByAdminRoleId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdminUsers_GetByAdminRoleId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdminUsers_GetByAdminRoleId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the AdminUsers table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdminUsers_GetByAdminRoleId
(

	@AdminRoleId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[AdminUserID],
					[AdminRoleID],
					[SiteID],
					[UserName],
					[UserPassword],
					[FirstName],
					[Surname],
					[Email],
					[LoginAttempts],
					[LastAttemptDate],
					[Status]
				FROM
					[dbo].[AdminUsers]
				WHERE
					[AdminRoleID] = @AdminRoleId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdminUsers_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdminUsers_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdminUsers_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the AdminUsers table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdminUsers_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[AdminUserID],
					[AdminRoleID],
					[SiteID],
					[UserName],
					[UserPassword],
					[FirstName],
					[Surname],
					[Email],
					[LoginAttempts],
					[LastAttemptDate],
					[Status]
				FROM
					[dbo].[AdminUsers]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdminUsers_GetBySiteIdUserName procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdminUsers_GetBySiteIdUserName') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdminUsers_GetBySiteIdUserName
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the AdminUsers table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdminUsers_GetBySiteIdUserName
(

	@SiteId int   ,

	@UserName varchar (255)  
)
AS


				SELECT
					[AdminUserID],
					[AdminRoleID],
					[SiteID],
					[UserName],
					[UserPassword],
					[FirstName],
					[Surname],
					[Email],
					[LoginAttempts],
					[LastAttemptDate],
					[Status]
				FROM
					[dbo].[AdminUsers]
				WHERE
					[SiteID] = @SiteId
					AND [UserName] = @UserName
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdminUsers_GetByAdminUserId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdminUsers_GetByAdminUserId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdminUsers_GetByAdminUserId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the AdminUsers table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdminUsers_GetByAdminUserId
(

	@AdminUserId int   
)
AS


				SELECT
					[AdminUserID],
					[AdminRoleID],
					[SiteID],
					[UserName],
					[UserPassword],
					[FirstName],
					[Surname],
					[Email],
					[LoginAttempts],
					[LastAttemptDate],
					[Status]
				FROM
					[dbo].[AdminUsers]
				WHERE
					[AdminUserID] = @AdminUserId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdminUsers_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdminUsers_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdminUsers_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the AdminUsers table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdminUsers_Find
(

	@SearchUsingOR bit   = null ,

	@AdminUserId int   = null ,

	@AdminRoleId int   = null ,

	@SiteId int   = null ,

	@UserName varchar (255)  = null ,

	@UserPassword varchar (255)  = null ,

	@FirstName nvarchar (500)  = null ,

	@Surname nvarchar (500)  = null ,

	@Email varchar (255)  = null ,

	@LoginAttempts int   = null ,

	@LastAttemptDate datetime   = null ,

	@Status int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [AdminUserID]
	, [AdminRoleID]
	, [SiteID]
	, [UserName]
	, [UserPassword]
	, [FirstName]
	, [Surname]
	, [Email]
	, [LoginAttempts]
	, [LastAttemptDate]
	, [Status]
    FROM
	[dbo].[AdminUsers]
    WHERE 
	 ([AdminUserID] = @AdminUserId OR @AdminUserId IS NULL)
	AND ([AdminRoleID] = @AdminRoleId OR @AdminRoleId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([UserName] = @UserName OR @UserName IS NULL)
	AND ([UserPassword] = @UserPassword OR @UserPassword IS NULL)
	AND ([FirstName] = @FirstName OR @FirstName IS NULL)
	AND ([Surname] = @Surname OR @Surname IS NULL)
	AND ([Email] = @Email OR @Email IS NULL)
	AND ([LoginAttempts] = @LoginAttempts OR @LoginAttempts IS NULL)
	AND ([LastAttemptDate] = @LastAttemptDate OR @LastAttemptDate IS NULL)
	AND ([Status] = @Status OR @Status IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [AdminUserID]
	, [AdminRoleID]
	, [SiteID]
	, [UserName]
	, [UserPassword]
	, [FirstName]
	, [Surname]
	, [Email]
	, [LoginAttempts]
	, [LastAttemptDate]
	, [Status]
    FROM
	[dbo].[AdminUsers]
    WHERE 
	 ([AdminUserID] = @AdminUserId AND @AdminUserId is not null)
	OR ([AdminRoleID] = @AdminRoleId AND @AdminRoleId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([UserName] = @UserName AND @UserName is not null)
	OR ([UserPassword] = @UserPassword AND @UserPassword is not null)
	OR ([FirstName] = @FirstName AND @FirstName is not null)
	OR ([Surname] = @Surname AND @Surname is not null)
	OR ([Email] = @Email AND @Email is not null)
	OR ([LoginAttempts] = @LoginAttempts AND @LoginAttempts is not null)
	OR ([LastAttemptDate] = @LastAttemptDate AND @LastAttemptDate is not null)
	OR ([Status] = @Status AND @Status is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserJobPricing_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserJobPricing_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserJobPricing_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the AdvertiserJobPricing table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserJobPricing_Get_List

AS


				
				SELECT
					[AdvertiserID],
					[JobItemsTypeID],
					[TotalAmount],
					[StartDate],
					[ExpiryDate],
					[LastModified],
					[LastModifiedBy]
				FROM
					[dbo].[AdvertiserJobPricing]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserJobPricing_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserJobPricing_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserJobPricing_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the AdvertiserJobPricing table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserJobPricing_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [AdvertiserID] int, [JobItemsTypeID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([AdvertiserID], [JobItemsTypeID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [AdvertiserID], [JobItemsTypeID]'
				SET @SQL = @SQL + ' FROM [dbo].[AdvertiserJobPricing]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[AdvertiserID], O.[JobItemsTypeID], O.[TotalAmount], O.[StartDate], O.[ExpiryDate], O.[LastModified], O.[LastModifiedBy]
				FROM
				    [dbo].[AdvertiserJobPricing] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[AdvertiserID] = PageIndex.[AdvertiserID]
					AND O.[JobItemsTypeID] = PageIndex.[JobItemsTypeID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[AdvertiserJobPricing]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserJobPricing_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserJobPricing_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserJobPricing_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the AdvertiserJobPricing table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserJobPricing_Insert
(

	@AdvertiserId int   ,

	@JobItemsTypeId int   ,

	@TotalAmount decimal (18, 2)  ,

	@StartDate datetime   ,

	@ExpiryDate datetime   ,

	@LastModified datetime   ,

	@LastModifiedBy int   
)
AS


				
				INSERT INTO [dbo].[AdvertiserJobPricing]
					(
					[AdvertiserID]
					,[JobItemsTypeID]
					,[TotalAmount]
					,[StartDate]
					,[ExpiryDate]
					,[LastModified]
					,[LastModifiedBy]
					)
				VALUES
					(
					@AdvertiserId
					,@JobItemsTypeId
					,@TotalAmount
					,@StartDate
					,@ExpiryDate
					,@LastModified
					,@LastModifiedBy
					)
				
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserJobPricing_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserJobPricing_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserJobPricing_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the AdvertiserJobPricing table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserJobPricing_Update
(

	@AdvertiserId int   ,

	@OriginalAdvertiserId int   ,

	@JobItemsTypeId int   ,

	@OriginalJobItemsTypeId int   ,

	@TotalAmount decimal (18, 2)  ,

	@StartDate datetime   ,

	@ExpiryDate datetime   ,

	@LastModified datetime   ,

	@LastModifiedBy int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[AdvertiserJobPricing]
				SET
					[AdvertiserID] = @AdvertiserId
					,[JobItemsTypeID] = @JobItemsTypeId
					,[TotalAmount] = @TotalAmount
					,[StartDate] = @StartDate
					,[ExpiryDate] = @ExpiryDate
					,[LastModified] = @LastModified
					,[LastModifiedBy] = @LastModifiedBy
				WHERE
[AdvertiserID] = @OriginalAdvertiserId 
AND [JobItemsTypeID] = @OriginalJobItemsTypeId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserJobPricing_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserJobPricing_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserJobPricing_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the AdvertiserJobPricing table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserJobPricing_Delete
(

	@AdvertiserId int   ,

	@JobItemsTypeId int   
)
AS


				DELETE FROM [dbo].[AdvertiserJobPricing] WITH (ROWLOCK) 
				WHERE
					[AdvertiserID] = @AdvertiserId
					AND [JobItemsTypeID] = @JobItemsTypeId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserJobPricing_GetByAdvertiserId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserJobPricing_GetByAdvertiserId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserJobPricing_GetByAdvertiserId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the AdvertiserJobPricing table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserJobPricing_GetByAdvertiserId
(

	@AdvertiserId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[AdvertiserID],
					[JobItemsTypeID],
					[TotalAmount],
					[StartDate],
					[ExpiryDate],
					[LastModified],
					[LastModifiedBy]
				FROM
					[dbo].[AdvertiserJobPricing]
				WHERE
					[AdvertiserID] = @AdvertiserId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserJobPricing_GetByJobItemsTypeId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserJobPricing_GetByJobItemsTypeId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserJobPricing_GetByJobItemsTypeId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the AdvertiserJobPricing table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserJobPricing_GetByJobItemsTypeId
(

	@JobItemsTypeId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[AdvertiserID],
					[JobItemsTypeID],
					[TotalAmount],
					[StartDate],
					[ExpiryDate],
					[LastModified],
					[LastModifiedBy]
				FROM
					[dbo].[AdvertiserJobPricing]
				WHERE
					[JobItemsTypeID] = @JobItemsTypeId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserJobPricing_GetByAdvertiserIdJobItemsTypeId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserJobPricing_GetByAdvertiserIdJobItemsTypeId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserJobPricing_GetByAdvertiserIdJobItemsTypeId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the AdvertiserJobPricing table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserJobPricing_GetByAdvertiserIdJobItemsTypeId
(

	@AdvertiserId int   ,

	@JobItemsTypeId int   
)
AS


				SELECT
					[AdvertiserID],
					[JobItemsTypeID],
					[TotalAmount],
					[StartDate],
					[ExpiryDate],
					[LastModified],
					[LastModifiedBy]
				FROM
					[dbo].[AdvertiserJobPricing]
				WHERE
					[AdvertiserID] = @AdvertiserId
					AND [JobItemsTypeID] = @JobItemsTypeId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserJobPricing_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserJobPricing_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserJobPricing_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the AdvertiserJobPricing table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserJobPricing_Find
(

	@SearchUsingOR bit   = null ,

	@AdvertiserId int   = null ,

	@JobItemsTypeId int   = null ,

	@TotalAmount decimal (18, 2)  = null ,

	@StartDate datetime   = null ,

	@ExpiryDate datetime   = null ,

	@LastModified datetime   = null ,

	@LastModifiedBy int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [AdvertiserID]
	, [JobItemsTypeID]
	, [TotalAmount]
	, [StartDate]
	, [ExpiryDate]
	, [LastModified]
	, [LastModifiedBy]
    FROM
	[dbo].[AdvertiserJobPricing]
    WHERE 
	 ([AdvertiserID] = @AdvertiserId OR @AdvertiserId IS NULL)
	AND ([JobItemsTypeID] = @JobItemsTypeId OR @JobItemsTypeId IS NULL)
	AND ([TotalAmount] = @TotalAmount OR @TotalAmount IS NULL)
	AND ([StartDate] = @StartDate OR @StartDate IS NULL)
	AND ([ExpiryDate] = @ExpiryDate OR @ExpiryDate IS NULL)
	AND ([LastModified] = @LastModified OR @LastModified IS NULL)
	AND ([LastModifiedBy] = @LastModifiedBy OR @LastModifiedBy IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [AdvertiserID]
	, [JobItemsTypeID]
	, [TotalAmount]
	, [StartDate]
	, [ExpiryDate]
	, [LastModified]
	, [LastModifiedBy]
    FROM
	[dbo].[AdvertiserJobPricing]
    WHERE 
	 ([AdvertiserID] = @AdvertiserId AND @AdvertiserId is not null)
	OR ([JobItemsTypeID] = @JobItemsTypeId AND @JobItemsTypeId is not null)
	OR ([TotalAmount] = @TotalAmount AND @TotalAmount is not null)
	OR ([StartDate] = @StartDate AND @StartDate is not null)
	OR ([ExpiryDate] = @ExpiryDate AND @ExpiryDate is not null)
	OR ([LastModified] = @LastModified AND @LastModified is not null)
	OR ([LastModifiedBy] = @LastModifiedBy AND @LastModifiedBy is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.NewsCategories_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.NewsCategories_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.NewsCategories_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the NewsCategories table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.NewsCategories_Get_List

AS


				
				SELECT
					[NewsCategoryID],
					[NewsCategoryName],
					[SiteID],
					[Valid],
					[Sequence],
					[MetaTitle],
					[MetaKeywords],
					[MetaDescription],
					[LastModified],
					[LastModifiedBy],
					[PageFriendlyName],
					[CustomXML]
				FROM
					[dbo].[NewsCategories]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.NewsCategories_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.NewsCategories_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.NewsCategories_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the NewsCategories table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.NewsCategories_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [NewsCategoryID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([NewsCategoryID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [NewsCategoryID]'
				SET @SQL = @SQL + ' FROM [dbo].[NewsCategories]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[NewsCategoryID], O.[NewsCategoryName], O.[SiteID], O.[Valid], O.[Sequence], O.[MetaTitle], O.[MetaKeywords], O.[MetaDescription], O.[LastModified], O.[LastModifiedBy], O.[PageFriendlyName], O.[CustomXML]
				FROM
				    [dbo].[NewsCategories] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[NewsCategoryID] = PageIndex.[NewsCategoryID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[NewsCategories]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.NewsCategories_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.NewsCategories_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.NewsCategories_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the NewsCategories table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.NewsCategories_Insert
(

	@NewsCategoryId int    OUTPUT,

	@NewsCategoryName nvarchar (500)  ,

	@SiteId int   ,

	@Valid bit   ,

	@Sequence int   ,

	@MetaTitle varchar (255)  ,

	@MetaKeywords varchar (255)  ,

	@MetaDescription varchar (512)  ,

	@LastModified datetime   ,

	@LastModifiedBy int   ,

	@PageFriendlyName varchar (255)  ,

	@CustomXml nvarchar (MAX)  
)
AS


				
				INSERT INTO [dbo].[NewsCategories]
					(
					[NewsCategoryName]
					,[SiteID]
					,[Valid]
					,[Sequence]
					,[MetaTitle]
					,[MetaKeywords]
					,[MetaDescription]
					,[LastModified]
					,[LastModifiedBy]
					,[PageFriendlyName]
					,[CustomXML]
					)
				VALUES
					(
					@NewsCategoryName
					,@SiteId
					,@Valid
					,@Sequence
					,@MetaTitle
					,@MetaKeywords
					,@MetaDescription
					,@LastModified
					,@LastModifiedBy
					,@PageFriendlyName
					,@CustomXml
					)
				
				-- Get the identity value
				SET @NewsCategoryId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.NewsCategories_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.NewsCategories_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.NewsCategories_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the NewsCategories table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.NewsCategories_Update
(

	@NewsCategoryId int   ,

	@NewsCategoryName nvarchar (500)  ,

	@SiteId int   ,

	@Valid bit   ,

	@Sequence int   ,

	@MetaTitle varchar (255)  ,

	@MetaKeywords varchar (255)  ,

	@MetaDescription varchar (512)  ,

	@LastModified datetime   ,

	@LastModifiedBy int   ,

	@PageFriendlyName varchar (255)  ,

	@CustomXml nvarchar (MAX)  
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[NewsCategories]
				SET
					[NewsCategoryName] = @NewsCategoryName
					,[SiteID] = @SiteId
					,[Valid] = @Valid
					,[Sequence] = @Sequence
					,[MetaTitle] = @MetaTitle
					,[MetaKeywords] = @MetaKeywords
					,[MetaDescription] = @MetaDescription
					,[LastModified] = @LastModified
					,[LastModifiedBy] = @LastModifiedBy
					,[PageFriendlyName] = @PageFriendlyName
					,[CustomXML] = @CustomXml
				WHERE
[NewsCategoryID] = @NewsCategoryId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.NewsCategories_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.NewsCategories_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.NewsCategories_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the NewsCategories table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.NewsCategories_Delete
(

	@NewsCategoryId int   
)
AS


				DELETE FROM [dbo].[NewsCategories] WITH (ROWLOCK) 
				WHERE
					[NewsCategoryID] = @NewsCategoryId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.NewsCategories_GetByLastModifiedBy procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.NewsCategories_GetByLastModifiedBy') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.NewsCategories_GetByLastModifiedBy
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the NewsCategories table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.NewsCategories_GetByLastModifiedBy
(

	@LastModifiedBy int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[NewsCategoryID],
					[NewsCategoryName],
					[SiteID],
					[Valid],
					[Sequence],
					[MetaTitle],
					[MetaKeywords],
					[MetaDescription],
					[LastModified],
					[LastModifiedBy],
					[PageFriendlyName],
					[CustomXML]
				FROM
					[dbo].[NewsCategories]
				WHERE
					[LastModifiedBy] = @LastModifiedBy
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.NewsCategories_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.NewsCategories_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.NewsCategories_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the NewsCategories table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.NewsCategories_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[NewsCategoryID],
					[NewsCategoryName],
					[SiteID],
					[Valid],
					[Sequence],
					[MetaTitle],
					[MetaKeywords],
					[MetaDescription],
					[LastModified],
					[LastModifiedBy],
					[PageFriendlyName],
					[CustomXML]
				FROM
					[dbo].[NewsCategories]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.NewsCategories_GetByNewsCategoryId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.NewsCategories_GetByNewsCategoryId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.NewsCategories_GetByNewsCategoryId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the NewsCategories table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.NewsCategories_GetByNewsCategoryId
(

	@NewsCategoryId int   
)
AS


				SELECT
					[NewsCategoryID],
					[NewsCategoryName],
					[SiteID],
					[Valid],
					[Sequence],
					[MetaTitle],
					[MetaKeywords],
					[MetaDescription],
					[LastModified],
					[LastModifiedBy],
					[PageFriendlyName],
					[CustomXML]
				FROM
					[dbo].[NewsCategories]
				WHERE
					[NewsCategoryID] = @NewsCategoryId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.NewsCategories_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.NewsCategories_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.NewsCategories_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the NewsCategories table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.NewsCategories_Find
(

	@SearchUsingOR bit   = null ,

	@NewsCategoryId int   = null ,

	@NewsCategoryName nvarchar (500)  = null ,

	@SiteId int   = null ,

	@Valid bit   = null ,

	@Sequence int   = null ,

	@MetaTitle varchar (255)  = null ,

	@MetaKeywords varchar (255)  = null ,

	@MetaDescription varchar (512)  = null ,

	@LastModified datetime   = null ,

	@LastModifiedBy int   = null ,

	@PageFriendlyName varchar (255)  = null ,

	@CustomXml nvarchar (MAX)  = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [NewsCategoryID]
	, [NewsCategoryName]
	, [SiteID]
	, [Valid]
	, [Sequence]
	, [MetaTitle]
	, [MetaKeywords]
	, [MetaDescription]
	, [LastModified]
	, [LastModifiedBy]
	, [PageFriendlyName]
	, [CustomXML]
    FROM
	[dbo].[NewsCategories]
    WHERE 
	 ([NewsCategoryID] = @NewsCategoryId OR @NewsCategoryId IS NULL)
	AND ([NewsCategoryName] = @NewsCategoryName OR @NewsCategoryName IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([Valid] = @Valid OR @Valid IS NULL)
	AND ([Sequence] = @Sequence OR @Sequence IS NULL)
	AND ([MetaTitle] = @MetaTitle OR @MetaTitle IS NULL)
	AND ([MetaKeywords] = @MetaKeywords OR @MetaKeywords IS NULL)
	AND ([MetaDescription] = @MetaDescription OR @MetaDescription IS NULL)
	AND ([LastModified] = @LastModified OR @LastModified IS NULL)
	AND ([LastModifiedBy] = @LastModifiedBy OR @LastModifiedBy IS NULL)
	AND ([PageFriendlyName] = @PageFriendlyName OR @PageFriendlyName IS NULL)
	AND ([CustomXML] = @CustomXml OR @CustomXml IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [NewsCategoryID]
	, [NewsCategoryName]
	, [SiteID]
	, [Valid]
	, [Sequence]
	, [MetaTitle]
	, [MetaKeywords]
	, [MetaDescription]
	, [LastModified]
	, [LastModifiedBy]
	, [PageFriendlyName]
	, [CustomXML]
    FROM
	[dbo].[NewsCategories]
    WHERE 
	 ([NewsCategoryID] = @NewsCategoryId AND @NewsCategoryId is not null)
	OR ([NewsCategoryName] = @NewsCategoryName AND @NewsCategoryName is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([Valid] = @Valid AND @Valid is not null)
	OR ([Sequence] = @Sequence AND @Sequence is not null)
	OR ([MetaTitle] = @MetaTitle AND @MetaTitle is not null)
	OR ([MetaKeywords] = @MetaKeywords AND @MetaKeywords is not null)
	OR ([MetaDescription] = @MetaDescription AND @MetaDescription is not null)
	OR ([LastModified] = @LastModified AND @LastModified is not null)
	OR ([LastModifiedBy] = @LastModifiedBy AND @LastModifiedBy is not null)
	OR ([PageFriendlyName] = @PageFriendlyName AND @PageFriendlyName is not null)
	OR ([CustomXML] = @CustomXml AND @CustomXml is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DefaultResources_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DefaultResources_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DefaultResources_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the DefaultResources table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DefaultResources_Get_List

AS


				
				SELECT
					[DefaultResourceID],
					[ResourceCode],
					[ResourceFileID],
					[ResourceText],
					[ResourceDescription],
					[LastModified],
					[LastModifiedBy]
				FROM
					[dbo].[DefaultResources]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DefaultResources_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DefaultResources_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DefaultResources_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the DefaultResources table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DefaultResources_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [DefaultResourceID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([DefaultResourceID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [DefaultResourceID]'
				SET @SQL = @SQL + ' FROM [dbo].[DefaultResources]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[DefaultResourceID], O.[ResourceCode], O.[ResourceFileID], O.[ResourceText], O.[ResourceDescription], O.[LastModified], O.[LastModifiedBy]
				FROM
				    [dbo].[DefaultResources] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[DefaultResourceID] = PageIndex.[DefaultResourceID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[DefaultResources]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DefaultResources_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DefaultResources_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DefaultResources_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the DefaultResources table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DefaultResources_Insert
(

	@DefaultResourceId int    OUTPUT,

	@ResourceCode varchar (255)  ,

	@ResourceFileId int   ,

	@ResourceText nvarchar (MAX)  ,

	@ResourceDescription varchar (255)  ,

	@LastModified datetime   ,

	@LastModifiedBy int   
)
AS


				
				INSERT INTO [dbo].[DefaultResources]
					(
					[ResourceCode]
					,[ResourceFileID]
					,[ResourceText]
					,[ResourceDescription]
					,[LastModified]
					,[LastModifiedBy]
					)
				VALUES
					(
					@ResourceCode
					,@ResourceFileId
					,@ResourceText
					,@ResourceDescription
					,@LastModified
					,@LastModifiedBy
					)
				
				-- Get the identity value
				SET @DefaultResourceId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DefaultResources_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DefaultResources_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DefaultResources_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the DefaultResources table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DefaultResources_Update
(

	@DefaultResourceId int   ,

	@ResourceCode varchar (255)  ,

	@ResourceFileId int   ,

	@ResourceText nvarchar (MAX)  ,

	@ResourceDescription varchar (255)  ,

	@LastModified datetime   ,

	@LastModifiedBy int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[DefaultResources]
				SET
					[ResourceCode] = @ResourceCode
					,[ResourceFileID] = @ResourceFileId
					,[ResourceText] = @ResourceText
					,[ResourceDescription] = @ResourceDescription
					,[LastModified] = @LastModified
					,[LastModifiedBy] = @LastModifiedBy
				WHERE
[DefaultResourceID] = @DefaultResourceId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DefaultResources_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DefaultResources_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DefaultResources_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the DefaultResources table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DefaultResources_Delete
(

	@DefaultResourceId int   
)
AS


				DELETE FROM [dbo].[DefaultResources] WITH (ROWLOCK) 
				WHERE
					[DefaultResourceID] = @DefaultResourceId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DefaultResources_GetByLastModifiedBy procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DefaultResources_GetByLastModifiedBy') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DefaultResources_GetByLastModifiedBy
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the DefaultResources table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DefaultResources_GetByLastModifiedBy
(

	@LastModifiedBy int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[DefaultResourceID],
					[ResourceCode],
					[ResourceFileID],
					[ResourceText],
					[ResourceDescription],
					[LastModified],
					[LastModifiedBy]
				FROM
					[dbo].[DefaultResources]
				WHERE
					[LastModifiedBy] = @LastModifiedBy
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DefaultResources_GetByResourceFileId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DefaultResources_GetByResourceFileId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DefaultResources_GetByResourceFileId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the DefaultResources table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DefaultResources_GetByResourceFileId
(

	@ResourceFileId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[DefaultResourceID],
					[ResourceCode],
					[ResourceFileID],
					[ResourceText],
					[ResourceDescription],
					[LastModified],
					[LastModifiedBy]
				FROM
					[dbo].[DefaultResources]
				WHERE
					[ResourceFileID] = @ResourceFileId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DefaultResources_GetByResourceCode procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DefaultResources_GetByResourceCode') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DefaultResources_GetByResourceCode
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the DefaultResources table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DefaultResources_GetByResourceCode
(

	@ResourceCode varchar (255)  
)
AS


				SELECT
					[DefaultResourceID],
					[ResourceCode],
					[ResourceFileID],
					[ResourceText],
					[ResourceDescription],
					[LastModified],
					[LastModifiedBy]
				FROM
					[dbo].[DefaultResources]
				WHERE
					[ResourceCode] = @ResourceCode
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DefaultResources_GetByDefaultResourceId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DefaultResources_GetByDefaultResourceId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DefaultResources_GetByDefaultResourceId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the DefaultResources table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DefaultResources_GetByDefaultResourceId
(

	@DefaultResourceId int   
)
AS


				SELECT
					[DefaultResourceID],
					[ResourceCode],
					[ResourceFileID],
					[ResourceText],
					[ResourceDescription],
					[LastModified],
					[LastModifiedBy]
				FROM
					[dbo].[DefaultResources]
				WHERE
					[DefaultResourceID] = @DefaultResourceId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DefaultResources_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DefaultResources_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DefaultResources_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the DefaultResources table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DefaultResources_Find
(

	@SearchUsingOR bit   = null ,

	@DefaultResourceId int   = null ,

	@ResourceCode varchar (255)  = null ,

	@ResourceFileId int   = null ,

	@ResourceText nvarchar (MAX)  = null ,

	@ResourceDescription varchar (255)  = null ,

	@LastModified datetime   = null ,

	@LastModifiedBy int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [DefaultResourceID]
	, [ResourceCode]
	, [ResourceFileID]
	, [ResourceText]
	, [ResourceDescription]
	, [LastModified]
	, [LastModifiedBy]
    FROM
	[dbo].[DefaultResources]
    WHERE 
	 ([DefaultResourceID] = @DefaultResourceId OR @DefaultResourceId IS NULL)
	AND ([ResourceCode] = @ResourceCode OR @ResourceCode IS NULL)
	AND ([ResourceFileID] = @ResourceFileId OR @ResourceFileId IS NULL)
	AND ([ResourceText] = @ResourceText OR @ResourceText IS NULL)
	AND ([ResourceDescription] = @ResourceDescription OR @ResourceDescription IS NULL)
	AND ([LastModified] = @LastModified OR @LastModified IS NULL)
	AND ([LastModifiedBy] = @LastModifiedBy OR @LastModifiedBy IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [DefaultResourceID]
	, [ResourceCode]
	, [ResourceFileID]
	, [ResourceText]
	, [ResourceDescription]
	, [LastModified]
	, [LastModifiedBy]
    FROM
	[dbo].[DefaultResources]
    WHERE 
	 ([DefaultResourceID] = @DefaultResourceId AND @DefaultResourceId is not null)
	OR ([ResourceCode] = @ResourceCode AND @ResourceCode is not null)
	OR ([ResourceFileID] = @ResourceFileId AND @ResourceFileId is not null)
	OR ([ResourceText] = @ResourceText AND @ResourceText is not null)
	OR ([ResourceDescription] = @ResourceDescription AND @ResourceDescription is not null)
	OR ([LastModified] = @LastModified AND @LastModified is not null)
	OR ([LastModifiedBy] = @LastModifiedBy AND @LastModifiedBy is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Countries_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Countries_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Countries_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the Countries table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Countries_Get_List

AS


				
				SELECT
					[CountryID],
					[CountryName],
					[Abbr],
					[Valid],
					[Sequence],
					[Currency]
				FROM
					[dbo].[Countries]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Countries_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Countries_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Countries_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the Countries table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Countries_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [CountryID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([CountryID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [CountryID]'
				SET @SQL = @SQL + ' FROM [dbo].[Countries]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[CountryID], O.[CountryName], O.[Abbr], O.[Valid], O.[Sequence], O.[Currency]
				FROM
				    [dbo].[Countries] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[CountryID] = PageIndex.[CountryID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[Countries]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Countries_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Countries_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Countries_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the Countries table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Countries_Insert
(

	@CountryId int    OUTPUT,

	@CountryName nvarchar (510)  ,

	@Abbr nvarchar (200)  ,

	@Valid bit   ,

	@Sequence int   ,

	@Currency nvarchar (5)  
)
AS


				
				INSERT INTO [dbo].[Countries]
					(
					[CountryName]
					,[Abbr]
					,[Valid]
					,[Sequence]
					,[Currency]
					)
				VALUES
					(
					@CountryName
					,@Abbr
					,@Valid
					,@Sequence
					,@Currency
					)
				
				-- Get the identity value
				SET @CountryId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Countries_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Countries_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Countries_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the Countries table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Countries_Update
(

	@CountryId int   ,

	@CountryName nvarchar (510)  ,

	@Abbr nvarchar (200)  ,

	@Valid bit   ,

	@Sequence int   ,

	@Currency nvarchar (5)  
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[Countries]
				SET
					[CountryName] = @CountryName
					,[Abbr] = @Abbr
					,[Valid] = @Valid
					,[Sequence] = @Sequence
					,[Currency] = @Currency
				WHERE
[CountryID] = @CountryId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Countries_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Countries_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Countries_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the Countries table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Countries_Delete
(

	@CountryId int   
)
AS


				DELETE FROM [dbo].[Countries] WITH (ROWLOCK) 
				WHERE
					[CountryID] = @CountryId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Countries_GetByCountryId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Countries_GetByCountryId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Countries_GetByCountryId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Countries table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Countries_GetByCountryId
(

	@CountryId int   
)
AS


				SELECT
					[CountryID],
					[CountryName],
					[Abbr],
					[Valid],
					[Sequence],
					[Currency]
				FROM
					[dbo].[Countries]
				WHERE
					[CountryID] = @CountryId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Countries_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Countries_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Countries_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the Countries table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Countries_Find
(

	@SearchUsingOR bit   = null ,

	@CountryId int   = null ,

	@CountryName nvarchar (510)  = null ,

	@Abbr nvarchar (200)  = null ,

	@Valid bit   = null ,

	@Sequence int   = null ,

	@Currency nvarchar (5)  = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [CountryID]
	, [CountryName]
	, [Abbr]
	, [Valid]
	, [Sequence]
	, [Currency]
    FROM
	[dbo].[Countries]
    WHERE 
	 ([CountryID] = @CountryId OR @CountryId IS NULL)
	AND ([CountryName] = @CountryName OR @CountryName IS NULL)
	AND ([Abbr] = @Abbr OR @Abbr IS NULL)
	AND ([Valid] = @Valid OR @Valid IS NULL)
	AND ([Sequence] = @Sequence OR @Sequence IS NULL)
	AND ([Currency] = @Currency OR @Currency IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [CountryID]
	, [CountryName]
	, [Abbr]
	, [Valid]
	, [Sequence]
	, [Currency]
    FROM
	[dbo].[Countries]
    WHERE 
	 ([CountryID] = @CountryId AND @CountryId is not null)
	OR ([CountryName] = @CountryName AND @CountryName is not null)
	OR ([Abbr] = @Abbr AND @Abbr is not null)
	OR ([Valid] = @Valid AND @Valid is not null)
	OR ([Sequence] = @Sequence AND @Sequence is not null)
	OR ([Currency] = @Currency AND @Currency is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserAccountType_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserAccountType_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserAccountType_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the AdvertiserAccountType table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserAccountType_Get_List

AS


				
				SELECT
					[AdvertiserAccountTypeID],
					[AdvertiserAccountTypeName]
				FROM
					[dbo].[AdvertiserAccountType]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserAccountType_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserAccountType_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserAccountType_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the AdvertiserAccountType table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserAccountType_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [AdvertiserAccountTypeID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([AdvertiserAccountTypeID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [AdvertiserAccountTypeID]'
				SET @SQL = @SQL + ' FROM [dbo].[AdvertiserAccountType]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[AdvertiserAccountTypeID], O.[AdvertiserAccountTypeName]
				FROM
				    [dbo].[AdvertiserAccountType] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[AdvertiserAccountTypeID] = PageIndex.[AdvertiserAccountTypeID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[AdvertiserAccountType]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserAccountType_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserAccountType_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserAccountType_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the AdvertiserAccountType table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserAccountType_Insert
(

	@AdvertiserAccountTypeId int    OUTPUT,

	@AdvertiserAccountTypeName varchar (255)  
)
AS


				
				INSERT INTO [dbo].[AdvertiserAccountType]
					(
					[AdvertiserAccountTypeName]
					)
				VALUES
					(
					@AdvertiserAccountTypeName
					)
				
				-- Get the identity value
				SET @AdvertiserAccountTypeId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserAccountType_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserAccountType_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserAccountType_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the AdvertiserAccountType table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserAccountType_Update
(

	@AdvertiserAccountTypeId int   ,

	@AdvertiserAccountTypeName varchar (255)  
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[AdvertiserAccountType]
				SET
					[AdvertiserAccountTypeName] = @AdvertiserAccountTypeName
				WHERE
[AdvertiserAccountTypeID] = @AdvertiserAccountTypeId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserAccountType_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserAccountType_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserAccountType_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the AdvertiserAccountType table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserAccountType_Delete
(

	@AdvertiserAccountTypeId int   
)
AS


				DELETE FROM [dbo].[AdvertiserAccountType] WITH (ROWLOCK) 
				WHERE
					[AdvertiserAccountTypeID] = @AdvertiserAccountTypeId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserAccountType_GetByAdvertiserAccountTypeId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserAccountType_GetByAdvertiserAccountTypeId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserAccountType_GetByAdvertiserAccountTypeId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the AdvertiserAccountType table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserAccountType_GetByAdvertiserAccountTypeId
(

	@AdvertiserAccountTypeId int   
)
AS


				SELECT
					[AdvertiserAccountTypeID],
					[AdvertiserAccountTypeName]
				FROM
					[dbo].[AdvertiserAccountType]
				WHERE
					[AdvertiserAccountTypeID] = @AdvertiserAccountTypeId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserAccountType_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserAccountType_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserAccountType_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the AdvertiserAccountType table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserAccountType_Find
(

	@SearchUsingOR bit   = null ,

	@AdvertiserAccountTypeId int   = null ,

	@AdvertiserAccountTypeName varchar (255)  = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [AdvertiserAccountTypeID]
	, [AdvertiserAccountTypeName]
    FROM
	[dbo].[AdvertiserAccountType]
    WHERE 
	 ([AdvertiserAccountTypeID] = @AdvertiserAccountTypeId OR @AdvertiserAccountTypeId IS NULL)
	AND ([AdvertiserAccountTypeName] = @AdvertiserAccountTypeName OR @AdvertiserAccountTypeName IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [AdvertiserAccountTypeID]
	, [AdvertiserAccountTypeName]
    FROM
	[dbo].[AdvertiserAccountType]
    WHERE 
	 ([AdvertiserAccountTypeID] = @AdvertiserAccountTypeId AND @AdvertiserAccountTypeId is not null)
	OR ([AdvertiserAccountTypeName] = @AdvertiserAccountTypeName AND @AdvertiserAccountTypeName is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Roles_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Roles_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Roles_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the Roles table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Roles_Get_List

AS


				
				SELECT
					[RoleID],
					[ProfessionID],
					[RoleName],
					[Valid],
					[MetaTitle],
					[MetaKeywords],
					[MetaDescription]
				FROM
					[dbo].[Roles]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Roles_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Roles_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Roles_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the Roles table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Roles_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [RoleID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([RoleID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [RoleID]'
				SET @SQL = @SQL + ' FROM [dbo].[Roles]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[RoleID], O.[ProfessionID], O.[RoleName], O.[Valid], O.[MetaTitle], O.[MetaKeywords], O.[MetaDescription]
				FROM
				    [dbo].[Roles] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[RoleID] = PageIndex.[RoleID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[Roles]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Roles_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Roles_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Roles_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the Roles table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Roles_Insert
(

	@RoleId int    OUTPUT,

	@ProfessionId int   ,

	@RoleName varchar (255)  ,

	@Valid bit   ,

	@MetaTitle varchar (255)  ,

	@MetaKeywords varchar (255)  ,

	@MetaDescription varchar (512)  
)
AS


				
				INSERT INTO [dbo].[Roles]
					(
					[ProfessionID]
					,[RoleName]
					,[Valid]
					,[MetaTitle]
					,[MetaKeywords]
					,[MetaDescription]
					)
				VALUES
					(
					@ProfessionId
					,@RoleName
					,@Valid
					,@MetaTitle
					,@MetaKeywords
					,@MetaDescription
					)
				
				-- Get the identity value
				SET @RoleId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Roles_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Roles_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Roles_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the Roles table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Roles_Update
(

	@RoleId int   ,

	@ProfessionId int   ,

	@RoleName varchar (255)  ,

	@Valid bit   ,

	@MetaTitle varchar (255)  ,

	@MetaKeywords varchar (255)  ,

	@MetaDescription varchar (512)  
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[Roles]
				SET
					[ProfessionID] = @ProfessionId
					,[RoleName] = @RoleName
					,[Valid] = @Valid
					,[MetaTitle] = @MetaTitle
					,[MetaKeywords] = @MetaKeywords
					,[MetaDescription] = @MetaDescription
				WHERE
[RoleID] = @RoleId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Roles_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Roles_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Roles_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the Roles table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Roles_Delete
(

	@RoleId int   
)
AS


				DELETE FROM [dbo].[Roles] WITH (ROWLOCK) 
				WHERE
					[RoleID] = @RoleId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Roles_GetByProfessionIdRoleId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Roles_GetByProfessionIdRoleId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Roles_GetByProfessionIdRoleId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Roles table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Roles_GetByProfessionIdRoleId
(

	@ProfessionId int   ,

	@RoleId int   
)
AS


				SELECT
					[RoleID],
					[ProfessionID],
					[RoleName],
					[Valid],
					[MetaTitle],
					[MetaKeywords],
					[MetaDescription]
				FROM
					[dbo].[Roles]
				WHERE
					[ProfessionID] = @ProfessionId
					AND [RoleID] = @RoleId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Roles_GetByProfessionId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Roles_GetByProfessionId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Roles_GetByProfessionId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Roles table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Roles_GetByProfessionId
(

	@ProfessionId int   
)
AS


				SELECT
					[RoleID],
					[ProfessionID],
					[RoleName],
					[Valid],
					[MetaTitle],
					[MetaKeywords],
					[MetaDescription]
				FROM
					[dbo].[Roles]
				WHERE
					[ProfessionID] = @ProfessionId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Roles_GetByRoleId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Roles_GetByRoleId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Roles_GetByRoleId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Roles table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Roles_GetByRoleId
(

	@RoleId int   
)
AS


				SELECT
					[RoleID],
					[ProfessionID],
					[RoleName],
					[Valid],
					[MetaTitle],
					[MetaKeywords],
					[MetaDescription]
				FROM
					[dbo].[Roles]
				WHERE
					[RoleID] = @RoleId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Roles_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Roles_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Roles_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the Roles table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Roles_Find
(

	@SearchUsingOR bit   = null ,

	@RoleId int   = null ,

	@ProfessionId int   = null ,

	@RoleName varchar (255)  = null ,

	@Valid bit   = null ,

	@MetaTitle varchar (255)  = null ,

	@MetaKeywords varchar (255)  = null ,

	@MetaDescription varchar (512)  = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [RoleID]
	, [ProfessionID]
	, [RoleName]
	, [Valid]
	, [MetaTitle]
	, [MetaKeywords]
	, [MetaDescription]
    FROM
	[dbo].[Roles]
    WHERE 
	 ([RoleID] = @RoleId OR @RoleId IS NULL)
	AND ([ProfessionID] = @ProfessionId OR @ProfessionId IS NULL)
	AND ([RoleName] = @RoleName OR @RoleName IS NULL)
	AND ([Valid] = @Valid OR @Valid IS NULL)
	AND ([MetaTitle] = @MetaTitle OR @MetaTitle IS NULL)
	AND ([MetaKeywords] = @MetaKeywords OR @MetaKeywords IS NULL)
	AND ([MetaDescription] = @MetaDescription OR @MetaDescription IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [RoleID]
	, [ProfessionID]
	, [RoleName]
	, [Valid]
	, [MetaTitle]
	, [MetaKeywords]
	, [MetaDescription]
    FROM
	[dbo].[Roles]
    WHERE 
	 ([RoleID] = @RoleId AND @RoleId is not null)
	OR ([ProfessionID] = @ProfessionId AND @ProfessionId is not null)
	OR ([RoleName] = @RoleName AND @RoleName is not null)
	OR ([Valid] = @Valid AND @Valid is not null)
	OR ([MetaTitle] = @MetaTitle AND @MetaTitle is not null)
	OR ([MetaKeywords] = @MetaKeywords AND @MetaKeywords is not null)
	OR ([MetaDescription] = @MetaDescription AND @MetaDescription is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.RelatedDynamicPages_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.RelatedDynamicPages_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.RelatedDynamicPages_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the RelatedDynamicPages table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.RelatedDynamicPages_Get_List

AS


				
				SELECT
					[DynamicPageID],
					[RelatedDynamicPageID],
					[Sequence]
				FROM
					[dbo].[RelatedDynamicPages]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.RelatedDynamicPages_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.RelatedDynamicPages_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.RelatedDynamicPages_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the RelatedDynamicPages table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.RelatedDynamicPages_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [DynamicPageID] int, [RelatedDynamicPageID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([DynamicPageID], [RelatedDynamicPageID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [DynamicPageID], [RelatedDynamicPageID]'
				SET @SQL = @SQL + ' FROM [dbo].[RelatedDynamicPages]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[DynamicPageID], O.[RelatedDynamicPageID], O.[Sequence]
				FROM
				    [dbo].[RelatedDynamicPages] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[DynamicPageID] = PageIndex.[DynamicPageID]
					AND O.[RelatedDynamicPageID] = PageIndex.[RelatedDynamicPageID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[RelatedDynamicPages]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.RelatedDynamicPages_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.RelatedDynamicPages_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.RelatedDynamicPages_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the RelatedDynamicPages table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.RelatedDynamicPages_Insert
(

	@DynamicPageId int   ,

	@RelatedDynamicPageId int   ,

	@Sequence int   
)
AS


				
				INSERT INTO [dbo].[RelatedDynamicPages]
					(
					[DynamicPageID]
					,[RelatedDynamicPageID]
					,[Sequence]
					)
				VALUES
					(
					@DynamicPageId
					,@RelatedDynamicPageId
					,@Sequence
					)
				
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.RelatedDynamicPages_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.RelatedDynamicPages_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.RelatedDynamicPages_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the RelatedDynamicPages table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.RelatedDynamicPages_Update
(

	@DynamicPageId int   ,

	@OriginalDynamicPageId int   ,

	@RelatedDynamicPageId int   ,

	@OriginalRelatedDynamicPageId int   ,

	@Sequence int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[RelatedDynamicPages]
				SET
					[DynamicPageID] = @DynamicPageId
					,[RelatedDynamicPageID] = @RelatedDynamicPageId
					,[Sequence] = @Sequence
				WHERE
[DynamicPageID] = @OriginalDynamicPageId 
AND [RelatedDynamicPageID] = @OriginalRelatedDynamicPageId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.RelatedDynamicPages_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.RelatedDynamicPages_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.RelatedDynamicPages_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the RelatedDynamicPages table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.RelatedDynamicPages_Delete
(

	@DynamicPageId int   ,

	@RelatedDynamicPageId int   
)
AS


				DELETE FROM [dbo].[RelatedDynamicPages] WITH (ROWLOCK) 
				WHERE
					[DynamicPageID] = @DynamicPageId
					AND [RelatedDynamicPageID] = @RelatedDynamicPageId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.RelatedDynamicPages_GetByDynamicPageId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.RelatedDynamicPages_GetByDynamicPageId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.RelatedDynamicPages_GetByDynamicPageId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the RelatedDynamicPages table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.RelatedDynamicPages_GetByDynamicPageId
(

	@DynamicPageId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[DynamicPageID],
					[RelatedDynamicPageID],
					[Sequence]
				FROM
					[dbo].[RelatedDynamicPages]
				WHERE
					[DynamicPageID] = @DynamicPageId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.RelatedDynamicPages_GetByRelatedDynamicPageId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.RelatedDynamicPages_GetByRelatedDynamicPageId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.RelatedDynamicPages_GetByRelatedDynamicPageId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the RelatedDynamicPages table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.RelatedDynamicPages_GetByRelatedDynamicPageId
(

	@RelatedDynamicPageId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[DynamicPageID],
					[RelatedDynamicPageID],
					[Sequence]
				FROM
					[dbo].[RelatedDynamicPages]
				WHERE
					[RelatedDynamicPageID] = @RelatedDynamicPageId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.RelatedDynamicPages_GetByDynamicPageIdRelatedDynamicPageId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.RelatedDynamicPages_GetByDynamicPageIdRelatedDynamicPageId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.RelatedDynamicPages_GetByDynamicPageIdRelatedDynamicPageId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the RelatedDynamicPages table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.RelatedDynamicPages_GetByDynamicPageIdRelatedDynamicPageId
(

	@DynamicPageId int   ,

	@RelatedDynamicPageId int   
)
AS


				SELECT
					[DynamicPageID],
					[RelatedDynamicPageID],
					[Sequence]
				FROM
					[dbo].[RelatedDynamicPages]
				WHERE
					[DynamicPageID] = @DynamicPageId
					AND [RelatedDynamicPageID] = @RelatedDynamicPageId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.RelatedDynamicPages_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.RelatedDynamicPages_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.RelatedDynamicPages_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the RelatedDynamicPages table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.RelatedDynamicPages_Find
(

	@SearchUsingOR bit   = null ,

	@DynamicPageId int   = null ,

	@RelatedDynamicPageId int   = null ,

	@Sequence int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [DynamicPageID]
	, [RelatedDynamicPageID]
	, [Sequence]
    FROM
	[dbo].[RelatedDynamicPages]
    WHERE 
	 ([DynamicPageID] = @DynamicPageId OR @DynamicPageId IS NULL)
	AND ([RelatedDynamicPageID] = @RelatedDynamicPageId OR @RelatedDynamicPageId IS NULL)
	AND ([Sequence] = @Sequence OR @Sequence IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [DynamicPageID]
	, [RelatedDynamicPageID]
	, [Sequence]
    FROM
	[dbo].[RelatedDynamicPages]
    WHERE 
	 ([DynamicPageID] = @DynamicPageId AND @DynamicPageId is not null)
	OR ([RelatedDynamicPageID] = @RelatedDynamicPageId AND @RelatedDynamicPageId is not null)
	OR ([Sequence] = @Sequence AND @Sequence is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Profession_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Profession_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Profession_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the Profession table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Profession_Get_List

AS


				
				SELECT
					[ProfessionID],
					[ProfessionName],
					[Valid],
					[MetaTitle],
					[MetaKeywords],
					[MetaDescription],
					[ReferredSiteID]
				FROM
					[dbo].[Profession]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Profession_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Profession_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Profession_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the Profession table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Profession_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [ProfessionID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([ProfessionID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [ProfessionID]'
				SET @SQL = @SQL + ' FROM [dbo].[Profession]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[ProfessionID], O.[ProfessionName], O.[Valid], O.[MetaTitle], O.[MetaKeywords], O.[MetaDescription], O.[ReferredSiteID]
				FROM
				    [dbo].[Profession] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[ProfessionID] = PageIndex.[ProfessionID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[Profession]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Profession_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Profession_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Profession_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the Profession table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Profession_Insert
(

	@ProfessionId int    OUTPUT,

	@ProfessionName varchar (255)  ,

	@Valid bit   ,

	@MetaTitle varchar (255)  ,

	@MetaKeywords varchar (255)  ,

	@MetaDescription varchar (512)  ,

	@ReferredSiteId int   
)
AS


				
				INSERT INTO [dbo].[Profession]
					(
					[ProfessionName]
					,[Valid]
					,[MetaTitle]
					,[MetaKeywords]
					,[MetaDescription]
					,[ReferredSiteID]
					)
				VALUES
					(
					@ProfessionName
					,@Valid
					,@MetaTitle
					,@MetaKeywords
					,@MetaDescription
					,@ReferredSiteId
					)
				
				-- Get the identity value
				SET @ProfessionId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Profession_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Profession_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Profession_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the Profession table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Profession_Update
(

	@ProfessionId int   ,

	@ProfessionName varchar (255)  ,

	@Valid bit   ,

	@MetaTitle varchar (255)  ,

	@MetaKeywords varchar (255)  ,

	@MetaDescription varchar (512)  ,

	@ReferredSiteId int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[Profession]
				SET
					[ProfessionName] = @ProfessionName
					,[Valid] = @Valid
					,[MetaTitle] = @MetaTitle
					,[MetaKeywords] = @MetaKeywords
					,[MetaDescription] = @MetaDescription
					,[ReferredSiteID] = @ReferredSiteId
				WHERE
[ProfessionID] = @ProfessionId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Profession_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Profession_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Profession_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the Profession table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Profession_Delete
(

	@ProfessionId int   
)
AS


				DELETE FROM [dbo].[Profession] WITH (ROWLOCK) 
				WHERE
					[ProfessionID] = @ProfessionId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Profession_GetByReferredSiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Profession_GetByReferredSiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Profession_GetByReferredSiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Profession table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Profession_GetByReferredSiteId
(

	@ReferredSiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[ProfessionID],
					[ProfessionName],
					[Valid],
					[MetaTitle],
					[MetaKeywords],
					[MetaDescription],
					[ReferredSiteID]
				FROM
					[dbo].[Profession]
				WHERE
					[ReferredSiteID] = @ReferredSiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Profession_GetByProfessionId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Profession_GetByProfessionId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Profession_GetByProfessionId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Profession table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Profession_GetByProfessionId
(

	@ProfessionId int   
)
AS


				SELECT
					[ProfessionID],
					[ProfessionName],
					[Valid],
					[MetaTitle],
					[MetaKeywords],
					[MetaDescription],
					[ReferredSiteID]
				FROM
					[dbo].[Profession]
				WHERE
					[ProfessionID] = @ProfessionId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Profession_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Profession_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Profession_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the Profession table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Profession_Find
(

	@SearchUsingOR bit   = null ,

	@ProfessionId int   = null ,

	@ProfessionName varchar (255)  = null ,

	@Valid bit   = null ,

	@MetaTitle varchar (255)  = null ,

	@MetaKeywords varchar (255)  = null ,

	@MetaDescription varchar (512)  = null ,

	@ReferredSiteId int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [ProfessionID]
	, [ProfessionName]
	, [Valid]
	, [MetaTitle]
	, [MetaKeywords]
	, [MetaDescription]
	, [ReferredSiteID]
    FROM
	[dbo].[Profession]
    WHERE 
	 ([ProfessionID] = @ProfessionId OR @ProfessionId IS NULL)
	AND ([ProfessionName] = @ProfessionName OR @ProfessionName IS NULL)
	AND ([Valid] = @Valid OR @Valid IS NULL)
	AND ([MetaTitle] = @MetaTitle OR @MetaTitle IS NULL)
	AND ([MetaKeywords] = @MetaKeywords OR @MetaKeywords IS NULL)
	AND ([MetaDescription] = @MetaDescription OR @MetaDescription IS NULL)
	AND ([ReferredSiteID] = @ReferredSiteId OR @ReferredSiteId IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [ProfessionID]
	, [ProfessionName]
	, [Valid]
	, [MetaTitle]
	, [MetaKeywords]
	, [MetaDescription]
	, [ReferredSiteID]
    FROM
	[dbo].[Profession]
    WHERE 
	 ([ProfessionID] = @ProfessionId AND @ProfessionId is not null)
	OR ([ProfessionName] = @ProfessionName AND @ProfessionName is not null)
	OR ([Valid] = @Valid AND @Valid is not null)
	OR ([MetaTitle] = @MetaTitle AND @MetaTitle is not null)
	OR ([MetaKeywords] = @MetaKeywords AND @MetaKeywords is not null)
	OR ([MetaDescription] = @MetaDescription AND @MetaDescription is not null)
	OR ([ReferredSiteID] = @ReferredSiteId AND @ReferredSiteId is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.News_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.News_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.News_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the News table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.News_Get_List

AS


				
				SELECT
					[NewsID],
					[SiteID],
					[NewsCategoryID],
					[Subject],
					[Content],
					[PostDate],
					[Valid],
					[Sequence],
					[LastModified],
					[LastModifiedBy],
					[SearchField],
					[Tags],
					[MetaTitle],
					[MetaKeywords],
					[MetaDescription],
					[PageFriendlyName],
					[NewsIndustryID],
					[NewsTypeIDs],
					[CustomXML],
					[ImageURL],
					[Author]
				FROM
					[dbo].[News]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.News_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.News_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.News_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the News table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.News_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [NewsID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([NewsID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [NewsID]'
				SET @SQL = @SQL + ' FROM [dbo].[News]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[NewsID], O.[SiteID], O.[NewsCategoryID], O.[Subject], O.[Content], O.[PostDate], O.[Valid], O.[Sequence], O.[LastModified], O.[LastModifiedBy], O.[SearchField], O.[Tags], O.[MetaTitle], O.[MetaKeywords], O.[MetaDescription], O.[PageFriendlyName], O.[NewsIndustryID], O.[NewsTypeIDs], O.[CustomXML], O.[ImageURL], O.[Author]
				FROM
				    [dbo].[News] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[NewsID] = PageIndex.[NewsID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[News]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.News_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.News_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.News_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the News table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.News_Insert
(

	@NewsId int    OUTPUT,

	@SiteId int   ,

	@NewsCategoryId int   ,

	@Subject nvarchar (255)  ,

	@Content ntext   ,

	@PostDate smalldatetime   ,

	@Valid bit   ,

	@Sequence int   ,

	@LastModified datetime   ,

	@LastModifiedBy int   ,

	@SearchField nvarchar (MAX)  ,

	@Tags nvarchar (250)  ,

	@MetaTitle nvarchar (510)  ,

	@MetaKeywords nvarchar (510)  ,

	@MetaDescription nvarchar (1024)  ,

	@PageFriendlyName varchar (255)  ,

	@NewsIndustryId int   ,

	@NewsTypeIds varchar (100)  ,

	@CustomXml nvarchar (MAX)  ,

	@ImageUrl varchar (255)  ,

	@Author nvarchar (255)  
)
AS


				
				INSERT INTO [dbo].[News]
					(
					[SiteID]
					,[NewsCategoryID]
					,[Subject]
					,[Content]
					,[PostDate]
					,[Valid]
					,[Sequence]
					,[LastModified]
					,[LastModifiedBy]
					,[SearchField]
					,[Tags]
					,[MetaTitle]
					,[MetaKeywords]
					,[MetaDescription]
					,[PageFriendlyName]
					,[NewsIndustryID]
					,[NewsTypeIDs]
					,[CustomXML]
					,[ImageURL]
					,[Author]
					)
				VALUES
					(
					@SiteId
					,@NewsCategoryId
					,@Subject
					,@Content
					,@PostDate
					,@Valid
					,@Sequence
					,@LastModified
					,@LastModifiedBy
					,@SearchField
					,@Tags
					,@MetaTitle
					,@MetaKeywords
					,@MetaDescription
					,@PageFriendlyName
					,@NewsIndustryId
					,@NewsTypeIds
					,@CustomXml
					,@ImageUrl
					,@Author
					)
				
				-- Get the identity value
				SET @NewsId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.News_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.News_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.News_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the News table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.News_Update
(

	@NewsId int   ,

	@SiteId int   ,

	@NewsCategoryId int   ,

	@Subject nvarchar (255)  ,

	@Content ntext   ,

	@PostDate smalldatetime   ,

	@Valid bit   ,

	@Sequence int   ,

	@LastModified datetime   ,

	@LastModifiedBy int   ,

	@SearchField nvarchar (MAX)  ,

	@Tags nvarchar (250)  ,

	@MetaTitle nvarchar (510)  ,

	@MetaKeywords nvarchar (510)  ,

	@MetaDescription nvarchar (1024)  ,

	@PageFriendlyName varchar (255)  ,

	@NewsIndustryId int   ,

	@NewsTypeIds varchar (100)  ,

	@CustomXml nvarchar (MAX)  ,

	@ImageUrl varchar (255)  ,

	@Author nvarchar (255)  
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[News]
				SET
					[SiteID] = @SiteId
					,[NewsCategoryID] = @NewsCategoryId
					,[Subject] = @Subject
					,[Content] = @Content
					,[PostDate] = @PostDate
					,[Valid] = @Valid
					,[Sequence] = @Sequence
					,[LastModified] = @LastModified
					,[LastModifiedBy] = @LastModifiedBy
					,[SearchField] = @SearchField
					,[Tags] = @Tags
					,[MetaTitle] = @MetaTitle
					,[MetaKeywords] = @MetaKeywords
					,[MetaDescription] = @MetaDescription
					,[PageFriendlyName] = @PageFriendlyName
					,[NewsIndustryID] = @NewsIndustryId
					,[NewsTypeIDs] = @NewsTypeIds
					,[CustomXML] = @CustomXml
					,[ImageURL] = @ImageUrl
					,[Author] = @Author
				WHERE
[NewsID] = @NewsId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.News_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.News_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.News_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the News table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.News_Delete
(

	@NewsId int   
)
AS


				DELETE FROM [dbo].[News] WITH (ROWLOCK) 
				WHERE
					[NewsID] = @NewsId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.News_GetByLastModifiedBy procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.News_GetByLastModifiedBy') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.News_GetByLastModifiedBy
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the News table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.News_GetByLastModifiedBy
(

	@LastModifiedBy int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[NewsID],
					[SiteID],
					[NewsCategoryID],
					[Subject],
					[Content],
					[PostDate],
					[Valid],
					[Sequence],
					[LastModified],
					[LastModifiedBy],
					[SearchField],
					[Tags],
					[MetaTitle],
					[MetaKeywords],
					[MetaDescription],
					[PageFriendlyName],
					[NewsIndustryID],
					[NewsTypeIDs],
					[CustomXML],
					[ImageURL],
					[Author]
				FROM
					[dbo].[News]
				WHERE
					[LastModifiedBy] = @LastModifiedBy
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.News_GetByNewsCategoryId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.News_GetByNewsCategoryId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.News_GetByNewsCategoryId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the News table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.News_GetByNewsCategoryId
(

	@NewsCategoryId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[NewsID],
					[SiteID],
					[NewsCategoryID],
					[Subject],
					[Content],
					[PostDate],
					[Valid],
					[Sequence],
					[LastModified],
					[LastModifiedBy],
					[SearchField],
					[Tags],
					[MetaTitle],
					[MetaKeywords],
					[MetaDescription],
					[PageFriendlyName],
					[NewsIndustryID],
					[NewsTypeIDs],
					[CustomXML],
					[ImageURL],
					[Author]
				FROM
					[dbo].[News]
				WHERE
					[NewsCategoryID] = @NewsCategoryId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.News_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.News_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.News_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the News table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.News_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[NewsID],
					[SiteID],
					[NewsCategoryID],
					[Subject],
					[Content],
					[PostDate],
					[Valid],
					[Sequence],
					[LastModified],
					[LastModifiedBy],
					[SearchField],
					[Tags],
					[MetaTitle],
					[MetaKeywords],
					[MetaDescription],
					[PageFriendlyName],
					[NewsIndustryID],
					[NewsTypeIDs],
					[CustomXML],
					[ImageURL],
					[Author]
				FROM
					[dbo].[News]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.News_GetByNewsId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.News_GetByNewsId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.News_GetByNewsId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the News table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.News_GetByNewsId
(

	@NewsId int   
)
AS


				SELECT
					[NewsID],
					[SiteID],
					[NewsCategoryID],
					[Subject],
					[Content],
					[PostDate],
					[Valid],
					[Sequence],
					[LastModified],
					[LastModifiedBy],
					[SearchField],
					[Tags],
					[MetaTitle],
					[MetaKeywords],
					[MetaDescription],
					[PageFriendlyName],
					[NewsIndustryID],
					[NewsTypeIDs],
					[CustomXML],
					[ImageURL],
					[Author]
				FROM
					[dbo].[News]
				WHERE
					[NewsID] = @NewsId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.News_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.News_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.News_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the News table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.News_Find
(

	@SearchUsingOR bit   = null ,

	@NewsId int   = null ,

	@SiteId int   = null ,

	@NewsCategoryId int   = null ,

	@Subject nvarchar (255)  = null ,

	@Content ntext   = null ,

	@PostDate smalldatetime   = null ,

	@Valid bit   = null ,

	@Sequence int   = null ,

	@LastModified datetime   = null ,

	@LastModifiedBy int   = null ,

	@SearchField nvarchar (MAX)  = null ,

	@Tags nvarchar (250)  = null ,

	@MetaTitle nvarchar (510)  = null ,

	@MetaKeywords nvarchar (510)  = null ,

	@MetaDescription nvarchar (1024)  = null ,

	@PageFriendlyName varchar (255)  = null ,

	@NewsIndustryId int   = null ,

	@NewsTypeIds varchar (100)  = null ,

	@CustomXml nvarchar (MAX)  = null ,

	@ImageUrl varchar (255)  = null ,

	@Author nvarchar (255)  = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [NewsID]
	, [SiteID]
	, [NewsCategoryID]
	, [Subject]
	, [Content]
	, [PostDate]
	, [Valid]
	, [Sequence]
	, [LastModified]
	, [LastModifiedBy]
	, [SearchField]
	, [Tags]
	, [MetaTitle]
	, [MetaKeywords]
	, [MetaDescription]
	, [PageFriendlyName]
	, [NewsIndustryID]
	, [NewsTypeIDs]
	, [CustomXML]
	, [ImageURL]
	, [Author]
    FROM
	[dbo].[News]
    WHERE 
	 ([NewsID] = @NewsId OR @NewsId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([NewsCategoryID] = @NewsCategoryId OR @NewsCategoryId IS NULL)
	AND ([Subject] = @Subject OR @Subject IS NULL)
	AND ([PostDate] = @PostDate OR @PostDate IS NULL)
	AND ([Valid] = @Valid OR @Valid IS NULL)
	AND ([Sequence] = @Sequence OR @Sequence IS NULL)
	AND ([LastModified] = @LastModified OR @LastModified IS NULL)
	AND ([LastModifiedBy] = @LastModifiedBy OR @LastModifiedBy IS NULL)
	AND ([SearchField] = @SearchField OR @SearchField IS NULL)
	AND ([Tags] = @Tags OR @Tags IS NULL)
	AND ([MetaTitle] = @MetaTitle OR @MetaTitle IS NULL)
	AND ([MetaKeywords] = @MetaKeywords OR @MetaKeywords IS NULL)
	AND ([MetaDescription] = @MetaDescription OR @MetaDescription IS NULL)
	AND ([PageFriendlyName] = @PageFriendlyName OR @PageFriendlyName IS NULL)
	AND ([NewsIndustryID] = @NewsIndustryId OR @NewsIndustryId IS NULL)
	AND ([NewsTypeIDs] = @NewsTypeIds OR @NewsTypeIds IS NULL)
	AND ([CustomXML] = @CustomXml OR @CustomXml IS NULL)
	AND ([ImageURL] = @ImageUrl OR @ImageUrl IS NULL)
	AND ([Author] = @Author OR @Author IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [NewsID]
	, [SiteID]
	, [NewsCategoryID]
	, [Subject]
	, [Content]
	, [PostDate]
	, [Valid]
	, [Sequence]
	, [LastModified]
	, [LastModifiedBy]
	, [SearchField]
	, [Tags]
	, [MetaTitle]
	, [MetaKeywords]
	, [MetaDescription]
	, [PageFriendlyName]
	, [NewsIndustryID]
	, [NewsTypeIDs]
	, [CustomXML]
	, [ImageURL]
	, [Author]
    FROM
	[dbo].[News]
    WHERE 
	 ([NewsID] = @NewsId AND @NewsId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([NewsCategoryID] = @NewsCategoryId AND @NewsCategoryId is not null)
	OR ([Subject] = @Subject AND @Subject is not null)
	OR ([PostDate] = @PostDate AND @PostDate is not null)
	OR ([Valid] = @Valid AND @Valid is not null)
	OR ([Sequence] = @Sequence AND @Sequence is not null)
	OR ([LastModified] = @LastModified AND @LastModified is not null)
	OR ([LastModifiedBy] = @LastModifiedBy AND @LastModifiedBy is not null)
	OR ([SearchField] = @SearchField AND @SearchField is not null)
	OR ([Tags] = @Tags AND @Tags is not null)
	OR ([MetaTitle] = @MetaTitle AND @MetaTitle is not null)
	OR ([MetaKeywords] = @MetaKeywords AND @MetaKeywords is not null)
	OR ([MetaDescription] = @MetaDescription AND @MetaDescription is not null)
	OR ([PageFriendlyName] = @PageFriendlyName AND @PageFriendlyName is not null)
	OR ([NewsIndustryID] = @NewsIndustryId AND @NewsIndustryId is not null)
	OR ([NewsTypeIDs] = @NewsTypeIds AND @NewsTypeIds is not null)
	OR ([CustomXML] = @CustomXml AND @CustomXml is not null)
	OR ([ImageURL] = @ImageUrl AND @ImageUrl is not null)
	OR ([Author] = @Author AND @Author is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Members_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Members_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Members_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the Members table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Members_Get_List

AS


				
				SELECT
					[MemberID],
					[SiteID],
					[Username],
					[Password],
					[Title],
					[FirstName],
					[Surname],
					[EmailAddress],
					[Company],
					[Position],
					[HomePhone],
					[WorkPhone],
					[MobilePhone],
					[Fax],
					[Address1],
					[Address2],
					[LocationID],
					[AreaID],
					[CountryID],
					[PreferredCategoryID],
					[PreferredSubCategoryID],
					[PreferredSalaryID],
					[Subscribed],
					[MonthlyUpdate],
					[ReferringMemberID],
					[LastModifiedDate],
					[Valid],
					[EmailFormat],
					[LastLogon],
					[DateOfBirth],
					[Gender],
					[Tags],
					[Validated],
					[ValidateGUID],
					[MemberURLExtension],
					[WebsiteURL],
					[AvailabilityID],
					[AvailabilityFromDate],
					[MySpaceHeading],
					[MySpaceContent],
					[URLReferrer],
					[RequiredPasswordChange],
					[PreferredJobTitle],
					[PreferredAvailability],
					[PreferredAvailabilityType],
					[PreferredSalaryFrom],
					[PreferredSalaryTo],
					[CurrentSalaryFrom],
					[CurrentSalaryTo],
					[LookingFor],
					[Experience],
					[Skills],
					[Reasons],
					[Comments],
					[ProfileType],
					[EducationID],
					[SearchField],
					[RegisteredDate],
					[States],
					[Suburb],
					[PostCode],
					[ProfilePicture],
					[ShortBio],
					[WorkTypeID],
					[Memberships],
					[MemberStatusID],
					[LinkedInAccessToken],
					[ExternalMemberID],
					[PassportNo],
					[MailingAddress1],
					[MailingAddress2],
					[MailingStates],
					[MailingSuburb],
					[MailingPostCode],
					[MailingCountryID],
					[CountryName],
					[MailingCountryName],
					[LoginAttempts],
					[LastAttemptDate],
					[Status],
					[LastTermsAndConditionsDate],
					[DefaultLanguageId],
					[ReferringSiteID],
					[MultiLingualFirstName],
					[MultiLingualSurame],
					[SecondaryEmail],
					[CandidateData],
					[EligibleToWorkIn],
					[ReferenceUponRequest],
					[PreferredLine],
					[VideoURL],
					[ProfileDataXML],
					[LastProfileSubmittedDate]
				FROM
					[dbo].[Members]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Members_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Members_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Members_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the Members table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Members_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [MemberID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([MemberID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [MemberID]'
				SET @SQL = @SQL + ' FROM [dbo].[Members]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[MemberID], O.[SiteID], O.[Username], O.[Password], O.[Title], O.[FirstName], O.[Surname], O.[EmailAddress], O.[Company], O.[Position], O.[HomePhone], O.[WorkPhone], O.[MobilePhone], O.[Fax], O.[Address1], O.[Address2], O.[LocationID], O.[AreaID], O.[CountryID], O.[PreferredCategoryID], O.[PreferredSubCategoryID], O.[PreferredSalaryID], O.[Subscribed], O.[MonthlyUpdate], O.[ReferringMemberID], O.[LastModifiedDate], O.[Valid], O.[EmailFormat], O.[LastLogon], O.[DateOfBirth], O.[Gender], O.[Tags], O.[Validated], O.[ValidateGUID], O.[MemberURLExtension], O.[WebsiteURL], O.[AvailabilityID], O.[AvailabilityFromDate], O.[MySpaceHeading], O.[MySpaceContent], O.[URLReferrer], O.[RequiredPasswordChange], O.[PreferredJobTitle], O.[PreferredAvailability], O.[PreferredAvailabilityType], O.[PreferredSalaryFrom], O.[PreferredSalaryTo], O.[CurrentSalaryFrom], O.[CurrentSalaryTo], O.[LookingFor], O.[Experience], O.[Skills], O.[Reasons], O.[Comments], O.[ProfileType], O.[EducationID], O.[SearchField], O.[RegisteredDate], O.[States], O.[Suburb], O.[PostCode], O.[ProfilePicture], O.[ShortBio], O.[WorkTypeID], O.[Memberships], O.[MemberStatusID], O.[LinkedInAccessToken], O.[ExternalMemberID], O.[PassportNo], O.[MailingAddress1], O.[MailingAddress2], O.[MailingStates], O.[MailingSuburb], O.[MailingPostCode], O.[MailingCountryID], O.[CountryName], O.[MailingCountryName], O.[LoginAttempts], O.[LastAttemptDate], O.[Status], O.[LastTermsAndConditionsDate], O.[DefaultLanguageId], O.[ReferringSiteID], O.[MultiLingualFirstName], O.[MultiLingualSurame], O.[SecondaryEmail], O.[CandidateData], O.[EligibleToWorkIn], O.[ReferenceUponRequest], O.[PreferredLine], O.[VideoURL], O.[ProfileDataXML], O.[LastProfileSubmittedDate]
				FROM
				    [dbo].[Members] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[MemberID] = PageIndex.[MemberID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[Members]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Members_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Members_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Members_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the Members table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Members_Insert
(

	@MemberId int    OUTPUT,

	@SiteId int   ,

	@Username nvarchar (510)  ,

	@Password nvarchar (255)  ,

	@Title nvarchar (100)  ,

	@FirstName nvarchar (510)  ,

	@Surname nvarchar (510)  ,

	@EmailAddress varchar (255)  ,

	@Company varchar (255)  ,

	@Position varchar (255)  ,

	@HomePhone char (40)  ,

	@WorkPhone char (40)  ,

	@MobilePhone char (40)  ,

	@Fax char (40)  ,

	@Address1 nvarchar (500)  ,

	@Address2 nvarchar (500)  ,

	@LocationId varchar (255)  ,

	@AreaId varchar (255)  ,

	@CountryId int   ,

	@PreferredCategoryId varchar (255)  ,

	@PreferredSubCategoryId varchar (255)  ,

	@PreferredSalaryId int   ,

	@Subscribed bit   ,

	@MonthlyUpdate bit   ,

	@ReferringMemberId int   ,

	@LastModifiedDate datetime   ,

	@Valid bit   ,

	@EmailFormat int   ,

	@LastLogon datetime   ,

	@DateOfBirth smalldatetime   ,

	@Gender char (1)  ,

	@Tags nvarchar (1000)  ,

	@Validated bit   ,

	@ValidateGuid uniqueidentifier   ,

	@MemberUrlExtension varchar (255)  ,

	@WebsiteUrl varchar (500)  ,

	@AvailabilityId int   ,

	@AvailabilityFromDate smalldatetime   ,

	@MySpaceHeading ntext   ,

	@MySpaceContent ntext   ,

	@UrlReferrer varchar (500)  ,

	@RequiredPasswordChange bit   ,

	@PreferredJobTitle nvarchar (512)  ,

	@PreferredAvailability varchar (500)  ,

	@PreferredAvailabilityType int   ,

	@PreferredSalaryFrom varchar (100)  ,

	@PreferredSalaryTo varchar (100)  ,

	@CurrentSalaryFrom varchar (100)  ,

	@CurrentSalaryTo varchar (100)  ,

	@LookingFor nvarchar (500)  ,

	@Experience nvarchar (MAX)  ,

	@Skills nvarchar (MAX)  ,

	@Reasons nvarchar (MAX)  ,

	@Comments nvarchar (MAX)  ,

	@ProfileType varchar (255)  ,

	@EducationId int   ,

	@SearchField nvarchar (MAX)  ,

	@RegisteredDate smalldatetime   ,

	@States nvarchar (510)  ,

	@Suburb nvarchar (510)  ,

	@PostCode nvarchar (510)  ,

	@ProfilePicture varchar (255)  ,

	@ShortBio nvarchar (MAX)  ,

	@WorkTypeId varchar (255)  ,

	@Memberships nvarchar (512)  ,

	@MemberStatusId int   ,

	@LinkedInAccessToken varchar (255)  ,

	@ExternalMemberId varchar (50)  ,

	@PassportNo varchar (255)  ,

	@MailingAddress1 nvarchar (1000)  ,

	@MailingAddress2 nvarchar (1000)  ,

	@MailingStates nvarchar (1020)  ,

	@MailingSuburb nvarchar (1020)  ,

	@MailingPostCode nvarchar (1020)  ,

	@MailingCountryId int   ,

	@CountryName nvarchar (510)  ,

	@MailingCountryName nvarchar (510)  ,

	@LoginAttempts int   ,

	@LastAttemptDate datetime   ,

	@Status int   ,

	@LastTermsAndConditionsDate datetime   ,

	@DefaultLanguageId int   ,

	@ReferringSiteId int   ,

	@MultiLingualFirstName nvarchar (510)  ,

	@MultiLingualSurame nvarchar (510)  ,

	@SecondaryEmail varchar (255)  ,

	@CandidateData nvarchar (MAX)  ,

	@EligibleToWorkIn varchar (100)  ,

	@ReferenceUponRequest bit   ,

	@PreferredLine int   ,

	@VideoUrl varchar (500)  ,

	@ProfileDataXml nvarchar (MAX)  ,

	@LastProfileSubmittedDate datetime   
)
AS


				
				INSERT INTO [dbo].[Members]
					(
					[SiteID]
					,[Username]
					,[Password]
					,[Title]
					,[FirstName]
					,[Surname]
					,[EmailAddress]
					,[Company]
					,[Position]
					,[HomePhone]
					,[WorkPhone]
					,[MobilePhone]
					,[Fax]
					,[Address1]
					,[Address2]
					,[LocationID]
					,[AreaID]
					,[CountryID]
					,[PreferredCategoryID]
					,[PreferredSubCategoryID]
					,[PreferredSalaryID]
					,[Subscribed]
					,[MonthlyUpdate]
					,[ReferringMemberID]
					,[LastModifiedDate]
					,[Valid]
					,[EmailFormat]
					,[LastLogon]
					,[DateOfBirth]
					,[Gender]
					,[Tags]
					,[Validated]
					,[ValidateGUID]
					,[MemberURLExtension]
					,[WebsiteURL]
					,[AvailabilityID]
					,[AvailabilityFromDate]
					,[MySpaceHeading]
					,[MySpaceContent]
					,[URLReferrer]
					,[RequiredPasswordChange]
					,[PreferredJobTitle]
					,[PreferredAvailability]
					,[PreferredAvailabilityType]
					,[PreferredSalaryFrom]
					,[PreferredSalaryTo]
					,[CurrentSalaryFrom]
					,[CurrentSalaryTo]
					,[LookingFor]
					,[Experience]
					,[Skills]
					,[Reasons]
					,[Comments]
					,[ProfileType]
					,[EducationID]
					,[SearchField]
					,[RegisteredDate]
					,[States]
					,[Suburb]
					,[PostCode]
					,[ProfilePicture]
					,[ShortBio]
					,[WorkTypeID]
					,[Memberships]
					,[MemberStatusID]
					,[LinkedInAccessToken]
					,[ExternalMemberID]
					,[PassportNo]
					,[MailingAddress1]
					,[MailingAddress2]
					,[MailingStates]
					,[MailingSuburb]
					,[MailingPostCode]
					,[MailingCountryID]
					,[CountryName]
					,[MailingCountryName]
					,[LoginAttempts]
					,[LastAttemptDate]
					,[Status]
					,[LastTermsAndConditionsDate]
					,[DefaultLanguageId]
					,[ReferringSiteID]
					,[MultiLingualFirstName]
					,[MultiLingualSurame]
					,[SecondaryEmail]
					,[CandidateData]
					,[EligibleToWorkIn]
					,[ReferenceUponRequest]
					,[PreferredLine]
					,[VideoURL]
					,[ProfileDataXML]
					,[LastProfileSubmittedDate]
					)
				VALUES
					(
					@SiteId
					,@Username
					,@Password
					,@Title
					,@FirstName
					,@Surname
					,@EmailAddress
					,@Company
					,@Position
					,@HomePhone
					,@WorkPhone
					,@MobilePhone
					,@Fax
					,@Address1
					,@Address2
					,@LocationId
					,@AreaId
					,@CountryId
					,@PreferredCategoryId
					,@PreferredSubCategoryId
					,@PreferredSalaryId
					,@Subscribed
					,@MonthlyUpdate
					,@ReferringMemberId
					,@LastModifiedDate
					,@Valid
					,@EmailFormat
					,@LastLogon
					,@DateOfBirth
					,@Gender
					,@Tags
					,@Validated
					,@ValidateGuid
					,@MemberUrlExtension
					,@WebsiteUrl
					,@AvailabilityId
					,@AvailabilityFromDate
					,@MySpaceHeading
					,@MySpaceContent
					,@UrlReferrer
					,@RequiredPasswordChange
					,@PreferredJobTitle
					,@PreferredAvailability
					,@PreferredAvailabilityType
					,@PreferredSalaryFrom
					,@PreferredSalaryTo
					,@CurrentSalaryFrom
					,@CurrentSalaryTo
					,@LookingFor
					,@Experience
					,@Skills
					,@Reasons
					,@Comments
					,@ProfileType
					,@EducationId
					,@SearchField
					,@RegisteredDate
					,@States
					,@Suburb
					,@PostCode
					,@ProfilePicture
					,@ShortBio
					,@WorkTypeId
					,@Memberships
					,@MemberStatusId
					,@LinkedInAccessToken
					,@ExternalMemberId
					,@PassportNo
					,@MailingAddress1
					,@MailingAddress2
					,@MailingStates
					,@MailingSuburb
					,@MailingPostCode
					,@MailingCountryId
					,@CountryName
					,@MailingCountryName
					,@LoginAttempts
					,@LastAttemptDate
					,@Status
					,@LastTermsAndConditionsDate
					,@DefaultLanguageId
					,@ReferringSiteId
					,@MultiLingualFirstName
					,@MultiLingualSurame
					,@SecondaryEmail
					,@CandidateData
					,@EligibleToWorkIn
					,@ReferenceUponRequest
					,@PreferredLine
					,@VideoUrl
					,@ProfileDataXml
					,@LastProfileSubmittedDate
					)
				
				-- Get the identity value
				SET @MemberId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Members_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Members_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Members_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the Members table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Members_Update
(

	@MemberId int   ,

	@SiteId int   ,

	@Username nvarchar (510)  ,

	@Password nvarchar (255)  ,

	@Title nvarchar (100)  ,

	@FirstName nvarchar (510)  ,

	@Surname nvarchar (510)  ,

	@EmailAddress varchar (255)  ,

	@Company varchar (255)  ,

	@Position varchar (255)  ,

	@HomePhone char (40)  ,

	@WorkPhone char (40)  ,

	@MobilePhone char (40)  ,

	@Fax char (40)  ,

	@Address1 nvarchar (500)  ,

	@Address2 nvarchar (500)  ,

	@LocationId varchar (255)  ,

	@AreaId varchar (255)  ,

	@CountryId int   ,

	@PreferredCategoryId varchar (255)  ,

	@PreferredSubCategoryId varchar (255)  ,

	@PreferredSalaryId int   ,

	@Subscribed bit   ,

	@MonthlyUpdate bit   ,

	@ReferringMemberId int   ,

	@LastModifiedDate datetime   ,

	@Valid bit   ,

	@EmailFormat int   ,

	@LastLogon datetime   ,

	@DateOfBirth smalldatetime   ,

	@Gender char (1)  ,

	@Tags nvarchar (1000)  ,

	@Validated bit   ,

	@ValidateGuid uniqueidentifier   ,

	@MemberUrlExtension varchar (255)  ,

	@WebsiteUrl varchar (500)  ,

	@AvailabilityId int   ,

	@AvailabilityFromDate smalldatetime   ,

	@MySpaceHeading ntext   ,

	@MySpaceContent ntext   ,

	@UrlReferrer varchar (500)  ,

	@RequiredPasswordChange bit   ,

	@PreferredJobTitle nvarchar (512)  ,

	@PreferredAvailability varchar (500)  ,

	@PreferredAvailabilityType int   ,

	@PreferredSalaryFrom varchar (100)  ,

	@PreferredSalaryTo varchar (100)  ,

	@CurrentSalaryFrom varchar (100)  ,

	@CurrentSalaryTo varchar (100)  ,

	@LookingFor nvarchar (500)  ,

	@Experience nvarchar (MAX)  ,

	@Skills nvarchar (MAX)  ,

	@Reasons nvarchar (MAX)  ,

	@Comments nvarchar (MAX)  ,

	@ProfileType varchar (255)  ,

	@EducationId int   ,

	@SearchField nvarchar (MAX)  ,

	@RegisteredDate smalldatetime   ,

	@States nvarchar (510)  ,

	@Suburb nvarchar (510)  ,

	@PostCode nvarchar (510)  ,

	@ProfilePicture varchar (255)  ,

	@ShortBio nvarchar (MAX)  ,

	@WorkTypeId varchar (255)  ,

	@Memberships nvarchar (512)  ,

	@MemberStatusId int   ,

	@LinkedInAccessToken varchar (255)  ,

	@ExternalMemberId varchar (50)  ,

	@PassportNo varchar (255)  ,

	@MailingAddress1 nvarchar (1000)  ,

	@MailingAddress2 nvarchar (1000)  ,

	@MailingStates nvarchar (1020)  ,

	@MailingSuburb nvarchar (1020)  ,

	@MailingPostCode nvarchar (1020)  ,

	@MailingCountryId int   ,

	@CountryName nvarchar (510)  ,

	@MailingCountryName nvarchar (510)  ,

	@LoginAttempts int   ,

	@LastAttemptDate datetime   ,

	@Status int   ,

	@LastTermsAndConditionsDate datetime   ,

	@DefaultLanguageId int   ,

	@ReferringSiteId int   ,

	@MultiLingualFirstName nvarchar (510)  ,

	@MultiLingualSurame nvarchar (510)  ,

	@SecondaryEmail varchar (255)  ,

	@CandidateData nvarchar (MAX)  ,

	@EligibleToWorkIn varchar (100)  ,

	@ReferenceUponRequest bit   ,

	@PreferredLine int   ,

	@VideoUrl varchar (500)  ,

	@ProfileDataXml nvarchar (MAX)  ,

	@LastProfileSubmittedDate datetime   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[Members]
				SET
					[SiteID] = @SiteId
					,[Username] = @Username
					,[Password] = @Password
					,[Title] = @Title
					,[FirstName] = @FirstName
					,[Surname] = @Surname
					,[EmailAddress] = @EmailAddress
					,[Company] = @Company
					,[Position] = @Position
					,[HomePhone] = @HomePhone
					,[WorkPhone] = @WorkPhone
					,[MobilePhone] = @MobilePhone
					,[Fax] = @Fax
					,[Address1] = @Address1
					,[Address2] = @Address2
					,[LocationID] = @LocationId
					,[AreaID] = @AreaId
					,[CountryID] = @CountryId
					,[PreferredCategoryID] = @PreferredCategoryId
					,[PreferredSubCategoryID] = @PreferredSubCategoryId
					,[PreferredSalaryID] = @PreferredSalaryId
					,[Subscribed] = @Subscribed
					,[MonthlyUpdate] = @MonthlyUpdate
					,[ReferringMemberID] = @ReferringMemberId
					,[LastModifiedDate] = @LastModifiedDate
					,[Valid] = @Valid
					,[EmailFormat] = @EmailFormat
					,[LastLogon] = @LastLogon
					,[DateOfBirth] = @DateOfBirth
					,[Gender] = @Gender
					,[Tags] = @Tags
					,[Validated] = @Validated
					,[ValidateGUID] = @ValidateGuid
					,[MemberURLExtension] = @MemberUrlExtension
					,[WebsiteURL] = @WebsiteUrl
					,[AvailabilityID] = @AvailabilityId
					,[AvailabilityFromDate] = @AvailabilityFromDate
					,[MySpaceHeading] = @MySpaceHeading
					,[MySpaceContent] = @MySpaceContent
					,[URLReferrer] = @UrlReferrer
					,[RequiredPasswordChange] = @RequiredPasswordChange
					,[PreferredJobTitle] = @PreferredJobTitle
					,[PreferredAvailability] = @PreferredAvailability
					,[PreferredAvailabilityType] = @PreferredAvailabilityType
					,[PreferredSalaryFrom] = @PreferredSalaryFrom
					,[PreferredSalaryTo] = @PreferredSalaryTo
					,[CurrentSalaryFrom] = @CurrentSalaryFrom
					,[CurrentSalaryTo] = @CurrentSalaryTo
					,[LookingFor] = @LookingFor
					,[Experience] = @Experience
					,[Skills] = @Skills
					,[Reasons] = @Reasons
					,[Comments] = @Comments
					,[ProfileType] = @ProfileType
					,[EducationID] = @EducationId
					,[SearchField] = @SearchField
					,[RegisteredDate] = @RegisteredDate
					,[States] = @States
					,[Suburb] = @Suburb
					,[PostCode] = @PostCode
					,[ProfilePicture] = @ProfilePicture
					,[ShortBio] = @ShortBio
					,[WorkTypeID] = @WorkTypeId
					,[Memberships] = @Memberships
					,[MemberStatusID] = @MemberStatusId
					,[LinkedInAccessToken] = @LinkedInAccessToken
					,[ExternalMemberID] = @ExternalMemberId
					,[PassportNo] = @PassportNo
					,[MailingAddress1] = @MailingAddress1
					,[MailingAddress2] = @MailingAddress2
					,[MailingStates] = @MailingStates
					,[MailingSuburb] = @MailingSuburb
					,[MailingPostCode] = @MailingPostCode
					,[MailingCountryID] = @MailingCountryId
					,[CountryName] = @CountryName
					,[MailingCountryName] = @MailingCountryName
					,[LoginAttempts] = @LoginAttempts
					,[LastAttemptDate] = @LastAttemptDate
					,[Status] = @Status
					,[LastTermsAndConditionsDate] = @LastTermsAndConditionsDate
					,[DefaultLanguageId] = @DefaultLanguageId
					,[ReferringSiteID] = @ReferringSiteId
					,[MultiLingualFirstName] = @MultiLingualFirstName
					,[MultiLingualSurame] = @MultiLingualSurame
					,[SecondaryEmail] = @SecondaryEmail
					,[CandidateData] = @CandidateData
					,[EligibleToWorkIn] = @EligibleToWorkIn
					,[ReferenceUponRequest] = @ReferenceUponRequest
					,[PreferredLine] = @PreferredLine
					,[VideoURL] = @VideoUrl
					,[ProfileDataXML] = @ProfileDataXml
					,[LastProfileSubmittedDate] = @LastProfileSubmittedDate
				WHERE
[MemberID] = @MemberId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Members_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Members_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Members_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the Members table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Members_Delete
(

	@MemberId int   
)
AS


				DELETE FROM [dbo].[Members] WITH (ROWLOCK) 
				WHERE
					[MemberID] = @MemberId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Members_GetByCountryId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Members_GetByCountryId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Members_GetByCountryId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Members table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Members_GetByCountryId
(

	@CountryId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[MemberID],
					[SiteID],
					[Username],
					[Password],
					[Title],
					[FirstName],
					[Surname],
					[EmailAddress],
					[Company],
					[Position],
					[HomePhone],
					[WorkPhone],
					[MobilePhone],
					[Fax],
					[Address1],
					[Address2],
					[LocationID],
					[AreaID],
					[CountryID],
					[PreferredCategoryID],
					[PreferredSubCategoryID],
					[PreferredSalaryID],
					[Subscribed],
					[MonthlyUpdate],
					[ReferringMemberID],
					[LastModifiedDate],
					[Valid],
					[EmailFormat],
					[LastLogon],
					[DateOfBirth],
					[Gender],
					[Tags],
					[Validated],
					[ValidateGUID],
					[MemberURLExtension],
					[WebsiteURL],
					[AvailabilityID],
					[AvailabilityFromDate],
					[MySpaceHeading],
					[MySpaceContent],
					[URLReferrer],
					[RequiredPasswordChange],
					[PreferredJobTitle],
					[PreferredAvailability],
					[PreferredAvailabilityType],
					[PreferredSalaryFrom],
					[PreferredSalaryTo],
					[CurrentSalaryFrom],
					[CurrentSalaryTo],
					[LookingFor],
					[Experience],
					[Skills],
					[Reasons],
					[Comments],
					[ProfileType],
					[EducationID],
					[SearchField],
					[RegisteredDate],
					[States],
					[Suburb],
					[PostCode],
					[ProfilePicture],
					[ShortBio],
					[WorkTypeID],
					[Memberships],
					[MemberStatusID],
					[LinkedInAccessToken],
					[ExternalMemberID],
					[PassportNo],
					[MailingAddress1],
					[MailingAddress2],
					[MailingStates],
					[MailingSuburb],
					[MailingPostCode],
					[MailingCountryID],
					[CountryName],
					[MailingCountryName],
					[LoginAttempts],
					[LastAttemptDate],
					[Status],
					[LastTermsAndConditionsDate],
					[DefaultLanguageId],
					[ReferringSiteID],
					[MultiLingualFirstName],
					[MultiLingualSurame],
					[SecondaryEmail],
					[CandidateData],
					[EligibleToWorkIn],
					[ReferenceUponRequest],
					[PreferredLine],
					[VideoURL],
					[ProfileDataXML],
					[LastProfileSubmittedDate]
				FROM
					[dbo].[Members]
				WHERE
					[CountryID] = @CountryId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Members_GetByEducationId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Members_GetByEducationId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Members_GetByEducationId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Members table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Members_GetByEducationId
(

	@EducationId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[MemberID],
					[SiteID],
					[Username],
					[Password],
					[Title],
					[FirstName],
					[Surname],
					[EmailAddress],
					[Company],
					[Position],
					[HomePhone],
					[WorkPhone],
					[MobilePhone],
					[Fax],
					[Address1],
					[Address2],
					[LocationID],
					[AreaID],
					[CountryID],
					[PreferredCategoryID],
					[PreferredSubCategoryID],
					[PreferredSalaryID],
					[Subscribed],
					[MonthlyUpdate],
					[ReferringMemberID],
					[LastModifiedDate],
					[Valid],
					[EmailFormat],
					[LastLogon],
					[DateOfBirth],
					[Gender],
					[Tags],
					[Validated],
					[ValidateGUID],
					[MemberURLExtension],
					[WebsiteURL],
					[AvailabilityID],
					[AvailabilityFromDate],
					[MySpaceHeading],
					[MySpaceContent],
					[URLReferrer],
					[RequiredPasswordChange],
					[PreferredJobTitle],
					[PreferredAvailability],
					[PreferredAvailabilityType],
					[PreferredSalaryFrom],
					[PreferredSalaryTo],
					[CurrentSalaryFrom],
					[CurrentSalaryTo],
					[LookingFor],
					[Experience],
					[Skills],
					[Reasons],
					[Comments],
					[ProfileType],
					[EducationID],
					[SearchField],
					[RegisteredDate],
					[States],
					[Suburb],
					[PostCode],
					[ProfilePicture],
					[ShortBio],
					[WorkTypeID],
					[Memberships],
					[MemberStatusID],
					[LinkedInAccessToken],
					[ExternalMemberID],
					[PassportNo],
					[MailingAddress1],
					[MailingAddress2],
					[MailingStates],
					[MailingSuburb],
					[MailingPostCode],
					[MailingCountryID],
					[CountryName],
					[MailingCountryName],
					[LoginAttempts],
					[LastAttemptDate],
					[Status],
					[LastTermsAndConditionsDate],
					[DefaultLanguageId],
					[ReferringSiteID],
					[MultiLingualFirstName],
					[MultiLingualSurame],
					[SecondaryEmail],
					[CandidateData],
					[EligibleToWorkIn],
					[ReferenceUponRequest],
					[PreferredLine],
					[VideoURL],
					[ProfileDataXML],
					[LastProfileSubmittedDate]
				FROM
					[dbo].[Members]
				WHERE
					[EducationID] = @EducationId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Members_GetByEmailFormat procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Members_GetByEmailFormat') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Members_GetByEmailFormat
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Members table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Members_GetByEmailFormat
(

	@EmailFormat int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[MemberID],
					[SiteID],
					[Username],
					[Password],
					[Title],
					[FirstName],
					[Surname],
					[EmailAddress],
					[Company],
					[Position],
					[HomePhone],
					[WorkPhone],
					[MobilePhone],
					[Fax],
					[Address1],
					[Address2],
					[LocationID],
					[AreaID],
					[CountryID],
					[PreferredCategoryID],
					[PreferredSubCategoryID],
					[PreferredSalaryID],
					[Subscribed],
					[MonthlyUpdate],
					[ReferringMemberID],
					[LastModifiedDate],
					[Valid],
					[EmailFormat],
					[LastLogon],
					[DateOfBirth],
					[Gender],
					[Tags],
					[Validated],
					[ValidateGUID],
					[MemberURLExtension],
					[WebsiteURL],
					[AvailabilityID],
					[AvailabilityFromDate],
					[MySpaceHeading],
					[MySpaceContent],
					[URLReferrer],
					[RequiredPasswordChange],
					[PreferredJobTitle],
					[PreferredAvailability],
					[PreferredAvailabilityType],
					[PreferredSalaryFrom],
					[PreferredSalaryTo],
					[CurrentSalaryFrom],
					[CurrentSalaryTo],
					[LookingFor],
					[Experience],
					[Skills],
					[Reasons],
					[Comments],
					[ProfileType],
					[EducationID],
					[SearchField],
					[RegisteredDate],
					[States],
					[Suburb],
					[PostCode],
					[ProfilePicture],
					[ShortBio],
					[WorkTypeID],
					[Memberships],
					[MemberStatusID],
					[LinkedInAccessToken],
					[ExternalMemberID],
					[PassportNo],
					[MailingAddress1],
					[MailingAddress2],
					[MailingStates],
					[MailingSuburb],
					[MailingPostCode],
					[MailingCountryID],
					[CountryName],
					[MailingCountryName],
					[LoginAttempts],
					[LastAttemptDate],
					[Status],
					[LastTermsAndConditionsDate],
					[DefaultLanguageId],
					[ReferringSiteID],
					[MultiLingualFirstName],
					[MultiLingualSurame],
					[SecondaryEmail],
					[CandidateData],
					[EligibleToWorkIn],
					[ReferenceUponRequest],
					[PreferredLine],
					[VideoURL],
					[ProfileDataXML],
					[LastProfileSubmittedDate]
				FROM
					[dbo].[Members]
				WHERE
					[EmailFormat] = @EmailFormat
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Members_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Members_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Members_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Members table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Members_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[MemberID],
					[SiteID],
					[Username],
					[Password],
					[Title],
					[FirstName],
					[Surname],
					[EmailAddress],
					[Company],
					[Position],
					[HomePhone],
					[WorkPhone],
					[MobilePhone],
					[Fax],
					[Address1],
					[Address2],
					[LocationID],
					[AreaID],
					[CountryID],
					[PreferredCategoryID],
					[PreferredSubCategoryID],
					[PreferredSalaryID],
					[Subscribed],
					[MonthlyUpdate],
					[ReferringMemberID],
					[LastModifiedDate],
					[Valid],
					[EmailFormat],
					[LastLogon],
					[DateOfBirth],
					[Gender],
					[Tags],
					[Validated],
					[ValidateGUID],
					[MemberURLExtension],
					[WebsiteURL],
					[AvailabilityID],
					[AvailabilityFromDate],
					[MySpaceHeading],
					[MySpaceContent],
					[URLReferrer],
					[RequiredPasswordChange],
					[PreferredJobTitle],
					[PreferredAvailability],
					[PreferredAvailabilityType],
					[PreferredSalaryFrom],
					[PreferredSalaryTo],
					[CurrentSalaryFrom],
					[CurrentSalaryTo],
					[LookingFor],
					[Experience],
					[Skills],
					[Reasons],
					[Comments],
					[ProfileType],
					[EducationID],
					[SearchField],
					[RegisteredDate],
					[States],
					[Suburb],
					[PostCode],
					[ProfilePicture],
					[ShortBio],
					[WorkTypeID],
					[Memberships],
					[MemberStatusID],
					[LinkedInAccessToken],
					[ExternalMemberID],
					[PassportNo],
					[MailingAddress1],
					[MailingAddress2],
					[MailingStates],
					[MailingSuburb],
					[MailingPostCode],
					[MailingCountryID],
					[CountryName],
					[MailingCountryName],
					[LoginAttempts],
					[LastAttemptDate],
					[Status],
					[LastTermsAndConditionsDate],
					[DefaultLanguageId],
					[ReferringSiteID],
					[MultiLingualFirstName],
					[MultiLingualSurame],
					[SecondaryEmail],
					[CandidateData],
					[EligibleToWorkIn],
					[ReferenceUponRequest],
					[PreferredLine],
					[VideoURL],
					[ProfileDataXML],
					[LastProfileSubmittedDate]
				FROM
					[dbo].[Members]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Members_GetBySiteIdEmailAddress procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Members_GetBySiteIdEmailAddress') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Members_GetBySiteIdEmailAddress
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Members table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Members_GetBySiteIdEmailAddress
(

	@SiteId int   ,

	@EmailAddress varchar (255)  
)
AS


				SELECT
					[MemberID],
					[SiteID],
					[Username],
					[Password],
					[Title],
					[FirstName],
					[Surname],
					[EmailAddress],
					[Company],
					[Position],
					[HomePhone],
					[WorkPhone],
					[MobilePhone],
					[Fax],
					[Address1],
					[Address2],
					[LocationID],
					[AreaID],
					[CountryID],
					[PreferredCategoryID],
					[PreferredSubCategoryID],
					[PreferredSalaryID],
					[Subscribed],
					[MonthlyUpdate],
					[ReferringMemberID],
					[LastModifiedDate],
					[Valid],
					[EmailFormat],
					[LastLogon],
					[DateOfBirth],
					[Gender],
					[Tags],
					[Validated],
					[ValidateGUID],
					[MemberURLExtension],
					[WebsiteURL],
					[AvailabilityID],
					[AvailabilityFromDate],
					[MySpaceHeading],
					[MySpaceContent],
					[URLReferrer],
					[RequiredPasswordChange],
					[PreferredJobTitle],
					[PreferredAvailability],
					[PreferredAvailabilityType],
					[PreferredSalaryFrom],
					[PreferredSalaryTo],
					[CurrentSalaryFrom],
					[CurrentSalaryTo],
					[LookingFor],
					[Experience],
					[Skills],
					[Reasons],
					[Comments],
					[ProfileType],
					[EducationID],
					[SearchField],
					[RegisteredDate],
					[States],
					[Suburb],
					[PostCode],
					[ProfilePicture],
					[ShortBio],
					[WorkTypeID],
					[Memberships],
					[MemberStatusID],
					[LinkedInAccessToken],
					[ExternalMemberID],
					[PassportNo],
					[MailingAddress1],
					[MailingAddress2],
					[MailingStates],
					[MailingSuburb],
					[MailingPostCode],
					[MailingCountryID],
					[CountryName],
					[MailingCountryName],
					[LoginAttempts],
					[LastAttemptDate],
					[Status],
					[LastTermsAndConditionsDate],
					[DefaultLanguageId],
					[ReferringSiteID],
					[MultiLingualFirstName],
					[MultiLingualSurame],
					[SecondaryEmail],
					[CandidateData],
					[EligibleToWorkIn],
					[ReferenceUponRequest],
					[PreferredLine],
					[VideoURL],
					[ProfileDataXML],
					[LastProfileSubmittedDate]
				FROM
					[dbo].[Members]
				WHERE
					[SiteID] = @SiteId
					AND [EmailAddress] = @EmailAddress
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Members_GetBySiteIdUsername procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Members_GetBySiteIdUsername') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Members_GetBySiteIdUsername
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Members table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Members_GetBySiteIdUsername
(

	@SiteId int   ,

	@Username nvarchar (510)  
)
AS


				SELECT
					[MemberID],
					[SiteID],
					[Username],
					[Password],
					[Title],
					[FirstName],
					[Surname],
					[EmailAddress],
					[Company],
					[Position],
					[HomePhone],
					[WorkPhone],
					[MobilePhone],
					[Fax],
					[Address1],
					[Address2],
					[LocationID],
					[AreaID],
					[CountryID],
					[PreferredCategoryID],
					[PreferredSubCategoryID],
					[PreferredSalaryID],
					[Subscribed],
					[MonthlyUpdate],
					[ReferringMemberID],
					[LastModifiedDate],
					[Valid],
					[EmailFormat],
					[LastLogon],
					[DateOfBirth],
					[Gender],
					[Tags],
					[Validated],
					[ValidateGUID],
					[MemberURLExtension],
					[WebsiteURL],
					[AvailabilityID],
					[AvailabilityFromDate],
					[MySpaceHeading],
					[MySpaceContent],
					[URLReferrer],
					[RequiredPasswordChange],
					[PreferredJobTitle],
					[PreferredAvailability],
					[PreferredAvailabilityType],
					[PreferredSalaryFrom],
					[PreferredSalaryTo],
					[CurrentSalaryFrom],
					[CurrentSalaryTo],
					[LookingFor],
					[Experience],
					[Skills],
					[Reasons],
					[Comments],
					[ProfileType],
					[EducationID],
					[SearchField],
					[RegisteredDate],
					[States],
					[Suburb],
					[PostCode],
					[ProfilePicture],
					[ShortBio],
					[WorkTypeID],
					[Memberships],
					[MemberStatusID],
					[LinkedInAccessToken],
					[ExternalMemberID],
					[PassportNo],
					[MailingAddress1],
					[MailingAddress2],
					[MailingStates],
					[MailingSuburb],
					[MailingPostCode],
					[MailingCountryID],
					[CountryName],
					[MailingCountryName],
					[LoginAttempts],
					[LastAttemptDate],
					[Status],
					[LastTermsAndConditionsDate],
					[DefaultLanguageId],
					[ReferringSiteID],
					[MultiLingualFirstName],
					[MultiLingualSurame],
					[SecondaryEmail],
					[CandidateData],
					[EligibleToWorkIn],
					[ReferenceUponRequest],
					[PreferredLine],
					[VideoURL],
					[ProfileDataXML],
					[LastProfileSubmittedDate]
				FROM
					[dbo].[Members]
				WHERE
					[SiteID] = @SiteId
					AND [Username] = @Username
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Members_GetByMemberId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Members_GetByMemberId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Members_GetByMemberId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Members table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Members_GetByMemberId
(

	@MemberId int   
)
AS


				SELECT
					[MemberID],
					[SiteID],
					[Username],
					[Password],
					[Title],
					[FirstName],
					[Surname],
					[EmailAddress],
					[Company],
					[Position],
					[HomePhone],
					[WorkPhone],
					[MobilePhone],
					[Fax],
					[Address1],
					[Address2],
					[LocationID],
					[AreaID],
					[CountryID],
					[PreferredCategoryID],
					[PreferredSubCategoryID],
					[PreferredSalaryID],
					[Subscribed],
					[MonthlyUpdate],
					[ReferringMemberID],
					[LastModifiedDate],
					[Valid],
					[EmailFormat],
					[LastLogon],
					[DateOfBirth],
					[Gender],
					[Tags],
					[Validated],
					[ValidateGUID],
					[MemberURLExtension],
					[WebsiteURL],
					[AvailabilityID],
					[AvailabilityFromDate],
					[MySpaceHeading],
					[MySpaceContent],
					[URLReferrer],
					[RequiredPasswordChange],
					[PreferredJobTitle],
					[PreferredAvailability],
					[PreferredAvailabilityType],
					[PreferredSalaryFrom],
					[PreferredSalaryTo],
					[CurrentSalaryFrom],
					[CurrentSalaryTo],
					[LookingFor],
					[Experience],
					[Skills],
					[Reasons],
					[Comments],
					[ProfileType],
					[EducationID],
					[SearchField],
					[RegisteredDate],
					[States],
					[Suburb],
					[PostCode],
					[ProfilePicture],
					[ShortBio],
					[WorkTypeID],
					[Memberships],
					[MemberStatusID],
					[LinkedInAccessToken],
					[ExternalMemberID],
					[PassportNo],
					[MailingAddress1],
					[MailingAddress2],
					[MailingStates],
					[MailingSuburb],
					[MailingPostCode],
					[MailingCountryID],
					[CountryName],
					[MailingCountryName],
					[LoginAttempts],
					[LastAttemptDate],
					[Status],
					[LastTermsAndConditionsDate],
					[DefaultLanguageId],
					[ReferringSiteID],
					[MultiLingualFirstName],
					[MultiLingualSurame],
					[SecondaryEmail],
					[CandidateData],
					[EligibleToWorkIn],
					[ReferenceUponRequest],
					[PreferredLine],
					[VideoURL],
					[ProfileDataXML],
					[LastProfileSubmittedDate]
				FROM
					[dbo].[Members]
				WHERE
					[MemberID] = @MemberId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Members_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Members_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Members_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the Members table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Members_Find
(

	@SearchUsingOR bit   = null ,

	@MemberId int   = null ,

	@SiteId int   = null ,

	@Username nvarchar (510)  = null ,

	@Password nvarchar (255)  = null ,

	@Title nvarchar (100)  = null ,

	@FirstName nvarchar (510)  = null ,

	@Surname nvarchar (510)  = null ,

	@EmailAddress varchar (255)  = null ,

	@Company varchar (255)  = null ,

	@Position varchar (255)  = null ,

	@HomePhone char (40)  = null ,

	@WorkPhone char (40)  = null ,

	@MobilePhone char (40)  = null ,

	@Fax char (40)  = null ,

	@Address1 nvarchar (500)  = null ,

	@Address2 nvarchar (500)  = null ,

	@LocationId varchar (255)  = null ,

	@AreaId varchar (255)  = null ,

	@CountryId int   = null ,

	@PreferredCategoryId varchar (255)  = null ,

	@PreferredSubCategoryId varchar (255)  = null ,

	@PreferredSalaryId int   = null ,

	@Subscribed bit   = null ,

	@MonthlyUpdate bit   = null ,

	@ReferringMemberId int   = null ,

	@LastModifiedDate datetime   = null ,

	@Valid bit   = null ,

	@EmailFormat int   = null ,

	@LastLogon datetime   = null ,

	@DateOfBirth smalldatetime   = null ,

	@Gender char (1)  = null ,

	@Tags nvarchar (1000)  = null ,

	@Validated bit   = null ,

	@ValidateGuid uniqueidentifier   = null ,

	@MemberUrlExtension varchar (255)  = null ,

	@WebsiteUrl varchar (500)  = null ,

	@AvailabilityId int   = null ,

	@AvailabilityFromDate smalldatetime   = null ,

	@MySpaceHeading ntext   = null ,

	@MySpaceContent ntext   = null ,

	@UrlReferrer varchar (500)  = null ,

	@RequiredPasswordChange bit   = null ,

	@PreferredJobTitle nvarchar (512)  = null ,

	@PreferredAvailability varchar (500)  = null ,

	@PreferredAvailabilityType int   = null ,

	@PreferredSalaryFrom varchar (100)  = null ,

	@PreferredSalaryTo varchar (100)  = null ,

	@CurrentSalaryFrom varchar (100)  = null ,

	@CurrentSalaryTo varchar (100)  = null ,

	@LookingFor nvarchar (500)  = null ,

	@Experience nvarchar (MAX)  = null ,

	@Skills nvarchar (MAX)  = null ,

	@Reasons nvarchar (MAX)  = null ,

	@Comments nvarchar (MAX)  = null ,

	@ProfileType varchar (255)  = null ,

	@EducationId int   = null ,

	@SearchField nvarchar (MAX)  = null ,

	@RegisteredDate smalldatetime   = null ,

	@States nvarchar (510)  = null ,

	@Suburb nvarchar (510)  = null ,

	@PostCode nvarchar (510)  = null ,

	@ProfilePicture varchar (255)  = null ,

	@ShortBio nvarchar (MAX)  = null ,

	@WorkTypeId varchar (255)  = null ,

	@Memberships nvarchar (512)  = null ,

	@MemberStatusId int   = null ,

	@LinkedInAccessToken varchar (255)  = null ,

	@ExternalMemberId varchar (50)  = null ,

	@PassportNo varchar (255)  = null ,

	@MailingAddress1 nvarchar (1000)  = null ,

	@MailingAddress2 nvarchar (1000)  = null ,

	@MailingStates nvarchar (1020)  = null ,

	@MailingSuburb nvarchar (1020)  = null ,

	@MailingPostCode nvarchar (1020)  = null ,

	@MailingCountryId int   = null ,

	@CountryName nvarchar (510)  = null ,

	@MailingCountryName nvarchar (510)  = null ,

	@LoginAttempts int   = null ,

	@LastAttemptDate datetime   = null ,

	@Status int   = null ,

	@LastTermsAndConditionsDate datetime   = null ,

	@DefaultLanguageId int   = null ,

	@ReferringSiteId int   = null ,

	@MultiLingualFirstName nvarchar (510)  = null ,

	@MultiLingualSurame nvarchar (510)  = null ,

	@SecondaryEmail varchar (255)  = null ,

	@CandidateData nvarchar (MAX)  = null ,

	@EligibleToWorkIn varchar (100)  = null ,

	@ReferenceUponRequest bit   = null ,

	@PreferredLine int   = null ,

	@VideoUrl varchar (500)  = null ,

	@ProfileDataXml nvarchar (MAX)  = null ,

	@LastProfileSubmittedDate datetime   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [MemberID]
	, [SiteID]
	, [Username]
	, [Password]
	, [Title]
	, [FirstName]
	, [Surname]
	, [EmailAddress]
	, [Company]
	, [Position]
	, [HomePhone]
	, [WorkPhone]
	, [MobilePhone]
	, [Fax]
	, [Address1]
	, [Address2]
	, [LocationID]
	, [AreaID]
	, [CountryID]
	, [PreferredCategoryID]
	, [PreferredSubCategoryID]
	, [PreferredSalaryID]
	, [Subscribed]
	, [MonthlyUpdate]
	, [ReferringMemberID]
	, [LastModifiedDate]
	, [Valid]
	, [EmailFormat]
	, [LastLogon]
	, [DateOfBirth]
	, [Gender]
	, [Tags]
	, [Validated]
	, [ValidateGUID]
	, [MemberURLExtension]
	, [WebsiteURL]
	, [AvailabilityID]
	, [AvailabilityFromDate]
	, [MySpaceHeading]
	, [MySpaceContent]
	, [URLReferrer]
	, [RequiredPasswordChange]
	, [PreferredJobTitle]
	, [PreferredAvailability]
	, [PreferredAvailabilityType]
	, [PreferredSalaryFrom]
	, [PreferredSalaryTo]
	, [CurrentSalaryFrom]
	, [CurrentSalaryTo]
	, [LookingFor]
	, [Experience]
	, [Skills]
	, [Reasons]
	, [Comments]
	, [ProfileType]
	, [EducationID]
	, [SearchField]
	, [RegisteredDate]
	, [States]
	, [Suburb]
	, [PostCode]
	, [ProfilePicture]
	, [ShortBio]
	, [WorkTypeID]
	, [Memberships]
	, [MemberStatusID]
	, [LinkedInAccessToken]
	, [ExternalMemberID]
	, [PassportNo]
	, [MailingAddress1]
	, [MailingAddress2]
	, [MailingStates]
	, [MailingSuburb]
	, [MailingPostCode]
	, [MailingCountryID]
	, [CountryName]
	, [MailingCountryName]
	, [LoginAttempts]
	, [LastAttemptDate]
	, [Status]
	, [LastTermsAndConditionsDate]
	, [DefaultLanguageId]
	, [ReferringSiteID]
	, [MultiLingualFirstName]
	, [MultiLingualSurame]
	, [SecondaryEmail]
	, [CandidateData]
	, [EligibleToWorkIn]
	, [ReferenceUponRequest]
	, [PreferredLine]
	, [VideoURL]
	, [ProfileDataXML]
	, [LastProfileSubmittedDate]
    FROM
	[dbo].[Members]
    WHERE 
	 ([MemberID] = @MemberId OR @MemberId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([Username] = @Username OR @Username IS NULL)
	AND ([Password] = @Password OR @Password IS NULL)
	AND ([Title] = @Title OR @Title IS NULL)
	AND ([FirstName] = @FirstName OR @FirstName IS NULL)
	AND ([Surname] = @Surname OR @Surname IS NULL)
	AND ([EmailAddress] = @EmailAddress OR @EmailAddress IS NULL)
	AND ([Company] = @Company OR @Company IS NULL)
	AND ([Position] = @Position OR @Position IS NULL)
	AND ([HomePhone] = @HomePhone OR @HomePhone IS NULL)
	AND ([WorkPhone] = @WorkPhone OR @WorkPhone IS NULL)
	AND ([MobilePhone] = @MobilePhone OR @MobilePhone IS NULL)
	AND ([Fax] = @Fax OR @Fax IS NULL)
	AND ([Address1] = @Address1 OR @Address1 IS NULL)
	AND ([Address2] = @Address2 OR @Address2 IS NULL)
	AND ([LocationID] = @LocationId OR @LocationId IS NULL)
	AND ([AreaID] = @AreaId OR @AreaId IS NULL)
	AND ([CountryID] = @CountryId OR @CountryId IS NULL)
	AND ([PreferredCategoryID] = @PreferredCategoryId OR @PreferredCategoryId IS NULL)
	AND ([PreferredSubCategoryID] = @PreferredSubCategoryId OR @PreferredSubCategoryId IS NULL)
	AND ([PreferredSalaryID] = @PreferredSalaryId OR @PreferredSalaryId IS NULL)
	AND ([Subscribed] = @Subscribed OR @Subscribed IS NULL)
	AND ([MonthlyUpdate] = @MonthlyUpdate OR @MonthlyUpdate IS NULL)
	AND ([ReferringMemberID] = @ReferringMemberId OR @ReferringMemberId IS NULL)
	AND ([LastModifiedDate] = @LastModifiedDate OR @LastModifiedDate IS NULL)
	AND ([Valid] = @Valid OR @Valid IS NULL)
	AND ([EmailFormat] = @EmailFormat OR @EmailFormat IS NULL)
	AND ([LastLogon] = @LastLogon OR @LastLogon IS NULL)
	AND ([DateOfBirth] = @DateOfBirth OR @DateOfBirth IS NULL)
	AND ([Gender] = @Gender OR @Gender IS NULL)
	AND ([Tags] = @Tags OR @Tags IS NULL)
	AND ([Validated] = @Validated OR @Validated IS NULL)
	AND ([ValidateGUID] = @ValidateGuid OR @ValidateGuid IS NULL)
	AND ([MemberURLExtension] = @MemberUrlExtension OR @MemberUrlExtension IS NULL)
	AND ([WebsiteURL] = @WebsiteUrl OR @WebsiteUrl IS NULL)
	AND ([AvailabilityID] = @AvailabilityId OR @AvailabilityId IS NULL)
	AND ([AvailabilityFromDate] = @AvailabilityFromDate OR @AvailabilityFromDate IS NULL)
	AND ([URLReferrer] = @UrlReferrer OR @UrlReferrer IS NULL)
	AND ([RequiredPasswordChange] = @RequiredPasswordChange OR @RequiredPasswordChange IS NULL)
	AND ([PreferredJobTitle] = @PreferredJobTitle OR @PreferredJobTitle IS NULL)
	AND ([PreferredAvailability] = @PreferredAvailability OR @PreferredAvailability IS NULL)
	AND ([PreferredAvailabilityType] = @PreferredAvailabilityType OR @PreferredAvailabilityType IS NULL)
	AND ([PreferredSalaryFrom] = @PreferredSalaryFrom OR @PreferredSalaryFrom IS NULL)
	AND ([PreferredSalaryTo] = @PreferredSalaryTo OR @PreferredSalaryTo IS NULL)
	AND ([CurrentSalaryFrom] = @CurrentSalaryFrom OR @CurrentSalaryFrom IS NULL)
	AND ([CurrentSalaryTo] = @CurrentSalaryTo OR @CurrentSalaryTo IS NULL)
	AND ([LookingFor] = @LookingFor OR @LookingFor IS NULL)
	AND ([Experience] = @Experience OR @Experience IS NULL)
	AND ([Skills] = @Skills OR @Skills IS NULL)
	AND ([Reasons] = @Reasons OR @Reasons IS NULL)
	AND ([Comments] = @Comments OR @Comments IS NULL)
	AND ([ProfileType] = @ProfileType OR @ProfileType IS NULL)
	AND ([EducationID] = @EducationId OR @EducationId IS NULL)
	AND ([SearchField] = @SearchField OR @SearchField IS NULL)
	AND ([RegisteredDate] = @RegisteredDate OR @RegisteredDate IS NULL)
	AND ([States] = @States OR @States IS NULL)
	AND ([Suburb] = @Suburb OR @Suburb IS NULL)
	AND ([PostCode] = @PostCode OR @PostCode IS NULL)
	AND ([ProfilePicture] = @ProfilePicture OR @ProfilePicture IS NULL)
	AND ([ShortBio] = @ShortBio OR @ShortBio IS NULL)
	AND ([WorkTypeID] = @WorkTypeId OR @WorkTypeId IS NULL)
	AND ([Memberships] = @Memberships OR @Memberships IS NULL)
	AND ([MemberStatusID] = @MemberStatusId OR @MemberStatusId IS NULL)
	AND ([LinkedInAccessToken] = @LinkedInAccessToken OR @LinkedInAccessToken IS NULL)
	AND ([ExternalMemberID] = @ExternalMemberId OR @ExternalMemberId IS NULL)
	AND ([PassportNo] = @PassportNo OR @PassportNo IS NULL)
	AND ([MailingAddress1] = @MailingAddress1 OR @MailingAddress1 IS NULL)
	AND ([MailingAddress2] = @MailingAddress2 OR @MailingAddress2 IS NULL)
	AND ([MailingStates] = @MailingStates OR @MailingStates IS NULL)
	AND ([MailingSuburb] = @MailingSuburb OR @MailingSuburb IS NULL)
	AND ([MailingPostCode] = @MailingPostCode OR @MailingPostCode IS NULL)
	AND ([MailingCountryID] = @MailingCountryId OR @MailingCountryId IS NULL)
	AND ([CountryName] = @CountryName OR @CountryName IS NULL)
	AND ([MailingCountryName] = @MailingCountryName OR @MailingCountryName IS NULL)
	AND ([LoginAttempts] = @LoginAttempts OR @LoginAttempts IS NULL)
	AND ([LastAttemptDate] = @LastAttemptDate OR @LastAttemptDate IS NULL)
	AND ([Status] = @Status OR @Status IS NULL)
	AND ([LastTermsAndConditionsDate] = @LastTermsAndConditionsDate OR @LastTermsAndConditionsDate IS NULL)
	AND ([DefaultLanguageId] = @DefaultLanguageId OR @DefaultLanguageId IS NULL)
	AND ([ReferringSiteID] = @ReferringSiteId OR @ReferringSiteId IS NULL)
	AND ([MultiLingualFirstName] = @MultiLingualFirstName OR @MultiLingualFirstName IS NULL)
	AND ([MultiLingualSurame] = @MultiLingualSurame OR @MultiLingualSurame IS NULL)
	AND ([SecondaryEmail] = @SecondaryEmail OR @SecondaryEmail IS NULL)
	AND ([CandidateData] = @CandidateData OR @CandidateData IS NULL)
	AND ([EligibleToWorkIn] = @EligibleToWorkIn OR @EligibleToWorkIn IS NULL)
	AND ([ReferenceUponRequest] = @ReferenceUponRequest OR @ReferenceUponRequest IS NULL)
	AND ([PreferredLine] = @PreferredLine OR @PreferredLine IS NULL)
	AND ([VideoURL] = @VideoUrl OR @VideoUrl IS NULL)
	AND ([ProfileDataXML] = @ProfileDataXml OR @ProfileDataXml IS NULL)
	AND ([LastProfileSubmittedDate] = @LastProfileSubmittedDate OR @LastProfileSubmittedDate IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [MemberID]
	, [SiteID]
	, [Username]
	, [Password]
	, [Title]
	, [FirstName]
	, [Surname]
	, [EmailAddress]
	, [Company]
	, [Position]
	, [HomePhone]
	, [WorkPhone]
	, [MobilePhone]
	, [Fax]
	, [Address1]
	, [Address2]
	, [LocationID]
	, [AreaID]
	, [CountryID]
	, [PreferredCategoryID]
	, [PreferredSubCategoryID]
	, [PreferredSalaryID]
	, [Subscribed]
	, [MonthlyUpdate]
	, [ReferringMemberID]
	, [LastModifiedDate]
	, [Valid]
	, [EmailFormat]
	, [LastLogon]
	, [DateOfBirth]
	, [Gender]
	, [Tags]
	, [Validated]
	, [ValidateGUID]
	, [MemberURLExtension]
	, [WebsiteURL]
	, [AvailabilityID]
	, [AvailabilityFromDate]
	, [MySpaceHeading]
	, [MySpaceContent]
	, [URLReferrer]
	, [RequiredPasswordChange]
	, [PreferredJobTitle]
	, [PreferredAvailability]
	, [PreferredAvailabilityType]
	, [PreferredSalaryFrom]
	, [PreferredSalaryTo]
	, [CurrentSalaryFrom]
	, [CurrentSalaryTo]
	, [LookingFor]
	, [Experience]
	, [Skills]
	, [Reasons]
	, [Comments]
	, [ProfileType]
	, [EducationID]
	, [SearchField]
	, [RegisteredDate]
	, [States]
	, [Suburb]
	, [PostCode]
	, [ProfilePicture]
	, [ShortBio]
	, [WorkTypeID]
	, [Memberships]
	, [MemberStatusID]
	, [LinkedInAccessToken]
	, [ExternalMemberID]
	, [PassportNo]
	, [MailingAddress1]
	, [MailingAddress2]
	, [MailingStates]
	, [MailingSuburb]
	, [MailingPostCode]
	, [MailingCountryID]
	, [CountryName]
	, [MailingCountryName]
	, [LoginAttempts]
	, [LastAttemptDate]
	, [Status]
	, [LastTermsAndConditionsDate]
	, [DefaultLanguageId]
	, [ReferringSiteID]
	, [MultiLingualFirstName]
	, [MultiLingualSurame]
	, [SecondaryEmail]
	, [CandidateData]
	, [EligibleToWorkIn]
	, [ReferenceUponRequest]
	, [PreferredLine]
	, [VideoURL]
	, [ProfileDataXML]
	, [LastProfileSubmittedDate]
    FROM
	[dbo].[Members]
    WHERE 
	 ([MemberID] = @MemberId AND @MemberId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([Username] = @Username AND @Username is not null)
	OR ([Password] = @Password AND @Password is not null)
	OR ([Title] = @Title AND @Title is not null)
	OR ([FirstName] = @FirstName AND @FirstName is not null)
	OR ([Surname] = @Surname AND @Surname is not null)
	OR ([EmailAddress] = @EmailAddress AND @EmailAddress is not null)
	OR ([Company] = @Company AND @Company is not null)
	OR ([Position] = @Position AND @Position is not null)
	OR ([HomePhone] = @HomePhone AND @HomePhone is not null)
	OR ([WorkPhone] = @WorkPhone AND @WorkPhone is not null)
	OR ([MobilePhone] = @MobilePhone AND @MobilePhone is not null)
	OR ([Fax] = @Fax AND @Fax is not null)
	OR ([Address1] = @Address1 AND @Address1 is not null)
	OR ([Address2] = @Address2 AND @Address2 is not null)
	OR ([LocationID] = @LocationId AND @LocationId is not null)
	OR ([AreaID] = @AreaId AND @AreaId is not null)
	OR ([CountryID] = @CountryId AND @CountryId is not null)
	OR ([PreferredCategoryID] = @PreferredCategoryId AND @PreferredCategoryId is not null)
	OR ([PreferredSubCategoryID] = @PreferredSubCategoryId AND @PreferredSubCategoryId is not null)
	OR ([PreferredSalaryID] = @PreferredSalaryId AND @PreferredSalaryId is not null)
	OR ([Subscribed] = @Subscribed AND @Subscribed is not null)
	OR ([MonthlyUpdate] = @MonthlyUpdate AND @MonthlyUpdate is not null)
	OR ([ReferringMemberID] = @ReferringMemberId AND @ReferringMemberId is not null)
	OR ([LastModifiedDate] = @LastModifiedDate AND @LastModifiedDate is not null)
	OR ([Valid] = @Valid AND @Valid is not null)
	OR ([EmailFormat] = @EmailFormat AND @EmailFormat is not null)
	OR ([LastLogon] = @LastLogon AND @LastLogon is not null)
	OR ([DateOfBirth] = @DateOfBirth AND @DateOfBirth is not null)
	OR ([Gender] = @Gender AND @Gender is not null)
	OR ([Tags] = @Tags AND @Tags is not null)
	OR ([Validated] = @Validated AND @Validated is not null)
	OR ([ValidateGUID] = @ValidateGuid AND @ValidateGuid is not null)
	OR ([MemberURLExtension] = @MemberUrlExtension AND @MemberUrlExtension is not null)
	OR ([WebsiteURL] = @WebsiteUrl AND @WebsiteUrl is not null)
	OR ([AvailabilityID] = @AvailabilityId AND @AvailabilityId is not null)
	OR ([AvailabilityFromDate] = @AvailabilityFromDate AND @AvailabilityFromDate is not null)
	OR ([URLReferrer] = @UrlReferrer AND @UrlReferrer is not null)
	OR ([RequiredPasswordChange] = @RequiredPasswordChange AND @RequiredPasswordChange is not null)
	OR ([PreferredJobTitle] = @PreferredJobTitle AND @PreferredJobTitle is not null)
	OR ([PreferredAvailability] = @PreferredAvailability AND @PreferredAvailability is not null)
	OR ([PreferredAvailabilityType] = @PreferredAvailabilityType AND @PreferredAvailabilityType is not null)
	OR ([PreferredSalaryFrom] = @PreferredSalaryFrom AND @PreferredSalaryFrom is not null)
	OR ([PreferredSalaryTo] = @PreferredSalaryTo AND @PreferredSalaryTo is not null)
	OR ([CurrentSalaryFrom] = @CurrentSalaryFrom AND @CurrentSalaryFrom is not null)
	OR ([CurrentSalaryTo] = @CurrentSalaryTo AND @CurrentSalaryTo is not null)
	OR ([LookingFor] = @LookingFor AND @LookingFor is not null)
	OR ([Experience] = @Experience AND @Experience is not null)
	OR ([Skills] = @Skills AND @Skills is not null)
	OR ([Reasons] = @Reasons AND @Reasons is not null)
	OR ([Comments] = @Comments AND @Comments is not null)
	OR ([ProfileType] = @ProfileType AND @ProfileType is not null)
	OR ([EducationID] = @EducationId AND @EducationId is not null)
	OR ([SearchField] = @SearchField AND @SearchField is not null)
	OR ([RegisteredDate] = @RegisteredDate AND @RegisteredDate is not null)
	OR ([States] = @States AND @States is not null)
	OR ([Suburb] = @Suburb AND @Suburb is not null)
	OR ([PostCode] = @PostCode AND @PostCode is not null)
	OR ([ProfilePicture] = @ProfilePicture AND @ProfilePicture is not null)
	OR ([ShortBio] = @ShortBio AND @ShortBio is not null)
	OR ([WorkTypeID] = @WorkTypeId AND @WorkTypeId is not null)
	OR ([Memberships] = @Memberships AND @Memberships is not null)
	OR ([MemberStatusID] = @MemberStatusId AND @MemberStatusId is not null)
	OR ([LinkedInAccessToken] = @LinkedInAccessToken AND @LinkedInAccessToken is not null)
	OR ([ExternalMemberID] = @ExternalMemberId AND @ExternalMemberId is not null)
	OR ([PassportNo] = @PassportNo AND @PassportNo is not null)
	OR ([MailingAddress1] = @MailingAddress1 AND @MailingAddress1 is not null)
	OR ([MailingAddress2] = @MailingAddress2 AND @MailingAddress2 is not null)
	OR ([MailingStates] = @MailingStates AND @MailingStates is not null)
	OR ([MailingSuburb] = @MailingSuburb AND @MailingSuburb is not null)
	OR ([MailingPostCode] = @MailingPostCode AND @MailingPostCode is not null)
	OR ([MailingCountryID] = @MailingCountryId AND @MailingCountryId is not null)
	OR ([CountryName] = @CountryName AND @CountryName is not null)
	OR ([MailingCountryName] = @MailingCountryName AND @MailingCountryName is not null)
	OR ([LoginAttempts] = @LoginAttempts AND @LoginAttempts is not null)
	OR ([LastAttemptDate] = @LastAttemptDate AND @LastAttemptDate is not null)
	OR ([Status] = @Status AND @Status is not null)
	OR ([LastTermsAndConditionsDate] = @LastTermsAndConditionsDate AND @LastTermsAndConditionsDate is not null)
	OR ([DefaultLanguageId] = @DefaultLanguageId AND @DefaultLanguageId is not null)
	OR ([ReferringSiteID] = @ReferringSiteId AND @ReferringSiteId is not null)
	OR ([MultiLingualFirstName] = @MultiLingualFirstName AND @MultiLingualFirstName is not null)
	OR ([MultiLingualSurame] = @MultiLingualSurame AND @MultiLingualSurame is not null)
	OR ([SecondaryEmail] = @SecondaryEmail AND @SecondaryEmail is not null)
	OR ([CandidateData] = @CandidateData AND @CandidateData is not null)
	OR ([EligibleToWorkIn] = @EligibleToWorkIn AND @EligibleToWorkIn is not null)
	OR ([ReferenceUponRequest] = @ReferenceUponRequest AND @ReferenceUponRequest is not null)
	OR ([PreferredLine] = @PreferredLine AND @PreferredLine is not null)
	OR ([VideoURL] = @VideoUrl AND @VideoUrl is not null)
	OR ([ProfileDataXML] = @ProfileDataXml AND @ProfileDataXml is not null)
	OR ([LastProfileSubmittedDate] = @LastProfileSubmittedDate AND @LastProfileSubmittedDate is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberWizard_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberWizard_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberWizard_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the MemberWizard table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberWizard_Get_List

AS


				
				SELECT
					[MemberWizardID],
					[SiteID],
					[MemberWizardParentID],
					[ProfileTitle],
					[CVTitle],
					[RolePreferencesTitle],
					[EducationTitle],
					[MembershipsTitle],
					[ExperienceTitle],
					[SkillsTitle],
					[ProfileEnable],
					[CVEnable],
					[RolePreferencesEnable],
					[EducationEnable],
					[MembershipsEnable],
					[ExperienceEnable],
					[SkillsEnable],
					[GlobalTemplate],
					[LastModifiedBy],
					[LastModified],
					[DirectorshipTitle],
					[DirectorshipEnable],
					[Skills],
					[LicenseTypes],
					[SummaryTitle],
					[PersonalDetailsTitle],
					[LicensesTitle],
					[AttachCoverLetterTitle],
					[LanguagesTitle],
					[ReferencesTitle],
					[CustomQuestionTitle],
					[SummaryPoints],
					[PersonalDetailsPoints],
					[LicensesPoints],
					[AttachCoverLetterPoints],
					[LanguagesPoints],
					[ReferencesPoints],
					[CustomQuestionPoints],
					[ProfilePoints],
					[CVPoints],
					[RolePreferencesPoints],
					[EducationPoints],
					[MembershipsPoints],
					[ExperiencePoints],
					[SkillsPoints],
					[DirectorshipPoints],
					[WizardLanguageXML],
					[CustomQuestionsXML],
					[MinExperiencesEntry],
					[MinReferencesEntry],
					[MinEducationsEntry],
					[QualificationNames]
				FROM
					[dbo].[MemberWizard]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberWizard_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberWizard_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberWizard_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the MemberWizard table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberWizard_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [MemberWizardID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([MemberWizardID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [MemberWizardID]'
				SET @SQL = @SQL + ' FROM [dbo].[MemberWizard]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[MemberWizardID], O.[SiteID], O.[MemberWizardParentID], O.[ProfileTitle], O.[CVTitle], O.[RolePreferencesTitle], O.[EducationTitle], O.[MembershipsTitle], O.[ExperienceTitle], O.[SkillsTitle], O.[ProfileEnable], O.[CVEnable], O.[RolePreferencesEnable], O.[EducationEnable], O.[MembershipsEnable], O.[ExperienceEnable], O.[SkillsEnable], O.[GlobalTemplate], O.[LastModifiedBy], O.[LastModified], O.[DirectorshipTitle], O.[DirectorshipEnable], O.[Skills], O.[LicenseTypes], O.[SummaryTitle], O.[PersonalDetailsTitle], O.[LicensesTitle], O.[AttachCoverLetterTitle], O.[LanguagesTitle], O.[ReferencesTitle], O.[CustomQuestionTitle], O.[SummaryPoints], O.[PersonalDetailsPoints], O.[LicensesPoints], O.[AttachCoverLetterPoints], O.[LanguagesPoints], O.[ReferencesPoints], O.[CustomQuestionPoints], O.[ProfilePoints], O.[CVPoints], O.[RolePreferencesPoints], O.[EducationPoints], O.[MembershipsPoints], O.[ExperiencePoints], O.[SkillsPoints], O.[DirectorshipPoints], O.[WizardLanguageXML], O.[CustomQuestionsXML], O.[MinExperiencesEntry], O.[MinReferencesEntry], O.[MinEducationsEntry], O.[QualificationNames]
				FROM
				    [dbo].[MemberWizard] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[MemberWizardID] = PageIndex.[MemberWizardID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[MemberWizard]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberWizard_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberWizard_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberWizard_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the MemberWizard table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberWizard_Insert
(

	@MemberWizardId int    OUTPUT,

	@SiteId int   ,

	@MemberWizardParentId int   ,

	@ProfileTitle nvarchar (512)  ,

	@CvTitle nvarchar (512)  ,

	@RolePreferencesTitle nvarchar (512)  ,

	@EducationTitle nvarchar (512)  ,

	@MembershipsTitle nvarchar (512)  ,

	@ExperienceTitle nvarchar (512)  ,

	@SkillsTitle nvarchar (512)  ,

	@ProfileEnable bit   ,

	@CvEnable bit   ,

	@RolePreferencesEnable bit   ,

	@EducationEnable bit   ,

	@MembershipsEnable bit   ,

	@ExperienceEnable bit   ,

	@SkillsEnable bit   ,

	@GlobalTemplate bit   ,

	@LastModifiedBy int   ,

	@LastModified datetime   ,

	@DirectorshipTitle nvarchar (512)  ,

	@DirectorshipEnable bit   ,

	@Skills nvarchar (MAX)  ,

	@LicenseTypes nvarchar (MAX)  ,

	@SummaryTitle nvarchar (512)  ,

	@PersonalDetailsTitle nvarchar (512)  ,

	@LicensesTitle nvarchar (512)  ,

	@AttachCoverLetterTitle nvarchar (512)  ,

	@LanguagesTitle nvarchar (512)  ,

	@ReferencesTitle nvarchar (512)  ,

	@CustomQuestionTitle nvarchar (512)  ,

	@SummaryPoints int   ,

	@PersonalDetailsPoints int   ,

	@LicensesPoints int   ,

	@AttachCoverLetterPoints int   ,

	@LanguagesPoints int   ,

	@ReferencesPoints int   ,

	@CustomQuestionPoints int   ,

	@ProfilePoints int   ,

	@CvPoints int   ,

	@RolePreferencesPoints int   ,

	@EducationPoints int   ,

	@MembershipsPoints int   ,

	@ExperiencePoints int   ,

	@SkillsPoints int   ,

	@DirectorshipPoints int   ,

	@WizardLanguageXml nvarchar (MAX)  ,

	@CustomQuestionsXml nvarchar (MAX)  ,

	@MinExperiencesEntry smallint   ,

	@MinReferencesEntry smallint   ,

	@MinEducationsEntry smallint   ,

	@QualificationNames nvarchar (MAX)  
)
AS


				
				INSERT INTO [dbo].[MemberWizard]
					(
					[SiteID]
					,[MemberWizardParentID]
					,[ProfileTitle]
					,[CVTitle]
					,[RolePreferencesTitle]
					,[EducationTitle]
					,[MembershipsTitle]
					,[ExperienceTitle]
					,[SkillsTitle]
					,[ProfileEnable]
					,[CVEnable]
					,[RolePreferencesEnable]
					,[EducationEnable]
					,[MembershipsEnable]
					,[ExperienceEnable]
					,[SkillsEnable]
					,[GlobalTemplate]
					,[LastModifiedBy]
					,[LastModified]
					,[DirectorshipTitle]
					,[DirectorshipEnable]
					,[Skills]
					,[LicenseTypes]
					,[SummaryTitle]
					,[PersonalDetailsTitle]
					,[LicensesTitle]
					,[AttachCoverLetterTitle]
					,[LanguagesTitle]
					,[ReferencesTitle]
					,[CustomQuestionTitle]
					,[SummaryPoints]
					,[PersonalDetailsPoints]
					,[LicensesPoints]
					,[AttachCoverLetterPoints]
					,[LanguagesPoints]
					,[ReferencesPoints]
					,[CustomQuestionPoints]
					,[ProfilePoints]
					,[CVPoints]
					,[RolePreferencesPoints]
					,[EducationPoints]
					,[MembershipsPoints]
					,[ExperiencePoints]
					,[SkillsPoints]
					,[DirectorshipPoints]
					,[WizardLanguageXML]
					,[CustomQuestionsXML]
					,[MinExperiencesEntry]
					,[MinReferencesEntry]
					,[MinEducationsEntry]
					,[QualificationNames]
					)
				VALUES
					(
					@SiteId
					,@MemberWizardParentId
					,@ProfileTitle
					,@CvTitle
					,@RolePreferencesTitle
					,@EducationTitle
					,@MembershipsTitle
					,@ExperienceTitle
					,@SkillsTitle
					,@ProfileEnable
					,@CvEnable
					,@RolePreferencesEnable
					,@EducationEnable
					,@MembershipsEnable
					,@ExperienceEnable
					,@SkillsEnable
					,@GlobalTemplate
					,@LastModifiedBy
					,@LastModified
					,@DirectorshipTitle
					,@DirectorshipEnable
					,@Skills
					,@LicenseTypes
					,@SummaryTitle
					,@PersonalDetailsTitle
					,@LicensesTitle
					,@AttachCoverLetterTitle
					,@LanguagesTitle
					,@ReferencesTitle
					,@CustomQuestionTitle
					,@SummaryPoints
					,@PersonalDetailsPoints
					,@LicensesPoints
					,@AttachCoverLetterPoints
					,@LanguagesPoints
					,@ReferencesPoints
					,@CustomQuestionPoints
					,@ProfilePoints
					,@CvPoints
					,@RolePreferencesPoints
					,@EducationPoints
					,@MembershipsPoints
					,@ExperiencePoints
					,@SkillsPoints
					,@DirectorshipPoints
					,@WizardLanguageXml
					,@CustomQuestionsXml
					,@MinExperiencesEntry
					,@MinReferencesEntry
					,@MinEducationsEntry
					,@QualificationNames
					)
				
				-- Get the identity value
				SET @MemberWizardId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberWizard_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberWizard_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberWizard_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the MemberWizard table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberWizard_Update
(

	@MemberWizardId int   ,

	@SiteId int   ,

	@MemberWizardParentId int   ,

	@ProfileTitle nvarchar (512)  ,

	@CvTitle nvarchar (512)  ,

	@RolePreferencesTitle nvarchar (512)  ,

	@EducationTitle nvarchar (512)  ,

	@MembershipsTitle nvarchar (512)  ,

	@ExperienceTitle nvarchar (512)  ,

	@SkillsTitle nvarchar (512)  ,

	@ProfileEnable bit   ,

	@CvEnable bit   ,

	@RolePreferencesEnable bit   ,

	@EducationEnable bit   ,

	@MembershipsEnable bit   ,

	@ExperienceEnable bit   ,

	@SkillsEnable bit   ,

	@GlobalTemplate bit   ,

	@LastModifiedBy int   ,

	@LastModified datetime   ,

	@DirectorshipTitle nvarchar (512)  ,

	@DirectorshipEnable bit   ,

	@Skills nvarchar (MAX)  ,

	@LicenseTypes nvarchar (MAX)  ,

	@SummaryTitle nvarchar (512)  ,

	@PersonalDetailsTitle nvarchar (512)  ,

	@LicensesTitle nvarchar (512)  ,

	@AttachCoverLetterTitle nvarchar (512)  ,

	@LanguagesTitle nvarchar (512)  ,

	@ReferencesTitle nvarchar (512)  ,

	@CustomQuestionTitle nvarchar (512)  ,

	@SummaryPoints int   ,

	@PersonalDetailsPoints int   ,

	@LicensesPoints int   ,

	@AttachCoverLetterPoints int   ,

	@LanguagesPoints int   ,

	@ReferencesPoints int   ,

	@CustomQuestionPoints int   ,

	@ProfilePoints int   ,

	@CvPoints int   ,

	@RolePreferencesPoints int   ,

	@EducationPoints int   ,

	@MembershipsPoints int   ,

	@ExperiencePoints int   ,

	@SkillsPoints int   ,

	@DirectorshipPoints int   ,

	@WizardLanguageXml nvarchar (MAX)  ,

	@CustomQuestionsXml nvarchar (MAX)  ,

	@MinExperiencesEntry smallint   ,

	@MinReferencesEntry smallint   ,

	@MinEducationsEntry smallint   ,

	@QualificationNames nvarchar (MAX)  
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[MemberWizard]
				SET
					[SiteID] = @SiteId
					,[MemberWizardParentID] = @MemberWizardParentId
					,[ProfileTitle] = @ProfileTitle
					,[CVTitle] = @CvTitle
					,[RolePreferencesTitle] = @RolePreferencesTitle
					,[EducationTitle] = @EducationTitle
					,[MembershipsTitle] = @MembershipsTitle
					,[ExperienceTitle] = @ExperienceTitle
					,[SkillsTitle] = @SkillsTitle
					,[ProfileEnable] = @ProfileEnable
					,[CVEnable] = @CvEnable
					,[RolePreferencesEnable] = @RolePreferencesEnable
					,[EducationEnable] = @EducationEnable
					,[MembershipsEnable] = @MembershipsEnable
					,[ExperienceEnable] = @ExperienceEnable
					,[SkillsEnable] = @SkillsEnable
					,[GlobalTemplate] = @GlobalTemplate
					,[LastModifiedBy] = @LastModifiedBy
					,[LastModified] = @LastModified
					,[DirectorshipTitle] = @DirectorshipTitle
					,[DirectorshipEnable] = @DirectorshipEnable
					,[Skills] = @Skills
					,[LicenseTypes] = @LicenseTypes
					,[SummaryTitle] = @SummaryTitle
					,[PersonalDetailsTitle] = @PersonalDetailsTitle
					,[LicensesTitle] = @LicensesTitle
					,[AttachCoverLetterTitle] = @AttachCoverLetterTitle
					,[LanguagesTitle] = @LanguagesTitle
					,[ReferencesTitle] = @ReferencesTitle
					,[CustomQuestionTitle] = @CustomQuestionTitle
					,[SummaryPoints] = @SummaryPoints
					,[PersonalDetailsPoints] = @PersonalDetailsPoints
					,[LicensesPoints] = @LicensesPoints
					,[AttachCoverLetterPoints] = @AttachCoverLetterPoints
					,[LanguagesPoints] = @LanguagesPoints
					,[ReferencesPoints] = @ReferencesPoints
					,[CustomQuestionPoints] = @CustomQuestionPoints
					,[ProfilePoints] = @ProfilePoints
					,[CVPoints] = @CvPoints
					,[RolePreferencesPoints] = @RolePreferencesPoints
					,[EducationPoints] = @EducationPoints
					,[MembershipsPoints] = @MembershipsPoints
					,[ExperiencePoints] = @ExperiencePoints
					,[SkillsPoints] = @SkillsPoints
					,[DirectorshipPoints] = @DirectorshipPoints
					,[WizardLanguageXML] = @WizardLanguageXml
					,[CustomQuestionsXML] = @CustomQuestionsXml
					,[MinExperiencesEntry] = @MinExperiencesEntry
					,[MinReferencesEntry] = @MinReferencesEntry
					,[MinEducationsEntry] = @MinEducationsEntry
					,[QualificationNames] = @QualificationNames
				WHERE
[MemberWizardID] = @MemberWizardId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberWizard_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberWizard_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberWizard_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the MemberWizard table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberWizard_Delete
(

	@MemberWizardId int   
)
AS


				DELETE FROM [dbo].[MemberWizard] WITH (ROWLOCK) 
				WHERE
					[MemberWizardID] = @MemberWizardId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberWizard_GetByLastModifiedBy procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberWizard_GetByLastModifiedBy') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberWizard_GetByLastModifiedBy
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the MemberWizard table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberWizard_GetByLastModifiedBy
(

	@LastModifiedBy int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[MemberWizardID],
					[SiteID],
					[MemberWizardParentID],
					[ProfileTitle],
					[CVTitle],
					[RolePreferencesTitle],
					[EducationTitle],
					[MembershipsTitle],
					[ExperienceTitle],
					[SkillsTitle],
					[ProfileEnable],
					[CVEnable],
					[RolePreferencesEnable],
					[EducationEnable],
					[MembershipsEnable],
					[ExperienceEnable],
					[SkillsEnable],
					[GlobalTemplate],
					[LastModifiedBy],
					[LastModified],
					[DirectorshipTitle],
					[DirectorshipEnable],
					[Skills],
					[LicenseTypes],
					[SummaryTitle],
					[PersonalDetailsTitle],
					[LicensesTitle],
					[AttachCoverLetterTitle],
					[LanguagesTitle],
					[ReferencesTitle],
					[CustomQuestionTitle],
					[SummaryPoints],
					[PersonalDetailsPoints],
					[LicensesPoints],
					[AttachCoverLetterPoints],
					[LanguagesPoints],
					[ReferencesPoints],
					[CustomQuestionPoints],
					[ProfilePoints],
					[CVPoints],
					[RolePreferencesPoints],
					[EducationPoints],
					[MembershipsPoints],
					[ExperiencePoints],
					[SkillsPoints],
					[DirectorshipPoints],
					[WizardLanguageXML],
					[CustomQuestionsXML],
					[MinExperiencesEntry],
					[MinReferencesEntry],
					[MinEducationsEntry],
					[QualificationNames]
				FROM
					[dbo].[MemberWizard]
				WHERE
					[LastModifiedBy] = @LastModifiedBy
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberWizard_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberWizard_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberWizard_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the MemberWizard table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberWizard_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[MemberWizardID],
					[SiteID],
					[MemberWizardParentID],
					[ProfileTitle],
					[CVTitle],
					[RolePreferencesTitle],
					[EducationTitle],
					[MembershipsTitle],
					[ExperienceTitle],
					[SkillsTitle],
					[ProfileEnable],
					[CVEnable],
					[RolePreferencesEnable],
					[EducationEnable],
					[MembershipsEnable],
					[ExperienceEnable],
					[SkillsEnable],
					[GlobalTemplate],
					[LastModifiedBy],
					[LastModified],
					[DirectorshipTitle],
					[DirectorshipEnable],
					[Skills],
					[LicenseTypes],
					[SummaryTitle],
					[PersonalDetailsTitle],
					[LicensesTitle],
					[AttachCoverLetterTitle],
					[LanguagesTitle],
					[ReferencesTitle],
					[CustomQuestionTitle],
					[SummaryPoints],
					[PersonalDetailsPoints],
					[LicensesPoints],
					[AttachCoverLetterPoints],
					[LanguagesPoints],
					[ReferencesPoints],
					[CustomQuestionPoints],
					[ProfilePoints],
					[CVPoints],
					[RolePreferencesPoints],
					[EducationPoints],
					[MembershipsPoints],
					[ExperiencePoints],
					[SkillsPoints],
					[DirectorshipPoints],
					[WizardLanguageXML],
					[CustomQuestionsXML],
					[MinExperiencesEntry],
					[MinReferencesEntry],
					[MinEducationsEntry],
					[QualificationNames]
				FROM
					[dbo].[MemberWizard]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberWizard_GetByMemberWizardId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberWizard_GetByMemberWizardId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberWizard_GetByMemberWizardId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the MemberWizard table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberWizard_GetByMemberWizardId
(

	@MemberWizardId int   
)
AS


				SELECT
					[MemberWizardID],
					[SiteID],
					[MemberWizardParentID],
					[ProfileTitle],
					[CVTitle],
					[RolePreferencesTitle],
					[EducationTitle],
					[MembershipsTitle],
					[ExperienceTitle],
					[SkillsTitle],
					[ProfileEnable],
					[CVEnable],
					[RolePreferencesEnable],
					[EducationEnable],
					[MembershipsEnable],
					[ExperienceEnable],
					[SkillsEnable],
					[GlobalTemplate],
					[LastModifiedBy],
					[LastModified],
					[DirectorshipTitle],
					[DirectorshipEnable],
					[Skills],
					[LicenseTypes],
					[SummaryTitle],
					[PersonalDetailsTitle],
					[LicensesTitle],
					[AttachCoverLetterTitle],
					[LanguagesTitle],
					[ReferencesTitle],
					[CustomQuestionTitle],
					[SummaryPoints],
					[PersonalDetailsPoints],
					[LicensesPoints],
					[AttachCoverLetterPoints],
					[LanguagesPoints],
					[ReferencesPoints],
					[CustomQuestionPoints],
					[ProfilePoints],
					[CVPoints],
					[RolePreferencesPoints],
					[EducationPoints],
					[MembershipsPoints],
					[ExperiencePoints],
					[SkillsPoints],
					[DirectorshipPoints],
					[WizardLanguageXML],
					[CustomQuestionsXML],
					[MinExperiencesEntry],
					[MinReferencesEntry],
					[MinEducationsEntry],
					[QualificationNames]
				FROM
					[dbo].[MemberWizard]
				WHERE
					[MemberWizardID] = @MemberWizardId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberWizard_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberWizard_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberWizard_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the MemberWizard table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberWizard_Find
(

	@SearchUsingOR bit   = null ,

	@MemberWizardId int   = null ,

	@SiteId int   = null ,

	@MemberWizardParentId int   = null ,

	@ProfileTitle nvarchar (512)  = null ,

	@CvTitle nvarchar (512)  = null ,

	@RolePreferencesTitle nvarchar (512)  = null ,

	@EducationTitle nvarchar (512)  = null ,

	@MembershipsTitle nvarchar (512)  = null ,

	@ExperienceTitle nvarchar (512)  = null ,

	@SkillsTitle nvarchar (512)  = null ,

	@ProfileEnable bit   = null ,

	@CvEnable bit   = null ,

	@RolePreferencesEnable bit   = null ,

	@EducationEnable bit   = null ,

	@MembershipsEnable bit   = null ,

	@ExperienceEnable bit   = null ,

	@SkillsEnable bit   = null ,

	@GlobalTemplate bit   = null ,

	@LastModifiedBy int   = null ,

	@LastModified datetime   = null ,

	@DirectorshipTitle nvarchar (512)  = null ,

	@DirectorshipEnable bit   = null ,

	@Skills nvarchar (MAX)  = null ,

	@LicenseTypes nvarchar (MAX)  = null ,

	@SummaryTitle nvarchar (512)  = null ,

	@PersonalDetailsTitle nvarchar (512)  = null ,

	@LicensesTitle nvarchar (512)  = null ,

	@AttachCoverLetterTitle nvarchar (512)  = null ,

	@LanguagesTitle nvarchar (512)  = null ,

	@ReferencesTitle nvarchar (512)  = null ,

	@CustomQuestionTitle nvarchar (512)  = null ,

	@SummaryPoints int   = null ,

	@PersonalDetailsPoints int   = null ,

	@LicensesPoints int   = null ,

	@AttachCoverLetterPoints int   = null ,

	@LanguagesPoints int   = null ,

	@ReferencesPoints int   = null ,

	@CustomQuestionPoints int   = null ,

	@ProfilePoints int   = null ,

	@CvPoints int   = null ,

	@RolePreferencesPoints int   = null ,

	@EducationPoints int   = null ,

	@MembershipsPoints int   = null ,

	@ExperiencePoints int   = null ,

	@SkillsPoints int   = null ,

	@DirectorshipPoints int   = null ,

	@WizardLanguageXml nvarchar (MAX)  = null ,

	@CustomQuestionsXml nvarchar (MAX)  = null ,

	@MinExperiencesEntry smallint   = null ,

	@MinReferencesEntry smallint   = null ,

	@MinEducationsEntry smallint   = null ,

	@QualificationNames nvarchar (MAX)  = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [MemberWizardID]
	, [SiteID]
	, [MemberWizardParentID]
	, [ProfileTitle]
	, [CVTitle]
	, [RolePreferencesTitle]
	, [EducationTitle]
	, [MembershipsTitle]
	, [ExperienceTitle]
	, [SkillsTitle]
	, [ProfileEnable]
	, [CVEnable]
	, [RolePreferencesEnable]
	, [EducationEnable]
	, [MembershipsEnable]
	, [ExperienceEnable]
	, [SkillsEnable]
	, [GlobalTemplate]
	, [LastModifiedBy]
	, [LastModified]
	, [DirectorshipTitle]
	, [DirectorshipEnable]
	, [Skills]
	, [LicenseTypes]
	, [SummaryTitle]
	, [PersonalDetailsTitle]
	, [LicensesTitle]
	, [AttachCoverLetterTitle]
	, [LanguagesTitle]
	, [ReferencesTitle]
	, [CustomQuestionTitle]
	, [SummaryPoints]
	, [PersonalDetailsPoints]
	, [LicensesPoints]
	, [AttachCoverLetterPoints]
	, [LanguagesPoints]
	, [ReferencesPoints]
	, [CustomQuestionPoints]
	, [ProfilePoints]
	, [CVPoints]
	, [RolePreferencesPoints]
	, [EducationPoints]
	, [MembershipsPoints]
	, [ExperiencePoints]
	, [SkillsPoints]
	, [DirectorshipPoints]
	, [WizardLanguageXML]
	, [CustomQuestionsXML]
	, [MinExperiencesEntry]
	, [MinReferencesEntry]
	, [MinEducationsEntry]
	, [QualificationNames]
    FROM
	[dbo].[MemberWizard]
    WHERE 
	 ([MemberWizardID] = @MemberWizardId OR @MemberWizardId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([MemberWizardParentID] = @MemberWizardParentId OR @MemberWizardParentId IS NULL)
	AND ([ProfileTitle] = @ProfileTitle OR @ProfileTitle IS NULL)
	AND ([CVTitle] = @CvTitle OR @CvTitle IS NULL)
	AND ([RolePreferencesTitle] = @RolePreferencesTitle OR @RolePreferencesTitle IS NULL)
	AND ([EducationTitle] = @EducationTitle OR @EducationTitle IS NULL)
	AND ([MembershipsTitle] = @MembershipsTitle OR @MembershipsTitle IS NULL)
	AND ([ExperienceTitle] = @ExperienceTitle OR @ExperienceTitle IS NULL)
	AND ([SkillsTitle] = @SkillsTitle OR @SkillsTitle IS NULL)
	AND ([ProfileEnable] = @ProfileEnable OR @ProfileEnable IS NULL)
	AND ([CVEnable] = @CvEnable OR @CvEnable IS NULL)
	AND ([RolePreferencesEnable] = @RolePreferencesEnable OR @RolePreferencesEnable IS NULL)
	AND ([EducationEnable] = @EducationEnable OR @EducationEnable IS NULL)
	AND ([MembershipsEnable] = @MembershipsEnable OR @MembershipsEnable IS NULL)
	AND ([ExperienceEnable] = @ExperienceEnable OR @ExperienceEnable IS NULL)
	AND ([SkillsEnable] = @SkillsEnable OR @SkillsEnable IS NULL)
	AND ([GlobalTemplate] = @GlobalTemplate OR @GlobalTemplate IS NULL)
	AND ([LastModifiedBy] = @LastModifiedBy OR @LastModifiedBy IS NULL)
	AND ([LastModified] = @LastModified OR @LastModified IS NULL)
	AND ([DirectorshipTitle] = @DirectorshipTitle OR @DirectorshipTitle IS NULL)
	AND ([DirectorshipEnable] = @DirectorshipEnable OR @DirectorshipEnable IS NULL)
	AND ([Skills] = @Skills OR @Skills IS NULL)
	AND ([LicenseTypes] = @LicenseTypes OR @LicenseTypes IS NULL)
	AND ([SummaryTitle] = @SummaryTitle OR @SummaryTitle IS NULL)
	AND ([PersonalDetailsTitle] = @PersonalDetailsTitle OR @PersonalDetailsTitle IS NULL)
	AND ([LicensesTitle] = @LicensesTitle OR @LicensesTitle IS NULL)
	AND ([AttachCoverLetterTitle] = @AttachCoverLetterTitle OR @AttachCoverLetterTitle IS NULL)
	AND ([LanguagesTitle] = @LanguagesTitle OR @LanguagesTitle IS NULL)
	AND ([ReferencesTitle] = @ReferencesTitle OR @ReferencesTitle IS NULL)
	AND ([CustomQuestionTitle] = @CustomQuestionTitle OR @CustomQuestionTitle IS NULL)
	AND ([SummaryPoints] = @SummaryPoints OR @SummaryPoints IS NULL)
	AND ([PersonalDetailsPoints] = @PersonalDetailsPoints OR @PersonalDetailsPoints IS NULL)
	AND ([LicensesPoints] = @LicensesPoints OR @LicensesPoints IS NULL)
	AND ([AttachCoverLetterPoints] = @AttachCoverLetterPoints OR @AttachCoverLetterPoints IS NULL)
	AND ([LanguagesPoints] = @LanguagesPoints OR @LanguagesPoints IS NULL)
	AND ([ReferencesPoints] = @ReferencesPoints OR @ReferencesPoints IS NULL)
	AND ([CustomQuestionPoints] = @CustomQuestionPoints OR @CustomQuestionPoints IS NULL)
	AND ([ProfilePoints] = @ProfilePoints OR @ProfilePoints IS NULL)
	AND ([CVPoints] = @CvPoints OR @CvPoints IS NULL)
	AND ([RolePreferencesPoints] = @RolePreferencesPoints OR @RolePreferencesPoints IS NULL)
	AND ([EducationPoints] = @EducationPoints OR @EducationPoints IS NULL)
	AND ([MembershipsPoints] = @MembershipsPoints OR @MembershipsPoints IS NULL)
	AND ([ExperiencePoints] = @ExperiencePoints OR @ExperiencePoints IS NULL)
	AND ([SkillsPoints] = @SkillsPoints OR @SkillsPoints IS NULL)
	AND ([DirectorshipPoints] = @DirectorshipPoints OR @DirectorshipPoints IS NULL)
	AND ([WizardLanguageXML] = @WizardLanguageXml OR @WizardLanguageXml IS NULL)
	AND ([CustomQuestionsXML] = @CustomQuestionsXml OR @CustomQuestionsXml IS NULL)
	AND ([MinExperiencesEntry] = @MinExperiencesEntry OR @MinExperiencesEntry IS NULL)
	AND ([MinReferencesEntry] = @MinReferencesEntry OR @MinReferencesEntry IS NULL)
	AND ([MinEducationsEntry] = @MinEducationsEntry OR @MinEducationsEntry IS NULL)
	AND ([QualificationNames] = @QualificationNames OR @QualificationNames IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [MemberWizardID]
	, [SiteID]
	, [MemberWizardParentID]
	, [ProfileTitle]
	, [CVTitle]
	, [RolePreferencesTitle]
	, [EducationTitle]
	, [MembershipsTitle]
	, [ExperienceTitle]
	, [SkillsTitle]
	, [ProfileEnable]
	, [CVEnable]
	, [RolePreferencesEnable]
	, [EducationEnable]
	, [MembershipsEnable]
	, [ExperienceEnable]
	, [SkillsEnable]
	, [GlobalTemplate]
	, [LastModifiedBy]
	, [LastModified]
	, [DirectorshipTitle]
	, [DirectorshipEnable]
	, [Skills]
	, [LicenseTypes]
	, [SummaryTitle]
	, [PersonalDetailsTitle]
	, [LicensesTitle]
	, [AttachCoverLetterTitle]
	, [LanguagesTitle]
	, [ReferencesTitle]
	, [CustomQuestionTitle]
	, [SummaryPoints]
	, [PersonalDetailsPoints]
	, [LicensesPoints]
	, [AttachCoverLetterPoints]
	, [LanguagesPoints]
	, [ReferencesPoints]
	, [CustomQuestionPoints]
	, [ProfilePoints]
	, [CVPoints]
	, [RolePreferencesPoints]
	, [EducationPoints]
	, [MembershipsPoints]
	, [ExperiencePoints]
	, [SkillsPoints]
	, [DirectorshipPoints]
	, [WizardLanguageXML]
	, [CustomQuestionsXML]
	, [MinExperiencesEntry]
	, [MinReferencesEntry]
	, [MinEducationsEntry]
	, [QualificationNames]
    FROM
	[dbo].[MemberWizard]
    WHERE 
	 ([MemberWizardID] = @MemberWizardId AND @MemberWizardId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([MemberWizardParentID] = @MemberWizardParentId AND @MemberWizardParentId is not null)
	OR ([ProfileTitle] = @ProfileTitle AND @ProfileTitle is not null)
	OR ([CVTitle] = @CvTitle AND @CvTitle is not null)
	OR ([RolePreferencesTitle] = @RolePreferencesTitle AND @RolePreferencesTitle is not null)
	OR ([EducationTitle] = @EducationTitle AND @EducationTitle is not null)
	OR ([MembershipsTitle] = @MembershipsTitle AND @MembershipsTitle is not null)
	OR ([ExperienceTitle] = @ExperienceTitle AND @ExperienceTitle is not null)
	OR ([SkillsTitle] = @SkillsTitle AND @SkillsTitle is not null)
	OR ([ProfileEnable] = @ProfileEnable AND @ProfileEnable is not null)
	OR ([CVEnable] = @CvEnable AND @CvEnable is not null)
	OR ([RolePreferencesEnable] = @RolePreferencesEnable AND @RolePreferencesEnable is not null)
	OR ([EducationEnable] = @EducationEnable AND @EducationEnable is not null)
	OR ([MembershipsEnable] = @MembershipsEnable AND @MembershipsEnable is not null)
	OR ([ExperienceEnable] = @ExperienceEnable AND @ExperienceEnable is not null)
	OR ([SkillsEnable] = @SkillsEnable AND @SkillsEnable is not null)
	OR ([GlobalTemplate] = @GlobalTemplate AND @GlobalTemplate is not null)
	OR ([LastModifiedBy] = @LastModifiedBy AND @LastModifiedBy is not null)
	OR ([LastModified] = @LastModified AND @LastModified is not null)
	OR ([DirectorshipTitle] = @DirectorshipTitle AND @DirectorshipTitle is not null)
	OR ([DirectorshipEnable] = @DirectorshipEnable AND @DirectorshipEnable is not null)
	OR ([Skills] = @Skills AND @Skills is not null)
	OR ([LicenseTypes] = @LicenseTypes AND @LicenseTypes is not null)
	OR ([SummaryTitle] = @SummaryTitle AND @SummaryTitle is not null)
	OR ([PersonalDetailsTitle] = @PersonalDetailsTitle AND @PersonalDetailsTitle is not null)
	OR ([LicensesTitle] = @LicensesTitle AND @LicensesTitle is not null)
	OR ([AttachCoverLetterTitle] = @AttachCoverLetterTitle AND @AttachCoverLetterTitle is not null)
	OR ([LanguagesTitle] = @LanguagesTitle AND @LanguagesTitle is not null)
	OR ([ReferencesTitle] = @ReferencesTitle AND @ReferencesTitle is not null)
	OR ([CustomQuestionTitle] = @CustomQuestionTitle AND @CustomQuestionTitle is not null)
	OR ([SummaryPoints] = @SummaryPoints AND @SummaryPoints is not null)
	OR ([PersonalDetailsPoints] = @PersonalDetailsPoints AND @PersonalDetailsPoints is not null)
	OR ([LicensesPoints] = @LicensesPoints AND @LicensesPoints is not null)
	OR ([AttachCoverLetterPoints] = @AttachCoverLetterPoints AND @AttachCoverLetterPoints is not null)
	OR ([LanguagesPoints] = @LanguagesPoints AND @LanguagesPoints is not null)
	OR ([ReferencesPoints] = @ReferencesPoints AND @ReferencesPoints is not null)
	OR ([CustomQuestionPoints] = @CustomQuestionPoints AND @CustomQuestionPoints is not null)
	OR ([ProfilePoints] = @ProfilePoints AND @ProfilePoints is not null)
	OR ([CVPoints] = @CvPoints AND @CvPoints is not null)
	OR ([RolePreferencesPoints] = @RolePreferencesPoints AND @RolePreferencesPoints is not null)
	OR ([EducationPoints] = @EducationPoints AND @EducationPoints is not null)
	OR ([MembershipsPoints] = @MembershipsPoints AND @MembershipsPoints is not null)
	OR ([ExperiencePoints] = @ExperiencePoints AND @ExperiencePoints is not null)
	OR ([SkillsPoints] = @SkillsPoints AND @SkillsPoints is not null)
	OR ([DirectorshipPoints] = @DirectorshipPoints AND @DirectorshipPoints is not null)
	OR ([WizardLanguageXML] = @WizardLanguageXml AND @WizardLanguageXml is not null)
	OR ([CustomQuestionsXML] = @CustomQuestionsXml AND @CustomQuestionsXml is not null)
	OR ([MinExperiencesEntry] = @MinExperiencesEntry AND @MinExperiencesEntry is not null)
	OR ([MinReferencesEntry] = @MinReferencesEntry AND @MinReferencesEntry is not null)
	OR ([MinEducationsEntry] = @MinEducationsEntry AND @MinEducationsEntry is not null)
	OR ([QualificationNames] = @QualificationNames AND @QualificationNames is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberLanguages_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberLanguages_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberLanguages_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the MemberLanguages table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberLanguages_Get_List

AS


				
				SELECT
					[MemberLanguageID],
					[MemberID],
					[Langauges],
					[Profieciency],
					[LastModifiedDate]
				FROM
					[dbo].[MemberLanguages]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberLanguages_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberLanguages_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberLanguages_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the MemberLanguages table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberLanguages_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [MemberLanguageID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([MemberLanguageID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [MemberLanguageID]'
				SET @SQL = @SQL + ' FROM [dbo].[MemberLanguages]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[MemberLanguageID], O.[MemberID], O.[Langauges], O.[Profieciency], O.[LastModifiedDate]
				FROM
				    [dbo].[MemberLanguages] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[MemberLanguageID] = PageIndex.[MemberLanguageID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[MemberLanguages]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberLanguages_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberLanguages_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberLanguages_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the MemberLanguages table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberLanguages_Insert
(

	@MemberLanguageId int    OUTPUT,

	@MemberId int   ,

	@Langauges nvarchar (150)  ,

	@Profieciency int   ,

	@LastModifiedDate datetime   
)
AS


				
				INSERT INTO [dbo].[MemberLanguages]
					(
					[MemberID]
					,[Langauges]
					,[Profieciency]
					,[LastModifiedDate]
					)
				VALUES
					(
					@MemberId
					,@Langauges
					,@Profieciency
					,@LastModifiedDate
					)
				
				-- Get the identity value
				SET @MemberLanguageId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberLanguages_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberLanguages_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberLanguages_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the MemberLanguages table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberLanguages_Update
(

	@MemberLanguageId int   ,

	@MemberId int   ,

	@Langauges nvarchar (150)  ,

	@Profieciency int   ,

	@LastModifiedDate datetime   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[MemberLanguages]
				SET
					[MemberID] = @MemberId
					,[Langauges] = @Langauges
					,[Profieciency] = @Profieciency
					,[LastModifiedDate] = @LastModifiedDate
				WHERE
[MemberLanguageID] = @MemberLanguageId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberLanguages_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberLanguages_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberLanguages_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the MemberLanguages table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberLanguages_Delete
(

	@MemberLanguageId int   
)
AS


				DELETE FROM [dbo].[MemberLanguages] WITH (ROWLOCK) 
				WHERE
					[MemberLanguageID] = @MemberLanguageId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberLanguages_GetByMemberId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberLanguages_GetByMemberId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberLanguages_GetByMemberId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the MemberLanguages table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberLanguages_GetByMemberId
(

	@MemberId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[MemberLanguageID],
					[MemberID],
					[Langauges],
					[Profieciency],
					[LastModifiedDate]
				FROM
					[dbo].[MemberLanguages]
				WHERE
					[MemberID] = @MemberId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberLanguages_GetByMemberLanguageId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberLanguages_GetByMemberLanguageId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberLanguages_GetByMemberLanguageId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the MemberLanguages table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberLanguages_GetByMemberLanguageId
(

	@MemberLanguageId int   
)
AS


				SELECT
					[MemberLanguageID],
					[MemberID],
					[Langauges],
					[Profieciency],
					[LastModifiedDate]
				FROM
					[dbo].[MemberLanguages]
				WHERE
					[MemberLanguageID] = @MemberLanguageId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberLanguages_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberLanguages_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberLanguages_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the MemberLanguages table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberLanguages_Find
(

	@SearchUsingOR bit   = null ,

	@MemberLanguageId int   = null ,

	@MemberId int   = null ,

	@Langauges nvarchar (150)  = null ,

	@Profieciency int   = null ,

	@LastModifiedDate datetime   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [MemberLanguageID]
	, [MemberID]
	, [Langauges]
	, [Profieciency]
	, [LastModifiedDate]
    FROM
	[dbo].[MemberLanguages]
    WHERE 
	 ([MemberLanguageID] = @MemberLanguageId OR @MemberLanguageId IS NULL)
	AND ([MemberID] = @MemberId OR @MemberId IS NULL)
	AND ([Langauges] = @Langauges OR @Langauges IS NULL)
	AND ([Profieciency] = @Profieciency OR @Profieciency IS NULL)
	AND ([LastModifiedDate] = @LastModifiedDate OR @LastModifiedDate IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [MemberLanguageID]
	, [MemberID]
	, [Langauges]
	, [Profieciency]
	, [LastModifiedDate]
    FROM
	[dbo].[MemberLanguages]
    WHERE 
	 ([MemberLanguageID] = @MemberLanguageId AND @MemberLanguageId is not null)
	OR ([MemberID] = @MemberId AND @MemberId is not null)
	OR ([Langauges] = @Langauges AND @Langauges is not null)
	OR ([Profieciency] = @Profieciency AND @Profieciency is not null)
	OR ([LastModifiedDate] = @LastModifiedDate AND @LastModifiedDate is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberLicenses_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberLicenses_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberLicenses_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the MemberLicenses table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberLicenses_Get_List

AS


				
				SELECT
					[MemberLicenseID],
					[MemberID],
					[MemberLicenseName],
					[LicenseType],
					[IssueDate],
					[ExpiryDate],
					[CountryID],
					[State],
					[DoesNotExpire],
					[LastModifiedDate]
				FROM
					[dbo].[MemberLicenses]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberLicenses_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberLicenses_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberLicenses_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the MemberLicenses table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberLicenses_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [MemberLicenseID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([MemberLicenseID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [MemberLicenseID]'
				SET @SQL = @SQL + ' FROM [dbo].[MemberLicenses]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[MemberLicenseID], O.[MemberID], O.[MemberLicenseName], O.[LicenseType], O.[IssueDate], O.[ExpiryDate], O.[CountryID], O.[State], O.[DoesNotExpire], O.[LastModifiedDate]
				FROM
				    [dbo].[MemberLicenses] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[MemberLicenseID] = PageIndex.[MemberLicenseID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[MemberLicenses]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberLicenses_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberLicenses_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberLicenses_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the MemberLicenses table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberLicenses_Insert
(

	@MemberLicenseId int    OUTPUT,

	@MemberId int   ,

	@MemberLicenseName nvarchar (100)  ,

	@LicenseType nvarchar (200)  ,

	@IssueDate date   ,

	@ExpiryDate date   ,

	@CountryId int   ,

	@State nvarchar (100)  ,

	@DoesNotExpire bit   ,

	@LastModifiedDate datetime   
)
AS


				
				INSERT INTO [dbo].[MemberLicenses]
					(
					[MemberID]
					,[MemberLicenseName]
					,[LicenseType]
					,[IssueDate]
					,[ExpiryDate]
					,[CountryID]
					,[State]
					,[DoesNotExpire]
					,[LastModifiedDate]
					)
				VALUES
					(
					@MemberId
					,@MemberLicenseName
					,@LicenseType
					,@IssueDate
					,@ExpiryDate
					,@CountryId
					,@State
					,@DoesNotExpire
					,@LastModifiedDate
					)
				
				-- Get the identity value
				SET @MemberLicenseId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberLicenses_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberLicenses_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberLicenses_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the MemberLicenses table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberLicenses_Update
(

	@MemberLicenseId int   ,

	@MemberId int   ,

	@MemberLicenseName nvarchar (100)  ,

	@LicenseType nvarchar (200)  ,

	@IssueDate date   ,

	@ExpiryDate date   ,

	@CountryId int   ,

	@State nvarchar (100)  ,

	@DoesNotExpire bit   ,

	@LastModifiedDate datetime   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[MemberLicenses]
				SET
					[MemberID] = @MemberId
					,[MemberLicenseName] = @MemberLicenseName
					,[LicenseType] = @LicenseType
					,[IssueDate] = @IssueDate
					,[ExpiryDate] = @ExpiryDate
					,[CountryID] = @CountryId
					,[State] = @State
					,[DoesNotExpire] = @DoesNotExpire
					,[LastModifiedDate] = @LastModifiedDate
				WHERE
[MemberLicenseID] = @MemberLicenseId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberLicenses_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberLicenses_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberLicenses_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the MemberLicenses table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberLicenses_Delete
(

	@MemberLicenseId int   
)
AS


				DELETE FROM [dbo].[MemberLicenses] WITH (ROWLOCK) 
				WHERE
					[MemberLicenseID] = @MemberLicenseId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberLicenses_GetByMemberId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberLicenses_GetByMemberId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberLicenses_GetByMemberId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the MemberLicenses table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberLicenses_GetByMemberId
(

	@MemberId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[MemberLicenseID],
					[MemberID],
					[MemberLicenseName],
					[LicenseType],
					[IssueDate],
					[ExpiryDate],
					[CountryID],
					[State],
					[DoesNotExpire],
					[LastModifiedDate]
				FROM
					[dbo].[MemberLicenses]
				WHERE
					[MemberID] = @MemberId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberLicenses_GetByMemberLicenseId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberLicenses_GetByMemberLicenseId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberLicenses_GetByMemberLicenseId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the MemberLicenses table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberLicenses_GetByMemberLicenseId
(

	@MemberLicenseId int   
)
AS


				SELECT
					[MemberLicenseID],
					[MemberID],
					[MemberLicenseName],
					[LicenseType],
					[IssueDate],
					[ExpiryDate],
					[CountryID],
					[State],
					[DoesNotExpire],
					[LastModifiedDate]
				FROM
					[dbo].[MemberLicenses]
				WHERE
					[MemberLicenseID] = @MemberLicenseId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberLicenses_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberLicenses_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberLicenses_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the MemberLicenses table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberLicenses_Find
(

	@SearchUsingOR bit   = null ,

	@MemberLicenseId int   = null ,

	@MemberId int   = null ,

	@MemberLicenseName nvarchar (100)  = null ,

	@LicenseType nvarchar (200)  = null ,

	@IssueDate date   = null ,

	@ExpiryDate date   = null ,

	@CountryId int   = null ,

	@State nvarchar (100)  = null ,

	@DoesNotExpire bit   = null ,

	@LastModifiedDate datetime   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [MemberLicenseID]
	, [MemberID]
	, [MemberLicenseName]
	, [LicenseType]
	, [IssueDate]
	, [ExpiryDate]
	, [CountryID]
	, [State]
	, [DoesNotExpire]
	, [LastModifiedDate]
    FROM
	[dbo].[MemberLicenses]
    WHERE 
	 ([MemberLicenseID] = @MemberLicenseId OR @MemberLicenseId IS NULL)
	AND ([MemberID] = @MemberId OR @MemberId IS NULL)
	AND ([MemberLicenseName] = @MemberLicenseName OR @MemberLicenseName IS NULL)
	AND ([LicenseType] = @LicenseType OR @LicenseType IS NULL)
	AND ([IssueDate] = @IssueDate OR @IssueDate IS NULL)
	AND ([ExpiryDate] = @ExpiryDate OR @ExpiryDate IS NULL)
	AND ([CountryID] = @CountryId OR @CountryId IS NULL)
	AND ([State] = @State OR @State IS NULL)
	AND ([DoesNotExpire] = @DoesNotExpire OR @DoesNotExpire IS NULL)
	AND ([LastModifiedDate] = @LastModifiedDate OR @LastModifiedDate IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [MemberLicenseID]
	, [MemberID]
	, [MemberLicenseName]
	, [LicenseType]
	, [IssueDate]
	, [ExpiryDate]
	, [CountryID]
	, [State]
	, [DoesNotExpire]
	, [LastModifiedDate]
    FROM
	[dbo].[MemberLicenses]
    WHERE 
	 ([MemberLicenseID] = @MemberLicenseId AND @MemberLicenseId is not null)
	OR ([MemberID] = @MemberId AND @MemberId is not null)
	OR ([MemberLicenseName] = @MemberLicenseName AND @MemberLicenseName is not null)
	OR ([LicenseType] = @LicenseType AND @LicenseType is not null)
	OR ([IssueDate] = @IssueDate AND @IssueDate is not null)
	OR ([ExpiryDate] = @ExpiryDate AND @ExpiryDate is not null)
	OR ([CountryID] = @CountryId AND @CountryId is not null)
	OR ([State] = @State AND @State is not null)
	OR ([DoesNotExpire] = @DoesNotExpire AND @DoesNotExpire is not null)
	OR ([LastModifiedDate] = @LastModifiedDate AND @LastModifiedDate is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberMemberships_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberMemberships_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberMemberships_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the MemberMemberships table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberMemberships_Get_List

AS


				
				SELECT
					[MemberMembershipsID],
					[SiteID],
					[MemberMembershipsName],
					[LastModifiedBy],
					[LastModified],
					[Sequence],
					[Valid]
				FROM
					[dbo].[MemberMemberships]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberMemberships_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberMemberships_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberMemberships_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the MemberMemberships table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberMemberships_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [MemberMembershipsID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([MemberMembershipsID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [MemberMembershipsID]'
				SET @SQL = @SQL + ' FROM [dbo].[MemberMemberships]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[MemberMembershipsID], O.[SiteID], O.[MemberMembershipsName], O.[LastModifiedBy], O.[LastModified], O.[Sequence], O.[Valid]
				FROM
				    [dbo].[MemberMemberships] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[MemberMembershipsID] = PageIndex.[MemberMembershipsID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[MemberMemberships]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberMemberships_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberMemberships_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberMemberships_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the MemberMemberships table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberMemberships_Insert
(

	@MemberMembershipsId int    OUTPUT,

	@SiteId int   ,

	@MemberMembershipsName nvarchar (512)  ,

	@LastModifiedBy int   ,

	@LastModified datetime   ,

	@Sequence int   ,

	@Valid bit   
)
AS


				
				INSERT INTO [dbo].[MemberMemberships]
					(
					[SiteID]
					,[MemberMembershipsName]
					,[LastModifiedBy]
					,[LastModified]
					,[Sequence]
					,[Valid]
					)
				VALUES
					(
					@SiteId
					,@MemberMembershipsName
					,@LastModifiedBy
					,@LastModified
					,@Sequence
					,@Valid
					)
				
				-- Get the identity value
				SET @MemberMembershipsId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberMemberships_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberMemberships_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberMemberships_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the MemberMemberships table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberMemberships_Update
(

	@MemberMembershipsId int   ,

	@SiteId int   ,

	@MemberMembershipsName nvarchar (512)  ,

	@LastModifiedBy int   ,

	@LastModified datetime   ,

	@Sequence int   ,

	@Valid bit   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[MemberMemberships]
				SET
					[SiteID] = @SiteId
					,[MemberMembershipsName] = @MemberMembershipsName
					,[LastModifiedBy] = @LastModifiedBy
					,[LastModified] = @LastModified
					,[Sequence] = @Sequence
					,[Valid] = @Valid
				WHERE
[MemberMembershipsID] = @MemberMembershipsId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberMemberships_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberMemberships_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberMemberships_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the MemberMemberships table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberMemberships_Delete
(

	@MemberMembershipsId int   
)
AS


				DELETE FROM [dbo].[MemberMemberships] WITH (ROWLOCK) 
				WHERE
					[MemberMembershipsID] = @MemberMembershipsId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberMemberships_GetByLastModifiedBy procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberMemberships_GetByLastModifiedBy') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberMemberships_GetByLastModifiedBy
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the MemberMemberships table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberMemberships_GetByLastModifiedBy
(

	@LastModifiedBy int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[MemberMembershipsID],
					[SiteID],
					[MemberMembershipsName],
					[LastModifiedBy],
					[LastModified],
					[Sequence],
					[Valid]
				FROM
					[dbo].[MemberMemberships]
				WHERE
					[LastModifiedBy] = @LastModifiedBy
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberMemberships_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberMemberships_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberMemberships_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the MemberMemberships table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberMemberships_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[MemberMembershipsID],
					[SiteID],
					[MemberMembershipsName],
					[LastModifiedBy],
					[LastModified],
					[Sequence],
					[Valid]
				FROM
					[dbo].[MemberMemberships]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberMemberships_GetByMemberMembershipsId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberMemberships_GetByMemberMembershipsId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberMemberships_GetByMemberMembershipsId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the MemberMemberships table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberMemberships_GetByMemberMembershipsId
(

	@MemberMembershipsId int   
)
AS


				SELECT
					[MemberMembershipsID],
					[SiteID],
					[MemberMembershipsName],
					[LastModifiedBy],
					[LastModified],
					[Sequence],
					[Valid]
				FROM
					[dbo].[MemberMemberships]
				WHERE
					[MemberMembershipsID] = @MemberMembershipsId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberMemberships_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberMemberships_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberMemberships_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the MemberMemberships table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberMemberships_Find
(

	@SearchUsingOR bit   = null ,

	@MemberMembershipsId int   = null ,

	@SiteId int   = null ,

	@MemberMembershipsName nvarchar (512)  = null ,

	@LastModifiedBy int   = null ,

	@LastModified datetime   = null ,

	@Sequence int   = null ,

	@Valid bit   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [MemberMembershipsID]
	, [SiteID]
	, [MemberMembershipsName]
	, [LastModifiedBy]
	, [LastModified]
	, [Sequence]
	, [Valid]
    FROM
	[dbo].[MemberMemberships]
    WHERE 
	 ([MemberMembershipsID] = @MemberMembershipsId OR @MemberMembershipsId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([MemberMembershipsName] = @MemberMembershipsName OR @MemberMembershipsName IS NULL)
	AND ([LastModifiedBy] = @LastModifiedBy OR @LastModifiedBy IS NULL)
	AND ([LastModified] = @LastModified OR @LastModified IS NULL)
	AND ([Sequence] = @Sequence OR @Sequence IS NULL)
	AND ([Valid] = @Valid OR @Valid IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [MemberMembershipsID]
	, [SiteID]
	, [MemberMembershipsName]
	, [LastModifiedBy]
	, [LastModified]
	, [Sequence]
	, [Valid]
    FROM
	[dbo].[MemberMemberships]
    WHERE 
	 ([MemberMembershipsID] = @MemberMembershipsId AND @MemberMembershipsId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([MemberMembershipsName] = @MemberMembershipsName AND @MemberMembershipsName is not null)
	OR ([LastModifiedBy] = @LastModifiedBy AND @LastModifiedBy is not null)
	OR ([LastModified] = @LastModified AND @LastModified is not null)
	OR ([Sequence] = @Sequence AND @Sequence is not null)
	OR ([Valid] = @Valid AND @Valid is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberPositions_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberPositions_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberPositions_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the MemberPositions table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberPositions_Get_List

AS


				
				SELECT
					[MemberPositionId],
					[LinkedInInternalPositionId],
					[Title],
					[Summary],
					[CompanyId],
					[CompanyName],
					[CompanyIndustry],
					[StartMonth],
					[StartYear],
					[EndMonth],
					[EndYear],
					[IsCurrent],
					[MemberID],
					[OrganisationWebsite],
					[ResponsibilitiesAndAchievements],
					[TypeOfDirectorship],
					[AdditionalRolesAndResponsibilities],
					[IsDirectorship],
					[City],
					[CountryID],
					[State]
				FROM
					[dbo].[MemberPositions]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberPositions_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberPositions_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberPositions_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the MemberPositions table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberPositions_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [MemberPositionId] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([MemberPositionId])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [MemberPositionId]'
				SET @SQL = @SQL + ' FROM [dbo].[MemberPositions]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[MemberPositionId], O.[LinkedInInternalPositionId], O.[Title], O.[Summary], O.[CompanyId], O.[CompanyName], O.[CompanyIndustry], O.[StartMonth], O.[StartYear], O.[EndMonth], O.[EndYear], O.[IsCurrent], O.[MemberID], O.[OrganisationWebsite], O.[ResponsibilitiesAndAchievements], O.[TypeOfDirectorship], O.[AdditionalRolesAndResponsibilities], O.[IsDirectorship], O.[City], O.[CountryID], O.[State]
				FROM
				    [dbo].[MemberPositions] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[MemberPositionId] = PageIndex.[MemberPositionId]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[MemberPositions]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberPositions_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberPositions_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberPositions_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the MemberPositions table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberPositions_Insert
(

	@MemberPositionId int    OUTPUT,

	@LinkedInInternalPositionId int   ,

	@Title nvarchar (255)  ,

	@Summary nvarchar (MAX)  ,

	@CompanyId int   ,

	@CompanyName nvarchar (255)  ,

	@CompanyIndustry nvarchar (255)  ,

	@StartMonth int   ,

	@StartYear int   ,

	@EndMonth int   ,

	@EndYear int   ,

	@IsCurrent bit   ,

	@MemberId int   ,

	@OrganisationWebsite nvarchar (255)  ,

	@ResponsibilitiesAndAchievements nvarchar (MAX)  ,

	@TypeOfDirectorship nvarchar (255)  ,

	@AdditionalRolesAndResponsibilities nvarchar (500)  ,

	@IsDirectorship bit   ,

	@City nvarchar (100)  ,

	@CountryId int   ,

	@State nvarchar (100)  
)
AS


				
				INSERT INTO [dbo].[MemberPositions]
					(
					[LinkedInInternalPositionId]
					,[Title]
					,[Summary]
					,[CompanyId]
					,[CompanyName]
					,[CompanyIndustry]
					,[StartMonth]
					,[StartYear]
					,[EndMonth]
					,[EndYear]
					,[IsCurrent]
					,[MemberID]
					,[OrganisationWebsite]
					,[ResponsibilitiesAndAchievements]
					,[TypeOfDirectorship]
					,[AdditionalRolesAndResponsibilities]
					,[IsDirectorship]
					,[City]
					,[CountryID]
					,[State]
					)
				VALUES
					(
					@LinkedInInternalPositionId
					,@Title
					,@Summary
					,@CompanyId
					,@CompanyName
					,@CompanyIndustry
					,@StartMonth
					,@StartYear
					,@EndMonth
					,@EndYear
					,@IsCurrent
					,@MemberId
					,@OrganisationWebsite
					,@ResponsibilitiesAndAchievements
					,@TypeOfDirectorship
					,@AdditionalRolesAndResponsibilities
					,@IsDirectorship
					,@City
					,@CountryId
					,@State
					)
				
				-- Get the identity value
				SET @MemberPositionId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberPositions_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberPositions_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberPositions_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the MemberPositions table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberPositions_Update
(

	@MemberPositionId int   ,

	@LinkedInInternalPositionId int   ,

	@Title nvarchar (255)  ,

	@Summary nvarchar (MAX)  ,

	@CompanyId int   ,

	@CompanyName nvarchar (255)  ,

	@CompanyIndustry nvarchar (255)  ,

	@StartMonth int   ,

	@StartYear int   ,

	@EndMonth int   ,

	@EndYear int   ,

	@IsCurrent bit   ,

	@MemberId int   ,

	@OrganisationWebsite nvarchar (255)  ,

	@ResponsibilitiesAndAchievements nvarchar (MAX)  ,

	@TypeOfDirectorship nvarchar (255)  ,

	@AdditionalRolesAndResponsibilities nvarchar (500)  ,

	@IsDirectorship bit   ,

	@City nvarchar (100)  ,

	@CountryId int   ,

	@State nvarchar (100)  
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[MemberPositions]
				SET
					[LinkedInInternalPositionId] = @LinkedInInternalPositionId
					,[Title] = @Title
					,[Summary] = @Summary
					,[CompanyId] = @CompanyId
					,[CompanyName] = @CompanyName
					,[CompanyIndustry] = @CompanyIndustry
					,[StartMonth] = @StartMonth
					,[StartYear] = @StartYear
					,[EndMonth] = @EndMonth
					,[EndYear] = @EndYear
					,[IsCurrent] = @IsCurrent
					,[MemberID] = @MemberId
					,[OrganisationWebsite] = @OrganisationWebsite
					,[ResponsibilitiesAndAchievements] = @ResponsibilitiesAndAchievements
					,[TypeOfDirectorship] = @TypeOfDirectorship
					,[AdditionalRolesAndResponsibilities] = @AdditionalRolesAndResponsibilities
					,[IsDirectorship] = @IsDirectorship
					,[City] = @City
					,[CountryID] = @CountryId
					,[State] = @State
				WHERE
[MemberPositionId] = @MemberPositionId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberPositions_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberPositions_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberPositions_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the MemberPositions table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberPositions_Delete
(

	@MemberPositionId int   
)
AS


				DELETE FROM [dbo].[MemberPositions] WITH (ROWLOCK) 
				WHERE
					[MemberPositionId] = @MemberPositionId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberPositions_GetByMemberId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberPositions_GetByMemberId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberPositions_GetByMemberId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the MemberPositions table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberPositions_GetByMemberId
(

	@MemberId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[MemberPositionId],
					[LinkedInInternalPositionId],
					[Title],
					[Summary],
					[CompanyId],
					[CompanyName],
					[CompanyIndustry],
					[StartMonth],
					[StartYear],
					[EndMonth],
					[EndYear],
					[IsCurrent],
					[MemberID],
					[OrganisationWebsite],
					[ResponsibilitiesAndAchievements],
					[TypeOfDirectorship],
					[AdditionalRolesAndResponsibilities],
					[IsDirectorship],
					[City],
					[CountryID],
					[State]
				FROM
					[dbo].[MemberPositions]
				WHERE
					[MemberID] = @MemberId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberPositions_GetByMemberPositionId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberPositions_GetByMemberPositionId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberPositions_GetByMemberPositionId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the MemberPositions table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberPositions_GetByMemberPositionId
(

	@MemberPositionId int   
)
AS


				SELECT
					[MemberPositionId],
					[LinkedInInternalPositionId],
					[Title],
					[Summary],
					[CompanyId],
					[CompanyName],
					[CompanyIndustry],
					[StartMonth],
					[StartYear],
					[EndMonth],
					[EndYear],
					[IsCurrent],
					[MemberID],
					[OrganisationWebsite],
					[ResponsibilitiesAndAchievements],
					[TypeOfDirectorship],
					[AdditionalRolesAndResponsibilities],
					[IsDirectorship],
					[City],
					[CountryID],
					[State]
				FROM
					[dbo].[MemberPositions]
				WHERE
					[MemberPositionId] = @MemberPositionId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberPositions_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberPositions_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberPositions_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the MemberPositions table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberPositions_Find
(

	@SearchUsingOR bit   = null ,

	@MemberPositionId int   = null ,

	@LinkedInInternalPositionId int   = null ,

	@Title nvarchar (255)  = null ,

	@Summary nvarchar (MAX)  = null ,

	@CompanyId int   = null ,

	@CompanyName nvarchar (255)  = null ,

	@CompanyIndustry nvarchar (255)  = null ,

	@StartMonth int   = null ,

	@StartYear int   = null ,

	@EndMonth int   = null ,

	@EndYear int   = null ,

	@IsCurrent bit   = null ,

	@MemberId int   = null ,

	@OrganisationWebsite nvarchar (255)  = null ,

	@ResponsibilitiesAndAchievements nvarchar (MAX)  = null ,

	@TypeOfDirectorship nvarchar (255)  = null ,

	@AdditionalRolesAndResponsibilities nvarchar (500)  = null ,

	@IsDirectorship bit   = null ,

	@City nvarchar (100)  = null ,

	@CountryId int   = null ,

	@State nvarchar (100)  = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [MemberPositionId]
	, [LinkedInInternalPositionId]
	, [Title]
	, [Summary]
	, [CompanyId]
	, [CompanyName]
	, [CompanyIndustry]
	, [StartMonth]
	, [StartYear]
	, [EndMonth]
	, [EndYear]
	, [IsCurrent]
	, [MemberID]
	, [OrganisationWebsite]
	, [ResponsibilitiesAndAchievements]
	, [TypeOfDirectorship]
	, [AdditionalRolesAndResponsibilities]
	, [IsDirectorship]
	, [City]
	, [CountryID]
	, [State]
    FROM
	[dbo].[MemberPositions]
    WHERE 
	 ([MemberPositionId] = @MemberPositionId OR @MemberPositionId IS NULL)
	AND ([LinkedInInternalPositionId] = @LinkedInInternalPositionId OR @LinkedInInternalPositionId IS NULL)
	AND ([Title] = @Title OR @Title IS NULL)
	AND ([Summary] = @Summary OR @Summary IS NULL)
	AND ([CompanyId] = @CompanyId OR @CompanyId IS NULL)
	AND ([CompanyName] = @CompanyName OR @CompanyName IS NULL)
	AND ([CompanyIndustry] = @CompanyIndustry OR @CompanyIndustry IS NULL)
	AND ([StartMonth] = @StartMonth OR @StartMonth IS NULL)
	AND ([StartYear] = @StartYear OR @StartYear IS NULL)
	AND ([EndMonth] = @EndMonth OR @EndMonth IS NULL)
	AND ([EndYear] = @EndYear OR @EndYear IS NULL)
	AND ([IsCurrent] = @IsCurrent OR @IsCurrent IS NULL)
	AND ([MemberID] = @MemberId OR @MemberId IS NULL)
	AND ([OrganisationWebsite] = @OrganisationWebsite OR @OrganisationWebsite IS NULL)
	AND ([ResponsibilitiesAndAchievements] = @ResponsibilitiesAndAchievements OR @ResponsibilitiesAndAchievements IS NULL)
	AND ([TypeOfDirectorship] = @TypeOfDirectorship OR @TypeOfDirectorship IS NULL)
	AND ([AdditionalRolesAndResponsibilities] = @AdditionalRolesAndResponsibilities OR @AdditionalRolesAndResponsibilities IS NULL)
	AND ([IsDirectorship] = @IsDirectorship OR @IsDirectorship IS NULL)
	AND ([City] = @City OR @City IS NULL)
	AND ([CountryID] = @CountryId OR @CountryId IS NULL)
	AND ([State] = @State OR @State IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [MemberPositionId]
	, [LinkedInInternalPositionId]
	, [Title]
	, [Summary]
	, [CompanyId]
	, [CompanyName]
	, [CompanyIndustry]
	, [StartMonth]
	, [StartYear]
	, [EndMonth]
	, [EndYear]
	, [IsCurrent]
	, [MemberID]
	, [OrganisationWebsite]
	, [ResponsibilitiesAndAchievements]
	, [TypeOfDirectorship]
	, [AdditionalRolesAndResponsibilities]
	, [IsDirectorship]
	, [City]
	, [CountryID]
	, [State]
    FROM
	[dbo].[MemberPositions]
    WHERE 
	 ([MemberPositionId] = @MemberPositionId AND @MemberPositionId is not null)
	OR ([LinkedInInternalPositionId] = @LinkedInInternalPositionId AND @LinkedInInternalPositionId is not null)
	OR ([Title] = @Title AND @Title is not null)
	OR ([Summary] = @Summary AND @Summary is not null)
	OR ([CompanyId] = @CompanyId AND @CompanyId is not null)
	OR ([CompanyName] = @CompanyName AND @CompanyName is not null)
	OR ([CompanyIndustry] = @CompanyIndustry AND @CompanyIndustry is not null)
	OR ([StartMonth] = @StartMonth AND @StartMonth is not null)
	OR ([StartYear] = @StartYear AND @StartYear is not null)
	OR ([EndMonth] = @EndMonth AND @EndMonth is not null)
	OR ([EndYear] = @EndYear AND @EndYear is not null)
	OR ([IsCurrent] = @IsCurrent AND @IsCurrent is not null)
	OR ([MemberID] = @MemberId AND @MemberId is not null)
	OR ([OrganisationWebsite] = @OrganisationWebsite AND @OrganisationWebsite is not null)
	OR ([ResponsibilitiesAndAchievements] = @ResponsibilitiesAndAchievements AND @ResponsibilitiesAndAchievements is not null)
	OR ([TypeOfDirectorship] = @TypeOfDirectorship AND @TypeOfDirectorship is not null)
	OR ([AdditionalRolesAndResponsibilities] = @AdditionalRolesAndResponsibilities AND @AdditionalRolesAndResponsibilities is not null)
	OR ([IsDirectorship] = @IsDirectorship AND @IsDirectorship is not null)
	OR ([City] = @City AND @City is not null)
	OR ([CountryID] = @CountryId AND @CountryId is not null)
	OR ([State] = @State AND @State is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberStatus_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberStatus_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberStatus_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the MemberStatus table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberStatus_Get_List

AS


				
				SELECT
					[MemberStatusID],
					[SiteID],
					[MemberStatusName],
					[LastModifiedBy],
					[LastModified],
					[Sequence],
					[Valid]
				FROM
					[dbo].[MemberStatus]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberStatus_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberStatus_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberStatus_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the MemberStatus table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberStatus_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [MemberStatusID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([MemberStatusID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [MemberStatusID]'
				SET @SQL = @SQL + ' FROM [dbo].[MemberStatus]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[MemberStatusID], O.[SiteID], O.[MemberStatusName], O.[LastModifiedBy], O.[LastModified], O.[Sequence], O.[Valid]
				FROM
				    [dbo].[MemberStatus] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[MemberStatusID] = PageIndex.[MemberStatusID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[MemberStatus]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberStatus_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberStatus_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberStatus_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the MemberStatus table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberStatus_Insert
(

	@MemberStatusId int    OUTPUT,

	@SiteId int   ,

	@MemberStatusName nvarchar (512)  ,

	@LastModifiedBy int   ,

	@LastModified datetime   ,

	@Sequence int   ,

	@Valid bit   
)
AS


				
				INSERT INTO [dbo].[MemberStatus]
					(
					[SiteID]
					,[MemberStatusName]
					,[LastModifiedBy]
					,[LastModified]
					,[Sequence]
					,[Valid]
					)
				VALUES
					(
					@SiteId
					,@MemberStatusName
					,@LastModifiedBy
					,@LastModified
					,@Sequence
					,@Valid
					)
				
				-- Get the identity value
				SET @MemberStatusId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberStatus_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberStatus_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberStatus_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the MemberStatus table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberStatus_Update
(

	@MemberStatusId int   ,

	@SiteId int   ,

	@MemberStatusName nvarchar (512)  ,

	@LastModifiedBy int   ,

	@LastModified datetime   ,

	@Sequence int   ,

	@Valid bit   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[MemberStatus]
				SET
					[SiteID] = @SiteId
					,[MemberStatusName] = @MemberStatusName
					,[LastModifiedBy] = @LastModifiedBy
					,[LastModified] = @LastModified
					,[Sequence] = @Sequence
					,[Valid] = @Valid
				WHERE
[MemberStatusID] = @MemberStatusId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberStatus_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberStatus_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberStatus_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the MemberStatus table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberStatus_Delete
(

	@MemberStatusId int   
)
AS


				DELETE FROM [dbo].[MemberStatus] WITH (ROWLOCK) 
				WHERE
					[MemberStatusID] = @MemberStatusId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberStatus_GetByLastModifiedBy procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberStatus_GetByLastModifiedBy') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberStatus_GetByLastModifiedBy
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the MemberStatus table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberStatus_GetByLastModifiedBy
(

	@LastModifiedBy int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[MemberStatusID],
					[SiteID],
					[MemberStatusName],
					[LastModifiedBy],
					[LastModified],
					[Sequence],
					[Valid]
				FROM
					[dbo].[MemberStatus]
				WHERE
					[LastModifiedBy] = @LastModifiedBy
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberStatus_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberStatus_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberStatus_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the MemberStatus table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberStatus_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[MemberStatusID],
					[SiteID],
					[MemberStatusName],
					[LastModifiedBy],
					[LastModified],
					[Sequence],
					[Valid]
				FROM
					[dbo].[MemberStatus]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberStatus_GetByMemberStatusId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberStatus_GetByMemberStatusId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberStatus_GetByMemberStatusId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the MemberStatus table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberStatus_GetByMemberStatusId
(

	@MemberStatusId int   
)
AS


				SELECT
					[MemberStatusID],
					[SiteID],
					[MemberStatusName],
					[LastModifiedBy],
					[LastModified],
					[Sequence],
					[Valid]
				FROM
					[dbo].[MemberStatus]
				WHERE
					[MemberStatusID] = @MemberStatusId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberStatus_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberStatus_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberStatus_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the MemberStatus table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberStatus_Find
(

	@SearchUsingOR bit   = null ,

	@MemberStatusId int   = null ,

	@SiteId int   = null ,

	@MemberStatusName nvarchar (512)  = null ,

	@LastModifiedBy int   = null ,

	@LastModified datetime   = null ,

	@Sequence int   = null ,

	@Valid bit   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [MemberStatusID]
	, [SiteID]
	, [MemberStatusName]
	, [LastModifiedBy]
	, [LastModified]
	, [Sequence]
	, [Valid]
    FROM
	[dbo].[MemberStatus]
    WHERE 
	 ([MemberStatusID] = @MemberStatusId OR @MemberStatusId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([MemberStatusName] = @MemberStatusName OR @MemberStatusName IS NULL)
	AND ([LastModifiedBy] = @LastModifiedBy OR @LastModifiedBy IS NULL)
	AND ([LastModified] = @LastModified OR @LastModified IS NULL)
	AND ([Sequence] = @Sequence OR @Sequence IS NULL)
	AND ([Valid] = @Valid OR @Valid IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [MemberStatusID]
	, [SiteID]
	, [MemberStatusName]
	, [LastModifiedBy]
	, [LastModified]
	, [Sequence]
	, [Valid]
    FROM
	[dbo].[MemberStatus]
    WHERE 
	 ([MemberStatusID] = @MemberStatusId AND @MemberStatusId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([MemberStatusName] = @MemberStatusName AND @MemberStatusName is not null)
	OR ([LastModifiedBy] = @LastModifiedBy AND @LastModifiedBy is not null)
	OR ([LastModified] = @LastModified AND @LastModified is not null)
	OR ([Sequence] = @Sequence AND @Sequence is not null)
	OR ([Valid] = @Valid AND @Valid is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberQualification_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberQualification_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberQualification_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the MemberQualification table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberQualification_Get_List

AS


				
				SELECT
					[MemberQualificationId],
					[LinkedInInternalEducationId],
					[SchoolName],
					[FieldOfStudy],
					[StartYear],
					[EndYear],
					[Degree],
					[Activities],
					[Notes],
					[MemberID],
					[City],
					[CountryID],
					[QualificationLevelID],
					[QualificationLevelOther],
					[Major],
					[Present],
					[StartMonth],
					[EndMonth],
					[Graduated],
					[NonGraduatedCredits]
				FROM
					[dbo].[MemberQualification]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberQualification_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberQualification_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberQualification_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the MemberQualification table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberQualification_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [MemberQualificationId] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([MemberQualificationId])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [MemberQualificationId]'
				SET @SQL = @SQL + ' FROM [dbo].[MemberQualification]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[MemberQualificationId], O.[LinkedInInternalEducationId], O.[SchoolName], O.[FieldOfStudy], O.[StartYear], O.[EndYear], O.[Degree], O.[Activities], O.[Notes], O.[MemberID], O.[City], O.[CountryID], O.[QualificationLevelID], O.[QualificationLevelOther], O.[Major], O.[Present], O.[StartMonth], O.[EndMonth], O.[Graduated], O.[NonGraduatedCredits]
				FROM
				    [dbo].[MemberQualification] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[MemberQualificationId] = PageIndex.[MemberQualificationId]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[MemberQualification]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberQualification_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberQualification_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberQualification_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the MemberQualification table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberQualification_Insert
(

	@MemberQualificationId int    OUTPUT,

	@LinkedInInternalEducationId int   ,

	@SchoolName nvarchar (255)  ,

	@FieldOfStudy nvarchar (255)  ,

	@StartYear int   ,

	@EndYear int   ,

	@Degree nvarchar (255)  ,

	@Activities nvarchar (256)  ,

	@Notes nvarchar (MAX)  ,

	@MemberId int   ,

	@City nvarchar (100)  ,

	@CountryId int   ,

	@QualificationLevelId int   ,

	@QualificationLevelOther nvarchar (100)  ,

	@Major nvarchar (100)  ,

	@Present bit   ,

	@StartMonth int   ,

	@EndMonth int   ,

	@Graduated bit   ,

	@NonGraduatedCredits int   
)
AS


				
				INSERT INTO [dbo].[MemberQualification]
					(
					[LinkedInInternalEducationId]
					,[SchoolName]
					,[FieldOfStudy]
					,[StartYear]
					,[EndYear]
					,[Degree]
					,[Activities]
					,[Notes]
					,[MemberID]
					,[City]
					,[CountryID]
					,[QualificationLevelID]
					,[QualificationLevelOther]
					,[Major]
					,[Present]
					,[StartMonth]
					,[EndMonth]
					,[Graduated]
					,[NonGraduatedCredits]
					)
				VALUES
					(
					@LinkedInInternalEducationId
					,@SchoolName
					,@FieldOfStudy
					,@StartYear
					,@EndYear
					,@Degree
					,@Activities
					,@Notes
					,@MemberId
					,@City
					,@CountryId
					,@QualificationLevelId
					,@QualificationLevelOther
					,@Major
					,@Present
					,@StartMonth
					,@EndMonth
					,@Graduated
					,@NonGraduatedCredits
					)
				
				-- Get the identity value
				SET @MemberQualificationId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberQualification_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberQualification_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberQualification_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the MemberQualification table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberQualification_Update
(

	@MemberQualificationId int   ,

	@LinkedInInternalEducationId int   ,

	@SchoolName nvarchar (255)  ,

	@FieldOfStudy nvarchar (255)  ,

	@StartYear int   ,

	@EndYear int   ,

	@Degree nvarchar (255)  ,

	@Activities nvarchar (256)  ,

	@Notes nvarchar (MAX)  ,

	@MemberId int   ,

	@City nvarchar (100)  ,

	@CountryId int   ,

	@QualificationLevelId int   ,

	@QualificationLevelOther nvarchar (100)  ,

	@Major nvarchar (100)  ,

	@Present bit   ,

	@StartMonth int   ,

	@EndMonth int   ,

	@Graduated bit   ,

	@NonGraduatedCredits int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[MemberQualification]
				SET
					[LinkedInInternalEducationId] = @LinkedInInternalEducationId
					,[SchoolName] = @SchoolName
					,[FieldOfStudy] = @FieldOfStudy
					,[StartYear] = @StartYear
					,[EndYear] = @EndYear
					,[Degree] = @Degree
					,[Activities] = @Activities
					,[Notes] = @Notes
					,[MemberID] = @MemberId
					,[City] = @City
					,[CountryID] = @CountryId
					,[QualificationLevelID] = @QualificationLevelId
					,[QualificationLevelOther] = @QualificationLevelOther
					,[Major] = @Major
					,[Present] = @Present
					,[StartMonth] = @StartMonth
					,[EndMonth] = @EndMonth
					,[Graduated] = @Graduated
					,[NonGraduatedCredits] = @NonGraduatedCredits
				WHERE
[MemberQualificationId] = @MemberQualificationId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberQualification_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberQualification_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberQualification_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the MemberQualification table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberQualification_Delete
(

	@MemberQualificationId int   
)
AS


				DELETE FROM [dbo].[MemberQualification] WITH (ROWLOCK) 
				WHERE
					[MemberQualificationId] = @MemberQualificationId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberQualification_GetByMemberId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberQualification_GetByMemberId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberQualification_GetByMemberId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the MemberQualification table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberQualification_GetByMemberId
(

	@MemberId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[MemberQualificationId],
					[LinkedInInternalEducationId],
					[SchoolName],
					[FieldOfStudy],
					[StartYear],
					[EndYear],
					[Degree],
					[Activities],
					[Notes],
					[MemberID],
					[City],
					[CountryID],
					[QualificationLevelID],
					[QualificationLevelOther],
					[Major],
					[Present],
					[StartMonth],
					[EndMonth],
					[Graduated],
					[NonGraduatedCredits]
				FROM
					[dbo].[MemberQualification]
				WHERE
					[MemberID] = @MemberId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberQualification_GetByMemberQualificationId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberQualification_GetByMemberQualificationId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberQualification_GetByMemberQualificationId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the MemberQualification table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberQualification_GetByMemberQualificationId
(

	@MemberQualificationId int   
)
AS


				SELECT
					[MemberQualificationId],
					[LinkedInInternalEducationId],
					[SchoolName],
					[FieldOfStudy],
					[StartYear],
					[EndYear],
					[Degree],
					[Activities],
					[Notes],
					[MemberID],
					[City],
					[CountryID],
					[QualificationLevelID],
					[QualificationLevelOther],
					[Major],
					[Present],
					[StartMonth],
					[EndMonth],
					[Graduated],
					[NonGraduatedCredits]
				FROM
					[dbo].[MemberQualification]
				WHERE
					[MemberQualificationId] = @MemberQualificationId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberQualification_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberQualification_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberQualification_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the MemberQualification table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberQualification_Find
(

	@SearchUsingOR bit   = null ,

	@MemberQualificationId int   = null ,

	@LinkedInInternalEducationId int   = null ,

	@SchoolName nvarchar (255)  = null ,

	@FieldOfStudy nvarchar (255)  = null ,

	@StartYear int   = null ,

	@EndYear int   = null ,

	@Degree nvarchar (255)  = null ,

	@Activities nvarchar (256)  = null ,

	@Notes nvarchar (MAX)  = null ,

	@MemberId int   = null ,

	@City nvarchar (100)  = null ,

	@CountryId int   = null ,

	@QualificationLevelId int   = null ,

	@QualificationLevelOther nvarchar (100)  = null ,

	@Major nvarchar (100)  = null ,

	@Present bit   = null ,

	@StartMonth int   = null ,

	@EndMonth int   = null ,

	@Graduated bit   = null ,

	@NonGraduatedCredits int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [MemberQualificationId]
	, [LinkedInInternalEducationId]
	, [SchoolName]
	, [FieldOfStudy]
	, [StartYear]
	, [EndYear]
	, [Degree]
	, [Activities]
	, [Notes]
	, [MemberID]
	, [City]
	, [CountryID]
	, [QualificationLevelID]
	, [QualificationLevelOther]
	, [Major]
	, [Present]
	, [StartMonth]
	, [EndMonth]
	, [Graduated]
	, [NonGraduatedCredits]
    FROM
	[dbo].[MemberQualification]
    WHERE 
	 ([MemberQualificationId] = @MemberQualificationId OR @MemberQualificationId IS NULL)
	AND ([LinkedInInternalEducationId] = @LinkedInInternalEducationId OR @LinkedInInternalEducationId IS NULL)
	AND ([SchoolName] = @SchoolName OR @SchoolName IS NULL)
	AND ([FieldOfStudy] = @FieldOfStudy OR @FieldOfStudy IS NULL)
	AND ([StartYear] = @StartYear OR @StartYear IS NULL)
	AND ([EndYear] = @EndYear OR @EndYear IS NULL)
	AND ([Degree] = @Degree OR @Degree IS NULL)
	AND ([Activities] = @Activities OR @Activities IS NULL)
	AND ([Notes] = @Notes OR @Notes IS NULL)
	AND ([MemberID] = @MemberId OR @MemberId IS NULL)
	AND ([City] = @City OR @City IS NULL)
	AND ([CountryID] = @CountryId OR @CountryId IS NULL)
	AND ([QualificationLevelID] = @QualificationLevelId OR @QualificationLevelId IS NULL)
	AND ([QualificationLevelOther] = @QualificationLevelOther OR @QualificationLevelOther IS NULL)
	AND ([Major] = @Major OR @Major IS NULL)
	AND ([Present] = @Present OR @Present IS NULL)
	AND ([StartMonth] = @StartMonth OR @StartMonth IS NULL)
	AND ([EndMonth] = @EndMonth OR @EndMonth IS NULL)
	AND ([Graduated] = @Graduated OR @Graduated IS NULL)
	AND ([NonGraduatedCredits] = @NonGraduatedCredits OR @NonGraduatedCredits IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [MemberQualificationId]
	, [LinkedInInternalEducationId]
	, [SchoolName]
	, [FieldOfStudy]
	, [StartYear]
	, [EndYear]
	, [Degree]
	, [Activities]
	, [Notes]
	, [MemberID]
	, [City]
	, [CountryID]
	, [QualificationLevelID]
	, [QualificationLevelOther]
	, [Major]
	, [Present]
	, [StartMonth]
	, [EndMonth]
	, [Graduated]
	, [NonGraduatedCredits]
    FROM
	[dbo].[MemberQualification]
    WHERE 
	 ([MemberQualificationId] = @MemberQualificationId AND @MemberQualificationId is not null)
	OR ([LinkedInInternalEducationId] = @LinkedInInternalEducationId AND @LinkedInInternalEducationId is not null)
	OR ([SchoolName] = @SchoolName AND @SchoolName is not null)
	OR ([FieldOfStudy] = @FieldOfStudy AND @FieldOfStudy is not null)
	OR ([StartYear] = @StartYear AND @StartYear is not null)
	OR ([EndYear] = @EndYear AND @EndYear is not null)
	OR ([Degree] = @Degree AND @Degree is not null)
	OR ([Activities] = @Activities AND @Activities is not null)
	OR ([Notes] = @Notes AND @Notes is not null)
	OR ([MemberID] = @MemberId AND @MemberId is not null)
	OR ([City] = @City AND @City is not null)
	OR ([CountryID] = @CountryId AND @CountryId is not null)
	OR ([QualificationLevelID] = @QualificationLevelId AND @QualificationLevelId is not null)
	OR ([QualificationLevelOther] = @QualificationLevelOther AND @QualificationLevelOther is not null)
	OR ([Major] = @Major AND @Major is not null)
	OR ([Present] = @Present AND @Present is not null)
	OR ([StartMonth] = @StartMonth AND @StartMonth is not null)
	OR ([EndMonth] = @EndMonth AND @EndMonth is not null)
	OR ([Graduated] = @Graduated AND @Graduated is not null)
	OR ([NonGraduatedCredits] = @NonGraduatedCredits AND @NonGraduatedCredits is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserAccountStatus_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserAccountStatus_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserAccountStatus_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the AdvertiserAccountStatus table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserAccountStatus_Get_List

AS


				
				SELECT
					[AdvertiserAccountStatusID],
					[AdvertiserAccountStatusName]
				FROM
					[dbo].[AdvertiserAccountStatus]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserAccountStatus_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserAccountStatus_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserAccountStatus_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the AdvertiserAccountStatus table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserAccountStatus_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [AdvertiserAccountStatusID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([AdvertiserAccountStatusID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [AdvertiserAccountStatusID]'
				SET @SQL = @SQL + ' FROM [dbo].[AdvertiserAccountStatus]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[AdvertiserAccountStatusID], O.[AdvertiserAccountStatusName]
				FROM
				    [dbo].[AdvertiserAccountStatus] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[AdvertiserAccountStatusID] = PageIndex.[AdvertiserAccountStatusID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[AdvertiserAccountStatus]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserAccountStatus_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserAccountStatus_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserAccountStatus_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the AdvertiserAccountStatus table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserAccountStatus_Insert
(

	@AdvertiserAccountStatusId int    OUTPUT,

	@AdvertiserAccountStatusName varchar (255)  
)
AS


				
				INSERT INTO [dbo].[AdvertiserAccountStatus]
					(
					[AdvertiserAccountStatusName]
					)
				VALUES
					(
					@AdvertiserAccountStatusName
					)
				
				-- Get the identity value
				SET @AdvertiserAccountStatusId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserAccountStatus_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserAccountStatus_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserAccountStatus_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the AdvertiserAccountStatus table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserAccountStatus_Update
(

	@AdvertiserAccountStatusId int   ,

	@AdvertiserAccountStatusName varchar (255)  
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[AdvertiserAccountStatus]
				SET
					[AdvertiserAccountStatusName] = @AdvertiserAccountStatusName
				WHERE
[AdvertiserAccountStatusID] = @AdvertiserAccountStatusId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserAccountStatus_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserAccountStatus_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserAccountStatus_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the AdvertiserAccountStatus table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserAccountStatus_Delete
(

	@AdvertiserAccountStatusId int   
)
AS


				DELETE FROM [dbo].[AdvertiserAccountStatus] WITH (ROWLOCK) 
				WHERE
					[AdvertiserAccountStatusID] = @AdvertiserAccountStatusId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserAccountStatus_GetByAdvertiserAccountStatusId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserAccountStatus_GetByAdvertiserAccountStatusId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserAccountStatus_GetByAdvertiserAccountStatusId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the AdvertiserAccountStatus table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserAccountStatus_GetByAdvertiserAccountStatusId
(

	@AdvertiserAccountStatusId int   
)
AS


				SELECT
					[AdvertiserAccountStatusID],
					[AdvertiserAccountStatusName]
				FROM
					[dbo].[AdvertiserAccountStatus]
				WHERE
					[AdvertiserAccountStatusID] = @AdvertiserAccountStatusId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserAccountStatus_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserAccountStatus_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserAccountStatus_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the AdvertiserAccountStatus table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserAccountStatus_Find
(

	@SearchUsingOR bit   = null ,

	@AdvertiserAccountStatusId int   = null ,

	@AdvertiserAccountStatusName varchar (255)  = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [AdvertiserAccountStatusID]
	, [AdvertiserAccountStatusName]
    FROM
	[dbo].[AdvertiserAccountStatus]
    WHERE 
	 ([AdvertiserAccountStatusID] = @AdvertiserAccountStatusId OR @AdvertiserAccountStatusId IS NULL)
	AND ([AdvertiserAccountStatusName] = @AdvertiserAccountStatusName OR @AdvertiserAccountStatusName IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [AdvertiserAccountStatusID]
	, [AdvertiserAccountStatusName]
    FROM
	[dbo].[AdvertiserAccountStatus]
    WHERE 
	 ([AdvertiserAccountStatusID] = @AdvertiserAccountStatusId AND @AdvertiserAccountStatusId is not null)
	OR ([AdvertiserAccountStatusName] = @AdvertiserAccountStatusName AND @AdvertiserAccountStatusName is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberReferences_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberReferences_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberReferences_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the MemberReferences table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberReferences_Get_List

AS


				
				SELECT
					[MemberReferenceID],
					[MemberID],
					[MemberReferenceName],
					[JobTitle],
					[Company],
					[Phone],
					[Relationship],
					[LastModifiedDate],
					[ReferenceEmail]
				FROM
					[dbo].[MemberReferences]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberReferences_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberReferences_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberReferences_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the MemberReferences table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberReferences_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [MemberReferenceID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([MemberReferenceID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [MemberReferenceID]'
				SET @SQL = @SQL + ' FROM [dbo].[MemberReferences]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[MemberReferenceID], O.[MemberID], O.[MemberReferenceName], O.[JobTitle], O.[Company], O.[Phone], O.[Relationship], O.[LastModifiedDate], O.[ReferenceEmail]
				FROM
				    [dbo].[MemberReferences] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[MemberReferenceID] = PageIndex.[MemberReferenceID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[MemberReferences]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberReferences_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberReferences_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberReferences_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the MemberReferences table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberReferences_Insert
(

	@MemberReferenceId int    OUTPUT,

	@MemberId int   ,

	@MemberReferenceName nvarchar (100)  ,

	@JobTitle nvarchar (100)  ,

	@Company nvarchar (100)  ,

	@Phone nvarchar (100)  ,

	@Relationship int   ,

	@LastModifiedDate datetime   ,

	@ReferenceEmail varchar (255)  
)
AS


				
				INSERT INTO [dbo].[MemberReferences]
					(
					[MemberID]
					,[MemberReferenceName]
					,[JobTitle]
					,[Company]
					,[Phone]
					,[Relationship]
					,[LastModifiedDate]
					,[ReferenceEmail]
					)
				VALUES
					(
					@MemberId
					,@MemberReferenceName
					,@JobTitle
					,@Company
					,@Phone
					,@Relationship
					,@LastModifiedDate
					,@ReferenceEmail
					)
				
				-- Get the identity value
				SET @MemberReferenceId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberReferences_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberReferences_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberReferences_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the MemberReferences table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberReferences_Update
(

	@MemberReferenceId int   ,

	@MemberId int   ,

	@MemberReferenceName nvarchar (100)  ,

	@JobTitle nvarchar (100)  ,

	@Company nvarchar (100)  ,

	@Phone nvarchar (100)  ,

	@Relationship int   ,

	@LastModifiedDate datetime   ,

	@ReferenceEmail varchar (255)  
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[MemberReferences]
				SET
					[MemberID] = @MemberId
					,[MemberReferenceName] = @MemberReferenceName
					,[JobTitle] = @JobTitle
					,[Company] = @Company
					,[Phone] = @Phone
					,[Relationship] = @Relationship
					,[LastModifiedDate] = @LastModifiedDate
					,[ReferenceEmail] = @ReferenceEmail
				WHERE
[MemberReferenceID] = @MemberReferenceId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberReferences_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberReferences_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberReferences_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the MemberReferences table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberReferences_Delete
(

	@MemberReferenceId int   
)
AS


				DELETE FROM [dbo].[MemberReferences] WITH (ROWLOCK) 
				WHERE
					[MemberReferenceID] = @MemberReferenceId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberReferences_GetByMemberId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberReferences_GetByMemberId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberReferences_GetByMemberId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the MemberReferences table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberReferences_GetByMemberId
(

	@MemberId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[MemberReferenceID],
					[MemberID],
					[MemberReferenceName],
					[JobTitle],
					[Company],
					[Phone],
					[Relationship],
					[LastModifiedDate],
					[ReferenceEmail]
				FROM
					[dbo].[MemberReferences]
				WHERE
					[MemberID] = @MemberId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberReferences_GetByMemberReferenceId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberReferences_GetByMemberReferenceId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberReferences_GetByMemberReferenceId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the MemberReferences table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberReferences_GetByMemberReferenceId
(

	@MemberReferenceId int   
)
AS


				SELECT
					[MemberReferenceID],
					[MemberID],
					[MemberReferenceName],
					[JobTitle],
					[Company],
					[Phone],
					[Relationship],
					[LastModifiedDate],
					[ReferenceEmail]
				FROM
					[dbo].[MemberReferences]
				WHERE
					[MemberReferenceID] = @MemberReferenceId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberReferences_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberReferences_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberReferences_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the MemberReferences table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberReferences_Find
(

	@SearchUsingOR bit   = null ,

	@MemberReferenceId int   = null ,

	@MemberId int   = null ,

	@MemberReferenceName nvarchar (100)  = null ,

	@JobTitle nvarchar (100)  = null ,

	@Company nvarchar (100)  = null ,

	@Phone nvarchar (100)  = null ,

	@Relationship int   = null ,

	@LastModifiedDate datetime   = null ,

	@ReferenceEmail varchar (255)  = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [MemberReferenceID]
	, [MemberID]
	, [MemberReferenceName]
	, [JobTitle]
	, [Company]
	, [Phone]
	, [Relationship]
	, [LastModifiedDate]
	, [ReferenceEmail]
    FROM
	[dbo].[MemberReferences]
    WHERE 
	 ([MemberReferenceID] = @MemberReferenceId OR @MemberReferenceId IS NULL)
	AND ([MemberID] = @MemberId OR @MemberId IS NULL)
	AND ([MemberReferenceName] = @MemberReferenceName OR @MemberReferenceName IS NULL)
	AND ([JobTitle] = @JobTitle OR @JobTitle IS NULL)
	AND ([Company] = @Company OR @Company IS NULL)
	AND ([Phone] = @Phone OR @Phone IS NULL)
	AND ([Relationship] = @Relationship OR @Relationship IS NULL)
	AND ([LastModifiedDate] = @LastModifiedDate OR @LastModifiedDate IS NULL)
	AND ([ReferenceEmail] = @ReferenceEmail OR @ReferenceEmail IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [MemberReferenceID]
	, [MemberID]
	, [MemberReferenceName]
	, [JobTitle]
	, [Company]
	, [Phone]
	, [Relationship]
	, [LastModifiedDate]
	, [ReferenceEmail]
    FROM
	[dbo].[MemberReferences]
    WHERE 
	 ([MemberReferenceID] = @MemberReferenceId AND @MemberReferenceId is not null)
	OR ([MemberID] = @MemberId AND @MemberId is not null)
	OR ([MemberReferenceName] = @MemberReferenceName AND @MemberReferenceName is not null)
	OR ([JobTitle] = @JobTitle AND @JobTitle is not null)
	OR ([Company] = @Company AND @Company is not null)
	OR ([Phone] = @Phone AND @Phone is not null)
	OR ([Relationship] = @Relationship AND @Relationship is not null)
	OR ([LastModifiedDate] = @LastModifiedDate AND @LastModifiedDate is not null)
	OR ([ReferenceEmail] = @ReferenceEmail AND @ReferenceEmail is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteAdvertiserFilter_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteAdvertiserFilter_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteAdvertiserFilter_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the SiteAdvertiserFilter table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteAdvertiserFilter_Get_List

AS


				
				SELECT
					[SiteAdvertiserFilterID],
					[SiteID],
					[AdvertiserID],
					[Status]
				FROM
					[dbo].[SiteAdvertiserFilter]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteAdvertiserFilter_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteAdvertiserFilter_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteAdvertiserFilter_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the SiteAdvertiserFilter table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteAdvertiserFilter_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [SiteAdvertiserFilterID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([SiteAdvertiserFilterID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [SiteAdvertiserFilterID]'
				SET @SQL = @SQL + ' FROM [dbo].[SiteAdvertiserFilter]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[SiteAdvertiserFilterID], O.[SiteID], O.[AdvertiserID], O.[Status]
				FROM
				    [dbo].[SiteAdvertiserFilter] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[SiteAdvertiserFilterID] = PageIndex.[SiteAdvertiserFilterID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[SiteAdvertiserFilter]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteAdvertiserFilter_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteAdvertiserFilter_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteAdvertiserFilter_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the SiteAdvertiserFilter table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteAdvertiserFilter_Insert
(

	@SiteAdvertiserFilterId int    OUTPUT,

	@SiteId int   ,

	@AdvertiserId int   ,

	@Status int   
)
AS


				
				INSERT INTO [dbo].[SiteAdvertiserFilter]
					(
					[SiteID]
					,[AdvertiserID]
					,[Status]
					)
				VALUES
					(
					@SiteId
					,@AdvertiserId
					,@Status
					)
				
				-- Get the identity value
				SET @SiteAdvertiserFilterId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteAdvertiserFilter_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteAdvertiserFilter_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteAdvertiserFilter_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the SiteAdvertiserFilter table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteAdvertiserFilter_Update
(

	@SiteAdvertiserFilterId int   ,

	@SiteId int   ,

	@AdvertiserId int   ,

	@Status int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[SiteAdvertiserFilter]
				SET
					[SiteID] = @SiteId
					,[AdvertiserID] = @AdvertiserId
					,[Status] = @Status
				WHERE
[SiteAdvertiserFilterID] = @SiteAdvertiserFilterId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteAdvertiserFilter_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteAdvertiserFilter_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteAdvertiserFilter_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the SiteAdvertiserFilter table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteAdvertiserFilter_Delete
(

	@SiteAdvertiserFilterId int   
)
AS


				DELETE FROM [dbo].[SiteAdvertiserFilter] WITH (ROWLOCK) 
				WHERE
					[SiteAdvertiserFilterID] = @SiteAdvertiserFilterId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteAdvertiserFilter_GetByAdvertiserId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteAdvertiserFilter_GetByAdvertiserId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteAdvertiserFilter_GetByAdvertiserId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteAdvertiserFilter table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteAdvertiserFilter_GetByAdvertiserId
(

	@AdvertiserId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[SiteAdvertiserFilterID],
					[SiteID],
					[AdvertiserID],
					[Status]
				FROM
					[dbo].[SiteAdvertiserFilter]
				WHERE
					[AdvertiserID] = @AdvertiserId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteAdvertiserFilter_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteAdvertiserFilter_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteAdvertiserFilter_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteAdvertiserFilter table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteAdvertiserFilter_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[SiteAdvertiserFilterID],
					[SiteID],
					[AdvertiserID],
					[Status]
				FROM
					[dbo].[SiteAdvertiserFilter]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteAdvertiserFilter_GetBySiteIdAdvertiserId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteAdvertiserFilter_GetBySiteIdAdvertiserId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteAdvertiserFilter_GetBySiteIdAdvertiserId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteAdvertiserFilter table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteAdvertiserFilter_GetBySiteIdAdvertiserId
(

	@SiteId int   ,

	@AdvertiserId int   
)
AS


				SELECT
					[SiteAdvertiserFilterID],
					[SiteID],
					[AdvertiserID],
					[Status]
				FROM
					[dbo].[SiteAdvertiserFilter]
				WHERE
					[SiteID] = @SiteId
					AND [AdvertiserID] = @AdvertiserId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteAdvertiserFilter_GetBySiteAdvertiserFilterId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteAdvertiserFilter_GetBySiteAdvertiserFilterId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteAdvertiserFilter_GetBySiteAdvertiserFilterId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteAdvertiserFilter table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteAdvertiserFilter_GetBySiteAdvertiserFilterId
(

	@SiteAdvertiserFilterId int   
)
AS


				SELECT
					[SiteAdvertiserFilterID],
					[SiteID],
					[AdvertiserID],
					[Status]
				FROM
					[dbo].[SiteAdvertiserFilter]
				WHERE
					[SiteAdvertiserFilterID] = @SiteAdvertiserFilterId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteAdvertiserFilter_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteAdvertiserFilter_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteAdvertiserFilter_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the SiteAdvertiserFilter table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteAdvertiserFilter_Find
(

	@SearchUsingOR bit   = null ,

	@SiteAdvertiserFilterId int   = null ,

	@SiteId int   = null ,

	@AdvertiserId int   = null ,

	@Status int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [SiteAdvertiserFilterID]
	, [SiteID]
	, [AdvertiserID]
	, [Status]
    FROM
	[dbo].[SiteAdvertiserFilter]
    WHERE 
	 ([SiteAdvertiserFilterID] = @SiteAdvertiserFilterId OR @SiteAdvertiserFilterId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([AdvertiserID] = @AdvertiserId OR @AdvertiserId IS NULL)
	AND ([Status] = @Status OR @Status IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [SiteAdvertiserFilterID]
	, [SiteID]
	, [AdvertiserID]
	, [Status]
    FROM
	[dbo].[SiteAdvertiserFilter]
    WHERE 
	 ([SiteAdvertiserFilterID] = @SiteAdvertiserFilterId AND @SiteAdvertiserFilterId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([AdvertiserID] = @AdvertiserId AND @AdvertiserId is not null)
	OR ([Status] = @Status AND @Status is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteSalaryType_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteSalaryType_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteSalaryType_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the SiteSalaryType table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteSalaryType_Get_List

AS


				
				SELECT
					[SiteSalaryTypeID],
					[SalaryTypeID],
					[SiteID],
					[SalaryTypeName],
					[Valid],
					[Sequence]
				FROM
					[dbo].[SiteSalaryType]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteSalaryType_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteSalaryType_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteSalaryType_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the SiteSalaryType table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteSalaryType_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [SiteSalaryTypeID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([SiteSalaryTypeID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [SiteSalaryTypeID]'
				SET @SQL = @SQL + ' FROM [dbo].[SiteSalaryType]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[SiteSalaryTypeID], O.[SalaryTypeID], O.[SiteID], O.[SalaryTypeName], O.[Valid], O.[Sequence]
				FROM
				    [dbo].[SiteSalaryType] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[SiteSalaryTypeID] = PageIndex.[SiteSalaryTypeID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[SiteSalaryType]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteSalaryType_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteSalaryType_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteSalaryType_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the SiteSalaryType table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteSalaryType_Insert
(

	@SiteSalaryTypeId int    OUTPUT,

	@SalaryTypeId int   ,

	@SiteId int   ,

	@SalaryTypeName nvarchar (510)  ,

	@Valid bit   ,

	@Sequence int   
)
AS


				
				INSERT INTO [dbo].[SiteSalaryType]
					(
					[SalaryTypeID]
					,[SiteID]
					,[SalaryTypeName]
					,[Valid]
					,[Sequence]
					)
				VALUES
					(
					@SalaryTypeId
					,@SiteId
					,@SalaryTypeName
					,@Valid
					,@Sequence
					)
				
				-- Get the identity value
				SET @SiteSalaryTypeId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteSalaryType_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteSalaryType_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteSalaryType_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the SiteSalaryType table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteSalaryType_Update
(

	@SiteSalaryTypeId int   ,

	@SalaryTypeId int   ,

	@SiteId int   ,

	@SalaryTypeName nvarchar (510)  ,

	@Valid bit   ,

	@Sequence int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[SiteSalaryType]
				SET
					[SalaryTypeID] = @SalaryTypeId
					,[SiteID] = @SiteId
					,[SalaryTypeName] = @SalaryTypeName
					,[Valid] = @Valid
					,[Sequence] = @Sequence
				WHERE
[SiteSalaryTypeID] = @SiteSalaryTypeId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteSalaryType_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteSalaryType_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteSalaryType_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the SiteSalaryType table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteSalaryType_Delete
(

	@SiteSalaryTypeId int   
)
AS


				DELETE FROM [dbo].[SiteSalaryType] WITH (ROWLOCK) 
				WHERE
					[SiteSalaryTypeID] = @SiteSalaryTypeId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteSalaryType_GetBySalaryTypeId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteSalaryType_GetBySalaryTypeId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteSalaryType_GetBySalaryTypeId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteSalaryType table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteSalaryType_GetBySalaryTypeId
(

	@SalaryTypeId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[SiteSalaryTypeID],
					[SalaryTypeID],
					[SiteID],
					[SalaryTypeName],
					[Valid],
					[Sequence]
				FROM
					[dbo].[SiteSalaryType]
				WHERE
					[SalaryTypeID] = @SalaryTypeId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteSalaryType_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteSalaryType_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteSalaryType_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteSalaryType table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteSalaryType_GetBySiteId
(

	@SiteId int   
)
AS


				SELECT
					[SiteSalaryTypeID],
					[SalaryTypeID],
					[SiteID],
					[SalaryTypeName],
					[Valid],
					[Sequence]
				FROM
					[dbo].[SiteSalaryType]
				WHERE
					[SiteID] = @SiteId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteSalaryType_GetBySiteSalaryTypeId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteSalaryType_GetBySiteSalaryTypeId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteSalaryType_GetBySiteSalaryTypeId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteSalaryType table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteSalaryType_GetBySiteSalaryTypeId
(

	@SiteSalaryTypeId int   
)
AS


				SELECT
					[SiteSalaryTypeID],
					[SalaryTypeID],
					[SiteID],
					[SalaryTypeName],
					[Valid],
					[Sequence]
				FROM
					[dbo].[SiteSalaryType]
				WHERE
					[SiteSalaryTypeID] = @SiteSalaryTypeId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteSalaryType_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteSalaryType_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteSalaryType_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the SiteSalaryType table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteSalaryType_Find
(

	@SearchUsingOR bit   = null ,

	@SiteSalaryTypeId int   = null ,

	@SalaryTypeId int   = null ,

	@SiteId int   = null ,

	@SalaryTypeName nvarchar (510)  = null ,

	@Valid bit   = null ,

	@Sequence int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [SiteSalaryTypeID]
	, [SalaryTypeID]
	, [SiteID]
	, [SalaryTypeName]
	, [Valid]
	, [Sequence]
    FROM
	[dbo].[SiteSalaryType]
    WHERE 
	 ([SiteSalaryTypeID] = @SiteSalaryTypeId OR @SiteSalaryTypeId IS NULL)
	AND ([SalaryTypeID] = @SalaryTypeId OR @SalaryTypeId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([SalaryTypeName] = @SalaryTypeName OR @SalaryTypeName IS NULL)
	AND ([Valid] = @Valid OR @Valid IS NULL)
	AND ([Sequence] = @Sequence OR @Sequence IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [SiteSalaryTypeID]
	, [SalaryTypeID]
	, [SiteID]
	, [SalaryTypeName]
	, [Valid]
	, [Sequence]
    FROM
	[dbo].[SiteSalaryType]
    WHERE 
	 ([SiteSalaryTypeID] = @SiteSalaryTypeId AND @SiteSalaryTypeId is not null)
	OR ([SalaryTypeID] = @SalaryTypeId AND @SalaryTypeId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([SalaryTypeName] = @SalaryTypeName AND @SalaryTypeName is not null)
	OR ([Valid] = @Valid AND @Valid is not null)
	OR ([Sequence] = @Sequence AND @Sequence is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteArea_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteArea_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteArea_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the SiteArea table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteArea_Get_List

AS


				
				SELECT
					[SiteAreaID],
					[AreaID],
					[SiteID],
					[SiteAreaName],
					[Valid]
				FROM
					[dbo].[SiteArea]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteArea_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteArea_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteArea_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the SiteArea table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteArea_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [SiteAreaID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([SiteAreaID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [SiteAreaID]'
				SET @SQL = @SQL + ' FROM [dbo].[SiteArea]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[SiteAreaID], O.[AreaID], O.[SiteID], O.[SiteAreaName], O.[Valid]
				FROM
				    [dbo].[SiteArea] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[SiteAreaID] = PageIndex.[SiteAreaID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[SiteArea]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteArea_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteArea_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteArea_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the SiteArea table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteArea_Insert
(

	@SiteAreaId int    OUTPUT,

	@AreaId int   ,

	@SiteId int   ,

	@SiteAreaName nvarchar (1020)  ,

	@Valid bit   
)
AS


				
				INSERT INTO [dbo].[SiteArea]
					(
					[AreaID]
					,[SiteID]
					,[SiteAreaName]
					,[Valid]
					)
				VALUES
					(
					@AreaId
					,@SiteId
					,@SiteAreaName
					,@Valid
					)
				
				-- Get the identity value
				SET @SiteAreaId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteArea_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteArea_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteArea_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the SiteArea table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteArea_Update
(

	@SiteAreaId int   ,

	@AreaId int   ,

	@SiteId int   ,

	@SiteAreaName nvarchar (1020)  ,

	@Valid bit   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[SiteArea]
				SET
					[AreaID] = @AreaId
					,[SiteID] = @SiteId
					,[SiteAreaName] = @SiteAreaName
					,[Valid] = @Valid
				WHERE
[SiteAreaID] = @SiteAreaId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteArea_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteArea_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteArea_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the SiteArea table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteArea_Delete
(

	@SiteAreaId int   
)
AS


				DELETE FROM [dbo].[SiteArea] WITH (ROWLOCK) 
				WHERE
					[SiteAreaID] = @SiteAreaId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteArea_GetByAreaId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteArea_GetByAreaId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteArea_GetByAreaId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteArea table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteArea_GetByAreaId
(

	@AreaId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[SiteAreaID],
					[AreaID],
					[SiteID],
					[SiteAreaName],
					[Valid]
				FROM
					[dbo].[SiteArea]
				WHERE
					[AreaID] = @AreaId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteArea_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteArea_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteArea_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteArea table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteArea_GetBySiteId
(

	@SiteId int   
)
AS


				SELECT
					[SiteAreaID],
					[AreaID],
					[SiteID],
					[SiteAreaName],
					[Valid]
				FROM
					[dbo].[SiteArea]
				WHERE
					[SiteID] = @SiteId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteArea_GetBySiteIdAreaId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteArea_GetBySiteIdAreaId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteArea_GetBySiteIdAreaId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteArea table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteArea_GetBySiteIdAreaId
(

	@SiteId int   ,

	@AreaId int   
)
AS


				SELECT
					[SiteAreaID],
					[AreaID],
					[SiteID],
					[SiteAreaName],
					[Valid]
				FROM
					[dbo].[SiteArea]
				WHERE
					[SiteID] = @SiteId
					AND [AreaID] = @AreaId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteArea_GetBySiteAreaId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteArea_GetBySiteAreaId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteArea_GetBySiteAreaId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteArea table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteArea_GetBySiteAreaId
(

	@SiteAreaId int   
)
AS


				SELECT
					[SiteAreaID],
					[AreaID],
					[SiteID],
					[SiteAreaName],
					[Valid]
				FROM
					[dbo].[SiteArea]
				WHERE
					[SiteAreaID] = @SiteAreaId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteArea_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteArea_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteArea_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the SiteArea table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteArea_Find
(

	@SearchUsingOR bit   = null ,

	@SiteAreaId int   = null ,

	@AreaId int   = null ,

	@SiteId int   = null ,

	@SiteAreaName nvarchar (1020)  = null ,

	@Valid bit   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [SiteAreaID]
	, [AreaID]
	, [SiteID]
	, [SiteAreaName]
	, [Valid]
    FROM
	[dbo].[SiteArea]
    WHERE 
	 ([SiteAreaID] = @SiteAreaId OR @SiteAreaId IS NULL)
	AND ([AreaID] = @AreaId OR @AreaId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([SiteAreaName] = @SiteAreaName OR @SiteAreaName IS NULL)
	AND ([Valid] = @Valid OR @Valid IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [SiteAreaID]
	, [AreaID]
	, [SiteID]
	, [SiteAreaName]
	, [Valid]
    FROM
	[dbo].[SiteArea]
    WHERE 
	 ([SiteAreaID] = @SiteAreaId AND @SiteAreaId is not null)
	OR ([AreaID] = @AreaId AND @AreaId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([SiteAreaName] = @SiteAreaName AND @SiteAreaName is not null)
	OR ([Valid] = @Valid AND @Valid is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteWebParts_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteWebParts_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteWebParts_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the SiteWebParts table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteWebParts_Get_List

AS


				
				SELECT
					[SiteWebPartID],
					[SiteID],
					[SiteWebPartName],
					[SiteWebPartTypeID],
					[SiteWebPartHTML],
					[SourceID]
				FROM
					[dbo].[SiteWebParts]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteWebParts_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteWebParts_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteWebParts_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the SiteWebParts table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteWebParts_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [SiteWebPartID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([SiteWebPartID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [SiteWebPartID]'
				SET @SQL = @SQL + ' FROM [dbo].[SiteWebParts]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[SiteWebPartID], O.[SiteID], O.[SiteWebPartName], O.[SiteWebPartTypeID], O.[SiteWebPartHTML], O.[SourceID]
				FROM
				    [dbo].[SiteWebParts] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[SiteWebPartID] = PageIndex.[SiteWebPartID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[SiteWebParts]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteWebParts_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteWebParts_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteWebParts_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the SiteWebParts table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteWebParts_Insert
(

	@SiteWebPartId int    OUTPUT,

	@SiteId int   ,

	@SiteWebPartName varchar (255)  ,

	@SiteWebPartTypeId int   ,

	@SiteWebPartHtml ntext   ,

	@SourceId int   
)
AS


				
				INSERT INTO [dbo].[SiteWebParts]
					(
					[SiteID]
					,[SiteWebPartName]
					,[SiteWebPartTypeID]
					,[SiteWebPartHTML]
					,[SourceID]
					)
				VALUES
					(
					@SiteId
					,@SiteWebPartName
					,@SiteWebPartTypeId
					,@SiteWebPartHtml
					,@SourceId
					)
				
				-- Get the identity value
				SET @SiteWebPartId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteWebParts_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteWebParts_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteWebParts_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the SiteWebParts table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteWebParts_Update
(

	@SiteWebPartId int   ,

	@SiteId int   ,

	@SiteWebPartName varchar (255)  ,

	@SiteWebPartTypeId int   ,

	@SiteWebPartHtml ntext   ,

	@SourceId int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[SiteWebParts]
				SET
					[SiteID] = @SiteId
					,[SiteWebPartName] = @SiteWebPartName
					,[SiteWebPartTypeID] = @SiteWebPartTypeId
					,[SiteWebPartHTML] = @SiteWebPartHtml
					,[SourceID] = @SourceId
				WHERE
[SiteWebPartID] = @SiteWebPartId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteWebParts_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteWebParts_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteWebParts_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the SiteWebParts table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteWebParts_Delete
(

	@SiteWebPartId int   
)
AS


				DELETE FROM [dbo].[SiteWebParts] WITH (ROWLOCK) 
				WHERE
					[SiteWebPartID] = @SiteWebPartId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteWebParts_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteWebParts_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteWebParts_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteWebParts table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteWebParts_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[SiteWebPartID],
					[SiteID],
					[SiteWebPartName],
					[SiteWebPartTypeID],
					[SiteWebPartHTML],
					[SourceID]
				FROM
					[dbo].[SiteWebParts]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteWebParts_GetBySiteWebPartTypeId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteWebParts_GetBySiteWebPartTypeId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteWebParts_GetBySiteWebPartTypeId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteWebParts table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteWebParts_GetBySiteWebPartTypeId
(

	@SiteWebPartTypeId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[SiteWebPartID],
					[SiteID],
					[SiteWebPartName],
					[SiteWebPartTypeID],
					[SiteWebPartHTML],
					[SourceID]
				FROM
					[dbo].[SiteWebParts]
				WHERE
					[SiteWebPartTypeID] = @SiteWebPartTypeId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteWebParts_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteWebParts_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteWebParts_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteWebParts table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteWebParts_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[SiteWebPartID],
					[SiteID],
					[SiteWebPartName],
					[SiteWebPartTypeID],
					[SiteWebPartHTML],
					[SourceID]
				FROM
					[dbo].[SiteWebParts]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteWebParts_GetBySiteWebPartTypeId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteWebParts_GetBySiteWebPartTypeId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteWebParts_GetBySiteWebPartTypeId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteWebParts table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteWebParts_GetBySiteWebPartTypeId
(

	@SiteWebPartTypeId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[SiteWebPartID],
					[SiteID],
					[SiteWebPartName],
					[SiteWebPartTypeID],
					[SiteWebPartHTML],
					[SourceID]
				FROM
					[dbo].[SiteWebParts]
				WHERE
					[SiteWebPartTypeID] = @SiteWebPartTypeId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteWebParts_GetBySiteWebPartId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteWebParts_GetBySiteWebPartId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteWebParts_GetBySiteWebPartId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteWebParts table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteWebParts_GetBySiteWebPartId
(

	@SiteWebPartId int   
)
AS


				SELECT
					[SiteWebPartID],
					[SiteID],
					[SiteWebPartName],
					[SiteWebPartTypeID],
					[SiteWebPartHTML],
					[SourceID]
				FROM
					[dbo].[SiteWebParts]
				WHERE
					[SiteWebPartID] = @SiteWebPartId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteWebParts_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteWebParts_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteWebParts_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the SiteWebParts table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteWebParts_Find
(

	@SearchUsingOR bit   = null ,

	@SiteWebPartId int   = null ,

	@SiteId int   = null ,

	@SiteWebPartName varchar (255)  = null ,

	@SiteWebPartTypeId int   = null ,

	@SiteWebPartHtml ntext   = null ,

	@SourceId int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [SiteWebPartID]
	, [SiteID]
	, [SiteWebPartName]
	, [SiteWebPartTypeID]
	, [SiteWebPartHTML]
	, [SourceID]
    FROM
	[dbo].[SiteWebParts]
    WHERE 
	 ([SiteWebPartID] = @SiteWebPartId OR @SiteWebPartId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([SiteWebPartName] = @SiteWebPartName OR @SiteWebPartName IS NULL)
	AND ([SiteWebPartTypeID] = @SiteWebPartTypeId OR @SiteWebPartTypeId IS NULL)
	AND ([SourceID] = @SourceId OR @SourceId IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [SiteWebPartID]
	, [SiteID]
	, [SiteWebPartName]
	, [SiteWebPartTypeID]
	, [SiteWebPartHTML]
	, [SourceID]
    FROM
	[dbo].[SiteWebParts]
    WHERE 
	 ([SiteWebPartID] = @SiteWebPartId AND @SiteWebPartId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([SiteWebPartName] = @SiteWebPartName AND @SiteWebPartName is not null)
	OR ([SiteWebPartTypeID] = @SiteWebPartTypeId AND @SiteWebPartTypeId is not null)
	OR ([SourceID] = @SourceId AND @SourceId is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Educations_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Educations_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Educations_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the Educations table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Educations_Get_List

AS


				
				SELECT
					[EducationID],
					[SiteID],
					[EducationParentID],
					[EducationName],
					[GlobalTemplate],
					[LastModifiedBy],
					[LastModified],
					[Sequence]
				FROM
					[dbo].[Educations]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Educations_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Educations_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Educations_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the Educations table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Educations_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [EducationID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([EducationID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [EducationID]'
				SET @SQL = @SQL + ' FROM [dbo].[Educations]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[EducationID], O.[SiteID], O.[EducationParentID], O.[EducationName], O.[GlobalTemplate], O.[LastModifiedBy], O.[LastModified], O.[Sequence]
				FROM
				    [dbo].[Educations] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[EducationID] = PageIndex.[EducationID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[Educations]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Educations_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Educations_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Educations_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the Educations table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Educations_Insert
(

	@EducationId int    OUTPUT,

	@SiteId int   ,

	@EducationParentId int   ,

	@EducationName nvarchar (512)  ,

	@GlobalTemplate bit   ,

	@LastModifiedBy int   ,

	@LastModified datetime   ,

	@Sequence int   
)
AS


				
				INSERT INTO [dbo].[Educations]
					(
					[SiteID]
					,[EducationParentID]
					,[EducationName]
					,[GlobalTemplate]
					,[LastModifiedBy]
					,[LastModified]
					,[Sequence]
					)
				VALUES
					(
					@SiteId
					,@EducationParentId
					,@EducationName
					,@GlobalTemplate
					,@LastModifiedBy
					,@LastModified
					,@Sequence
					)
				
				-- Get the identity value
				SET @EducationId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Educations_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Educations_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Educations_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the Educations table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Educations_Update
(

	@EducationId int   ,

	@SiteId int   ,

	@EducationParentId int   ,

	@EducationName nvarchar (512)  ,

	@GlobalTemplate bit   ,

	@LastModifiedBy int   ,

	@LastModified datetime   ,

	@Sequence int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[Educations]
				SET
					[SiteID] = @SiteId
					,[EducationParentID] = @EducationParentId
					,[EducationName] = @EducationName
					,[GlobalTemplate] = @GlobalTemplate
					,[LastModifiedBy] = @LastModifiedBy
					,[LastModified] = @LastModified
					,[Sequence] = @Sequence
				WHERE
[EducationID] = @EducationId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Educations_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Educations_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Educations_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the Educations table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Educations_Delete
(

	@EducationId int   
)
AS


				DELETE FROM [dbo].[Educations] WITH (ROWLOCK) 
				WHERE
					[EducationID] = @EducationId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Educations_GetByLastModifiedBy procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Educations_GetByLastModifiedBy') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Educations_GetByLastModifiedBy
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Educations table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Educations_GetByLastModifiedBy
(

	@LastModifiedBy int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[EducationID],
					[SiteID],
					[EducationParentID],
					[EducationName],
					[GlobalTemplate],
					[LastModifiedBy],
					[LastModified],
					[Sequence]
				FROM
					[dbo].[Educations]
				WHERE
					[LastModifiedBy] = @LastModifiedBy
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Educations_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Educations_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Educations_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Educations table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Educations_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[EducationID],
					[SiteID],
					[EducationParentID],
					[EducationName],
					[GlobalTemplate],
					[LastModifiedBy],
					[LastModified],
					[Sequence]
				FROM
					[dbo].[Educations]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Educations_GetByEducationId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Educations_GetByEducationId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Educations_GetByEducationId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Educations table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Educations_GetByEducationId
(

	@EducationId int   
)
AS


				SELECT
					[EducationID],
					[SiteID],
					[EducationParentID],
					[EducationName],
					[GlobalTemplate],
					[LastModifiedBy],
					[LastModified],
					[Sequence]
				FROM
					[dbo].[Educations]
				WHERE
					[EducationID] = @EducationId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Educations_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Educations_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Educations_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the Educations table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Educations_Find
(

	@SearchUsingOR bit   = null ,

	@EducationId int   = null ,

	@SiteId int   = null ,

	@EducationParentId int   = null ,

	@EducationName nvarchar (512)  = null ,

	@GlobalTemplate bit   = null ,

	@LastModifiedBy int   = null ,

	@LastModified datetime   = null ,

	@Sequence int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [EducationID]
	, [SiteID]
	, [EducationParentID]
	, [EducationName]
	, [GlobalTemplate]
	, [LastModifiedBy]
	, [LastModified]
	, [Sequence]
    FROM
	[dbo].[Educations]
    WHERE 
	 ([EducationID] = @EducationId OR @EducationId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([EducationParentID] = @EducationParentId OR @EducationParentId IS NULL)
	AND ([EducationName] = @EducationName OR @EducationName IS NULL)
	AND ([GlobalTemplate] = @GlobalTemplate OR @GlobalTemplate IS NULL)
	AND ([LastModifiedBy] = @LastModifiedBy OR @LastModifiedBy IS NULL)
	AND ([LastModified] = @LastModified OR @LastModified IS NULL)
	AND ([Sequence] = @Sequence OR @Sequence IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [EducationID]
	, [SiteID]
	, [EducationParentID]
	, [EducationName]
	, [GlobalTemplate]
	, [LastModifiedBy]
	, [LastModified]
	, [Sequence]
    FROM
	[dbo].[Educations]
    WHERE 
	 ([EducationID] = @EducationId AND @EducationId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([EducationParentID] = @EducationParentId AND @EducationParentId is not null)
	OR ([EducationName] = @EducationName AND @EducationName is not null)
	OR ([GlobalTemplate] = @GlobalTemplate AND @GlobalTemplate is not null)
	OR ([LastModifiedBy] = @LastModifiedBy AND @LastModifiedBy is not null)
	OR ([LastModified] = @LastModified AND @LastModified is not null)
	OR ([Sequence] = @Sequence AND @Sequence is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.WorkType_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.WorkType_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.WorkType_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the WorkType table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.WorkType_Get_List

AS


				
				SELECT
					[WorkTypeID],
					[WorkTypeName],
					[Valid]
				FROM
					[dbo].[WorkType]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.WorkType_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.WorkType_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.WorkType_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the WorkType table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.WorkType_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [WorkTypeID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([WorkTypeID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [WorkTypeID]'
				SET @SQL = @SQL + ' FROM [dbo].[WorkType]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[WorkTypeID], O.[WorkTypeName], O.[Valid]
				FROM
				    [dbo].[WorkType] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[WorkTypeID] = PageIndex.[WorkTypeID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[WorkType]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.WorkType_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.WorkType_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.WorkType_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the WorkType table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.WorkType_Insert
(

	@WorkTypeId int    OUTPUT,

	@WorkTypeName varchar (255)  ,

	@Valid bit   
)
AS


				
				INSERT INTO [dbo].[WorkType]
					(
					[WorkTypeName]
					,[Valid]
					)
				VALUES
					(
					@WorkTypeName
					,@Valid
					)
				
				-- Get the identity value
				SET @WorkTypeId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.WorkType_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.WorkType_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.WorkType_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the WorkType table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.WorkType_Update
(

	@WorkTypeId int   ,

	@WorkTypeName varchar (255)  ,

	@Valid bit   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[WorkType]
				SET
					[WorkTypeName] = @WorkTypeName
					,[Valid] = @Valid
				WHERE
[WorkTypeID] = @WorkTypeId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.WorkType_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.WorkType_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.WorkType_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the WorkType table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.WorkType_Delete
(

	@WorkTypeId int   
)
AS


				DELETE FROM [dbo].[WorkType] WITH (ROWLOCK) 
				WHERE
					[WorkTypeID] = @WorkTypeId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.WorkType_GetByWorkTypeId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.WorkType_GetByWorkTypeId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.WorkType_GetByWorkTypeId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the WorkType table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.WorkType_GetByWorkTypeId
(

	@WorkTypeId int   
)
AS


				SELECT
					[WorkTypeID],
					[WorkTypeName],
					[Valid]
				FROM
					[dbo].[WorkType]
				WHERE
					[WorkTypeID] = @WorkTypeId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.WorkType_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.WorkType_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.WorkType_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the WorkType table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.WorkType_Find
(

	@SearchUsingOR bit   = null ,

	@WorkTypeId int   = null ,

	@WorkTypeName varchar (255)  = null ,

	@Valid bit   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [WorkTypeID]
	, [WorkTypeName]
	, [Valid]
    FROM
	[dbo].[WorkType]
    WHERE 
	 ([WorkTypeID] = @WorkTypeId OR @WorkTypeId IS NULL)
	AND ([WorkTypeName] = @WorkTypeName OR @WorkTypeName IS NULL)
	AND ([Valid] = @Valid OR @Valid IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [WorkTypeID]
	, [WorkTypeName]
	, [Valid]
    FROM
	[dbo].[WorkType]
    WHERE 
	 ([WorkTypeID] = @WorkTypeId AND @WorkTypeId is not null)
	OR ([WorkTypeName] = @WorkTypeName AND @WorkTypeName is not null)
	OR ([Valid] = @Valid AND @Valid is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.WidgetContainers_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.WidgetContainers_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.WidgetContainers_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the WidgetContainers table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.WidgetContainers_Get_List

AS


				
				SELECT
					[WidgetID],
					[SiteID],
					[LanguageID],
					[WidgetName],
					[WidgetDomain],
					[WidgetContainerClass],
					[WidgetContainerHeaderClass],
					[WidgetItemClass],
					[WidgetJobLinkCSS],
					[WidgetItemLinkImageID],
					[Valid],
					[ShowJobs],
					[ShowCompanies],
					[ShowSite],
					[ShowPeople],
					[JobHtml],
					[CompanyHtml],
					[SiteHtml],
					[PeopleHtml],
					[Javascript],
					[SearchCSS],
					[DefaultProfessionID],
					[DefaultCountryID],
					[DefaultLocationID],
					[Width],
					[Height],
					[OnAdvancedSearch]
				FROM
					[dbo].[WidgetContainers]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.WidgetContainers_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.WidgetContainers_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.WidgetContainers_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the WidgetContainers table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.WidgetContainers_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [WidgetID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([WidgetID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [WidgetID]'
				SET @SQL = @SQL + ' FROM [dbo].[WidgetContainers]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[WidgetID], O.[SiteID], O.[LanguageID], O.[WidgetName], O.[WidgetDomain], O.[WidgetContainerClass], O.[WidgetContainerHeaderClass], O.[WidgetItemClass], O.[WidgetJobLinkCSS], O.[WidgetItemLinkImageID], O.[Valid], O.[ShowJobs], O.[ShowCompanies], O.[ShowSite], O.[ShowPeople], O.[JobHtml], O.[CompanyHtml], O.[SiteHtml], O.[PeopleHtml], O.[Javascript], O.[SearchCSS], O.[DefaultProfessionID], O.[DefaultCountryID], O.[DefaultLocationID], O.[Width], O.[Height], O.[OnAdvancedSearch]
				FROM
				    [dbo].[WidgetContainers] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[WidgetID] = PageIndex.[WidgetID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[WidgetContainers]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.WidgetContainers_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.WidgetContainers_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.WidgetContainers_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the WidgetContainers table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.WidgetContainers_Insert
(

	@WidgetId int    OUTPUT,

	@SiteId int   ,

	@LanguageId int   ,

	@WidgetName varchar (255)  ,

	@WidgetDomain varchar (255)  ,

	@WidgetContainerClass varchar (255)  ,

	@WidgetContainerHeaderClass varchar (255)  ,

	@WidgetItemClass varchar (255)  ,

	@WidgetJobLinkCss varchar (255)  ,

	@WidgetItemLinkImageId int   ,

	@Valid bit   ,

	@ShowJobs bit   ,

	@ShowCompanies bit   ,

	@ShowSite bit   ,

	@ShowPeople bit   ,

	@JobHtml nvarchar (MAX)  ,

	@CompanyHtml nvarchar (MAX)  ,

	@SiteHtml nvarchar (MAX)  ,

	@PeopleHtml nvarchar (MAX)  ,

	@Javascript varchar (MAX)  ,

	@SearchCss varchar (MAX)  ,

	@DefaultProfessionId int   ,

	@DefaultCountryId int   ,

	@DefaultLocationId int   ,

	@Width int   ,

	@Height int   ,

	@OnAdvancedSearch bit   
)
AS


				
				INSERT INTO [dbo].[WidgetContainers]
					(
					[SiteID]
					,[LanguageID]
					,[WidgetName]
					,[WidgetDomain]
					,[WidgetContainerClass]
					,[WidgetContainerHeaderClass]
					,[WidgetItemClass]
					,[WidgetJobLinkCSS]
					,[WidgetItemLinkImageID]
					,[Valid]
					,[ShowJobs]
					,[ShowCompanies]
					,[ShowSite]
					,[ShowPeople]
					,[JobHtml]
					,[CompanyHtml]
					,[SiteHtml]
					,[PeopleHtml]
					,[Javascript]
					,[SearchCSS]
					,[DefaultProfessionID]
					,[DefaultCountryID]
					,[DefaultLocationID]
					,[Width]
					,[Height]
					,[OnAdvancedSearch]
					)
				VALUES
					(
					@SiteId
					,@LanguageId
					,@WidgetName
					,@WidgetDomain
					,@WidgetContainerClass
					,@WidgetContainerHeaderClass
					,@WidgetItemClass
					,@WidgetJobLinkCss
					,@WidgetItemLinkImageId
					,@Valid
					,@ShowJobs
					,@ShowCompanies
					,@ShowSite
					,@ShowPeople
					,@JobHtml
					,@CompanyHtml
					,@SiteHtml
					,@PeopleHtml
					,@Javascript
					,@SearchCss
					,@DefaultProfessionId
					,@DefaultCountryId
					,@DefaultLocationId
					,@Width
					,@Height
					,@OnAdvancedSearch
					)
				
				-- Get the identity value
				SET @WidgetId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.WidgetContainers_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.WidgetContainers_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.WidgetContainers_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the WidgetContainers table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.WidgetContainers_Update
(

	@WidgetId int   ,

	@SiteId int   ,

	@LanguageId int   ,

	@WidgetName varchar (255)  ,

	@WidgetDomain varchar (255)  ,

	@WidgetContainerClass varchar (255)  ,

	@WidgetContainerHeaderClass varchar (255)  ,

	@WidgetItemClass varchar (255)  ,

	@WidgetJobLinkCss varchar (255)  ,

	@WidgetItemLinkImageId int   ,

	@Valid bit   ,

	@ShowJobs bit   ,

	@ShowCompanies bit   ,

	@ShowSite bit   ,

	@ShowPeople bit   ,

	@JobHtml nvarchar (MAX)  ,

	@CompanyHtml nvarchar (MAX)  ,

	@SiteHtml nvarchar (MAX)  ,

	@PeopleHtml nvarchar (MAX)  ,

	@Javascript varchar (MAX)  ,

	@SearchCss varchar (MAX)  ,

	@DefaultProfessionId int   ,

	@DefaultCountryId int   ,

	@DefaultLocationId int   ,

	@Width int   ,

	@Height int   ,

	@OnAdvancedSearch bit   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[WidgetContainers]
				SET
					[SiteID] = @SiteId
					,[LanguageID] = @LanguageId
					,[WidgetName] = @WidgetName
					,[WidgetDomain] = @WidgetDomain
					,[WidgetContainerClass] = @WidgetContainerClass
					,[WidgetContainerHeaderClass] = @WidgetContainerHeaderClass
					,[WidgetItemClass] = @WidgetItemClass
					,[WidgetJobLinkCSS] = @WidgetJobLinkCss
					,[WidgetItemLinkImageID] = @WidgetItemLinkImageId
					,[Valid] = @Valid
					,[ShowJobs] = @ShowJobs
					,[ShowCompanies] = @ShowCompanies
					,[ShowSite] = @ShowSite
					,[ShowPeople] = @ShowPeople
					,[JobHtml] = @JobHtml
					,[CompanyHtml] = @CompanyHtml
					,[SiteHtml] = @SiteHtml
					,[PeopleHtml] = @PeopleHtml
					,[Javascript] = @Javascript
					,[SearchCSS] = @SearchCss
					,[DefaultProfessionID] = @DefaultProfessionId
					,[DefaultCountryID] = @DefaultCountryId
					,[DefaultLocationID] = @DefaultLocationId
					,[Width] = @Width
					,[Height] = @Height
					,[OnAdvancedSearch] = @OnAdvancedSearch
				WHERE
[WidgetID] = @WidgetId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.WidgetContainers_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.WidgetContainers_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.WidgetContainers_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the WidgetContainers table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.WidgetContainers_Delete
(

	@WidgetId int   
)
AS


				DELETE FROM [dbo].[WidgetContainers] WITH (ROWLOCK) 
				WHERE
					[WidgetID] = @WidgetId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.WidgetContainers_GetByDefaultProfessionId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.WidgetContainers_GetByDefaultProfessionId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.WidgetContainers_GetByDefaultProfessionId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the WidgetContainers table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.WidgetContainers_GetByDefaultProfessionId
(

	@DefaultProfessionId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[WidgetID],
					[SiteID],
					[LanguageID],
					[WidgetName],
					[WidgetDomain],
					[WidgetContainerClass],
					[WidgetContainerHeaderClass],
					[WidgetItemClass],
					[WidgetJobLinkCSS],
					[WidgetItemLinkImageID],
					[Valid],
					[ShowJobs],
					[ShowCompanies],
					[ShowSite],
					[ShowPeople],
					[JobHtml],
					[CompanyHtml],
					[SiteHtml],
					[PeopleHtml],
					[Javascript],
					[SearchCSS],
					[DefaultProfessionID],
					[DefaultCountryID],
					[DefaultLocationID],
					[Width],
					[Height],
					[OnAdvancedSearch]
				FROM
					[dbo].[WidgetContainers]
				WHERE
					[DefaultProfessionID] = @DefaultProfessionId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.WidgetContainers_GetByDefaultCountryId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.WidgetContainers_GetByDefaultCountryId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.WidgetContainers_GetByDefaultCountryId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the WidgetContainers table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.WidgetContainers_GetByDefaultCountryId
(

	@DefaultCountryId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[WidgetID],
					[SiteID],
					[LanguageID],
					[WidgetName],
					[WidgetDomain],
					[WidgetContainerClass],
					[WidgetContainerHeaderClass],
					[WidgetItemClass],
					[WidgetJobLinkCSS],
					[WidgetItemLinkImageID],
					[Valid],
					[ShowJobs],
					[ShowCompanies],
					[ShowSite],
					[ShowPeople],
					[JobHtml],
					[CompanyHtml],
					[SiteHtml],
					[PeopleHtml],
					[Javascript],
					[SearchCSS],
					[DefaultProfessionID],
					[DefaultCountryID],
					[DefaultLocationID],
					[Width],
					[Height],
					[OnAdvancedSearch]
				FROM
					[dbo].[WidgetContainers]
				WHERE
					[DefaultCountryID] = @DefaultCountryId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.WidgetContainers_GetByDefaultLocationId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.WidgetContainers_GetByDefaultLocationId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.WidgetContainers_GetByDefaultLocationId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the WidgetContainers table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.WidgetContainers_GetByDefaultLocationId
(

	@DefaultLocationId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[WidgetID],
					[SiteID],
					[LanguageID],
					[WidgetName],
					[WidgetDomain],
					[WidgetContainerClass],
					[WidgetContainerHeaderClass],
					[WidgetItemClass],
					[WidgetJobLinkCSS],
					[WidgetItemLinkImageID],
					[Valid],
					[ShowJobs],
					[ShowCompanies],
					[ShowSite],
					[ShowPeople],
					[JobHtml],
					[CompanyHtml],
					[SiteHtml],
					[PeopleHtml],
					[Javascript],
					[SearchCSS],
					[DefaultProfessionID],
					[DefaultCountryID],
					[DefaultLocationID],
					[Width],
					[Height],
					[OnAdvancedSearch]
				FROM
					[dbo].[WidgetContainers]
				WHERE
					[DefaultLocationID] = @DefaultLocationId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.WidgetContainers_GetByLanguageId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.WidgetContainers_GetByLanguageId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.WidgetContainers_GetByLanguageId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the WidgetContainers table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.WidgetContainers_GetByLanguageId
(

	@LanguageId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[WidgetID],
					[SiteID],
					[LanguageID],
					[WidgetName],
					[WidgetDomain],
					[WidgetContainerClass],
					[WidgetContainerHeaderClass],
					[WidgetItemClass],
					[WidgetJobLinkCSS],
					[WidgetItemLinkImageID],
					[Valid],
					[ShowJobs],
					[ShowCompanies],
					[ShowSite],
					[ShowPeople],
					[JobHtml],
					[CompanyHtml],
					[SiteHtml],
					[PeopleHtml],
					[Javascript],
					[SearchCSS],
					[DefaultProfessionID],
					[DefaultCountryID],
					[DefaultLocationID],
					[Width],
					[Height],
					[OnAdvancedSearch]
				FROM
					[dbo].[WidgetContainers]
				WHERE
					[LanguageID] = @LanguageId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.WidgetContainers_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.WidgetContainers_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.WidgetContainers_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the WidgetContainers table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.WidgetContainers_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[WidgetID],
					[SiteID],
					[LanguageID],
					[WidgetName],
					[WidgetDomain],
					[WidgetContainerClass],
					[WidgetContainerHeaderClass],
					[WidgetItemClass],
					[WidgetJobLinkCSS],
					[WidgetItemLinkImageID],
					[Valid],
					[ShowJobs],
					[ShowCompanies],
					[ShowSite],
					[ShowPeople],
					[JobHtml],
					[CompanyHtml],
					[SiteHtml],
					[PeopleHtml],
					[Javascript],
					[SearchCSS],
					[DefaultProfessionID],
					[DefaultCountryID],
					[DefaultLocationID],
					[Width],
					[Height],
					[OnAdvancedSearch]
				FROM
					[dbo].[WidgetContainers]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.WidgetContainers_GetByWidgetId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.WidgetContainers_GetByWidgetId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.WidgetContainers_GetByWidgetId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the WidgetContainers table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.WidgetContainers_GetByWidgetId
(

	@WidgetId int   
)
AS


				SELECT
					[WidgetID],
					[SiteID],
					[LanguageID],
					[WidgetName],
					[WidgetDomain],
					[WidgetContainerClass],
					[WidgetContainerHeaderClass],
					[WidgetItemClass],
					[WidgetJobLinkCSS],
					[WidgetItemLinkImageID],
					[Valid],
					[ShowJobs],
					[ShowCompanies],
					[ShowSite],
					[ShowPeople],
					[JobHtml],
					[CompanyHtml],
					[SiteHtml],
					[PeopleHtml],
					[Javascript],
					[SearchCSS],
					[DefaultProfessionID],
					[DefaultCountryID],
					[DefaultLocationID],
					[Width],
					[Height],
					[OnAdvancedSearch]
				FROM
					[dbo].[WidgetContainers]
				WHERE
					[WidgetID] = @WidgetId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.WidgetContainers_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.WidgetContainers_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.WidgetContainers_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the WidgetContainers table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.WidgetContainers_Find
(

	@SearchUsingOR bit   = null ,

	@WidgetId int   = null ,

	@SiteId int   = null ,

	@LanguageId int   = null ,

	@WidgetName varchar (255)  = null ,

	@WidgetDomain varchar (255)  = null ,

	@WidgetContainerClass varchar (255)  = null ,

	@WidgetContainerHeaderClass varchar (255)  = null ,

	@WidgetItemClass varchar (255)  = null ,

	@WidgetJobLinkCss varchar (255)  = null ,

	@WidgetItemLinkImageId int   = null ,

	@Valid bit   = null ,

	@ShowJobs bit   = null ,

	@ShowCompanies bit   = null ,

	@ShowSite bit   = null ,

	@ShowPeople bit   = null ,

	@JobHtml nvarchar (MAX)  = null ,

	@CompanyHtml nvarchar (MAX)  = null ,

	@SiteHtml nvarchar (MAX)  = null ,

	@PeopleHtml nvarchar (MAX)  = null ,

	@Javascript varchar (MAX)  = null ,

	@SearchCss varchar (MAX)  = null ,

	@DefaultProfessionId int   = null ,

	@DefaultCountryId int   = null ,

	@DefaultLocationId int   = null ,

	@Width int   = null ,

	@Height int   = null ,

	@OnAdvancedSearch bit   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [WidgetID]
	, [SiteID]
	, [LanguageID]
	, [WidgetName]
	, [WidgetDomain]
	, [WidgetContainerClass]
	, [WidgetContainerHeaderClass]
	, [WidgetItemClass]
	, [WidgetJobLinkCSS]
	, [WidgetItemLinkImageID]
	, [Valid]
	, [ShowJobs]
	, [ShowCompanies]
	, [ShowSite]
	, [ShowPeople]
	, [JobHtml]
	, [CompanyHtml]
	, [SiteHtml]
	, [PeopleHtml]
	, [Javascript]
	, [SearchCSS]
	, [DefaultProfessionID]
	, [DefaultCountryID]
	, [DefaultLocationID]
	, [Width]
	, [Height]
	, [OnAdvancedSearch]
    FROM
	[dbo].[WidgetContainers]
    WHERE 
	 ([WidgetID] = @WidgetId OR @WidgetId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([LanguageID] = @LanguageId OR @LanguageId IS NULL)
	AND ([WidgetName] = @WidgetName OR @WidgetName IS NULL)
	AND ([WidgetDomain] = @WidgetDomain OR @WidgetDomain IS NULL)
	AND ([WidgetContainerClass] = @WidgetContainerClass OR @WidgetContainerClass IS NULL)
	AND ([WidgetContainerHeaderClass] = @WidgetContainerHeaderClass OR @WidgetContainerHeaderClass IS NULL)
	AND ([WidgetItemClass] = @WidgetItemClass OR @WidgetItemClass IS NULL)
	AND ([WidgetJobLinkCSS] = @WidgetJobLinkCss OR @WidgetJobLinkCss IS NULL)
	AND ([WidgetItemLinkImageID] = @WidgetItemLinkImageId OR @WidgetItemLinkImageId IS NULL)
	AND ([Valid] = @Valid OR @Valid IS NULL)
	AND ([ShowJobs] = @ShowJobs OR @ShowJobs IS NULL)
	AND ([ShowCompanies] = @ShowCompanies OR @ShowCompanies IS NULL)
	AND ([ShowSite] = @ShowSite OR @ShowSite IS NULL)
	AND ([ShowPeople] = @ShowPeople OR @ShowPeople IS NULL)
	AND ([JobHtml] = @JobHtml OR @JobHtml IS NULL)
	AND ([CompanyHtml] = @CompanyHtml OR @CompanyHtml IS NULL)
	AND ([SiteHtml] = @SiteHtml OR @SiteHtml IS NULL)
	AND ([PeopleHtml] = @PeopleHtml OR @PeopleHtml IS NULL)
	AND ([Javascript] = @Javascript OR @Javascript IS NULL)
	AND ([SearchCSS] = @SearchCss OR @SearchCss IS NULL)
	AND ([DefaultProfessionID] = @DefaultProfessionId OR @DefaultProfessionId IS NULL)
	AND ([DefaultCountryID] = @DefaultCountryId OR @DefaultCountryId IS NULL)
	AND ([DefaultLocationID] = @DefaultLocationId OR @DefaultLocationId IS NULL)
	AND ([Width] = @Width OR @Width IS NULL)
	AND ([Height] = @Height OR @Height IS NULL)
	AND ([OnAdvancedSearch] = @OnAdvancedSearch OR @OnAdvancedSearch IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [WidgetID]
	, [SiteID]
	, [LanguageID]
	, [WidgetName]
	, [WidgetDomain]
	, [WidgetContainerClass]
	, [WidgetContainerHeaderClass]
	, [WidgetItemClass]
	, [WidgetJobLinkCSS]
	, [WidgetItemLinkImageID]
	, [Valid]
	, [ShowJobs]
	, [ShowCompanies]
	, [ShowSite]
	, [ShowPeople]
	, [JobHtml]
	, [CompanyHtml]
	, [SiteHtml]
	, [PeopleHtml]
	, [Javascript]
	, [SearchCSS]
	, [DefaultProfessionID]
	, [DefaultCountryID]
	, [DefaultLocationID]
	, [Width]
	, [Height]
	, [OnAdvancedSearch]
    FROM
	[dbo].[WidgetContainers]
    WHERE 
	 ([WidgetID] = @WidgetId AND @WidgetId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([LanguageID] = @LanguageId AND @LanguageId is not null)
	OR ([WidgetName] = @WidgetName AND @WidgetName is not null)
	OR ([WidgetDomain] = @WidgetDomain AND @WidgetDomain is not null)
	OR ([WidgetContainerClass] = @WidgetContainerClass AND @WidgetContainerClass is not null)
	OR ([WidgetContainerHeaderClass] = @WidgetContainerHeaderClass AND @WidgetContainerHeaderClass is not null)
	OR ([WidgetItemClass] = @WidgetItemClass AND @WidgetItemClass is not null)
	OR ([WidgetJobLinkCSS] = @WidgetJobLinkCss AND @WidgetJobLinkCss is not null)
	OR ([WidgetItemLinkImageID] = @WidgetItemLinkImageId AND @WidgetItemLinkImageId is not null)
	OR ([Valid] = @Valid AND @Valid is not null)
	OR ([ShowJobs] = @ShowJobs AND @ShowJobs is not null)
	OR ([ShowCompanies] = @ShowCompanies AND @ShowCompanies is not null)
	OR ([ShowSite] = @ShowSite AND @ShowSite is not null)
	OR ([ShowPeople] = @ShowPeople AND @ShowPeople is not null)
	OR ([JobHtml] = @JobHtml AND @JobHtml is not null)
	OR ([CompanyHtml] = @CompanyHtml AND @CompanyHtml is not null)
	OR ([SiteHtml] = @SiteHtml AND @SiteHtml is not null)
	OR ([PeopleHtml] = @PeopleHtml AND @PeopleHtml is not null)
	OR ([Javascript] = @Javascript AND @Javascript is not null)
	OR ([SearchCSS] = @SearchCss AND @SearchCss is not null)
	OR ([DefaultProfessionID] = @DefaultProfessionId AND @DefaultProfessionId is not null)
	OR ([DefaultCountryID] = @DefaultCountryId AND @DefaultCountryId is not null)
	OR ([DefaultLocationID] = @DefaultLocationId AND @DefaultLocationId is not null)
	OR ([Width] = @Width AND @Width is not null)
	OR ([Height] = @Height AND @Height is not null)
	OR ([OnAdvancedSearch] = @OnAdvancedSearch AND @OnAdvancedSearch is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteWorkType_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteWorkType_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteWorkType_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the SiteWorkType table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteWorkType_Get_List

AS


				
				SELECT
					[SiteWorkTypeID],
					[SiteID],
					[WorkTypeID],
					[SiteWorkTypeName],
					[Valid],
					[Sequence],
					[SiteWorkTypeFriendlyUrl]
				FROM
					[dbo].[SiteWorkType]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteWorkType_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteWorkType_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteWorkType_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the SiteWorkType table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteWorkType_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [SiteWorkTypeID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([SiteWorkTypeID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [SiteWorkTypeID]'
				SET @SQL = @SQL + ' FROM [dbo].[SiteWorkType]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[SiteWorkTypeID], O.[SiteID], O.[WorkTypeID], O.[SiteWorkTypeName], O.[Valid], O.[Sequence], O.[SiteWorkTypeFriendlyUrl]
				FROM
				    [dbo].[SiteWorkType] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[SiteWorkTypeID] = PageIndex.[SiteWorkTypeID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[SiteWorkType]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteWorkType_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteWorkType_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteWorkType_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the SiteWorkType table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteWorkType_Insert
(

	@SiteWorkTypeId int    OUTPUT,

	@SiteId int   ,

	@WorkTypeId int   ,

	@SiteWorkTypeName nvarchar (1020)  ,

	@Valid bit   ,

	@Sequence int   ,

	@SiteWorkTypeFriendlyUrl varchar (255)  
)
AS


				
				INSERT INTO [dbo].[SiteWorkType]
					(
					[SiteID]
					,[WorkTypeID]
					,[SiteWorkTypeName]
					,[Valid]
					,[Sequence]
					,[SiteWorkTypeFriendlyUrl]
					)
				VALUES
					(
					@SiteId
					,@WorkTypeId
					,@SiteWorkTypeName
					,@Valid
					,@Sequence
					,@SiteWorkTypeFriendlyUrl
					)
				
				-- Get the identity value
				SET @SiteWorkTypeId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteWorkType_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteWorkType_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteWorkType_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the SiteWorkType table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteWorkType_Update
(

	@SiteWorkTypeId int   ,

	@SiteId int   ,

	@WorkTypeId int   ,

	@SiteWorkTypeName nvarchar (1020)  ,

	@Valid bit   ,

	@Sequence int   ,

	@SiteWorkTypeFriendlyUrl varchar (255)  
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[SiteWorkType]
				SET
					[SiteID] = @SiteId
					,[WorkTypeID] = @WorkTypeId
					,[SiteWorkTypeName] = @SiteWorkTypeName
					,[Valid] = @Valid
					,[Sequence] = @Sequence
					,[SiteWorkTypeFriendlyUrl] = @SiteWorkTypeFriendlyUrl
				WHERE
[SiteWorkTypeID] = @SiteWorkTypeId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteWorkType_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteWorkType_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteWorkType_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the SiteWorkType table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteWorkType_Delete
(

	@SiteWorkTypeId int   
)
AS


				DELETE FROM [dbo].[SiteWorkType] WITH (ROWLOCK) 
				WHERE
					[SiteWorkTypeID] = @SiteWorkTypeId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteWorkType_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteWorkType_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteWorkType_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteWorkType table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteWorkType_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[SiteWorkTypeID],
					[SiteID],
					[WorkTypeID],
					[SiteWorkTypeName],
					[Valid],
					[Sequence],
					[SiteWorkTypeFriendlyUrl]
				FROM
					[dbo].[SiteWorkType]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteWorkType_GetByWorkTypeId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteWorkType_GetByWorkTypeId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteWorkType_GetByWorkTypeId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteWorkType table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteWorkType_GetByWorkTypeId
(

	@WorkTypeId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[SiteWorkTypeID],
					[SiteID],
					[WorkTypeID],
					[SiteWorkTypeName],
					[Valid],
					[Sequence],
					[SiteWorkTypeFriendlyUrl]
				FROM
					[dbo].[SiteWorkType]
				WHERE
					[WorkTypeID] = @WorkTypeId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteWorkType_GetBySiteIdSiteWorkTypeIdWorkTypeId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteWorkType_GetBySiteIdSiteWorkTypeIdWorkTypeId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteWorkType_GetBySiteIdSiteWorkTypeIdWorkTypeId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteWorkType table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteWorkType_GetBySiteIdSiteWorkTypeIdWorkTypeId
(

	@SiteId int   ,

	@SiteWorkTypeId int   ,

	@WorkTypeId int   
)
AS


				SELECT
					[SiteWorkTypeID],
					[SiteID],
					[WorkTypeID],
					[SiteWorkTypeName],
					[Valid],
					[Sequence],
					[SiteWorkTypeFriendlyUrl]
				FROM
					[dbo].[SiteWorkType]
				WHERE
					[SiteID] = @SiteId
					AND [SiteWorkTypeID] = @SiteWorkTypeId
					AND [WorkTypeID] = @WorkTypeId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteWorkType_GetBySiteIdWorkTypeId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteWorkType_GetBySiteIdWorkTypeId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteWorkType_GetBySiteIdWorkTypeId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteWorkType table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteWorkType_GetBySiteIdWorkTypeId
(

	@SiteId int   ,

	@WorkTypeId int   
)
AS


				SELECT
					[SiteWorkTypeID],
					[SiteID],
					[WorkTypeID],
					[SiteWorkTypeName],
					[Valid],
					[Sequence],
					[SiteWorkTypeFriendlyUrl]
				FROM
					[dbo].[SiteWorkType]
				WHERE
					[SiteID] = @SiteId
					AND [WorkTypeID] = @WorkTypeId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteWorkType_GetBySiteWorkTypeId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteWorkType_GetBySiteWorkTypeId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteWorkType_GetBySiteWorkTypeId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteWorkType table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteWorkType_GetBySiteWorkTypeId
(

	@SiteWorkTypeId int   
)
AS


				SELECT
					[SiteWorkTypeID],
					[SiteID],
					[WorkTypeID],
					[SiteWorkTypeName],
					[Valid],
					[Sequence],
					[SiteWorkTypeFriendlyUrl]
				FROM
					[dbo].[SiteWorkType]
				WHERE
					[SiteWorkTypeID] = @SiteWorkTypeId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteWorkType_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteWorkType_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteWorkType_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the SiteWorkType table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteWorkType_Find
(

	@SearchUsingOR bit   = null ,

	@SiteWorkTypeId int   = null ,

	@SiteId int   = null ,

	@WorkTypeId int   = null ,

	@SiteWorkTypeName nvarchar (1020)  = null ,

	@Valid bit   = null ,

	@Sequence int   = null ,

	@SiteWorkTypeFriendlyUrl varchar (255)  = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [SiteWorkTypeID]
	, [SiteID]
	, [WorkTypeID]
	, [SiteWorkTypeName]
	, [Valid]
	, [Sequence]
	, [SiteWorkTypeFriendlyUrl]
    FROM
	[dbo].[SiteWorkType]
    WHERE 
	 ([SiteWorkTypeID] = @SiteWorkTypeId OR @SiteWorkTypeId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([WorkTypeID] = @WorkTypeId OR @WorkTypeId IS NULL)
	AND ([SiteWorkTypeName] = @SiteWorkTypeName OR @SiteWorkTypeName IS NULL)
	AND ([Valid] = @Valid OR @Valid IS NULL)
	AND ([Sequence] = @Sequence OR @Sequence IS NULL)
	AND ([SiteWorkTypeFriendlyUrl] = @SiteWorkTypeFriendlyUrl OR @SiteWorkTypeFriendlyUrl IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [SiteWorkTypeID]
	, [SiteID]
	, [WorkTypeID]
	, [SiteWorkTypeName]
	, [Valid]
	, [Sequence]
	, [SiteWorkTypeFriendlyUrl]
    FROM
	[dbo].[SiteWorkType]
    WHERE 
	 ([SiteWorkTypeID] = @SiteWorkTypeId AND @SiteWorkTypeId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([WorkTypeID] = @WorkTypeId AND @WorkTypeId is not null)
	OR ([SiteWorkTypeName] = @SiteWorkTypeName AND @SiteWorkTypeName is not null)
	OR ([Valid] = @Valid AND @Valid is not null)
	OR ([Sequence] = @Sequence AND @Sequence is not null)
	OR ([SiteWorkTypeFriendlyUrl] = @SiteWorkTypeFriendlyUrl AND @SiteWorkTypeFriendlyUrl is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteRoles_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteRoles_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteRoles_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the SiteRoles table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteRoles_Get_List

AS


				
				SELECT
					[SiteRoleID],
					[SiteID],
					[RoleID],
					[SiteRoleName],
					[Valid],
					[MetaTitle],
					[MetaKeywords],
					[MetaDescription],
					[Sequence],
					[SiteRoleFriendlyUrl],
					[TotalJobs],
					[CanonicalUrl]
				FROM
					[dbo].[SiteRoles]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteRoles_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteRoles_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteRoles_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the SiteRoles table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteRoles_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [SiteRoleID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([SiteRoleID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [SiteRoleID]'
				SET @SQL = @SQL + ' FROM [dbo].[SiteRoles]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[SiteRoleID], O.[SiteID], O.[RoleID], O.[SiteRoleName], O.[Valid], O.[MetaTitle], O.[MetaKeywords], O.[MetaDescription], O.[Sequence], O.[SiteRoleFriendlyUrl], O.[TotalJobs], O.[CanonicalUrl]
				FROM
				    [dbo].[SiteRoles] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[SiteRoleID] = PageIndex.[SiteRoleID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[SiteRoles]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteRoles_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteRoles_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteRoles_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the SiteRoles table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteRoles_Insert
(

	@SiteRoleId int    OUTPUT,

	@SiteId int   ,

	@RoleId int   ,

	@SiteRoleName nvarchar (1020)  ,

	@Valid bit   ,

	@MetaTitle varchar (255)  ,

	@MetaKeywords varchar (255)  ,

	@MetaDescription varchar (512)  ,

	@Sequence int   ,

	@SiteRoleFriendlyUrl varchar (255)  ,

	@TotalJobs int   ,

	@CanonicalUrl varchar (255)  
)
AS


				
				INSERT INTO [dbo].[SiteRoles]
					(
					[SiteID]
					,[RoleID]
					,[SiteRoleName]
					,[Valid]
					,[MetaTitle]
					,[MetaKeywords]
					,[MetaDescription]
					,[Sequence]
					,[SiteRoleFriendlyUrl]
					,[TotalJobs]
					,[CanonicalUrl]
					)
				VALUES
					(
					@SiteId
					,@RoleId
					,@SiteRoleName
					,@Valid
					,@MetaTitle
					,@MetaKeywords
					,@MetaDescription
					,@Sequence
					,@SiteRoleFriendlyUrl
					,@TotalJobs
					,@CanonicalUrl
					)
				
				-- Get the identity value
				SET @SiteRoleId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteRoles_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteRoles_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteRoles_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the SiteRoles table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteRoles_Update
(

	@SiteRoleId int   ,

	@SiteId int   ,

	@RoleId int   ,

	@SiteRoleName nvarchar (1020)  ,

	@Valid bit   ,

	@MetaTitle varchar (255)  ,

	@MetaKeywords varchar (255)  ,

	@MetaDescription varchar (512)  ,

	@Sequence int   ,

	@SiteRoleFriendlyUrl varchar (255)  ,

	@TotalJobs int   ,

	@CanonicalUrl varchar (255)  
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[SiteRoles]
				SET
					[SiteID] = @SiteId
					,[RoleID] = @RoleId
					,[SiteRoleName] = @SiteRoleName
					,[Valid] = @Valid
					,[MetaTitle] = @MetaTitle
					,[MetaKeywords] = @MetaKeywords
					,[MetaDescription] = @MetaDescription
					,[Sequence] = @Sequence
					,[SiteRoleFriendlyUrl] = @SiteRoleFriendlyUrl
					,[TotalJobs] = @TotalJobs
					,[CanonicalUrl] = @CanonicalUrl
				WHERE
[SiteRoleID] = @SiteRoleId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteRoles_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteRoles_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteRoles_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the SiteRoles table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteRoles_Delete
(

	@SiteRoleId int   
)
AS


				DELETE FROM [dbo].[SiteRoles] WITH (ROWLOCK) 
				WHERE
					[SiteRoleID] = @SiteRoleId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteRoles_GetByRoleId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteRoles_GetByRoleId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteRoles_GetByRoleId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteRoles table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteRoles_GetByRoleId
(

	@RoleId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[SiteRoleID],
					[SiteID],
					[RoleID],
					[SiteRoleName],
					[Valid],
					[MetaTitle],
					[MetaKeywords],
					[MetaDescription],
					[Sequence],
					[SiteRoleFriendlyUrl],
					[TotalJobs],
					[CanonicalUrl]
				FROM
					[dbo].[SiteRoles]
				WHERE
					[RoleID] = @RoleId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteRoles_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteRoles_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteRoles_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteRoles table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteRoles_GetBySiteId
(

	@SiteId int   
)
AS


				SELECT
					[SiteRoleID],
					[SiteID],
					[RoleID],
					[SiteRoleName],
					[Valid],
					[MetaTitle],
					[MetaKeywords],
					[MetaDescription],
					[Sequence],
					[SiteRoleFriendlyUrl],
					[TotalJobs],
					[CanonicalUrl]
				FROM
					[dbo].[SiteRoles]
				WHERE
					[SiteID] = @SiteId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteRoles_GetBySiteRoleId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteRoles_GetBySiteRoleId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteRoles_GetBySiteRoleId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteRoles table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteRoles_GetBySiteRoleId
(

	@SiteRoleId int   
)
AS


				SELECT
					[SiteRoleID],
					[SiteID],
					[RoleID],
					[SiteRoleName],
					[Valid],
					[MetaTitle],
					[MetaKeywords],
					[MetaDescription],
					[Sequence],
					[SiteRoleFriendlyUrl],
					[TotalJobs],
					[CanonicalUrl]
				FROM
					[dbo].[SiteRoles]
				WHERE
					[SiteRoleID] = @SiteRoleId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteRoles_GetBySiteIdSiteRoleFriendlyUrl procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteRoles_GetBySiteIdSiteRoleFriendlyUrl') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteRoles_GetBySiteIdSiteRoleFriendlyUrl
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteRoles table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteRoles_GetBySiteIdSiteRoleFriendlyUrl
(

	@SiteId int   ,

	@SiteRoleFriendlyUrl varchar (255)  
)
AS


				SELECT
					[SiteRoleID],
					[SiteID],
					[RoleID],
					[SiteRoleName],
					[Valid],
					[MetaTitle],
					[MetaKeywords],
					[MetaDescription],
					[Sequence],
					[SiteRoleFriendlyUrl],
					[TotalJobs],
					[CanonicalUrl]
				FROM
					[dbo].[SiteRoles]
				WHERE
					[SiteID] = @SiteId
					AND [SiteRoleFriendlyUrl] = @SiteRoleFriendlyUrl
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteRoles_GetBySiteIdRoleId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteRoles_GetBySiteIdRoleId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteRoles_GetBySiteIdRoleId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteRoles table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteRoles_GetBySiteIdRoleId
(

	@SiteId int   ,

	@RoleId int   
)
AS


				SELECT
					[SiteRoleID],
					[SiteID],
					[RoleID],
					[SiteRoleName],
					[Valid],
					[MetaTitle],
					[MetaKeywords],
					[MetaDescription],
					[Sequence],
					[SiteRoleFriendlyUrl],
					[TotalJobs],
					[CanonicalUrl]
				FROM
					[dbo].[SiteRoles]
				WHERE
					[SiteID] = @SiteId
					AND [RoleID] = @RoleId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteRoles_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteRoles_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteRoles_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the SiteRoles table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteRoles_Find
(

	@SearchUsingOR bit   = null ,

	@SiteRoleId int   = null ,

	@SiteId int   = null ,

	@RoleId int   = null ,

	@SiteRoleName nvarchar (1020)  = null ,

	@Valid bit   = null ,

	@MetaTitle varchar (255)  = null ,

	@MetaKeywords varchar (255)  = null ,

	@MetaDescription varchar (512)  = null ,

	@Sequence int   = null ,

	@SiteRoleFriendlyUrl varchar (255)  = null ,

	@TotalJobs int   = null ,

	@CanonicalUrl varchar (255)  = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [SiteRoleID]
	, [SiteID]
	, [RoleID]
	, [SiteRoleName]
	, [Valid]
	, [MetaTitle]
	, [MetaKeywords]
	, [MetaDescription]
	, [Sequence]
	, [SiteRoleFriendlyUrl]
	, [TotalJobs]
	, [CanonicalUrl]
    FROM
	[dbo].[SiteRoles]
    WHERE 
	 ([SiteRoleID] = @SiteRoleId OR @SiteRoleId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([RoleID] = @RoleId OR @RoleId IS NULL)
	AND ([SiteRoleName] = @SiteRoleName OR @SiteRoleName IS NULL)
	AND ([Valid] = @Valid OR @Valid IS NULL)
	AND ([MetaTitle] = @MetaTitle OR @MetaTitle IS NULL)
	AND ([MetaKeywords] = @MetaKeywords OR @MetaKeywords IS NULL)
	AND ([MetaDescription] = @MetaDescription OR @MetaDescription IS NULL)
	AND ([Sequence] = @Sequence OR @Sequence IS NULL)
	AND ([SiteRoleFriendlyUrl] = @SiteRoleFriendlyUrl OR @SiteRoleFriendlyUrl IS NULL)
	AND ([TotalJobs] = @TotalJobs OR @TotalJobs IS NULL)
	AND ([CanonicalUrl] = @CanonicalUrl OR @CanonicalUrl IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [SiteRoleID]
	, [SiteID]
	, [RoleID]
	, [SiteRoleName]
	, [Valid]
	, [MetaTitle]
	, [MetaKeywords]
	, [MetaDescription]
	, [Sequence]
	, [SiteRoleFriendlyUrl]
	, [TotalJobs]
	, [CanonicalUrl]
    FROM
	[dbo].[SiteRoles]
    WHERE 
	 ([SiteRoleID] = @SiteRoleId AND @SiteRoleId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([RoleID] = @RoleId AND @RoleId is not null)
	OR ([SiteRoleName] = @SiteRoleName AND @SiteRoleName is not null)
	OR ([Valid] = @Valid AND @Valid is not null)
	OR ([MetaTitle] = @MetaTitle AND @MetaTitle is not null)
	OR ([MetaKeywords] = @MetaKeywords AND @MetaKeywords is not null)
	OR ([MetaDescription] = @MetaDescription AND @MetaDescription is not null)
	OR ([Sequence] = @Sequence AND @Sequence is not null)
	OR ([SiteRoleFriendlyUrl] = @SiteRoleFriendlyUrl AND @SiteRoleFriendlyUrl is not null)
	OR ([TotalJobs] = @TotalJobs AND @TotalJobs is not null)
	OR ([CanonicalUrl] = @CanonicalUrl AND @CanonicalUrl is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.WebServiceLog_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.WebServiceLog_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.WebServiceLog_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the WebServiceLog table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.WebServiceLog_Get_List

AS


				
				SELECT
					[WebServiceLogId],
					[ClientIPAddress],
					[AdvertiserId],
					[AdvertiserUserID],
					[CreatedDate],
					[MethodInvoked],
					[InputXML],
					[OutputResponse],
					[InvalidXML],
					[TotalSent],
					[TotalUpdated],
					[TotalArchived],
					[TotalFailed],
					[SiteId],
					[FinishedDate],
					[TotalInserted]
				FROM
					[dbo].[WebServiceLog]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.WebServiceLog_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.WebServiceLog_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.WebServiceLog_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the WebServiceLog table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.WebServiceLog_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [WebServiceLogId] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([WebServiceLogId])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [WebServiceLogId]'
				SET @SQL = @SQL + ' FROM [dbo].[WebServiceLog]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[WebServiceLogId], O.[ClientIPAddress], O.[AdvertiserId], O.[AdvertiserUserID], O.[CreatedDate], O.[MethodInvoked], O.[InputXML], O.[OutputResponse], O.[InvalidXML], O.[TotalSent], O.[TotalUpdated], O.[TotalArchived], O.[TotalFailed], O.[SiteId], O.[FinishedDate], O.[TotalInserted]
				FROM
				    [dbo].[WebServiceLog] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[WebServiceLogId] = PageIndex.[WebServiceLogId]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[WebServiceLog]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.WebServiceLog_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.WebServiceLog_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.WebServiceLog_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the WebServiceLog table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.WebServiceLog_Insert
(

	@WebServiceLogId int    OUTPUT,

	@ClientIpAddress varchar (255)  ,

	@AdvertiserId int   ,

	@AdvertiserUserId int   ,

	@CreatedDate datetime   ,

	@MethodInvoked varchar (255)  ,

	@InputXml xml   ,

	@OutputResponse xml   ,

	@InvalidXml nvarchar (MAX)  ,

	@TotalSent int   ,

	@TotalUpdated int   ,

	@TotalArchived int   ,

	@TotalFailed int   ,

	@SiteId int   ,

	@FinishedDate datetime   ,

	@TotalInserted int   
)
AS


				
				INSERT INTO [dbo].[WebServiceLog]
					(
					[ClientIPAddress]
					,[AdvertiserId]
					,[AdvertiserUserID]
					,[CreatedDate]
					,[MethodInvoked]
					,[InputXML]
					,[OutputResponse]
					,[InvalidXML]
					,[TotalSent]
					,[TotalUpdated]
					,[TotalArchived]
					,[TotalFailed]
					,[SiteId]
					,[FinishedDate]
					,[TotalInserted]
					)
				VALUES
					(
					@ClientIpAddress
					,@AdvertiserId
					,@AdvertiserUserId
					,@CreatedDate
					,@MethodInvoked
					,@InputXml
					,@OutputResponse
					,@InvalidXml
					,@TotalSent
					,@TotalUpdated
					,@TotalArchived
					,@TotalFailed
					,@SiteId
					,@FinishedDate
					,@TotalInserted
					)
				
				-- Get the identity value
				SET @WebServiceLogId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.WebServiceLog_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.WebServiceLog_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.WebServiceLog_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the WebServiceLog table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.WebServiceLog_Update
(

	@WebServiceLogId int   ,

	@ClientIpAddress varchar (255)  ,

	@AdvertiserId int   ,

	@AdvertiserUserId int   ,

	@CreatedDate datetime   ,

	@MethodInvoked varchar (255)  ,

	@InputXml xml   ,

	@OutputResponse xml   ,

	@InvalidXml nvarchar (MAX)  ,

	@TotalSent int   ,

	@TotalUpdated int   ,

	@TotalArchived int   ,

	@TotalFailed int   ,

	@SiteId int   ,

	@FinishedDate datetime   ,

	@TotalInserted int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[WebServiceLog]
				SET
					[ClientIPAddress] = @ClientIpAddress
					,[AdvertiserId] = @AdvertiserId
					,[AdvertiserUserID] = @AdvertiserUserId
					,[CreatedDate] = @CreatedDate
					,[MethodInvoked] = @MethodInvoked
					,[InputXML] = @InputXml
					,[OutputResponse] = @OutputResponse
					,[InvalidXML] = @InvalidXml
					,[TotalSent] = @TotalSent
					,[TotalUpdated] = @TotalUpdated
					,[TotalArchived] = @TotalArchived
					,[TotalFailed] = @TotalFailed
					,[SiteId] = @SiteId
					,[FinishedDate] = @FinishedDate
					,[TotalInserted] = @TotalInserted
				WHERE
[WebServiceLogId] = @WebServiceLogId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.WebServiceLog_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.WebServiceLog_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.WebServiceLog_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the WebServiceLog table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.WebServiceLog_Delete
(

	@WebServiceLogId int   
)
AS


				DELETE FROM [dbo].[WebServiceLog] WITH (ROWLOCK) 
				WHERE
					[WebServiceLogId] = @WebServiceLogId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.WebServiceLog_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.WebServiceLog_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.WebServiceLog_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the WebServiceLog table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.WebServiceLog_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[WebServiceLogId],
					[ClientIPAddress],
					[AdvertiserId],
					[AdvertiserUserID],
					[CreatedDate],
					[MethodInvoked],
					[InputXML],
					[OutputResponse],
					[InvalidXML],
					[TotalSent],
					[TotalUpdated],
					[TotalArchived],
					[TotalFailed],
					[SiteId],
					[FinishedDate],
					[TotalInserted]
				FROM
					[dbo].[WebServiceLog]
				WHERE
					[SiteId] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.WebServiceLog_GetByWebServiceLogId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.WebServiceLog_GetByWebServiceLogId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.WebServiceLog_GetByWebServiceLogId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the WebServiceLog table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.WebServiceLog_GetByWebServiceLogId
(

	@WebServiceLogId int   
)
AS


				SELECT
					[WebServiceLogId],
					[ClientIPAddress],
					[AdvertiserId],
					[AdvertiserUserID],
					[CreatedDate],
					[MethodInvoked],
					[InputXML],
					[OutputResponse],
					[InvalidXML],
					[TotalSent],
					[TotalUpdated],
					[TotalArchived],
					[TotalFailed],
					[SiteId],
					[FinishedDate],
					[TotalInserted]
				FROM
					[dbo].[WebServiceLog]
				WHERE
					[WebServiceLogId] = @WebServiceLogId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.WebServiceLog_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.WebServiceLog_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.WebServiceLog_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the WebServiceLog table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.WebServiceLog_Find
(

	@SearchUsingOR bit   = null ,

	@WebServiceLogId int   = null ,

	@ClientIpAddress varchar (255)  = null ,

	@AdvertiserId int   = null ,

	@AdvertiserUserId int   = null ,

	@CreatedDate datetime   = null ,

	@MethodInvoked varchar (255)  = null ,

	@InputXml xml   = null ,

	@OutputResponse xml   = null ,

	@InvalidXml nvarchar (MAX)  = null ,

	@TotalSent int   = null ,

	@TotalUpdated int   = null ,

	@TotalArchived int   = null ,

	@TotalFailed int   = null ,

	@SiteId int   = null ,

	@FinishedDate datetime   = null ,

	@TotalInserted int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [WebServiceLogId]
	, [ClientIPAddress]
	, [AdvertiserId]
	, [AdvertiserUserID]
	, [CreatedDate]
	, [MethodInvoked]
	, [InputXML]
	, [OutputResponse]
	, [InvalidXML]
	, [TotalSent]
	, [TotalUpdated]
	, [TotalArchived]
	, [TotalFailed]
	, [SiteId]
	, [FinishedDate]
	, [TotalInserted]
    FROM
	[dbo].[WebServiceLog]
    WHERE 
	 ([WebServiceLogId] = @WebServiceLogId OR @WebServiceLogId IS NULL)
	AND ([ClientIPAddress] = @ClientIpAddress OR @ClientIpAddress IS NULL)
	AND ([AdvertiserId] = @AdvertiserId OR @AdvertiserId IS NULL)
	AND ([AdvertiserUserID] = @AdvertiserUserId OR @AdvertiserUserId IS NULL)
	AND ([CreatedDate] = @CreatedDate OR @CreatedDate IS NULL)
	AND ([MethodInvoked] = @MethodInvoked OR @MethodInvoked IS NULL)
	AND ([InvalidXML] = @InvalidXml OR @InvalidXml IS NULL)
	AND ([TotalSent] = @TotalSent OR @TotalSent IS NULL)
	AND ([TotalUpdated] = @TotalUpdated OR @TotalUpdated IS NULL)
	AND ([TotalArchived] = @TotalArchived OR @TotalArchived IS NULL)
	AND ([TotalFailed] = @TotalFailed OR @TotalFailed IS NULL)
	AND ([SiteId] = @SiteId OR @SiteId IS NULL)
	AND ([FinishedDate] = @FinishedDate OR @FinishedDate IS NULL)
	AND ([TotalInserted] = @TotalInserted OR @TotalInserted IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [WebServiceLogId]
	, [ClientIPAddress]
	, [AdvertiserId]
	, [AdvertiserUserID]
	, [CreatedDate]
	, [MethodInvoked]
	, [InputXML]
	, [OutputResponse]
	, [InvalidXML]
	, [TotalSent]
	, [TotalUpdated]
	, [TotalArchived]
	, [TotalFailed]
	, [SiteId]
	, [FinishedDate]
	, [TotalInserted]
    FROM
	[dbo].[WebServiceLog]
    WHERE 
	 ([WebServiceLogId] = @WebServiceLogId AND @WebServiceLogId is not null)
	OR ([ClientIPAddress] = @ClientIpAddress AND @ClientIpAddress is not null)
	OR ([AdvertiserId] = @AdvertiserId AND @AdvertiserId is not null)
	OR ([AdvertiserUserID] = @AdvertiserUserId AND @AdvertiserUserId is not null)
	OR ([CreatedDate] = @CreatedDate AND @CreatedDate is not null)
	OR ([MethodInvoked] = @MethodInvoked AND @MethodInvoked is not null)
	OR ([InvalidXML] = @InvalidXml AND @InvalidXml is not null)
	OR ([TotalSent] = @TotalSent AND @TotalSent is not null)
	OR ([TotalUpdated] = @TotalUpdated AND @TotalUpdated is not null)
	OR ([TotalArchived] = @TotalArchived AND @TotalArchived is not null)
	OR ([TotalFailed] = @TotalFailed AND @TotalFailed is not null)
	OR ([SiteId] = @SiteId AND @SiteId is not null)
	OR ([FinishedDate] = @FinishedDate AND @FinishedDate is not null)
	OR ([TotalInserted] = @TotalInserted AND @TotalInserted is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteResourcesXML_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteResourcesXML_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteResourcesXML_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the SiteResourcesXML table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteResourcesXML_Get_List

AS


				
				SELECT
					[SiteResourceXMLID],
					[SiteID],
					[LanguageID],
					[ResourceType],
					[ResourceXML],
					[LastModified],
					[LastModifiedBy]
				FROM
					[dbo].[SiteResourcesXML]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteResourcesXML_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteResourcesXML_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteResourcesXML_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the SiteResourcesXML table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteResourcesXML_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [SiteResourceXMLID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([SiteResourceXMLID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [SiteResourceXMLID]'
				SET @SQL = @SQL + ' FROM [dbo].[SiteResourcesXML]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[SiteResourceXMLID], O.[SiteID], O.[LanguageID], O.[ResourceType], O.[ResourceXML], O.[LastModified], O.[LastModifiedBy]
				FROM
				    [dbo].[SiteResourcesXML] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[SiteResourceXMLID] = PageIndex.[SiteResourceXMLID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[SiteResourcesXML]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteResourcesXML_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteResourcesXML_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteResourcesXML_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the SiteResourcesXML table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteResourcesXML_Insert
(

	@SiteResourceXmlid int    OUTPUT,

	@SiteId int   ,

	@LanguageId int   ,

	@ResourceType int   ,

	@ResourceXml nvarchar (MAX)  ,

	@LastModified datetime   ,

	@LastModifiedBy int   
)
AS


				
				INSERT INTO [dbo].[SiteResourcesXML]
					(
					[SiteID]
					,[LanguageID]
					,[ResourceType]
					,[ResourceXML]
					,[LastModified]
					,[LastModifiedBy]
					)
				VALUES
					(
					@SiteId
					,@LanguageId
					,@ResourceType
					,@ResourceXml
					,@LastModified
					,@LastModifiedBy
					)
				
				-- Get the identity value
				SET @SiteResourceXmlid = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteResourcesXML_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteResourcesXML_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteResourcesXML_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the SiteResourcesXML table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteResourcesXML_Update
(

	@SiteResourceXmlid int   ,

	@SiteId int   ,

	@LanguageId int   ,

	@ResourceType int   ,

	@ResourceXml nvarchar (MAX)  ,

	@LastModified datetime   ,

	@LastModifiedBy int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[SiteResourcesXML]
				SET
					[SiteID] = @SiteId
					,[LanguageID] = @LanguageId
					,[ResourceType] = @ResourceType
					,[ResourceXML] = @ResourceXml
					,[LastModified] = @LastModified
					,[LastModifiedBy] = @LastModifiedBy
				WHERE
[SiteResourceXMLID] = @SiteResourceXmlid 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteResourcesXML_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteResourcesXML_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteResourcesXML_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the SiteResourcesXML table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteResourcesXML_Delete
(

	@SiteResourceXmlid int   
)
AS


				DELETE FROM [dbo].[SiteResourcesXML] WITH (ROWLOCK) 
				WHERE
					[SiteResourceXMLID] = @SiteResourceXmlid
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteResourcesXML_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteResourcesXML_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteResourcesXML_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteResourcesXML table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteResourcesXML_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[SiteResourceXMLID],
					[SiteID],
					[LanguageID],
					[ResourceType],
					[ResourceXML],
					[LastModified],
					[LastModifiedBy]
				FROM
					[dbo].[SiteResourcesXML]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteResourcesXML_GetBySiteResourceXmlid procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteResourcesXML_GetBySiteResourceXmlid') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteResourcesXML_GetBySiteResourceXmlid
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteResourcesXML table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteResourcesXML_GetBySiteResourceXmlid
(

	@SiteResourceXmlid int   
)
AS


				SELECT
					[SiteResourceXMLID],
					[SiteID],
					[LanguageID],
					[ResourceType],
					[ResourceXML],
					[LastModified],
					[LastModifiedBy]
				FROM
					[dbo].[SiteResourcesXML]
				WHERE
					[SiteResourceXMLID] = @SiteResourceXmlid
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteResourcesXML_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteResourcesXML_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteResourcesXML_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the SiteResourcesXML table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteResourcesXML_Find
(

	@SearchUsingOR bit   = null ,

	@SiteResourceXmlid int   = null ,

	@SiteId int   = null ,

	@LanguageId int   = null ,

	@ResourceType int   = null ,

	@ResourceXml nvarchar (MAX)  = null ,

	@LastModified datetime   = null ,

	@LastModifiedBy int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [SiteResourceXMLID]
	, [SiteID]
	, [LanguageID]
	, [ResourceType]
	, [ResourceXML]
	, [LastModified]
	, [LastModifiedBy]
    FROM
	[dbo].[SiteResourcesXML]
    WHERE 
	 ([SiteResourceXMLID] = @SiteResourceXmlid OR @SiteResourceXmlid IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([LanguageID] = @LanguageId OR @LanguageId IS NULL)
	AND ([ResourceType] = @ResourceType OR @ResourceType IS NULL)
	AND ([ResourceXML] = @ResourceXml OR @ResourceXml IS NULL)
	AND ([LastModified] = @LastModified OR @LastModified IS NULL)
	AND ([LastModifiedBy] = @LastModifiedBy OR @LastModifiedBy IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [SiteResourceXMLID]
	, [SiteID]
	, [LanguageID]
	, [ResourceType]
	, [ResourceXML]
	, [LastModified]
	, [LastModifiedBy]
    FROM
	[dbo].[SiteResourcesXML]
    WHERE 
	 ([SiteResourceXMLID] = @SiteResourceXmlid AND @SiteResourceXmlid is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([LanguageID] = @LanguageId AND @LanguageId is not null)
	OR ([ResourceType] = @ResourceType AND @ResourceType is not null)
	OR ([ResourceXML] = @ResourceXml AND @ResourceXml is not null)
	OR ([LastModified] = @LastModified AND @LastModified is not null)
	OR ([LastModifiedBy] = @LastModifiedBy AND @LastModifiedBy is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteCurrencies_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteCurrencies_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteCurrencies_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the SiteCurrencies table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteCurrencies_Get_List

AS


				
				SELECT
					[SiteCurrencyID],
					[SiteID],
					[CurrencyID]
				FROM
					[dbo].[SiteCurrencies]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteCurrencies_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteCurrencies_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteCurrencies_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the SiteCurrencies table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteCurrencies_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [SiteCurrencyID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([SiteCurrencyID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [SiteCurrencyID]'
				SET @SQL = @SQL + ' FROM [dbo].[SiteCurrencies]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[SiteCurrencyID], O.[SiteID], O.[CurrencyID]
				FROM
				    [dbo].[SiteCurrencies] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[SiteCurrencyID] = PageIndex.[SiteCurrencyID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[SiteCurrencies]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteCurrencies_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteCurrencies_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteCurrencies_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the SiteCurrencies table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteCurrencies_Insert
(

	@SiteCurrencyId int    OUTPUT,

	@SiteId int   ,

	@CurrencyId int   
)
AS


				
				INSERT INTO [dbo].[SiteCurrencies]
					(
					[SiteID]
					,[CurrencyID]
					)
				VALUES
					(
					@SiteId
					,@CurrencyId
					)
				
				-- Get the identity value
				SET @SiteCurrencyId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteCurrencies_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteCurrencies_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteCurrencies_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the SiteCurrencies table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteCurrencies_Update
(

	@SiteCurrencyId int   ,

	@SiteId int   ,

	@CurrencyId int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[SiteCurrencies]
				SET
					[SiteID] = @SiteId
					,[CurrencyID] = @CurrencyId
				WHERE
[SiteCurrencyID] = @SiteCurrencyId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteCurrencies_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteCurrencies_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteCurrencies_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the SiteCurrencies table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteCurrencies_Delete
(

	@SiteCurrencyId int   
)
AS


				DELETE FROM [dbo].[SiteCurrencies] WITH (ROWLOCK) 
				WHERE
					[SiteCurrencyID] = @SiteCurrencyId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteCurrencies_GetByCurrencyId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteCurrencies_GetByCurrencyId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteCurrencies_GetByCurrencyId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteCurrencies table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteCurrencies_GetByCurrencyId
(

	@CurrencyId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[SiteCurrencyID],
					[SiteID],
					[CurrencyID]
				FROM
					[dbo].[SiteCurrencies]
				WHERE
					[CurrencyID] = @CurrencyId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteCurrencies_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteCurrencies_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteCurrencies_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteCurrencies table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteCurrencies_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[SiteCurrencyID],
					[SiteID],
					[CurrencyID]
				FROM
					[dbo].[SiteCurrencies]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteCurrencies_GetBySiteCurrencyId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteCurrencies_GetBySiteCurrencyId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteCurrencies_GetBySiteCurrencyId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteCurrencies table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteCurrencies_GetBySiteCurrencyId
(

	@SiteCurrencyId int   
)
AS


				SELECT
					[SiteCurrencyID],
					[SiteID],
					[CurrencyID]
				FROM
					[dbo].[SiteCurrencies]
				WHERE
					[SiteCurrencyID] = @SiteCurrencyId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteCurrencies_GetBySiteIdCurrencyId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteCurrencies_GetBySiteIdCurrencyId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteCurrencies_GetBySiteIdCurrencyId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteCurrencies table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteCurrencies_GetBySiteIdCurrencyId
(

	@SiteId int   ,

	@CurrencyId int   
)
AS


				SELECT
					[SiteCurrencyID],
					[SiteID],
					[CurrencyID]
				FROM
					[dbo].[SiteCurrencies]
				WHERE
					[SiteID] = @SiteId
					AND [CurrencyID] = @CurrencyId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteCurrencies_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteCurrencies_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteCurrencies_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the SiteCurrencies table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteCurrencies_Find
(

	@SearchUsingOR bit   = null ,

	@SiteCurrencyId int   = null ,

	@SiteId int   = null ,

	@CurrencyId int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [SiteCurrencyID]
	, [SiteID]
	, [CurrencyID]
    FROM
	[dbo].[SiteCurrencies]
    WHERE 
	 ([SiteCurrencyID] = @SiteCurrencyId OR @SiteCurrencyId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([CurrencyID] = @CurrencyId OR @CurrencyId IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [SiteCurrencyID]
	, [SiteID]
	, [CurrencyID]
    FROM
	[dbo].[SiteCurrencies]
    WHERE 
	 ([SiteCurrencyID] = @SiteCurrencyId AND @SiteCurrencyId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([CurrencyID] = @CurrencyId AND @CurrencyId is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteResources_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteResources_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteResources_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the SiteResources table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteResources_Get_List

AS


				
				SELECT
					[SiteResourceID],
					[SiteID],
					[LanguageID],
					[ResourceCode],
					[ResourceFileID],
					[ResourceText],
					[LastModified],
					[LastModifiedBy]
				FROM
					[dbo].[SiteResources]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteResources_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteResources_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteResources_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the SiteResources table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteResources_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [SiteResourceID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([SiteResourceID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [SiteResourceID]'
				SET @SQL = @SQL + ' FROM [dbo].[SiteResources]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[SiteResourceID], O.[SiteID], O.[LanguageID], O.[ResourceCode], O.[ResourceFileID], O.[ResourceText], O.[LastModified], O.[LastModifiedBy]
				FROM
				    [dbo].[SiteResources] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[SiteResourceID] = PageIndex.[SiteResourceID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[SiteResources]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteResources_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteResources_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteResources_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the SiteResources table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteResources_Insert
(

	@SiteResourceId int    OUTPUT,

	@SiteId int   ,

	@LanguageId int   ,

	@ResourceCode varchar (255)  ,

	@ResourceFileId int   ,

	@ResourceText nvarchar (MAX)  ,

	@LastModified datetime   ,

	@LastModifiedBy int   
)
AS


				
				INSERT INTO [dbo].[SiteResources]
					(
					[SiteID]
					,[LanguageID]
					,[ResourceCode]
					,[ResourceFileID]
					,[ResourceText]
					,[LastModified]
					,[LastModifiedBy]
					)
				VALUES
					(
					@SiteId
					,@LanguageId
					,@ResourceCode
					,@ResourceFileId
					,@ResourceText
					,@LastModified
					,@LastModifiedBy
					)
				
				-- Get the identity value
				SET @SiteResourceId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteResources_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteResources_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteResources_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the SiteResources table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteResources_Update
(

	@SiteResourceId int   ,

	@SiteId int   ,

	@LanguageId int   ,

	@ResourceCode varchar (255)  ,

	@ResourceFileId int   ,

	@ResourceText nvarchar (MAX)  ,

	@LastModified datetime   ,

	@LastModifiedBy int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[SiteResources]
				SET
					[SiteID] = @SiteId
					,[LanguageID] = @LanguageId
					,[ResourceCode] = @ResourceCode
					,[ResourceFileID] = @ResourceFileId
					,[ResourceText] = @ResourceText
					,[LastModified] = @LastModified
					,[LastModifiedBy] = @LastModifiedBy
				WHERE
[SiteResourceID] = @SiteResourceId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteResources_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteResources_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteResources_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the SiteResources table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteResources_Delete
(

	@SiteResourceId int   
)
AS


				DELETE FROM [dbo].[SiteResources] WITH (ROWLOCK) 
				WHERE
					[SiteResourceID] = @SiteResourceId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteResources_GetByLanguageId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteResources_GetByLanguageId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteResources_GetByLanguageId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteResources table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteResources_GetByLanguageId
(

	@LanguageId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[SiteResourceID],
					[SiteID],
					[LanguageID],
					[ResourceCode],
					[ResourceFileID],
					[ResourceText],
					[LastModified],
					[LastModifiedBy]
				FROM
					[dbo].[SiteResources]
				WHERE
					[LanguageID] = @LanguageId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteResources_GetByLastModifiedBy procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteResources_GetByLastModifiedBy') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteResources_GetByLastModifiedBy
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteResources table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteResources_GetByLastModifiedBy
(

	@LastModifiedBy int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[SiteResourceID],
					[SiteID],
					[LanguageID],
					[ResourceCode],
					[ResourceFileID],
					[ResourceText],
					[LastModified],
					[LastModifiedBy]
				FROM
					[dbo].[SiteResources]
				WHERE
					[LastModifiedBy] = @LastModifiedBy
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteResources_GetByResourceCode procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteResources_GetByResourceCode') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteResources_GetByResourceCode
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteResources table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteResources_GetByResourceCode
(

	@ResourceCode varchar (255)  
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[SiteResourceID],
					[SiteID],
					[LanguageID],
					[ResourceCode],
					[ResourceFileID],
					[ResourceText],
					[LastModified],
					[LastModifiedBy]
				FROM
					[dbo].[SiteResources]
				WHERE
					[ResourceCode] = @ResourceCode
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteResources_GetByResourceFileId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteResources_GetByResourceFileId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteResources_GetByResourceFileId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteResources table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteResources_GetByResourceFileId
(

	@ResourceFileId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[SiteResourceID],
					[SiteID],
					[LanguageID],
					[ResourceCode],
					[ResourceFileID],
					[ResourceText],
					[LastModified],
					[LastModifiedBy]
				FROM
					[dbo].[SiteResources]
				WHERE
					[ResourceFileID] = @ResourceFileId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteResources_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteResources_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteResources_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteResources table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteResources_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[SiteResourceID],
					[SiteID],
					[LanguageID],
					[ResourceCode],
					[ResourceFileID],
					[ResourceText],
					[LastModified],
					[LastModifiedBy]
				FROM
					[dbo].[SiteResources]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteResources_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteResources_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteResources_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteResources table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteResources_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[SiteResourceID],
					[SiteID],
					[LanguageID],
					[ResourceCode],
					[ResourceFileID],
					[ResourceText],
					[LastModified],
					[LastModifiedBy]
				FROM
					[dbo].[SiteResources]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteResources_GetBySiteIdLanguageIdResourceCode procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteResources_GetBySiteIdLanguageIdResourceCode') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteResources_GetBySiteIdLanguageIdResourceCode
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteResources table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteResources_GetBySiteIdLanguageIdResourceCode
(

	@SiteId int   ,

	@LanguageId int   ,

	@ResourceCode varchar (255)  
)
AS


				SELECT
					[SiteResourceID],
					[SiteID],
					[LanguageID],
					[ResourceCode],
					[ResourceFileID],
					[ResourceText],
					[LastModified],
					[LastModifiedBy]
				FROM
					[dbo].[SiteResources]
				WHERE
					[SiteID] = @SiteId
					AND [LanguageID] = @LanguageId
					AND [ResourceCode] = @ResourceCode
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteResources_GetBySiteResourceId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteResources_GetBySiteResourceId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteResources_GetBySiteResourceId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteResources table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteResources_GetBySiteResourceId
(

	@SiteResourceId int   
)
AS


				SELECT
					[SiteResourceID],
					[SiteID],
					[LanguageID],
					[ResourceCode],
					[ResourceFileID],
					[ResourceText],
					[LastModified],
					[LastModifiedBy]
				FROM
					[dbo].[SiteResources]
				WHERE
					[SiteResourceID] = @SiteResourceId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteResources_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteResources_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteResources_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the SiteResources table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteResources_Find
(

	@SearchUsingOR bit   = null ,

	@SiteResourceId int   = null ,

	@SiteId int   = null ,

	@LanguageId int   = null ,

	@ResourceCode varchar (255)  = null ,

	@ResourceFileId int   = null ,

	@ResourceText nvarchar (MAX)  = null ,

	@LastModified datetime   = null ,

	@LastModifiedBy int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [SiteResourceID]
	, [SiteID]
	, [LanguageID]
	, [ResourceCode]
	, [ResourceFileID]
	, [ResourceText]
	, [LastModified]
	, [LastModifiedBy]
    FROM
	[dbo].[SiteResources]
    WHERE 
	 ([SiteResourceID] = @SiteResourceId OR @SiteResourceId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([LanguageID] = @LanguageId OR @LanguageId IS NULL)
	AND ([ResourceCode] = @ResourceCode OR @ResourceCode IS NULL)
	AND ([ResourceFileID] = @ResourceFileId OR @ResourceFileId IS NULL)
	AND ([ResourceText] = @ResourceText OR @ResourceText IS NULL)
	AND ([LastModified] = @LastModified OR @LastModified IS NULL)
	AND ([LastModifiedBy] = @LastModifiedBy OR @LastModifiedBy IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [SiteResourceID]
	, [SiteID]
	, [LanguageID]
	, [ResourceCode]
	, [ResourceFileID]
	, [ResourceText]
	, [LastModified]
	, [LastModifiedBy]
    FROM
	[dbo].[SiteResources]
    WHERE 
	 ([SiteResourceID] = @SiteResourceId AND @SiteResourceId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([LanguageID] = @LanguageId AND @LanguageId is not null)
	OR ([ResourceCode] = @ResourceCode AND @ResourceCode is not null)
	OR ([ResourceFileID] = @ResourceFileId AND @ResourceFileId is not null)
	OR ([ResourceText] = @ResourceText AND @ResourceText is not null)
	OR ([LastModified] = @LastModified AND @LastModified is not null)
	OR ([LastModifiedBy] = @LastModifiedBy AND @LastModifiedBy is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteCustomMapping_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteCustomMapping_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteCustomMapping_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the SiteCustomMapping table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteCustomMapping_Get_List

AS


				
				SELECT
					[SiteCustomMappingID],
					[SiteID],
					[MasterSiteID]
				FROM
					[dbo].[SiteCustomMapping]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteCustomMapping_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteCustomMapping_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteCustomMapping_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the SiteCustomMapping table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteCustomMapping_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [SiteCustomMappingID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([SiteCustomMappingID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [SiteCustomMappingID]'
				SET @SQL = @SQL + ' FROM [dbo].[SiteCustomMapping]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[SiteCustomMappingID], O.[SiteID], O.[MasterSiteID]
				FROM
				    [dbo].[SiteCustomMapping] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[SiteCustomMappingID] = PageIndex.[SiteCustomMappingID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[SiteCustomMapping]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteCustomMapping_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteCustomMapping_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteCustomMapping_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the SiteCustomMapping table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteCustomMapping_Insert
(

	@SiteCustomMappingId int    OUTPUT,

	@SiteId int   ,

	@MasterSiteId int   
)
AS


				
				INSERT INTO [dbo].[SiteCustomMapping]
					(
					[SiteID]
					,[MasterSiteID]
					)
				VALUES
					(
					@SiteId
					,@MasterSiteId
					)
				
				-- Get the identity value
				SET @SiteCustomMappingId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteCustomMapping_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteCustomMapping_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteCustomMapping_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the SiteCustomMapping table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteCustomMapping_Update
(

	@SiteCustomMappingId int   ,

	@SiteId int   ,

	@MasterSiteId int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[SiteCustomMapping]
				SET
					[SiteID] = @SiteId
					,[MasterSiteID] = @MasterSiteId
				WHERE
[SiteCustomMappingID] = @SiteCustomMappingId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteCustomMapping_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteCustomMapping_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteCustomMapping_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the SiteCustomMapping table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteCustomMapping_Delete
(

	@SiteCustomMappingId int   
)
AS


				DELETE FROM [dbo].[SiteCustomMapping] WITH (ROWLOCK) 
				WHERE
					[SiteCustomMappingID] = @SiteCustomMappingId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteCustomMapping_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteCustomMapping_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteCustomMapping_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteCustomMapping table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteCustomMapping_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[SiteCustomMappingID],
					[SiteID],
					[MasterSiteID]
				FROM
					[dbo].[SiteCustomMapping]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteCustomMapping_GetBySiteCustomMappingId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteCustomMapping_GetBySiteCustomMappingId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteCustomMapping_GetBySiteCustomMappingId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteCustomMapping table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteCustomMapping_GetBySiteCustomMappingId
(

	@SiteCustomMappingId int   
)
AS


				SELECT
					[SiteCustomMappingID],
					[SiteID],
					[MasterSiteID]
				FROM
					[dbo].[SiteCustomMapping]
				WHERE
					[SiteCustomMappingID] = @SiteCustomMappingId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteCustomMapping_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteCustomMapping_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteCustomMapping_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the SiteCustomMapping table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteCustomMapping_Find
(

	@SearchUsingOR bit   = null ,

	@SiteCustomMappingId int   = null ,

	@SiteId int   = null ,

	@MasterSiteId int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [SiteCustomMappingID]
	, [SiteID]
	, [MasterSiteID]
    FROM
	[dbo].[SiteCustomMapping]
    WHERE 
	 ([SiteCustomMappingID] = @SiteCustomMappingId OR @SiteCustomMappingId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([MasterSiteID] = @MasterSiteId OR @MasterSiteId IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [SiteCustomMappingID]
	, [SiteID]
	, [MasterSiteID]
    FROM
	[dbo].[SiteCustomMapping]
    WHERE 
	 ([SiteCustomMappingID] = @SiteCustomMappingId AND @SiteCustomMappingId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([MasterSiteID] = @MasterSiteId AND @MasterSiteId is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteCountries_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteCountries_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteCountries_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the SiteCountries table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteCountries_Get_List

AS


				
				SELECT
					[SiteCountryID],
					[SiteID],
					[CountryID],
					[SiteCountryName],
					[SiteCountryFriendlyUrl],
					[Currency],
					[Sequence]
				FROM
					[dbo].[SiteCountries]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteCountries_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteCountries_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteCountries_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the SiteCountries table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteCountries_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [SiteCountryID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([SiteCountryID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [SiteCountryID]'
				SET @SQL = @SQL + ' FROM [dbo].[SiteCountries]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[SiteCountryID], O.[SiteID], O.[CountryID], O.[SiteCountryName], O.[SiteCountryFriendlyUrl], O.[Currency], O.[Sequence]
				FROM
				    [dbo].[SiteCountries] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[SiteCountryID] = PageIndex.[SiteCountryID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[SiteCountries]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteCountries_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteCountries_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteCountries_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the SiteCountries table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteCountries_Insert
(

	@SiteCountryId int    OUTPUT,

	@SiteId int   ,

	@CountryId int   ,

	@SiteCountryName nvarchar (255)  ,

	@SiteCountryFriendlyUrl varchar (255)  ,

	@Currency nvarchar (5)  ,

	@Sequence int   
)
AS


				
				INSERT INTO [dbo].[SiteCountries]
					(
					[SiteID]
					,[CountryID]
					,[SiteCountryName]
					,[SiteCountryFriendlyUrl]
					,[Currency]
					,[Sequence]
					)
				VALUES
					(
					@SiteId
					,@CountryId
					,@SiteCountryName
					,@SiteCountryFriendlyUrl
					,@Currency
					,@Sequence
					)
				
				-- Get the identity value
				SET @SiteCountryId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteCountries_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteCountries_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteCountries_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the SiteCountries table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteCountries_Update
(

	@SiteCountryId int   ,

	@SiteId int   ,

	@CountryId int   ,

	@SiteCountryName nvarchar (255)  ,

	@SiteCountryFriendlyUrl varchar (255)  ,

	@Currency nvarchar (5)  ,

	@Sequence int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[SiteCountries]
				SET
					[SiteID] = @SiteId
					,[CountryID] = @CountryId
					,[SiteCountryName] = @SiteCountryName
					,[SiteCountryFriendlyUrl] = @SiteCountryFriendlyUrl
					,[Currency] = @Currency
					,[Sequence] = @Sequence
				WHERE
[SiteCountryID] = @SiteCountryId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteCountries_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteCountries_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteCountries_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the SiteCountries table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteCountries_Delete
(

	@SiteCountryId int   
)
AS


				DELETE FROM [dbo].[SiteCountries] WITH (ROWLOCK) 
				WHERE
					[SiteCountryID] = @SiteCountryId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteCountries_GetByCountryId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteCountries_GetByCountryId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteCountries_GetByCountryId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteCountries table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteCountries_GetByCountryId
(

	@CountryId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[SiteCountryID],
					[SiteID],
					[CountryID],
					[SiteCountryName],
					[SiteCountryFriendlyUrl],
					[Currency],
					[Sequence]
				FROM
					[dbo].[SiteCountries]
				WHERE
					[CountryID] = @CountryId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteCountries_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteCountries_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteCountries_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteCountries table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteCountries_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[SiteCountryID],
					[SiteID],
					[CountryID],
					[SiteCountryName],
					[SiteCountryFriendlyUrl],
					[Currency],
					[Sequence]
				FROM
					[dbo].[SiteCountries]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteCountries_GetBySiteIdCountryId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteCountries_GetBySiteIdCountryId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteCountries_GetBySiteIdCountryId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteCountries table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteCountries_GetBySiteIdCountryId
(

	@SiteId int   ,

	@CountryId int   
)
AS


				SELECT
					[SiteCountryID],
					[SiteID],
					[CountryID],
					[SiteCountryName],
					[SiteCountryFriendlyUrl],
					[Currency],
					[Sequence]
				FROM
					[dbo].[SiteCountries]
				WHERE
					[SiteID] = @SiteId
					AND [CountryID] = @CountryId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteCountries_GetBySiteCountryId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteCountries_GetBySiteCountryId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteCountries_GetBySiteCountryId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteCountries table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteCountries_GetBySiteCountryId
(

	@SiteCountryId int   
)
AS


				SELECT
					[SiteCountryID],
					[SiteID],
					[CountryID],
					[SiteCountryName],
					[SiteCountryFriendlyUrl],
					[Currency],
					[Sequence]
				FROM
					[dbo].[SiteCountries]
				WHERE
					[SiteCountryID] = @SiteCountryId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteCountries_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteCountries_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteCountries_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the SiteCountries table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteCountries_Find
(

	@SearchUsingOR bit   = null ,

	@SiteCountryId int   = null ,

	@SiteId int   = null ,

	@CountryId int   = null ,

	@SiteCountryName nvarchar (255)  = null ,

	@SiteCountryFriendlyUrl varchar (255)  = null ,

	@Currency nvarchar (5)  = null ,

	@Sequence int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [SiteCountryID]
	, [SiteID]
	, [CountryID]
	, [SiteCountryName]
	, [SiteCountryFriendlyUrl]
	, [Currency]
	, [Sequence]
    FROM
	[dbo].[SiteCountries]
    WHERE 
	 ([SiteCountryID] = @SiteCountryId OR @SiteCountryId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([CountryID] = @CountryId OR @CountryId IS NULL)
	AND ([SiteCountryName] = @SiteCountryName OR @SiteCountryName IS NULL)
	AND ([SiteCountryFriendlyUrl] = @SiteCountryFriendlyUrl OR @SiteCountryFriendlyUrl IS NULL)
	AND ([Currency] = @Currency OR @Currency IS NULL)
	AND ([Sequence] = @Sequence OR @Sequence IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [SiteCountryID]
	, [SiteID]
	, [CountryID]
	, [SiteCountryName]
	, [SiteCountryFriendlyUrl]
	, [Currency]
	, [Sequence]
    FROM
	[dbo].[SiteCountries]
    WHERE 
	 ([SiteCountryID] = @SiteCountryId AND @SiteCountryId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([CountryID] = @CountryId AND @CountryId is not null)
	OR ([SiteCountryName] = @SiteCountryName AND @SiteCountryName is not null)
	OR ([SiteCountryFriendlyUrl] = @SiteCountryFriendlyUrl AND @SiteCountryFriendlyUrl is not null)
	OR ([Currency] = @Currency AND @Currency is not null)
	OR ([Sequence] = @Sequence AND @Sequence is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteLanguages_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteLanguages_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteLanguages_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the SiteLanguages table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteLanguages_Get_List

AS


				
				SELECT
					[SiteLanguageID],
					[SiteID],
					[LanguageID],
					[SiteLanguageName],
					[ResourceFileName]
				FROM
					[dbo].[SiteLanguages]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteLanguages_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteLanguages_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteLanguages_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the SiteLanguages table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteLanguages_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [SiteLanguageID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([SiteLanguageID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [SiteLanguageID]'
				SET @SQL = @SQL + ' FROM [dbo].[SiteLanguages]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[SiteLanguageID], O.[SiteID], O.[LanguageID], O.[SiteLanguageName], O.[ResourceFileName]
				FROM
				    [dbo].[SiteLanguages] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[SiteLanguageID] = PageIndex.[SiteLanguageID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[SiteLanguages]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteLanguages_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteLanguages_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteLanguages_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the SiteLanguages table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteLanguages_Insert
(

	@SiteLanguageId int    OUTPUT,

	@SiteId int   ,

	@LanguageId int   ,

	@SiteLanguageName nvarchar (255)  ,

	@ResourceFileName nvarchar (512)  
)
AS


				
				INSERT INTO [dbo].[SiteLanguages]
					(
					[SiteID]
					,[LanguageID]
					,[SiteLanguageName]
					,[ResourceFileName]
					)
				VALUES
					(
					@SiteId
					,@LanguageId
					,@SiteLanguageName
					,@ResourceFileName
					)
				
				-- Get the identity value
				SET @SiteLanguageId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteLanguages_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteLanguages_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteLanguages_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the SiteLanguages table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteLanguages_Update
(

	@SiteLanguageId int   ,

	@SiteId int   ,

	@LanguageId int   ,

	@SiteLanguageName nvarchar (255)  ,

	@ResourceFileName nvarchar (512)  
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[SiteLanguages]
				SET
					[SiteID] = @SiteId
					,[LanguageID] = @LanguageId
					,[SiteLanguageName] = @SiteLanguageName
					,[ResourceFileName] = @ResourceFileName
				WHERE
[SiteLanguageID] = @SiteLanguageId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteLanguages_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteLanguages_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteLanguages_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the SiteLanguages table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteLanguages_Delete
(

	@SiteLanguageId int   
)
AS


				DELETE FROM [dbo].[SiteLanguages] WITH (ROWLOCK) 
				WHERE
					[SiteLanguageID] = @SiteLanguageId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteLanguages_GetByLanguageId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteLanguages_GetByLanguageId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteLanguages_GetByLanguageId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteLanguages table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteLanguages_GetByLanguageId
(

	@LanguageId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[SiteLanguageID],
					[SiteID],
					[LanguageID],
					[SiteLanguageName],
					[ResourceFileName]
				FROM
					[dbo].[SiteLanguages]
				WHERE
					[LanguageID] = @LanguageId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteLanguages_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteLanguages_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteLanguages_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteLanguages table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteLanguages_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[SiteLanguageID],
					[SiteID],
					[LanguageID],
					[SiteLanguageName],
					[ResourceFileName]
				FROM
					[dbo].[SiteLanguages]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteLanguages_GetBySiteIdLanguageId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteLanguages_GetBySiteIdLanguageId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteLanguages_GetBySiteIdLanguageId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteLanguages table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteLanguages_GetBySiteIdLanguageId
(

	@SiteId int   ,

	@LanguageId int   
)
AS


				SELECT
					[SiteLanguageID],
					[SiteID],
					[LanguageID],
					[SiteLanguageName],
					[ResourceFileName]
				FROM
					[dbo].[SiteLanguages]
				WHERE
					[SiteID] = @SiteId
					AND [LanguageID] = @LanguageId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteLanguages_GetBySiteLanguageId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteLanguages_GetBySiteLanguageId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteLanguages_GetBySiteLanguageId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteLanguages table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteLanguages_GetBySiteLanguageId
(

	@SiteLanguageId int   
)
AS


				SELECT
					[SiteLanguageID],
					[SiteID],
					[LanguageID],
					[SiteLanguageName],
					[ResourceFileName]
				FROM
					[dbo].[SiteLanguages]
				WHERE
					[SiteLanguageID] = @SiteLanguageId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteLanguages_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteLanguages_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteLanguages_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the SiteLanguages table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteLanguages_Find
(

	@SearchUsingOR bit   = null ,

	@SiteLanguageId int   = null ,

	@SiteId int   = null ,

	@LanguageId int   = null ,

	@SiteLanguageName nvarchar (255)  = null ,

	@ResourceFileName nvarchar (512)  = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [SiteLanguageID]
	, [SiteID]
	, [LanguageID]
	, [SiteLanguageName]
	, [ResourceFileName]
    FROM
	[dbo].[SiteLanguages]
    WHERE 
	 ([SiteLanguageID] = @SiteLanguageId OR @SiteLanguageId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([LanguageID] = @LanguageId OR @LanguageId IS NULL)
	AND ([SiteLanguageName] = @SiteLanguageName OR @SiteLanguageName IS NULL)
	AND ([ResourceFileName] = @ResourceFileName OR @ResourceFileName IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [SiteLanguageID]
	, [SiteID]
	, [LanguageID]
	, [SiteLanguageName]
	, [ResourceFileName]
    FROM
	[dbo].[SiteLanguages]
    WHERE 
	 ([SiteLanguageID] = @SiteLanguageId AND @SiteLanguageId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([LanguageID] = @LanguageId AND @LanguageId is not null)
	OR ([SiteLanguageName] = @SiteLanguageName AND @SiteLanguageName is not null)
	OR ([ResourceFileName] = @ResourceFileName AND @ResourceFileName is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteProfession_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteProfession_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteProfession_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the SiteProfession table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteProfession_Get_List

AS


				
				SELECT
					[SiteProfessionID],
					[SiteID],
					[ProfessionID],
					[SiteProfessionName],
					[Valid],
					[MetaTitle],
					[MetaKeywords],
					[MetaDescription],
					[Sequence],
					[SiteProfessionFriendlyUrl],
					[TotalJobs],
					[CanonicalUrl]
				FROM
					[dbo].[SiteProfession]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteProfession_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteProfession_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteProfession_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the SiteProfession table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteProfession_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [SiteProfessionID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([SiteProfessionID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [SiteProfessionID]'
				SET @SQL = @SQL + ' FROM [dbo].[SiteProfession]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[SiteProfessionID], O.[SiteID], O.[ProfessionID], O.[SiteProfessionName], O.[Valid], O.[MetaTitle], O.[MetaKeywords], O.[MetaDescription], O.[Sequence], O.[SiteProfessionFriendlyUrl], O.[TotalJobs], O.[CanonicalUrl]
				FROM
				    [dbo].[SiteProfession] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[SiteProfessionID] = PageIndex.[SiteProfessionID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[SiteProfession]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteProfession_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteProfession_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteProfession_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the SiteProfession table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteProfession_Insert
(

	@SiteProfessionId int    OUTPUT,

	@SiteId int   ,

	@ProfessionId int   ,

	@SiteProfessionName nvarchar (1020)  ,

	@Valid bit   ,

	@MetaTitle varchar (255)  ,

	@MetaKeywords varchar (255)  ,

	@MetaDescription varchar (512)  ,

	@Sequence int   ,

	@SiteProfessionFriendlyUrl varchar (255)  ,

	@TotalJobs int   ,

	@CanonicalUrl varchar (255)  
)
AS


				
				INSERT INTO [dbo].[SiteProfession]
					(
					[SiteID]
					,[ProfessionID]
					,[SiteProfessionName]
					,[Valid]
					,[MetaTitle]
					,[MetaKeywords]
					,[MetaDescription]
					,[Sequence]
					,[SiteProfessionFriendlyUrl]
					,[TotalJobs]
					,[CanonicalUrl]
					)
				VALUES
					(
					@SiteId
					,@ProfessionId
					,@SiteProfessionName
					,@Valid
					,@MetaTitle
					,@MetaKeywords
					,@MetaDescription
					,@Sequence
					,@SiteProfessionFriendlyUrl
					,@TotalJobs
					,@CanonicalUrl
					)
				
				-- Get the identity value
				SET @SiteProfessionId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteProfession_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteProfession_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteProfession_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the SiteProfession table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteProfession_Update
(

	@SiteProfessionId int   ,

	@SiteId int   ,

	@ProfessionId int   ,

	@SiteProfessionName nvarchar (1020)  ,

	@Valid bit   ,

	@MetaTitle varchar (255)  ,

	@MetaKeywords varchar (255)  ,

	@MetaDescription varchar (512)  ,

	@Sequence int   ,

	@SiteProfessionFriendlyUrl varchar (255)  ,

	@TotalJobs int   ,

	@CanonicalUrl varchar (255)  
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[SiteProfession]
				SET
					[SiteID] = @SiteId
					,[ProfessionID] = @ProfessionId
					,[SiteProfessionName] = @SiteProfessionName
					,[Valid] = @Valid
					,[MetaTitle] = @MetaTitle
					,[MetaKeywords] = @MetaKeywords
					,[MetaDescription] = @MetaDescription
					,[Sequence] = @Sequence
					,[SiteProfessionFriendlyUrl] = @SiteProfessionFriendlyUrl
					,[TotalJobs] = @TotalJobs
					,[CanonicalUrl] = @CanonicalUrl
				WHERE
[SiteProfessionID] = @SiteProfessionId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteProfession_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteProfession_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteProfession_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the SiteProfession table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteProfession_Delete
(

	@SiteProfessionId int   
)
AS


				DELETE FROM [dbo].[SiteProfession] WITH (ROWLOCK) 
				WHERE
					[SiteProfessionID] = @SiteProfessionId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteProfession_GetBySiteIdProfessionId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteProfession_GetBySiteIdProfessionId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteProfession_GetBySiteIdProfessionId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteProfession table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteProfession_GetBySiteIdProfessionId
(

	@SiteId int   ,

	@ProfessionId int   
)
AS


				SELECT
					[SiteProfessionID],
					[SiteID],
					[ProfessionID],
					[SiteProfessionName],
					[Valid],
					[MetaTitle],
					[MetaKeywords],
					[MetaDescription],
					[Sequence],
					[SiteProfessionFriendlyUrl],
					[TotalJobs],
					[CanonicalUrl]
				FROM
					[dbo].[SiteProfession]
				WHERE
					[SiteID] = @SiteId
					AND [ProfessionID] = @ProfessionId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteProfession_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteProfession_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteProfession_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteProfession table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteProfession_GetBySiteId
(

	@SiteId int   
)
AS


				SELECT
					[SiteProfessionID],
					[SiteID],
					[ProfessionID],
					[SiteProfessionName],
					[Valid],
					[MetaTitle],
					[MetaKeywords],
					[MetaDescription],
					[Sequence],
					[SiteProfessionFriendlyUrl],
					[TotalJobs],
					[CanonicalUrl]
				FROM
					[dbo].[SiteProfession]
				WHERE
					[SiteID] = @SiteId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteProfession_GetByProfessionId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteProfession_GetByProfessionId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteProfession_GetByProfessionId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteProfession table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteProfession_GetByProfessionId
(

	@ProfessionId int   
)
AS


				SELECT
					[SiteProfessionID],
					[SiteID],
					[ProfessionID],
					[SiteProfessionName],
					[Valid],
					[MetaTitle],
					[MetaKeywords],
					[MetaDescription],
					[Sequence],
					[SiteProfessionFriendlyUrl],
					[TotalJobs],
					[CanonicalUrl]
				FROM
					[dbo].[SiteProfession]
				WHERE
					[ProfessionID] = @ProfessionId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteProfession_GetBySiteProfessionId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteProfession_GetBySiteProfessionId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteProfession_GetBySiteProfessionId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteProfession table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteProfession_GetBySiteProfessionId
(

	@SiteProfessionId int   
)
AS


				SELECT
					[SiteProfessionID],
					[SiteID],
					[ProfessionID],
					[SiteProfessionName],
					[Valid],
					[MetaTitle],
					[MetaKeywords],
					[MetaDescription],
					[Sequence],
					[SiteProfessionFriendlyUrl],
					[TotalJobs],
					[CanonicalUrl]
				FROM
					[dbo].[SiteProfession]
				WHERE
					[SiteProfessionID] = @SiteProfessionId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteProfession_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteProfession_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteProfession_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the SiteProfession table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteProfession_Find
(

	@SearchUsingOR bit   = null ,

	@SiteProfessionId int   = null ,

	@SiteId int   = null ,

	@ProfessionId int   = null ,

	@SiteProfessionName nvarchar (1020)  = null ,

	@Valid bit   = null ,

	@MetaTitle varchar (255)  = null ,

	@MetaKeywords varchar (255)  = null ,

	@MetaDescription varchar (512)  = null ,

	@Sequence int   = null ,

	@SiteProfessionFriendlyUrl varchar (255)  = null ,

	@TotalJobs int   = null ,

	@CanonicalUrl varchar (255)  = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [SiteProfessionID]
	, [SiteID]
	, [ProfessionID]
	, [SiteProfessionName]
	, [Valid]
	, [MetaTitle]
	, [MetaKeywords]
	, [MetaDescription]
	, [Sequence]
	, [SiteProfessionFriendlyUrl]
	, [TotalJobs]
	, [CanonicalUrl]
    FROM
	[dbo].[SiteProfession]
    WHERE 
	 ([SiteProfessionID] = @SiteProfessionId OR @SiteProfessionId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([ProfessionID] = @ProfessionId OR @ProfessionId IS NULL)
	AND ([SiteProfessionName] = @SiteProfessionName OR @SiteProfessionName IS NULL)
	AND ([Valid] = @Valid OR @Valid IS NULL)
	AND ([MetaTitle] = @MetaTitle OR @MetaTitle IS NULL)
	AND ([MetaKeywords] = @MetaKeywords OR @MetaKeywords IS NULL)
	AND ([MetaDescription] = @MetaDescription OR @MetaDescription IS NULL)
	AND ([Sequence] = @Sequence OR @Sequence IS NULL)
	AND ([SiteProfessionFriendlyUrl] = @SiteProfessionFriendlyUrl OR @SiteProfessionFriendlyUrl IS NULL)
	AND ([TotalJobs] = @TotalJobs OR @TotalJobs IS NULL)
	AND ([CanonicalUrl] = @CanonicalUrl OR @CanonicalUrl IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [SiteProfessionID]
	, [SiteID]
	, [ProfessionID]
	, [SiteProfessionName]
	, [Valid]
	, [MetaTitle]
	, [MetaKeywords]
	, [MetaDescription]
	, [Sequence]
	, [SiteProfessionFriendlyUrl]
	, [TotalJobs]
	, [CanonicalUrl]
    FROM
	[dbo].[SiteProfession]
    WHERE 
	 ([SiteProfessionID] = @SiteProfessionId AND @SiteProfessionId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([ProfessionID] = @ProfessionId AND @ProfessionId is not null)
	OR ([SiteProfessionName] = @SiteProfessionName AND @SiteProfessionName is not null)
	OR ([Valid] = @Valid AND @Valid is not null)
	OR ([MetaTitle] = @MetaTitle AND @MetaTitle is not null)
	OR ([MetaKeywords] = @MetaKeywords AND @MetaKeywords is not null)
	OR ([MetaDescription] = @MetaDescription AND @MetaDescription is not null)
	OR ([Sequence] = @Sequence AND @Sequence is not null)
	OR ([SiteProfessionFriendlyUrl] = @SiteProfessionFriendlyUrl AND @SiteProfessionFriendlyUrl is not null)
	OR ([TotalJobs] = @TotalJobs AND @TotalJobs is not null)
	OR ([CanonicalUrl] = @CanonicalUrl AND @CanonicalUrl is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteLocation_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteLocation_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteLocation_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the SiteLocation table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteLocation_Get_List

AS


				
				SELECT
					[SiteLocationID],
					[LocationID],
					[SiteID],
					[SiteLocationName],
					[Valid],
					[SiteLocationFriendlyUrl]
				FROM
					[dbo].[SiteLocation]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteLocation_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteLocation_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteLocation_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the SiteLocation table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteLocation_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [SiteLocationID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([SiteLocationID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [SiteLocationID]'
				SET @SQL = @SQL + ' FROM [dbo].[SiteLocation]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[SiteLocationID], O.[LocationID], O.[SiteID], O.[SiteLocationName], O.[Valid], O.[SiteLocationFriendlyUrl]
				FROM
				    [dbo].[SiteLocation] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[SiteLocationID] = PageIndex.[SiteLocationID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[SiteLocation]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteLocation_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteLocation_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteLocation_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the SiteLocation table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteLocation_Insert
(

	@SiteLocationId int    OUTPUT,

	@LocationId int   ,

	@SiteId int   ,

	@SiteLocationName nvarchar (1020)  ,

	@Valid bit   ,

	@SiteLocationFriendlyUrl varchar (255)  
)
AS


				
				INSERT INTO [dbo].[SiteLocation]
					(
					[LocationID]
					,[SiteID]
					,[SiteLocationName]
					,[Valid]
					,[SiteLocationFriendlyUrl]
					)
				VALUES
					(
					@LocationId
					,@SiteId
					,@SiteLocationName
					,@Valid
					,@SiteLocationFriendlyUrl
					)
				
				-- Get the identity value
				SET @SiteLocationId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteLocation_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteLocation_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteLocation_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the SiteLocation table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteLocation_Update
(

	@SiteLocationId int   ,

	@LocationId int   ,

	@SiteId int   ,

	@SiteLocationName nvarchar (1020)  ,

	@Valid bit   ,

	@SiteLocationFriendlyUrl varchar (255)  
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[SiteLocation]
				SET
					[LocationID] = @LocationId
					,[SiteID] = @SiteId
					,[SiteLocationName] = @SiteLocationName
					,[Valid] = @Valid
					,[SiteLocationFriendlyUrl] = @SiteLocationFriendlyUrl
				WHERE
[SiteLocationID] = @SiteLocationId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteLocation_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteLocation_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteLocation_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the SiteLocation table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteLocation_Delete
(

	@SiteLocationId int   
)
AS


				DELETE FROM [dbo].[SiteLocation] WITH (ROWLOCK) 
				WHERE
					[SiteLocationID] = @SiteLocationId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteLocation_GetByLocationId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteLocation_GetByLocationId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteLocation_GetByLocationId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteLocation table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteLocation_GetByLocationId
(

	@LocationId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[SiteLocationID],
					[LocationID],
					[SiteID],
					[SiteLocationName],
					[Valid],
					[SiteLocationFriendlyUrl]
				FROM
					[dbo].[SiteLocation]
				WHERE
					[LocationID] = @LocationId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteLocation_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteLocation_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteLocation_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteLocation table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteLocation_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[SiteLocationID],
					[LocationID],
					[SiteID],
					[SiteLocationName],
					[Valid],
					[SiteLocationFriendlyUrl]
				FROM
					[dbo].[SiteLocation]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteLocation_GetBySiteIdLocationIdSiteLocationId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteLocation_GetBySiteIdLocationIdSiteLocationId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteLocation_GetBySiteIdLocationIdSiteLocationId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteLocation table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteLocation_GetBySiteIdLocationIdSiteLocationId
(

	@SiteId int   ,

	@LocationId int   ,

	@SiteLocationId int   
)
AS


				SELECT
					[SiteLocationID],
					[LocationID],
					[SiteID],
					[SiteLocationName],
					[Valid],
					[SiteLocationFriendlyUrl]
				FROM
					[dbo].[SiteLocation]
				WHERE
					[SiteID] = @SiteId
					AND [LocationID] = @LocationId
					AND [SiteLocationID] = @SiteLocationId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteLocation_GetBySiteIdLocationId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteLocation_GetBySiteIdLocationId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteLocation_GetBySiteIdLocationId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteLocation table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteLocation_GetBySiteIdLocationId
(

	@SiteId int   ,

	@LocationId int   
)
AS


				SELECT
					[SiteLocationID],
					[LocationID],
					[SiteID],
					[SiteLocationName],
					[Valid],
					[SiteLocationFriendlyUrl]
				FROM
					[dbo].[SiteLocation]
				WHERE
					[SiteID] = @SiteId
					AND [LocationID] = @LocationId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteLocation_GetBySiteLocationId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteLocation_GetBySiteLocationId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteLocation_GetBySiteLocationId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteLocation table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteLocation_GetBySiteLocationId
(

	@SiteLocationId int   
)
AS


				SELECT
					[SiteLocationID],
					[LocationID],
					[SiteID],
					[SiteLocationName],
					[Valid],
					[SiteLocationFriendlyUrl]
				FROM
					[dbo].[SiteLocation]
				WHERE
					[SiteLocationID] = @SiteLocationId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteLocation_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteLocation_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteLocation_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the SiteLocation table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteLocation_Find
(

	@SearchUsingOR bit   = null ,

	@SiteLocationId int   = null ,

	@LocationId int   = null ,

	@SiteId int   = null ,

	@SiteLocationName nvarchar (1020)  = null ,

	@Valid bit   = null ,

	@SiteLocationFriendlyUrl varchar (255)  = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [SiteLocationID]
	, [LocationID]
	, [SiteID]
	, [SiteLocationName]
	, [Valid]
	, [SiteLocationFriendlyUrl]
    FROM
	[dbo].[SiteLocation]
    WHERE 
	 ([SiteLocationID] = @SiteLocationId OR @SiteLocationId IS NULL)
	AND ([LocationID] = @LocationId OR @LocationId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([SiteLocationName] = @SiteLocationName OR @SiteLocationName IS NULL)
	AND ([Valid] = @Valid OR @Valid IS NULL)
	AND ([SiteLocationFriendlyUrl] = @SiteLocationFriendlyUrl OR @SiteLocationFriendlyUrl IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [SiteLocationID]
	, [LocationID]
	, [SiteID]
	, [SiteLocationName]
	, [Valid]
	, [SiteLocationFriendlyUrl]
    FROM
	[dbo].[SiteLocation]
    WHERE 
	 ([SiteLocationID] = @SiteLocationId AND @SiteLocationId is not null)
	OR ([LocationID] = @LocationId AND @LocationId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([SiteLocationName] = @SiteLocationName AND @SiteLocationName is not null)
	OR ([Valid] = @Valid AND @Valid is not null)
	OR ([SiteLocationFriendlyUrl] = @SiteLocationFriendlyUrl AND @SiteLocationFriendlyUrl is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserJobTemplateLogo_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserJobTemplateLogo_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserJobTemplateLogo_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the AdvertiserJobTemplateLogo table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserJobTemplateLogo_Get_List

AS


				
				SELECT
					[AdvertiserJobTemplateLogoID],
					[AdvertiserID],
					[JobLogoName],
					[JobTemplateLogo],
					[JobTemplateLogoUrl]
				FROM
					[dbo].[AdvertiserJobTemplateLogo]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserJobTemplateLogo_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserJobTemplateLogo_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserJobTemplateLogo_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the AdvertiserJobTemplateLogo table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserJobTemplateLogo_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [AdvertiserJobTemplateLogoID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([AdvertiserJobTemplateLogoID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [AdvertiserJobTemplateLogoID]'
				SET @SQL = @SQL + ' FROM [dbo].[AdvertiserJobTemplateLogo]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[AdvertiserJobTemplateLogoID], O.[AdvertiserID], O.[JobLogoName], O.[JobTemplateLogo], O.[JobTemplateLogoUrl]
				FROM
				    [dbo].[AdvertiserJobTemplateLogo] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[AdvertiserJobTemplateLogoID] = PageIndex.[AdvertiserJobTemplateLogoID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[AdvertiserJobTemplateLogo]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserJobTemplateLogo_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserJobTemplateLogo_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserJobTemplateLogo_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the AdvertiserJobTemplateLogo table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserJobTemplateLogo_Insert
(

	@AdvertiserJobTemplateLogoId int    OUTPUT,

	@AdvertiserId int   ,

	@JobLogoName nvarchar (255)  ,

	@JobTemplateLogo image   ,

	@JobTemplateLogoUrl nvarchar (1000)  
)
AS


				
				INSERT INTO [dbo].[AdvertiserJobTemplateLogo]
					(
					[AdvertiserID]
					,[JobLogoName]
					,[JobTemplateLogo]
					,[JobTemplateLogoUrl]
					)
				VALUES
					(
					@AdvertiserId
					,@JobLogoName
					,@JobTemplateLogo
					,@JobTemplateLogoUrl
					)
				
				-- Get the identity value
				SET @AdvertiserJobTemplateLogoId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserJobTemplateLogo_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserJobTemplateLogo_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserJobTemplateLogo_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the AdvertiserJobTemplateLogo table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserJobTemplateLogo_Update
(

	@AdvertiserJobTemplateLogoId int   ,

	@AdvertiserId int   ,

	@JobLogoName nvarchar (255)  ,

	@JobTemplateLogo image   ,

	@JobTemplateLogoUrl nvarchar (1000)  
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[AdvertiserJobTemplateLogo]
				SET
					[AdvertiserID] = @AdvertiserId
					,[JobLogoName] = @JobLogoName
					,[JobTemplateLogo] = @JobTemplateLogo
					,[JobTemplateLogoUrl] = @JobTemplateLogoUrl
				WHERE
[AdvertiserJobTemplateLogoID] = @AdvertiserJobTemplateLogoId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserJobTemplateLogo_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserJobTemplateLogo_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserJobTemplateLogo_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the AdvertiserJobTemplateLogo table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserJobTemplateLogo_Delete
(

	@AdvertiserJobTemplateLogoId int   
)
AS


				DELETE FROM [dbo].[AdvertiserJobTemplateLogo] WITH (ROWLOCK) 
				WHERE
					[AdvertiserJobTemplateLogoID] = @AdvertiserJobTemplateLogoId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserJobTemplateLogo_GetByAdvertiserId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserJobTemplateLogo_GetByAdvertiserId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserJobTemplateLogo_GetByAdvertiserId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the AdvertiserJobTemplateLogo table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserJobTemplateLogo_GetByAdvertiserId
(

	@AdvertiserId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[AdvertiserJobTemplateLogoID],
					[AdvertiserID],
					[JobLogoName],
					[JobTemplateLogo],
					[JobTemplateLogoUrl]
				FROM
					[dbo].[AdvertiserJobTemplateLogo]
				WHERE
					[AdvertiserID] = @AdvertiserId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserJobTemplateLogo_GetByAdvertiserJobTemplateLogoId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserJobTemplateLogo_GetByAdvertiserJobTemplateLogoId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserJobTemplateLogo_GetByAdvertiserJobTemplateLogoId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the AdvertiserJobTemplateLogo table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserJobTemplateLogo_GetByAdvertiserJobTemplateLogoId
(

	@AdvertiserJobTemplateLogoId int   
)
AS


				SELECT
					[AdvertiserJobTemplateLogoID],
					[AdvertiserID],
					[JobLogoName],
					[JobTemplateLogo],
					[JobTemplateLogoUrl]
				FROM
					[dbo].[AdvertiserJobTemplateLogo]
				WHERE
					[AdvertiserJobTemplateLogoID] = @AdvertiserJobTemplateLogoId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserJobTemplateLogo_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserJobTemplateLogo_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserJobTemplateLogo_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the AdvertiserJobTemplateLogo table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserJobTemplateLogo_Find
(

	@SearchUsingOR bit   = null ,

	@AdvertiserJobTemplateLogoId int   = null ,

	@AdvertiserId int   = null ,

	@JobLogoName nvarchar (255)  = null ,

	@JobTemplateLogo image   = null ,

	@JobTemplateLogoUrl nvarchar (1000)  = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [AdvertiserJobTemplateLogoID]
	, [AdvertiserID]
	, [JobLogoName]
	, [JobTemplateLogo]
	, [JobTemplateLogoUrl]
    FROM
	[dbo].[AdvertiserJobTemplateLogo]
    WHERE 
	 ([AdvertiserJobTemplateLogoID] = @AdvertiserJobTemplateLogoId OR @AdvertiserJobTemplateLogoId IS NULL)
	AND ([AdvertiserID] = @AdvertiserId OR @AdvertiserId IS NULL)
	AND ([JobLogoName] = @JobLogoName OR @JobLogoName IS NULL)
	AND ([JobTemplateLogoUrl] = @JobTemplateLogoUrl OR @JobTemplateLogoUrl IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [AdvertiserJobTemplateLogoID]
	, [AdvertiserID]
	, [JobLogoName]
	, [JobTemplateLogo]
	, [JobTemplateLogoUrl]
    FROM
	[dbo].[AdvertiserJobTemplateLogo]
    WHERE 
	 ([AdvertiserJobTemplateLogoID] = @AdvertiserJobTemplateLogoId AND @AdvertiserJobTemplateLogoId is not null)
	OR ([AdvertiserID] = @AdvertiserId AND @AdvertiserId is not null)
	OR ([JobLogoName] = @JobLogoName AND @JobLogoName is not null)
	OR ([JobTemplateLogoUrl] = @JobTemplateLogoUrl AND @JobTemplateLogoUrl is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteMappings_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteMappings_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteMappings_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the SiteMappings table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteMappings_Get_List

AS


				
				SELECT
					[SiteMappingID],
					[SiteID],
					[MasterSiteID]
				FROM
					[dbo].[SiteMappings]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteMappings_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteMappings_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteMappings_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the SiteMappings table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteMappings_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [SiteMappingID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([SiteMappingID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [SiteMappingID]'
				SET @SQL = @SQL + ' FROM [dbo].[SiteMappings]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[SiteMappingID], O.[SiteID], O.[MasterSiteID]
				FROM
				    [dbo].[SiteMappings] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[SiteMappingID] = PageIndex.[SiteMappingID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[SiteMappings]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteMappings_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteMappings_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteMappings_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the SiteMappings table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteMappings_Insert
(

	@SiteMappingId int    OUTPUT,

	@SiteId int   ,

	@MasterSiteId int   
)
AS


				
				INSERT INTO [dbo].[SiteMappings]
					(
					[SiteID]
					,[MasterSiteID]
					)
				VALUES
					(
					@SiteId
					,@MasterSiteId
					)
				
				-- Get the identity value
				SET @SiteMappingId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteMappings_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteMappings_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteMappings_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the SiteMappings table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteMappings_Update
(

	@SiteMappingId int   ,

	@SiteId int   ,

	@MasterSiteId int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[SiteMappings]
				SET
					[SiteID] = @SiteId
					,[MasterSiteID] = @MasterSiteId
				WHERE
[SiteMappingID] = @SiteMappingId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteMappings_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteMappings_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteMappings_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the SiteMappings table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteMappings_Delete
(

	@SiteMappingId int   
)
AS


				DELETE FROM [dbo].[SiteMappings] WITH (ROWLOCK) 
				WHERE
					[SiteMappingID] = @SiteMappingId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteMappings_GetByMasterSiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteMappings_GetByMasterSiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteMappings_GetByMasterSiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteMappings table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteMappings_GetByMasterSiteId
(

	@MasterSiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[SiteMappingID],
					[SiteID],
					[MasterSiteID]
				FROM
					[dbo].[SiteMappings]
				WHERE
					[MasterSiteID] = @MasterSiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteMappings_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteMappings_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteMappings_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteMappings table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteMappings_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[SiteMappingID],
					[SiteID],
					[MasterSiteID]
				FROM
					[dbo].[SiteMappings]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteMappings_GetBySiteMappingId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteMappings_GetBySiteMappingId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteMappings_GetBySiteMappingId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the SiteMappings table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteMappings_GetBySiteMappingId
(

	@SiteMappingId int   
)
AS


				SELECT
					[SiteMappingID],
					[SiteID],
					[MasterSiteID]
				FROM
					[dbo].[SiteMappings]
				WHERE
					[SiteMappingID] = @SiteMappingId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.SiteMappings_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.SiteMappings_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.SiteMappings_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the SiteMappings table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.SiteMappings_Find
(

	@SearchUsingOR bit   = null ,

	@SiteMappingId int   = null ,

	@SiteId int   = null ,

	@MasterSiteId int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [SiteMappingID]
	, [SiteID]
	, [MasterSiteID]
    FROM
	[dbo].[SiteMappings]
    WHERE 
	 ([SiteMappingID] = @SiteMappingId OR @SiteMappingId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([MasterSiteID] = @MasterSiteId OR @MasterSiteId IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [SiteMappingID]
	, [SiteID]
	, [MasterSiteID]
    FROM
	[dbo].[SiteMappings]
    WHERE 
	 ([SiteMappingID] = @SiteMappingId AND @SiteMappingId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([MasterSiteID] = @MasterSiteId AND @MasterSiteId is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberFiles_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberFiles_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberFiles_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the MemberFiles table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberFiles_Get_List

AS


				
				SELECT
					[MemberFileID],
					[MemberID],
					[MemberFileTypeID],
					[MemberFileName],
					[MemberFileSearchExtension],
					[MemberFileContent],
					[MemberFileTitle],
					[LastModifiedDate],
					[DocumentTypeID],
					[MemberFileUrl]
				FROM
					[dbo].[MemberFiles]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberFiles_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberFiles_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberFiles_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the MemberFiles table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberFiles_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [MemberFileID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([MemberFileID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [MemberFileID]'
				SET @SQL = @SQL + ' FROM [dbo].[MemberFiles]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[MemberFileID], O.[MemberID], O.[MemberFileTypeID], O.[MemberFileName], O.[MemberFileSearchExtension], O.[MemberFileContent], O.[MemberFileTitle], O.[LastModifiedDate], O.[DocumentTypeID], O.[MemberFileUrl]
				FROM
				    [dbo].[MemberFiles] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[MemberFileID] = PageIndex.[MemberFileID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[MemberFiles]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberFiles_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberFiles_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberFiles_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the MemberFiles table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberFiles_Insert
(

	@MemberFileId int    OUTPUT,

	@MemberId int   ,

	@MemberFileTypeId int   ,

	@MemberFileName nvarchar (500)  ,

	@MemberFileSearchExtension varchar (8)  ,

	@MemberFileContent image   ,

	@MemberFileTitle nvarchar (500)  ,

	@LastModifiedDate datetime   ,

	@DocumentTypeId int   ,

	@MemberFileUrl nvarchar (1000)  
)
AS


				
				INSERT INTO [dbo].[MemberFiles]
					(
					[MemberID]
					,[MemberFileTypeID]
					,[MemberFileName]
					,[MemberFileSearchExtension]
					,[MemberFileContent]
					,[MemberFileTitle]
					,[LastModifiedDate]
					,[DocumentTypeID]
					,[MemberFileUrl]
					)
				VALUES
					(
					@MemberId
					,@MemberFileTypeId
					,@MemberFileName
					,@MemberFileSearchExtension
					,@MemberFileContent
					,@MemberFileTitle
					,@LastModifiedDate
					,@DocumentTypeId
					,@MemberFileUrl
					)
				
				-- Get the identity value
				SET @MemberFileId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberFiles_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberFiles_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberFiles_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the MemberFiles table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberFiles_Update
(

	@MemberFileId int   ,

	@MemberId int   ,

	@MemberFileTypeId int   ,

	@MemberFileName nvarchar (500)  ,

	@MemberFileSearchExtension varchar (8)  ,

	@MemberFileContent image   ,

	@MemberFileTitle nvarchar (500)  ,

	@LastModifiedDate datetime   ,

	@DocumentTypeId int   ,

	@MemberFileUrl nvarchar (1000)  
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[MemberFiles]
				SET
					[MemberID] = @MemberId
					,[MemberFileTypeID] = @MemberFileTypeId
					,[MemberFileName] = @MemberFileName
					,[MemberFileSearchExtension] = @MemberFileSearchExtension
					,[MemberFileContent] = @MemberFileContent
					,[MemberFileTitle] = @MemberFileTitle
					,[LastModifiedDate] = @LastModifiedDate
					,[DocumentTypeID] = @DocumentTypeId
					,[MemberFileUrl] = @MemberFileUrl
				WHERE
[MemberFileID] = @MemberFileId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberFiles_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberFiles_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberFiles_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the MemberFiles table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberFiles_Delete
(

	@MemberFileId int   
)
AS


				DELETE FROM [dbo].[MemberFiles] WITH (ROWLOCK) 
				WHERE
					[MemberFileID] = @MemberFileId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberFiles_GetByMemberId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberFiles_GetByMemberId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberFiles_GetByMemberId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the MemberFiles table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberFiles_GetByMemberId
(

	@MemberId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[MemberFileID],
					[MemberID],
					[MemberFileTypeID],
					[MemberFileName],
					[MemberFileSearchExtension],
					[MemberFileContent],
					[MemberFileTitle],
					[LastModifiedDate],
					[DocumentTypeID],
					[MemberFileUrl]
				FROM
					[dbo].[MemberFiles]
				WHERE
					[MemberID] = @MemberId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberFiles_GetByMemberFileTypeId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberFiles_GetByMemberFileTypeId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberFiles_GetByMemberFileTypeId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the MemberFiles table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberFiles_GetByMemberFileTypeId
(

	@MemberFileTypeId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[MemberFileID],
					[MemberID],
					[MemberFileTypeID],
					[MemberFileName],
					[MemberFileSearchExtension],
					[MemberFileContent],
					[MemberFileTitle],
					[LastModifiedDate],
					[DocumentTypeID],
					[MemberFileUrl]
				FROM
					[dbo].[MemberFiles]
				WHERE
					[MemberFileTypeID] = @MemberFileTypeId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberFiles_GetByMemberFileId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberFiles_GetByMemberFileId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberFiles_GetByMemberFileId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the MemberFiles table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberFiles_GetByMemberFileId
(

	@MemberFileId int   
)
AS


				SELECT
					[MemberFileID],
					[MemberID],
					[MemberFileTypeID],
					[MemberFileName],
					[MemberFileSearchExtension],
					[MemberFileContent],
					[MemberFileTitle],
					[LastModifiedDate],
					[DocumentTypeID],
					[MemberFileUrl]
				FROM
					[dbo].[MemberFiles]
				WHERE
					[MemberFileID] = @MemberFileId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberFiles_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberFiles_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberFiles_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the MemberFiles table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberFiles_Find
(

	@SearchUsingOR bit   = null ,

	@MemberFileId int   = null ,

	@MemberId int   = null ,

	@MemberFileTypeId int   = null ,

	@MemberFileName nvarchar (500)  = null ,

	@MemberFileSearchExtension varchar (8)  = null ,

	@MemberFileContent image   = null ,

	@MemberFileTitle nvarchar (500)  = null ,

	@LastModifiedDate datetime   = null ,

	@DocumentTypeId int   = null ,

	@MemberFileUrl nvarchar (1000)  = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [MemberFileID]
	, [MemberID]
	, [MemberFileTypeID]
	, [MemberFileName]
	, [MemberFileSearchExtension]
	, [MemberFileContent]
	, [MemberFileTitle]
	, [LastModifiedDate]
	, [DocumentTypeID]
	, [MemberFileUrl]
    FROM
	[dbo].[MemberFiles]
    WHERE 
	 ([MemberFileID] = @MemberFileId OR @MemberFileId IS NULL)
	AND ([MemberID] = @MemberId OR @MemberId IS NULL)
	AND ([MemberFileTypeID] = @MemberFileTypeId OR @MemberFileTypeId IS NULL)
	AND ([MemberFileName] = @MemberFileName OR @MemberFileName IS NULL)
	AND ([MemberFileSearchExtension] = @MemberFileSearchExtension OR @MemberFileSearchExtension IS NULL)
	AND ([MemberFileTitle] = @MemberFileTitle OR @MemberFileTitle IS NULL)
	AND ([LastModifiedDate] = @LastModifiedDate OR @LastModifiedDate IS NULL)
	AND ([DocumentTypeID] = @DocumentTypeId OR @DocumentTypeId IS NULL)
	AND ([MemberFileUrl] = @MemberFileUrl OR @MemberFileUrl IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [MemberFileID]
	, [MemberID]
	, [MemberFileTypeID]
	, [MemberFileName]
	, [MemberFileSearchExtension]
	, [MemberFileContent]
	, [MemberFileTitle]
	, [LastModifiedDate]
	, [DocumentTypeID]
	, [MemberFileUrl]
    FROM
	[dbo].[MemberFiles]
    WHERE 
	 ([MemberFileID] = @MemberFileId AND @MemberFileId is not null)
	OR ([MemberID] = @MemberId AND @MemberId is not null)
	OR ([MemberFileTypeID] = @MemberFileTypeId AND @MemberFileTypeId is not null)
	OR ([MemberFileName] = @MemberFileName AND @MemberFileName is not null)
	OR ([MemberFileSearchExtension] = @MemberFileSearchExtension AND @MemberFileSearchExtension is not null)
	OR ([MemberFileTitle] = @MemberFileTitle AND @MemberFileTitle is not null)
	OR ([LastModifiedDate] = @LastModifiedDate AND @LastModifiedDate is not null)
	OR ([DocumentTypeID] = @DocumentTypeId AND @DocumentTypeId is not null)
	OR ([MemberFileUrl] = @MemberFileUrl AND @MemberFileUrl is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Files_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Files_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Files_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the Files table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Files_Get_List

AS


				
				SELECT
					[FileID],
					[SiteID],
					[FolderID],
					[FileName],
					[FileSystemName],
					[FileTypeID],
					[LastModified],
					[LastModifiedBy],
					[SourceID]
				FROM
					[dbo].[Files]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Files_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Files_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Files_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the Files table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Files_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [FileID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([FileID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [FileID]'
				SET @SQL = @SQL + ' FROM [dbo].[Files]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[FileID], O.[SiteID], O.[FolderID], O.[FileName], O.[FileSystemName], O.[FileTypeID], O.[LastModified], O.[LastModifiedBy], O.[SourceID]
				FROM
				    [dbo].[Files] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[FileID] = PageIndex.[FileID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[Files]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Files_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Files_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Files_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the Files table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Files_Insert
(

	@FileId int    OUTPUT,

	@SiteId int   ,

	@FolderId int   ,

	@FileName nvarchar (500)  ,

	@FileSystemName nvarchar (500)  ,

	@FileTypeId int   ,

	@LastModified datetime   ,

	@LastModifiedBy int   ,

	@SourceId int   
)
AS


				
				INSERT INTO [dbo].[Files]
					(
					[SiteID]
					,[FolderID]
					,[FileName]
					,[FileSystemName]
					,[FileTypeID]
					,[LastModified]
					,[LastModifiedBy]
					,[SourceID]
					)
				VALUES
					(
					@SiteId
					,@FolderId
					,@FileName
					,@FileSystemName
					,@FileTypeId
					,@LastModified
					,@LastModifiedBy
					,@SourceId
					)
				
				-- Get the identity value
				SET @FileId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Files_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Files_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Files_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the Files table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Files_Update
(

	@FileId int   ,

	@SiteId int   ,

	@FolderId int   ,

	@FileName nvarchar (500)  ,

	@FileSystemName nvarchar (500)  ,

	@FileTypeId int   ,

	@LastModified datetime   ,

	@LastModifiedBy int   ,

	@SourceId int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[Files]
				SET
					[SiteID] = @SiteId
					,[FolderID] = @FolderId
					,[FileName] = @FileName
					,[FileSystemName] = @FileSystemName
					,[FileTypeID] = @FileTypeId
					,[LastModified] = @LastModified
					,[LastModifiedBy] = @LastModifiedBy
					,[SourceID] = @SourceId
				WHERE
[FileID] = @FileId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Files_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Files_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Files_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the Files table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Files_Delete
(

	@FileId int   
)
AS


				DELETE FROM [dbo].[Files] WITH (ROWLOCK) 
				WHERE
					[FileID] = @FileId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Files_GetByLastModifiedBy procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Files_GetByLastModifiedBy') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Files_GetByLastModifiedBy
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Files table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Files_GetByLastModifiedBy
(

	@LastModifiedBy int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[FileID],
					[SiteID],
					[FolderID],
					[FileName],
					[FileSystemName],
					[FileTypeID],
					[LastModified],
					[LastModifiedBy],
					[SourceID]
				FROM
					[dbo].[Files]
				WHERE
					[LastModifiedBy] = @LastModifiedBy
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Files_GetByFileTypeId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Files_GetByFileTypeId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Files_GetByFileTypeId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Files table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Files_GetByFileTypeId
(

	@FileTypeId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[FileID],
					[SiteID],
					[FolderID],
					[FileName],
					[FileSystemName],
					[FileTypeID],
					[LastModified],
					[LastModifiedBy],
					[SourceID]
				FROM
					[dbo].[Files]
				WHERE
					[FileTypeID] = @FileTypeId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Files_GetByFolderId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Files_GetByFolderId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Files_GetByFolderId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Files table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Files_GetByFolderId
(

	@FolderId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[FileID],
					[SiteID],
					[FolderID],
					[FileName],
					[FileSystemName],
					[FileTypeID],
					[LastModified],
					[LastModifiedBy],
					[SourceID]
				FROM
					[dbo].[Files]
				WHERE
					[FolderID] = @FolderId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Files_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Files_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Files_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Files table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Files_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[FileID],
					[SiteID],
					[FolderID],
					[FileName],
					[FileSystemName],
					[FileTypeID],
					[LastModified],
					[LastModifiedBy],
					[SourceID]
				FROM
					[dbo].[Files]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Files_GetByFolderIdSiteIdFileName procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Files_GetByFolderIdSiteIdFileName') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Files_GetByFolderIdSiteIdFileName
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Files table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Files_GetByFolderIdSiteIdFileName
(

	@FolderId int   ,

	@SiteId int   ,

	@FileName nvarchar (500)  
)
AS


				SELECT
					[FileID],
					[SiteID],
					[FolderID],
					[FileName],
					[FileSystemName],
					[FileTypeID],
					[LastModified],
					[LastModifiedBy],
					[SourceID]
				FROM
					[dbo].[Files]
				WHERE
					[FolderID] = @FolderId
					AND [SiteID] = @SiteId
					AND [FileName] = @FileName
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Files_GetByFileId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Files_GetByFileId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Files_GetByFileId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Files table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Files_GetByFileId
(

	@FileId int   
)
AS


				SELECT
					[FileID],
					[SiteID],
					[FolderID],
					[FileName],
					[FileSystemName],
					[FileTypeID],
					[LastModified],
					[LastModifiedBy],
					[SourceID]
				FROM
					[dbo].[Files]
				WHERE
					[FileID] = @FileId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Files_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Files_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Files_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the Files table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Files_Find
(

	@SearchUsingOR bit   = null ,

	@FileId int   = null ,

	@SiteId int   = null ,

	@FolderId int   = null ,

	@FileName nvarchar (500)  = null ,

	@FileSystemName nvarchar (500)  = null ,

	@FileTypeId int   = null ,

	@LastModified datetime   = null ,

	@LastModifiedBy int   = null ,

	@SourceId int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [FileID]
	, [SiteID]
	, [FolderID]
	, [FileName]
	, [FileSystemName]
	, [FileTypeID]
	, [LastModified]
	, [LastModifiedBy]
	, [SourceID]
    FROM
	[dbo].[Files]
    WHERE 
	 ([FileID] = @FileId OR @FileId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([FolderID] = @FolderId OR @FolderId IS NULL)
	AND ([FileName] = @FileName OR @FileName IS NULL)
	AND ([FileSystemName] = @FileSystemName OR @FileSystemName IS NULL)
	AND ([FileTypeID] = @FileTypeId OR @FileTypeId IS NULL)
	AND ([LastModified] = @LastModified OR @LastModified IS NULL)
	AND ([LastModifiedBy] = @LastModifiedBy OR @LastModifiedBy IS NULL)
	AND ([SourceID] = @SourceId OR @SourceId IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [FileID]
	, [SiteID]
	, [FolderID]
	, [FileName]
	, [FileSystemName]
	, [FileTypeID]
	, [LastModified]
	, [LastModifiedBy]
	, [SourceID]
    FROM
	[dbo].[Files]
    WHERE 
	 ([FileID] = @FileId AND @FileId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([FolderID] = @FolderId AND @FolderId is not null)
	OR ([FileName] = @FileName AND @FileName is not null)
	OR ([FileSystemName] = @FileSystemName AND @FileSystemName is not null)
	OR ([FileTypeID] = @FileTypeId AND @FileTypeId is not null)
	OR ([LastModified] = @LastModified AND @LastModified is not null)
	OR ([LastModifiedBy] = @LastModifiedBy AND @LastModifiedBy is not null)
	OR ([SourceID] = @SourceId AND @SourceId is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberCertificateMemberships_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberCertificateMemberships_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberCertificateMemberships_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the MemberCertificateMemberships table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberCertificateMemberships_Get_List

AS


				
				SELECT
					[MemberCertificateMembershipID],
					[MemberID],
					[MemberCertificateMembershipName],
					[CertificationAuthority],
					[LicenseNumber],
					[CertificationURL],
					[StartMonth],
					[StartYear],
					[EndMonth],
					[EndYear],
					[DoesnotExpire],
					[LastModifiedDate]
				FROM
					[dbo].[MemberCertificateMemberships]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberCertificateMemberships_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberCertificateMemberships_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberCertificateMemberships_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the MemberCertificateMemberships table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberCertificateMemberships_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [MemberCertificateMembershipID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([MemberCertificateMembershipID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [MemberCertificateMembershipID]'
				SET @SQL = @SQL + ' FROM [dbo].[MemberCertificateMemberships]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[MemberCertificateMembershipID], O.[MemberID], O.[MemberCertificateMembershipName], O.[CertificationAuthority], O.[LicenseNumber], O.[CertificationURL], O.[StartMonth], O.[StartYear], O.[EndMonth], O.[EndYear], O.[DoesnotExpire], O.[LastModifiedDate]
				FROM
				    [dbo].[MemberCertificateMemberships] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[MemberCertificateMembershipID] = PageIndex.[MemberCertificateMembershipID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[MemberCertificateMemberships]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberCertificateMemberships_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberCertificateMemberships_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberCertificateMemberships_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the MemberCertificateMemberships table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberCertificateMemberships_Insert
(

	@MemberCertificateMembershipId int    OUTPUT,

	@MemberId int   ,

	@MemberCertificateMembershipName nvarchar (600)  ,

	@CertificationAuthority nvarchar (100)  ,

	@LicenseNumber nvarchar (100)  ,

	@CertificationUrl nvarchar (256)  ,

	@StartMonth int   ,

	@StartYear int   ,

	@EndMonth int   ,

	@EndYear int   ,

	@DoesnotExpire bit   ,

	@LastModifiedDate datetime   
)
AS


				
				INSERT INTO [dbo].[MemberCertificateMemberships]
					(
					[MemberID]
					,[MemberCertificateMembershipName]
					,[CertificationAuthority]
					,[LicenseNumber]
					,[CertificationURL]
					,[StartMonth]
					,[StartYear]
					,[EndMonth]
					,[EndYear]
					,[DoesnotExpire]
					,[LastModifiedDate]
					)
				VALUES
					(
					@MemberId
					,@MemberCertificateMembershipName
					,@CertificationAuthority
					,@LicenseNumber
					,@CertificationUrl
					,@StartMonth
					,@StartYear
					,@EndMonth
					,@EndYear
					,@DoesnotExpire
					,@LastModifiedDate
					)
				
				-- Get the identity value
				SET @MemberCertificateMembershipId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberCertificateMemberships_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberCertificateMemberships_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberCertificateMemberships_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the MemberCertificateMemberships table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberCertificateMemberships_Update
(

	@MemberCertificateMembershipId int   ,

	@MemberId int   ,

	@MemberCertificateMembershipName nvarchar (600)  ,

	@CertificationAuthority nvarchar (100)  ,

	@LicenseNumber nvarchar (100)  ,

	@CertificationUrl nvarchar (256)  ,

	@StartMonth int   ,

	@StartYear int   ,

	@EndMonth int   ,

	@EndYear int   ,

	@DoesnotExpire bit   ,

	@LastModifiedDate datetime   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[MemberCertificateMemberships]
				SET
					[MemberID] = @MemberId
					,[MemberCertificateMembershipName] = @MemberCertificateMembershipName
					,[CertificationAuthority] = @CertificationAuthority
					,[LicenseNumber] = @LicenseNumber
					,[CertificationURL] = @CertificationUrl
					,[StartMonth] = @StartMonth
					,[StartYear] = @StartYear
					,[EndMonth] = @EndMonth
					,[EndYear] = @EndYear
					,[DoesnotExpire] = @DoesnotExpire
					,[LastModifiedDate] = @LastModifiedDate
				WHERE
[MemberCertificateMembershipID] = @MemberCertificateMembershipId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberCertificateMemberships_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberCertificateMemberships_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberCertificateMemberships_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the MemberCertificateMemberships table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberCertificateMemberships_Delete
(

	@MemberCertificateMembershipId int   
)
AS


				DELETE FROM [dbo].[MemberCertificateMemberships] WITH (ROWLOCK) 
				WHERE
					[MemberCertificateMembershipID] = @MemberCertificateMembershipId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberCertificateMemberships_GetByMemberId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberCertificateMemberships_GetByMemberId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberCertificateMemberships_GetByMemberId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the MemberCertificateMemberships table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberCertificateMemberships_GetByMemberId
(

	@MemberId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[MemberCertificateMembershipID],
					[MemberID],
					[MemberCertificateMembershipName],
					[CertificationAuthority],
					[LicenseNumber],
					[CertificationURL],
					[StartMonth],
					[StartYear],
					[EndMonth],
					[EndYear],
					[DoesnotExpire],
					[LastModifiedDate]
				FROM
					[dbo].[MemberCertificateMemberships]
				WHERE
					[MemberID] = @MemberId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberCertificateMemberships_GetByMemberCertificateMembershipId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberCertificateMemberships_GetByMemberCertificateMembershipId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberCertificateMemberships_GetByMemberCertificateMembershipId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the MemberCertificateMemberships table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberCertificateMemberships_GetByMemberCertificateMembershipId
(

	@MemberCertificateMembershipId int   
)
AS


				SELECT
					[MemberCertificateMembershipID],
					[MemberID],
					[MemberCertificateMembershipName],
					[CertificationAuthority],
					[LicenseNumber],
					[CertificationURL],
					[StartMonth],
					[StartYear],
					[EndMonth],
					[EndYear],
					[DoesnotExpire],
					[LastModifiedDate]
				FROM
					[dbo].[MemberCertificateMemberships]
				WHERE
					[MemberCertificateMembershipID] = @MemberCertificateMembershipId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.MemberCertificateMemberships_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.MemberCertificateMemberships_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.MemberCertificateMemberships_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the MemberCertificateMemberships table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.MemberCertificateMemberships_Find
(

	@SearchUsingOR bit   = null ,

	@MemberCertificateMembershipId int   = null ,

	@MemberId int   = null ,

	@MemberCertificateMembershipName nvarchar (600)  = null ,

	@CertificationAuthority nvarchar (100)  = null ,

	@LicenseNumber nvarchar (100)  = null ,

	@CertificationUrl nvarchar (256)  = null ,

	@StartMonth int   = null ,

	@StartYear int   = null ,

	@EndMonth int   = null ,

	@EndYear int   = null ,

	@DoesnotExpire bit   = null ,

	@LastModifiedDate datetime   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [MemberCertificateMembershipID]
	, [MemberID]
	, [MemberCertificateMembershipName]
	, [CertificationAuthority]
	, [LicenseNumber]
	, [CertificationURL]
	, [StartMonth]
	, [StartYear]
	, [EndMonth]
	, [EndYear]
	, [DoesnotExpire]
	, [LastModifiedDate]
    FROM
	[dbo].[MemberCertificateMemberships]
    WHERE 
	 ([MemberCertificateMembershipID] = @MemberCertificateMembershipId OR @MemberCertificateMembershipId IS NULL)
	AND ([MemberID] = @MemberId OR @MemberId IS NULL)
	AND ([MemberCertificateMembershipName] = @MemberCertificateMembershipName OR @MemberCertificateMembershipName IS NULL)
	AND ([CertificationAuthority] = @CertificationAuthority OR @CertificationAuthority IS NULL)
	AND ([LicenseNumber] = @LicenseNumber OR @LicenseNumber IS NULL)
	AND ([CertificationURL] = @CertificationUrl OR @CertificationUrl IS NULL)
	AND ([StartMonth] = @StartMonth OR @StartMonth IS NULL)
	AND ([StartYear] = @StartYear OR @StartYear IS NULL)
	AND ([EndMonth] = @EndMonth OR @EndMonth IS NULL)
	AND ([EndYear] = @EndYear OR @EndYear IS NULL)
	AND ([DoesnotExpire] = @DoesnotExpire OR @DoesnotExpire IS NULL)
	AND ([LastModifiedDate] = @LastModifiedDate OR @LastModifiedDate IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [MemberCertificateMembershipID]
	, [MemberID]
	, [MemberCertificateMembershipName]
	, [CertificationAuthority]
	, [LicenseNumber]
	, [CertificationURL]
	, [StartMonth]
	, [StartYear]
	, [EndMonth]
	, [EndYear]
	, [DoesnotExpire]
	, [LastModifiedDate]
    FROM
	[dbo].[MemberCertificateMemberships]
    WHERE 
	 ([MemberCertificateMembershipID] = @MemberCertificateMembershipId AND @MemberCertificateMembershipId is not null)
	OR ([MemberID] = @MemberId AND @MemberId is not null)
	OR ([MemberCertificateMembershipName] = @MemberCertificateMembershipName AND @MemberCertificateMembershipName is not null)
	OR ([CertificationAuthority] = @CertificationAuthority AND @CertificationAuthority is not null)
	OR ([LicenseNumber] = @LicenseNumber AND @LicenseNumber is not null)
	OR ([CertificationURL] = @CertificationUrl AND @CertificationUrl is not null)
	OR ([StartMonth] = @StartMonth AND @StartMonth is not null)
	OR ([StartYear] = @StartYear AND @StartYear is not null)
	OR ([EndMonth] = @EndMonth AND @EndMonth is not null)
	OR ([EndYear] = @EndYear AND @EndYear is not null)
	OR ([DoesnotExpire] = @DoesnotExpire AND @DoesnotExpire is not null)
	OR ([LastModifiedDate] = @LastModifiedDate AND @LastModifiedDate is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.CustomPayment_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.CustomPayment_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.CustomPayment_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the CustomPayment table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.CustomPayment_Get_List

AS


				
				SELECT
					[CustomPaymentID],
					[CustomPaymentGuid],
					[Name],
					[EmailAddress],
					[InvoiceNumber],
					[Amount],
					[Comments],
					[CreatedDate],
					[IpAddress],
					[Response],
					[SecurePay],
					[Paypal],
					[Paid],
					[PaymentNameOnCard],
					[PaymentCardNumber],
					[PaymentCCV],
					[PaymentExpiry],
					[PaymentType],
					[SiteID]
				FROM
					[dbo].[CustomPayment]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.CustomPayment_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.CustomPayment_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.CustomPayment_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the CustomPayment table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.CustomPayment_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [CustomPaymentID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([CustomPaymentID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [CustomPaymentID]'
				SET @SQL = @SQL + ' FROM [dbo].[CustomPayment]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[CustomPaymentID], O.[CustomPaymentGuid], O.[Name], O.[EmailAddress], O.[InvoiceNumber], O.[Amount], O.[Comments], O.[CreatedDate], O.[IpAddress], O.[Response], O.[SecurePay], O.[Paypal], O.[Paid], O.[PaymentNameOnCard], O.[PaymentCardNumber], O.[PaymentCCV], O.[PaymentExpiry], O.[PaymentType], O.[SiteID]
				FROM
				    [dbo].[CustomPayment] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[CustomPaymentID] = PageIndex.[CustomPaymentID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[CustomPayment]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.CustomPayment_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.CustomPayment_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.CustomPayment_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the CustomPayment table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.CustomPayment_Insert
(

	@CustomPaymentId int    OUTPUT,

	@CustomPaymentGuid uniqueidentifier   ,

	@Name nvarchar (200)  ,

	@EmailAddress nvarchar (100)  ,

	@InvoiceNumber nvarchar (100)  ,

	@Amount decimal (18, 2)  ,

	@Comments nvarchar (MAX)  ,

	@CreatedDate datetime   ,

	@IpAddress nvarchar (200)  ,

	@Response nvarchar (MAX)  ,

	@SecurePay bit   ,

	@Paypal bit   ,

	@Paid bit   ,

	@PaymentNameOnCard nvarchar (200)  ,

	@PaymentCardNumber nvarchar (50)  ,

	@PaymentCcv nvarchar (50)  ,

	@PaymentExpiry nvarchar (20)  ,

	@PaymentType nvarchar (50)  ,

	@SiteId int   
)
AS


				
				INSERT INTO [dbo].[CustomPayment]
					(
					[CustomPaymentGuid]
					,[Name]
					,[EmailAddress]
					,[InvoiceNumber]
					,[Amount]
					,[Comments]
					,[CreatedDate]
					,[IpAddress]
					,[Response]
					,[SecurePay]
					,[Paypal]
					,[Paid]
					,[PaymentNameOnCard]
					,[PaymentCardNumber]
					,[PaymentCCV]
					,[PaymentExpiry]
					,[PaymentType]
					,[SiteID]
					)
				VALUES
					(
					@CustomPaymentGuid
					,@Name
					,@EmailAddress
					,@InvoiceNumber
					,@Amount
					,@Comments
					,@CreatedDate
					,@IpAddress
					,@Response
					,@SecurePay
					,@Paypal
					,@Paid
					,@PaymentNameOnCard
					,@PaymentCardNumber
					,@PaymentCcv
					,@PaymentExpiry
					,@PaymentType
					,@SiteId
					)
				
				-- Get the identity value
				SET @CustomPaymentId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.CustomPayment_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.CustomPayment_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.CustomPayment_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the CustomPayment table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.CustomPayment_Update
(

	@CustomPaymentId int   ,

	@CustomPaymentGuid uniqueidentifier   ,

	@Name nvarchar (200)  ,

	@EmailAddress nvarchar (100)  ,

	@InvoiceNumber nvarchar (100)  ,

	@Amount decimal (18, 2)  ,

	@Comments nvarchar (MAX)  ,

	@CreatedDate datetime   ,

	@IpAddress nvarchar (200)  ,

	@Response nvarchar (MAX)  ,

	@SecurePay bit   ,

	@Paypal bit   ,

	@Paid bit   ,

	@PaymentNameOnCard nvarchar (200)  ,

	@PaymentCardNumber nvarchar (50)  ,

	@PaymentCcv nvarchar (50)  ,

	@PaymentExpiry nvarchar (20)  ,

	@PaymentType nvarchar (50)  ,

	@SiteId int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[CustomPayment]
				SET
					[CustomPaymentGuid] = @CustomPaymentGuid
					,[Name] = @Name
					,[EmailAddress] = @EmailAddress
					,[InvoiceNumber] = @InvoiceNumber
					,[Amount] = @Amount
					,[Comments] = @Comments
					,[CreatedDate] = @CreatedDate
					,[IpAddress] = @IpAddress
					,[Response] = @Response
					,[SecurePay] = @SecurePay
					,[Paypal] = @Paypal
					,[Paid] = @Paid
					,[PaymentNameOnCard] = @PaymentNameOnCard
					,[PaymentCardNumber] = @PaymentCardNumber
					,[PaymentCCV] = @PaymentCcv
					,[PaymentExpiry] = @PaymentExpiry
					,[PaymentType] = @PaymentType
					,[SiteID] = @SiteId
				WHERE
[CustomPaymentID] = @CustomPaymentId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.CustomPayment_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.CustomPayment_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.CustomPayment_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the CustomPayment table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.CustomPayment_Delete
(

	@CustomPaymentId int   
)
AS


				DELETE FROM [dbo].[CustomPayment] WITH (ROWLOCK) 
				WHERE
					[CustomPaymentID] = @CustomPaymentId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.CustomPayment_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.CustomPayment_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.CustomPayment_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the CustomPayment table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.CustomPayment_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[CustomPaymentID],
					[CustomPaymentGuid],
					[Name],
					[EmailAddress],
					[InvoiceNumber],
					[Amount],
					[Comments],
					[CreatedDate],
					[IpAddress],
					[Response],
					[SecurePay],
					[Paypal],
					[Paid],
					[PaymentNameOnCard],
					[PaymentCardNumber],
					[PaymentCCV],
					[PaymentExpiry],
					[PaymentType],
					[SiteID]
				FROM
					[dbo].[CustomPayment]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.CustomPayment_GetByCustomPaymentId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.CustomPayment_GetByCustomPaymentId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.CustomPayment_GetByCustomPaymentId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the CustomPayment table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.CustomPayment_GetByCustomPaymentId
(

	@CustomPaymentId int   
)
AS


				SELECT
					[CustomPaymentID],
					[CustomPaymentGuid],
					[Name],
					[EmailAddress],
					[InvoiceNumber],
					[Amount],
					[Comments],
					[CreatedDate],
					[IpAddress],
					[Response],
					[SecurePay],
					[Paypal],
					[Paid],
					[PaymentNameOnCard],
					[PaymentCardNumber],
					[PaymentCCV],
					[PaymentExpiry],
					[PaymentType],
					[SiteID]
				FROM
					[dbo].[CustomPayment]
				WHERE
					[CustomPaymentID] = @CustomPaymentId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.CustomPayment_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.CustomPayment_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.CustomPayment_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the CustomPayment table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.CustomPayment_Find
(

	@SearchUsingOR bit   = null ,

	@CustomPaymentId int   = null ,

	@CustomPaymentGuid uniqueidentifier   = null ,

	@Name nvarchar (200)  = null ,

	@EmailAddress nvarchar (100)  = null ,

	@InvoiceNumber nvarchar (100)  = null ,

	@Amount decimal (18, 2)  = null ,

	@Comments nvarchar (MAX)  = null ,

	@CreatedDate datetime   = null ,

	@IpAddress nvarchar (200)  = null ,

	@Response nvarchar (MAX)  = null ,

	@SecurePay bit   = null ,

	@Paypal bit   = null ,

	@Paid bit   = null ,

	@PaymentNameOnCard nvarchar (200)  = null ,

	@PaymentCardNumber nvarchar (50)  = null ,

	@PaymentCcv nvarchar (50)  = null ,

	@PaymentExpiry nvarchar (20)  = null ,

	@PaymentType nvarchar (50)  = null ,

	@SiteId int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [CustomPaymentID]
	, [CustomPaymentGuid]
	, [Name]
	, [EmailAddress]
	, [InvoiceNumber]
	, [Amount]
	, [Comments]
	, [CreatedDate]
	, [IpAddress]
	, [Response]
	, [SecurePay]
	, [Paypal]
	, [Paid]
	, [PaymentNameOnCard]
	, [PaymentCardNumber]
	, [PaymentCCV]
	, [PaymentExpiry]
	, [PaymentType]
	, [SiteID]
    FROM
	[dbo].[CustomPayment]
    WHERE 
	 ([CustomPaymentID] = @CustomPaymentId OR @CustomPaymentId IS NULL)
	AND ([CustomPaymentGuid] = @CustomPaymentGuid OR @CustomPaymentGuid IS NULL)
	AND ([Name] = @Name OR @Name IS NULL)
	AND ([EmailAddress] = @EmailAddress OR @EmailAddress IS NULL)
	AND ([InvoiceNumber] = @InvoiceNumber OR @InvoiceNumber IS NULL)
	AND ([Amount] = @Amount OR @Amount IS NULL)
	AND ([Comments] = @Comments OR @Comments IS NULL)
	AND ([CreatedDate] = @CreatedDate OR @CreatedDate IS NULL)
	AND ([IpAddress] = @IpAddress OR @IpAddress IS NULL)
	AND ([Response] = @Response OR @Response IS NULL)
	AND ([SecurePay] = @SecurePay OR @SecurePay IS NULL)
	AND ([Paypal] = @Paypal OR @Paypal IS NULL)
	AND ([Paid] = @Paid OR @Paid IS NULL)
	AND ([PaymentNameOnCard] = @PaymentNameOnCard OR @PaymentNameOnCard IS NULL)
	AND ([PaymentCardNumber] = @PaymentCardNumber OR @PaymentCardNumber IS NULL)
	AND ([PaymentCCV] = @PaymentCcv OR @PaymentCcv IS NULL)
	AND ([PaymentExpiry] = @PaymentExpiry OR @PaymentExpiry IS NULL)
	AND ([PaymentType] = @PaymentType OR @PaymentType IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [CustomPaymentID]
	, [CustomPaymentGuid]
	, [Name]
	, [EmailAddress]
	, [InvoiceNumber]
	, [Amount]
	, [Comments]
	, [CreatedDate]
	, [IpAddress]
	, [Response]
	, [SecurePay]
	, [Paypal]
	, [Paid]
	, [PaymentNameOnCard]
	, [PaymentCardNumber]
	, [PaymentCCV]
	, [PaymentExpiry]
	, [PaymentType]
	, [SiteID]
    FROM
	[dbo].[CustomPayment]
    WHERE 
	 ([CustomPaymentID] = @CustomPaymentId AND @CustomPaymentId is not null)
	OR ([CustomPaymentGuid] = @CustomPaymentGuid AND @CustomPaymentGuid is not null)
	OR ([Name] = @Name AND @Name is not null)
	OR ([EmailAddress] = @EmailAddress AND @EmailAddress is not null)
	OR ([InvoiceNumber] = @InvoiceNumber AND @InvoiceNumber is not null)
	OR ([Amount] = @Amount AND @Amount is not null)
	OR ([Comments] = @Comments AND @Comments is not null)
	OR ([CreatedDate] = @CreatedDate AND @CreatedDate is not null)
	OR ([IpAddress] = @IpAddress AND @IpAddress is not null)
	OR ([Response] = @Response AND @Response is not null)
	OR ([SecurePay] = @SecurePay AND @SecurePay is not null)
	OR ([Paypal] = @Paypal AND @Paypal is not null)
	OR ([Paid] = @Paid AND @Paid is not null)
	OR ([PaymentNameOnCard] = @PaymentNameOnCard AND @PaymentNameOnCard is not null)
	OR ([PaymentCardNumber] = @PaymentCardNumber AND @PaymentCardNumber is not null)
	OR ([PaymentCCV] = @PaymentCcv AND @PaymentCcv is not null)
	OR ([PaymentExpiry] = @PaymentExpiry AND @PaymentExpiry is not null)
	OR ([PaymentType] = @PaymentType AND @PaymentType is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Currencies_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Currencies_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Currencies_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the Currencies table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Currencies_Get_List

AS


				
				SELECT
					[CurrencyID],
					[CurrencySymbol]
				FROM
					[dbo].[Currencies]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Currencies_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Currencies_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Currencies_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the Currencies table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Currencies_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [CurrencyID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([CurrencyID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [CurrencyID]'
				SET @SQL = @SQL + ' FROM [dbo].[Currencies]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[CurrencyID], O.[CurrencySymbol]
				FROM
				    [dbo].[Currencies] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[CurrencyID] = PageIndex.[CurrencyID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[Currencies]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Currencies_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Currencies_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Currencies_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the Currencies table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Currencies_Insert
(

	@CurrencyId int    OUTPUT,

	@CurrencySymbol varchar (6)  
)
AS


				
				INSERT INTO [dbo].[Currencies]
					(
					[CurrencySymbol]
					)
				VALUES
					(
					@CurrencySymbol
					)
				
				-- Get the identity value
				SET @CurrencyId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Currencies_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Currencies_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Currencies_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the Currencies table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Currencies_Update
(

	@CurrencyId int   ,

	@CurrencySymbol varchar (6)  
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[Currencies]
				SET
					[CurrencySymbol] = @CurrencySymbol
				WHERE
[CurrencyID] = @CurrencyId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Currencies_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Currencies_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Currencies_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the Currencies table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Currencies_Delete
(

	@CurrencyId int   
)
AS


				DELETE FROM [dbo].[Currencies] WITH (ROWLOCK) 
				WHERE
					[CurrencyID] = @CurrencyId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Currencies_GetByCurrencyId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Currencies_GetByCurrencyId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Currencies_GetByCurrencyId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Currencies table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Currencies_GetByCurrencyId
(

	@CurrencyId int   
)
AS


				SELECT
					[CurrencyID],
					[CurrencySymbol]
				FROM
					[dbo].[Currencies]
				WHERE
					[CurrencyID] = @CurrencyId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Currencies_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Currencies_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Currencies_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the Currencies table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Currencies_Find
(

	@SearchUsingOR bit   = null ,

	@CurrencyId int   = null ,

	@CurrencySymbol varchar (6)  = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [CurrencyID]
	, [CurrencySymbol]
    FROM
	[dbo].[Currencies]
    WHERE 
	 ([CurrencyID] = @CurrencyId OR @CurrencyId IS NULL)
	AND ([CurrencySymbol] = @CurrencySymbol OR @CurrencySymbol IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [CurrencyID]
	, [CurrencySymbol]
    FROM
	[dbo].[Currencies]
    WHERE 
	 ([CurrencyID] = @CurrencyId AND @CurrencyId is not null)
	OR ([CurrencySymbol] = @CurrencySymbol AND @CurrencySymbol is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Enquiries_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Enquiries_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Enquiries_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the Enquiries table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Enquiries_Get_List

AS


				
				SELECT
					[EnquiryID],
					[SiteID],
					[Name],
					[Email],
					[ContactPhone],
					[Content],
					[Date],
					[IpAddress]
				FROM
					[dbo].[Enquiries]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Enquiries_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Enquiries_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Enquiries_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the Enquiries table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Enquiries_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [EnquiryID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([EnquiryID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [EnquiryID]'
				SET @SQL = @SQL + ' FROM [dbo].[Enquiries]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[EnquiryID], O.[SiteID], O.[Name], O.[Email], O.[ContactPhone], O.[Content], O.[Date], O.[IpAddress]
				FROM
				    [dbo].[Enquiries] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[EnquiryID] = PageIndex.[EnquiryID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[Enquiries]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Enquiries_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Enquiries_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Enquiries_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the Enquiries table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Enquiries_Insert
(

	@EnquiryId int    OUTPUT,

	@SiteId int   ,

	@Name nvarchar (500)  ,

	@Email varchar (500)  ,

	@ContactPhone char (40)  ,

	@Content ntext   ,

	@Date smalldatetime   ,

	@IpAddress varchar (150)  
)
AS


				
				INSERT INTO [dbo].[Enquiries]
					(
					[SiteID]
					,[Name]
					,[Email]
					,[ContactPhone]
					,[Content]
					,[Date]
					,[IpAddress]
					)
				VALUES
					(
					@SiteId
					,@Name
					,@Email
					,@ContactPhone
					,@Content
					,@Date
					,@IpAddress
					)
				
				-- Get the identity value
				SET @EnquiryId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Enquiries_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Enquiries_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Enquiries_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the Enquiries table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Enquiries_Update
(

	@EnquiryId int   ,

	@SiteId int   ,

	@Name nvarchar (500)  ,

	@Email varchar (500)  ,

	@ContactPhone char (40)  ,

	@Content ntext   ,

	@Date smalldatetime   ,

	@IpAddress varchar (150)  
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[Enquiries]
				SET
					[SiteID] = @SiteId
					,[Name] = @Name
					,[Email] = @Email
					,[ContactPhone] = @ContactPhone
					,[Content] = @Content
					,[Date] = @Date
					,[IpAddress] = @IpAddress
				WHERE
[EnquiryID] = @EnquiryId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Enquiries_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Enquiries_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Enquiries_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the Enquiries table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Enquiries_Delete
(

	@EnquiryId int   
)
AS


				DELETE FROM [dbo].[Enquiries] WITH (ROWLOCK) 
				WHERE
					[EnquiryID] = @EnquiryId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Enquiries_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Enquiries_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Enquiries_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Enquiries table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Enquiries_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[EnquiryID],
					[SiteID],
					[Name],
					[Email],
					[ContactPhone],
					[Content],
					[Date],
					[IpAddress]
				FROM
					[dbo].[Enquiries]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Enquiries_GetByEnquiryId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Enquiries_GetByEnquiryId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Enquiries_GetByEnquiryId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Enquiries table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Enquiries_GetByEnquiryId
(

	@EnquiryId int   
)
AS


				SELECT
					[EnquiryID],
					[SiteID],
					[Name],
					[Email],
					[ContactPhone],
					[Content],
					[Date],
					[IpAddress]
				FROM
					[dbo].[Enquiries]
				WHERE
					[EnquiryID] = @EnquiryId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Enquiries_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Enquiries_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Enquiries_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the Enquiries table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Enquiries_Find
(

	@SearchUsingOR bit   = null ,

	@EnquiryId int   = null ,

	@SiteId int   = null ,

	@Name nvarchar (500)  = null ,

	@Email varchar (500)  = null ,

	@ContactPhone char (40)  = null ,

	@Content ntext   = null ,

	@Date smalldatetime   = null ,

	@IpAddress varchar (150)  = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [EnquiryID]
	, [SiteID]
	, [Name]
	, [Email]
	, [ContactPhone]
	, [Content]
	, [Date]
	, [IpAddress]
    FROM
	[dbo].[Enquiries]
    WHERE 
	 ([EnquiryID] = @EnquiryId OR @EnquiryId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([Name] = @Name OR @Name IS NULL)
	AND ([Email] = @Email OR @Email IS NULL)
	AND ([ContactPhone] = @ContactPhone OR @ContactPhone IS NULL)
	AND ([Date] = @Date OR @Date IS NULL)
	AND ([IpAddress] = @IpAddress OR @IpAddress IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [EnquiryID]
	, [SiteID]
	, [Name]
	, [Email]
	, [ContactPhone]
	, [Content]
	, [Date]
	, [IpAddress]
    FROM
	[dbo].[Enquiries]
    WHERE 
	 ([EnquiryID] = @EnquiryId AND @EnquiryId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([Name] = @Name AND @Name is not null)
	OR ([Email] = @Email AND @Email is not null)
	OR ([ContactPhone] = @ContactPhone AND @ContactPhone is not null)
	OR ([Date] = @Date AND @Date is not null)
	OR ([IpAddress] = @IpAddress AND @IpAddress is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.CustomWidgetCSSSelector_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.CustomWidgetCSSSelector_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.CustomWidgetCSSSelector_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the CustomWidgetCSSSelector table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.CustomWidgetCSSSelector_Get_List

AS


				
				SELECT
					[CustomWidgetCSSSelectorID],
					[SiteID],
					[CustomWidgetCSSSelectorName],
					[CustomWidgetCSSSelectorClassName],
					[Active],
					[ModifiedDate],
					[ModifiedBy],
					[SourceID]
				FROM
					[dbo].[CustomWidgetCSSSelector]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.CustomWidgetCSSSelector_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.CustomWidgetCSSSelector_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.CustomWidgetCSSSelector_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the CustomWidgetCSSSelector table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.CustomWidgetCSSSelector_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [CustomWidgetCSSSelectorID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([CustomWidgetCSSSelectorID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [CustomWidgetCSSSelectorID]'
				SET @SQL = @SQL + ' FROM [dbo].[CustomWidgetCSSSelector]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[CustomWidgetCSSSelectorID], O.[SiteID], O.[CustomWidgetCSSSelectorName], O.[CustomWidgetCSSSelectorClassName], O.[Active], O.[ModifiedDate], O.[ModifiedBy], O.[SourceID]
				FROM
				    [dbo].[CustomWidgetCSSSelector] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[CustomWidgetCSSSelectorID] = PageIndex.[CustomWidgetCSSSelectorID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[CustomWidgetCSSSelector]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.CustomWidgetCSSSelector_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.CustomWidgetCSSSelector_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.CustomWidgetCSSSelector_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the CustomWidgetCSSSelector table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.CustomWidgetCSSSelector_Insert
(

	@CustomWidgetCssSelectorId int    OUTPUT,

	@SiteId int   ,

	@CustomWidgetCssSelectorName varchar (255)  ,

	@CustomWidgetCssSelectorClassName varchar (255)  ,

	@Active bit   ,

	@ModifiedDate datetime   ,

	@ModifiedBy int   ,

	@SourceId int   
)
AS


				
				INSERT INTO [dbo].[CustomWidgetCSSSelector]
					(
					[SiteID]
					,[CustomWidgetCSSSelectorName]
					,[CustomWidgetCSSSelectorClassName]
					,[Active]
					,[ModifiedDate]
					,[ModifiedBy]
					,[SourceID]
					)
				VALUES
					(
					@SiteId
					,@CustomWidgetCssSelectorName
					,@CustomWidgetCssSelectorClassName
					,@Active
					,@ModifiedDate
					,@ModifiedBy
					,@SourceId
					)
				
				-- Get the identity value
				SET @CustomWidgetCssSelectorId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.CustomWidgetCSSSelector_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.CustomWidgetCSSSelector_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.CustomWidgetCSSSelector_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the CustomWidgetCSSSelector table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.CustomWidgetCSSSelector_Update
(

	@CustomWidgetCssSelectorId int   ,

	@SiteId int   ,

	@CustomWidgetCssSelectorName varchar (255)  ,

	@CustomWidgetCssSelectorClassName varchar (255)  ,

	@Active bit   ,

	@ModifiedDate datetime   ,

	@ModifiedBy int   ,

	@SourceId int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[CustomWidgetCSSSelector]
				SET
					[SiteID] = @SiteId
					,[CustomWidgetCSSSelectorName] = @CustomWidgetCssSelectorName
					,[CustomWidgetCSSSelectorClassName] = @CustomWidgetCssSelectorClassName
					,[Active] = @Active
					,[ModifiedDate] = @ModifiedDate
					,[ModifiedBy] = @ModifiedBy
					,[SourceID] = @SourceId
				WHERE
[CustomWidgetCSSSelectorID] = @CustomWidgetCssSelectorId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.CustomWidgetCSSSelector_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.CustomWidgetCSSSelector_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.CustomWidgetCSSSelector_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the CustomWidgetCSSSelector table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.CustomWidgetCSSSelector_Delete
(

	@CustomWidgetCssSelectorId int   
)
AS


				DELETE FROM [dbo].[CustomWidgetCSSSelector] WITH (ROWLOCK) 
				WHERE
					[CustomWidgetCSSSelectorID] = @CustomWidgetCssSelectorId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.CustomWidgetCSSSelector_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.CustomWidgetCSSSelector_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.CustomWidgetCSSSelector_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the CustomWidgetCSSSelector table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.CustomWidgetCSSSelector_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[CustomWidgetCSSSelectorID],
					[SiteID],
					[CustomWidgetCSSSelectorName],
					[CustomWidgetCSSSelectorClassName],
					[Active],
					[ModifiedDate],
					[ModifiedBy],
					[SourceID]
				FROM
					[dbo].[CustomWidgetCSSSelector]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.CustomWidgetCSSSelector_GetByCustomWidgetCssSelectorId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.CustomWidgetCSSSelector_GetByCustomWidgetCssSelectorId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.CustomWidgetCSSSelector_GetByCustomWidgetCssSelectorId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the CustomWidgetCSSSelector table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.CustomWidgetCSSSelector_GetByCustomWidgetCssSelectorId
(

	@CustomWidgetCssSelectorId int   
)
AS


				SELECT
					[CustomWidgetCSSSelectorID],
					[SiteID],
					[CustomWidgetCSSSelectorName],
					[CustomWidgetCSSSelectorClassName],
					[Active],
					[ModifiedDate],
					[ModifiedBy],
					[SourceID]
				FROM
					[dbo].[CustomWidgetCSSSelector]
				WHERE
					[CustomWidgetCSSSelectorID] = @CustomWidgetCssSelectorId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.CustomWidgetCSSSelector_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.CustomWidgetCSSSelector_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.CustomWidgetCSSSelector_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the CustomWidgetCSSSelector table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.CustomWidgetCSSSelector_Find
(

	@SearchUsingOR bit   = null ,

	@CustomWidgetCssSelectorId int   = null ,

	@SiteId int   = null ,

	@CustomWidgetCssSelectorName varchar (255)  = null ,

	@CustomWidgetCssSelectorClassName varchar (255)  = null ,

	@Active bit   = null ,

	@ModifiedDate datetime   = null ,

	@ModifiedBy int   = null ,

	@SourceId int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [CustomWidgetCSSSelectorID]
	, [SiteID]
	, [CustomWidgetCSSSelectorName]
	, [CustomWidgetCSSSelectorClassName]
	, [Active]
	, [ModifiedDate]
	, [ModifiedBy]
	, [SourceID]
    FROM
	[dbo].[CustomWidgetCSSSelector]
    WHERE 
	 ([CustomWidgetCSSSelectorID] = @CustomWidgetCssSelectorId OR @CustomWidgetCssSelectorId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([CustomWidgetCSSSelectorName] = @CustomWidgetCssSelectorName OR @CustomWidgetCssSelectorName IS NULL)
	AND ([CustomWidgetCSSSelectorClassName] = @CustomWidgetCssSelectorClassName OR @CustomWidgetCssSelectorClassName IS NULL)
	AND ([Active] = @Active OR @Active IS NULL)
	AND ([ModifiedDate] = @ModifiedDate OR @ModifiedDate IS NULL)
	AND ([ModifiedBy] = @ModifiedBy OR @ModifiedBy IS NULL)
	AND ([SourceID] = @SourceId OR @SourceId IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [CustomWidgetCSSSelectorID]
	, [SiteID]
	, [CustomWidgetCSSSelectorName]
	, [CustomWidgetCSSSelectorClassName]
	, [Active]
	, [ModifiedDate]
	, [ModifiedBy]
	, [SourceID]
    FROM
	[dbo].[CustomWidgetCSSSelector]
    WHERE 
	 ([CustomWidgetCSSSelectorID] = @CustomWidgetCssSelectorId AND @CustomWidgetCssSelectorId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([CustomWidgetCSSSelectorName] = @CustomWidgetCssSelectorName AND @CustomWidgetCssSelectorName is not null)
	OR ([CustomWidgetCSSSelectorClassName] = @CustomWidgetCssSelectorClassName AND @CustomWidgetCssSelectorClassName is not null)
	OR ([Active] = @Active AND @Active is not null)
	OR ([ModifiedDate] = @ModifiedDate AND @ModifiedDate is not null)
	OR ([ModifiedBy] = @ModifiedBy AND @ModifiedBy is not null)
	OR ([SourceID] = @SourceId AND @SourceId is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Folders_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Folders_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Folders_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the Folders table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Folders_Get_List

AS


				
				SELECT
					[FolderID],
					[ParentFolderID],
					[SiteID],
					[FolderName],
					[SourceID]
				FROM
					[dbo].[Folders]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Folders_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Folders_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Folders_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the Folders table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Folders_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [FolderID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([FolderID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [FolderID]'
				SET @SQL = @SQL + ' FROM [dbo].[Folders]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[FolderID], O.[ParentFolderID], O.[SiteID], O.[FolderName], O.[SourceID]
				FROM
				    [dbo].[Folders] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[FolderID] = PageIndex.[FolderID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[Folders]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Folders_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Folders_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Folders_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the Folders table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Folders_Insert
(

	@FolderId int    OUTPUT,

	@ParentFolderId int   ,

	@SiteId int   ,

	@FolderName nvarchar (255)  ,

	@SourceId int   
)
AS


				
				INSERT INTO [dbo].[Folders]
					(
					[ParentFolderID]
					,[SiteID]
					,[FolderName]
					,[SourceID]
					)
				VALUES
					(
					@ParentFolderId
					,@SiteId
					,@FolderName
					,@SourceId
					)
				
				-- Get the identity value
				SET @FolderId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Folders_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Folders_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Folders_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the Folders table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Folders_Update
(

	@FolderId int   ,

	@ParentFolderId int   ,

	@SiteId int   ,

	@FolderName nvarchar (255)  ,

	@SourceId int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[Folders]
				SET
					[ParentFolderID] = @ParentFolderId
					,[SiteID] = @SiteId
					,[FolderName] = @FolderName
					,[SourceID] = @SourceId
				WHERE
[FolderID] = @FolderId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Folders_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Folders_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Folders_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the Folders table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Folders_Delete
(

	@FolderId int   
)
AS


				DELETE FROM [dbo].[Folders] WITH (ROWLOCK) 
				WHERE
					[FolderID] = @FolderId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Folders_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Folders_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Folders_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Folders table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Folders_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[FolderID],
					[ParentFolderID],
					[SiteID],
					[FolderName],
					[SourceID]
				FROM
					[dbo].[Folders]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Folders_GetBySiteIdFolderIdParentFolderId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Folders_GetBySiteIdFolderIdParentFolderId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Folders_GetBySiteIdFolderIdParentFolderId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Folders table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Folders_GetBySiteIdFolderIdParentFolderId
(

	@SiteId int   ,

	@FolderId int   ,

	@ParentFolderId int   
)
AS


				SELECT
					[FolderID],
					[ParentFolderID],
					[SiteID],
					[FolderName],
					[SourceID]
				FROM
					[dbo].[Folders]
				WHERE
					[SiteID] = @SiteId
					AND [FolderID] = @FolderId
					AND [ParentFolderID] = @ParentFolderId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Folders_GetByFolderId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Folders_GetByFolderId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Folders_GetByFolderId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Folders table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Folders_GetByFolderId
(

	@FolderId int   
)
AS


				SELECT
					[FolderID],
					[ParentFolderID],
					[SiteID],
					[FolderName],
					[SourceID]
				FROM
					[dbo].[Folders]
				WHERE
					[FolderID] = @FolderId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Folders_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Folders_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Folders_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the Folders table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Folders_Find
(

	@SearchUsingOR bit   = null ,

	@FolderId int   = null ,

	@ParentFolderId int   = null ,

	@SiteId int   = null ,

	@FolderName nvarchar (255)  = null ,

	@SourceId int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [FolderID]
	, [ParentFolderID]
	, [SiteID]
	, [FolderName]
	, [SourceID]
    FROM
	[dbo].[Folders]
    WHERE 
	 ([FolderID] = @FolderId OR @FolderId IS NULL)
	AND ([ParentFolderID] = @ParentFolderId OR @ParentFolderId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([FolderName] = @FolderName OR @FolderName IS NULL)
	AND ([SourceID] = @SourceId OR @SourceId IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [FolderID]
	, [ParentFolderID]
	, [SiteID]
	, [FolderName]
	, [SourceID]
    FROM
	[dbo].[Folders]
    WHERE 
	 ([FolderID] = @FolderId AND @FolderId is not null)
	OR ([ParentFolderID] = @ParentFolderId AND @ParentFolderId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([FolderName] = @FolderName AND @FolderName is not null)
	OR ([SourceID] = @SourceId AND @SourceId is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.GlobalSettings_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.GlobalSettings_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.GlobalSettings_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the GlobalSettings table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.GlobalSettings_Get_List

AS


				
				SELECT
					[GlobalSettingID],
					[SiteID],
					[DefaultLanguageID],
					[DefaultDynamicPageID],
					[PublicJobsSearch],
					[PublicMembersSearch],
					[PublicCompaniesSearch],
					[PublicSponsoredAdverts],
					[PrivateJobs],
					[PrivateMembers],
					[PrivateCompanies],
					[LastModifiedBy],
					[LastModified],
					[PageTitlePrefix],
					[PageTitleSuffix],
					[DefaultTitle],
					[HomeTitle],
					[DefaultDescription],
					[HomeDescription],
					[DefaultKeywords],
					[HomeKeywords],
					[ShowFaceBookButton],
					[UseAdvertiserFilter],
					[MerchantID],
					[ShowTwitterButton],
					[ShowJobAlertButton],
					[ShowLinkedInButton],
					[SiteFavIconID],
					[SiteDocType],
					[CurrencySymbol],
					[FtpFolderLocation],
					[MetaTags],
					[SystemMetaTags],
					[MemberRegistrationNotification],
					[LinkedInAPI],
					[LinkedInLogo],
					[LinkedInCompanyID],
					[LinkedInEmail],
					[PrivacySettings],
					[WWWRedirect],
					[AllowAdvertiser],
					[LinkedInAPISecret],
					[GoogleClientID],
					[GoogleClientSecret],
					[FacebookAppID],
					[FacebookAppSecret],
					[LinkedInButtonSize],
					[DefaultCountryID],
					[PayPalUsername],
					[PayPalPassword],
					[PayPalSignature],
					[SecurePayMerchantID],
					[SecurePayPassword],
					[UsingSSL],
					[UseCustomProfessionRole],
					[GenerateJobXML],
					[IsPrivateSite],
					[PrivateRedirectUrl],
					[EnableJobCustomQuestionnaire],
					[JobApplicationTypeID],
					[JobScreeningProcess],
					[AdvertiserApprovalProcess],
					[SiteType],
					[EnableSSL],
					[GST],
					[GSTLabel],
					[NumberOfPremiumJobs],
					[PremiumJobDays],
					[DisplayPremiumJobsOnResults],
					[JobExpiryNotification],
					[CurrencyID],
					[PayPalClientID],
					[PayPalClientSecret],
					[PaypalUser],
					[PaypalProPassword],
					[PaypalVendor],
					[PaypalPartner],
					[InvoiceSiteInfo],
					[InvoiceSiteFooter],
					[EnableTermsAndConditions],
					[DefaultEmailLanguageId],
					[GoogleTagManager],
					[GoogleAnalytics],
					[GoogleWebMaster],
					[EnablePeopleSearch],
					[GlobalDateFormat],
					[TimeZone],
					[EnableScreeningQuestions]
				FROM
					[dbo].[GlobalSettings]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.GlobalSettings_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.GlobalSettings_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.GlobalSettings_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the GlobalSettings table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.GlobalSettings_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [GlobalSettingID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([GlobalSettingID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [GlobalSettingID]'
				SET @SQL = @SQL + ' FROM [dbo].[GlobalSettings]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[GlobalSettingID], O.[SiteID], O.[DefaultLanguageID], O.[DefaultDynamicPageID], O.[PublicJobsSearch], O.[PublicMembersSearch], O.[PublicCompaniesSearch], O.[PublicSponsoredAdverts], O.[PrivateJobs], O.[PrivateMembers], O.[PrivateCompanies], O.[LastModifiedBy], O.[LastModified], O.[PageTitlePrefix], O.[PageTitleSuffix], O.[DefaultTitle], O.[HomeTitle], O.[DefaultDescription], O.[HomeDescription], O.[DefaultKeywords], O.[HomeKeywords], O.[ShowFaceBookButton], O.[UseAdvertiserFilter], O.[MerchantID], O.[ShowTwitterButton], O.[ShowJobAlertButton], O.[ShowLinkedInButton], O.[SiteFavIconID], O.[SiteDocType], O.[CurrencySymbol], O.[FtpFolderLocation], O.[MetaTags], O.[SystemMetaTags], O.[MemberRegistrationNotification], O.[LinkedInAPI], O.[LinkedInLogo], O.[LinkedInCompanyID], O.[LinkedInEmail], O.[PrivacySettings], O.[WWWRedirect], O.[AllowAdvertiser], O.[LinkedInAPISecret], O.[GoogleClientID], O.[GoogleClientSecret], O.[FacebookAppID], O.[FacebookAppSecret], O.[LinkedInButtonSize], O.[DefaultCountryID], O.[PayPalUsername], O.[PayPalPassword], O.[PayPalSignature], O.[SecurePayMerchantID], O.[SecurePayPassword], O.[UsingSSL], O.[UseCustomProfessionRole], O.[GenerateJobXML], O.[IsPrivateSite], O.[PrivateRedirectUrl], O.[EnableJobCustomQuestionnaire], O.[JobApplicationTypeID], O.[JobScreeningProcess], O.[AdvertiserApprovalProcess], O.[SiteType], O.[EnableSSL], O.[GST], O.[GSTLabel], O.[NumberOfPremiumJobs], O.[PremiumJobDays], O.[DisplayPremiumJobsOnResults], O.[JobExpiryNotification], O.[CurrencyID], O.[PayPalClientID], O.[PayPalClientSecret], O.[PaypalUser], O.[PaypalProPassword], O.[PaypalVendor], O.[PaypalPartner], O.[InvoiceSiteInfo], O.[InvoiceSiteFooter], O.[EnableTermsAndConditions], O.[DefaultEmailLanguageId], O.[GoogleTagManager], O.[GoogleAnalytics], O.[GoogleWebMaster], O.[EnablePeopleSearch], O.[GlobalDateFormat], O.[TimeZone], O.[EnableScreeningQuestions]
				FROM
				    [dbo].[GlobalSettings] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[GlobalSettingID] = PageIndex.[GlobalSettingID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[GlobalSettings]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.GlobalSettings_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.GlobalSettings_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.GlobalSettings_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the GlobalSettings table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.GlobalSettings_Insert
(

	@GlobalSettingId int    OUTPUT,

	@SiteId int   ,

	@DefaultLanguageId int   ,

	@DefaultDynamicPageId int   ,

	@PublicJobsSearch bit   ,

	@PublicMembersSearch bit   ,

	@PublicCompaniesSearch bit   ,

	@PublicSponsoredAdverts bit   ,

	@PrivateJobs bit   ,

	@PrivateMembers bit   ,

	@PrivateCompanies bit   ,

	@LastModifiedBy int   ,

	@LastModified datetime   ,

	@PageTitlePrefix nvarchar (510)  ,

	@PageTitleSuffix nvarchar (510)  ,

	@DefaultTitle nvarchar (510)  ,

	@HomeTitle nvarchar (510)  ,

	@DefaultDescription nvarchar (510)  ,

	@HomeDescription nvarchar (510)  ,

	@DefaultKeywords nvarchar (510)  ,

	@HomeKeywords nvarchar (510)  ,

	@ShowFaceBookButton bit   ,

	@UseAdvertiserFilter int   ,

	@MerchantId int   ,

	@ShowTwitterButton bit   ,

	@ShowJobAlertButton bit   ,

	@ShowLinkedInButton bit   ,

	@SiteFavIconId int   ,

	@SiteDocType varchar (512)  ,

	@CurrencySymbol varchar (10)  ,

	@FtpFolderLocation varchar (255)  ,

	@MetaTags nvarchar (MAX)  ,

	@SystemMetaTags nvarchar (4000)  ,

	@MemberRegistrationNotification varchar (255)  ,

	@LinkedInApi varchar (255)  ,

	@LinkedInLogo varchar (255)  ,

	@LinkedInCompanyId int   ,

	@LinkedInEmail varchar (255)  ,

	@PrivacySettings nvarchar (4000)  ,

	@WwwRedirect bit   ,

	@AllowAdvertiser bit   ,

	@LinkedInApiSecret varchar (255)  ,

	@GoogleClientId varchar (255)  ,

	@GoogleClientSecret varchar (255)  ,

	@FacebookAppId varchar (255)  ,

	@FacebookAppSecret varchar (255)  ,

	@LinkedInButtonSize int   ,

	@DefaultCountryId int   ,

	@PayPalUsername varchar (100)  ,

	@PayPalPassword varchar (100)  ,

	@PayPalSignature varchar (100)  ,

	@SecurePayMerchantId varchar (100)  ,

	@SecurePayPassword varchar (100)  ,

	@UsingSsl bit   ,

	@UseCustomProfessionRole bit   ,

	@GenerateJobXml bit   ,

	@IsPrivateSite bit   ,

	@PrivateRedirectUrl varchar (255)  ,

	@EnableJobCustomQuestionnaire bit   ,

	@JobApplicationTypeId int   ,

	@JobScreeningProcess bit   ,

	@AdvertiserApprovalProcess int   ,

	@SiteType int   ,

	@EnableSsl bit   ,

	@Gst decimal (5, 2)  ,

	@GstLabel nvarchar (510)  ,

	@NumberOfPremiumJobs int   ,

	@PremiumJobDays int   ,

	@DisplayPremiumJobsOnResults bit   ,

	@JobExpiryNotification bit   ,

	@CurrencyId int   ,

	@PayPalClientId varchar (255)  ,

	@PayPalClientSecret varchar (255)  ,

	@PaypalUser varchar (255)  ,

	@PaypalProPassword varchar (255)  ,

	@PaypalVendor varchar (255)  ,

	@PaypalPartner varchar (255)  ,

	@InvoiceSiteInfo nvarchar (1000)  ,

	@InvoiceSiteFooter nvarchar (1500)  ,

	@EnableTermsAndConditions bit   ,

	@DefaultEmailLanguageId int   ,

	@GoogleTagManager varchar (100)  ,

	@GoogleAnalytics varchar (100)  ,

	@GoogleWebMaster varchar (100)  ,

	@EnablePeopleSearch bit   ,

	@GlobalDateFormat varchar (20)  ,

	@TimeZone varchar (255)  ,

	@EnableScreeningQuestions bit   
)
AS


				
				INSERT INTO [dbo].[GlobalSettings]
					(
					[SiteID]
					,[DefaultLanguageID]
					,[DefaultDynamicPageID]
					,[PublicJobsSearch]
					,[PublicMembersSearch]
					,[PublicCompaniesSearch]
					,[PublicSponsoredAdverts]
					,[PrivateJobs]
					,[PrivateMembers]
					,[PrivateCompanies]
					,[LastModifiedBy]
					,[LastModified]
					,[PageTitlePrefix]
					,[PageTitleSuffix]
					,[DefaultTitle]
					,[HomeTitle]
					,[DefaultDescription]
					,[HomeDescription]
					,[DefaultKeywords]
					,[HomeKeywords]
					,[ShowFaceBookButton]
					,[UseAdvertiserFilter]
					,[MerchantID]
					,[ShowTwitterButton]
					,[ShowJobAlertButton]
					,[ShowLinkedInButton]
					,[SiteFavIconID]
					,[SiteDocType]
					,[CurrencySymbol]
					,[FtpFolderLocation]
					,[MetaTags]
					,[SystemMetaTags]
					,[MemberRegistrationNotification]
					,[LinkedInAPI]
					,[LinkedInLogo]
					,[LinkedInCompanyID]
					,[LinkedInEmail]
					,[PrivacySettings]
					,[WWWRedirect]
					,[AllowAdvertiser]
					,[LinkedInAPISecret]
					,[GoogleClientID]
					,[GoogleClientSecret]
					,[FacebookAppID]
					,[FacebookAppSecret]
					,[LinkedInButtonSize]
					,[DefaultCountryID]
					,[PayPalUsername]
					,[PayPalPassword]
					,[PayPalSignature]
					,[SecurePayMerchantID]
					,[SecurePayPassword]
					,[UsingSSL]
					,[UseCustomProfessionRole]
					,[GenerateJobXML]
					,[IsPrivateSite]
					,[PrivateRedirectUrl]
					,[EnableJobCustomQuestionnaire]
					,[JobApplicationTypeID]
					,[JobScreeningProcess]
					,[AdvertiserApprovalProcess]
					,[SiteType]
					,[EnableSSL]
					,[GST]
					,[GSTLabel]
					,[NumberOfPremiumJobs]
					,[PremiumJobDays]
					,[DisplayPremiumJobsOnResults]
					,[JobExpiryNotification]
					,[CurrencyID]
					,[PayPalClientID]
					,[PayPalClientSecret]
					,[PaypalUser]
					,[PaypalProPassword]
					,[PaypalVendor]
					,[PaypalPartner]
					,[InvoiceSiteInfo]
					,[InvoiceSiteFooter]
					,[EnableTermsAndConditions]
					,[DefaultEmailLanguageId]
					,[GoogleTagManager]
					,[GoogleAnalytics]
					,[GoogleWebMaster]
					,[EnablePeopleSearch]
					,[GlobalDateFormat]
					,[TimeZone]
					,[EnableScreeningQuestions]
					)
				VALUES
					(
					@SiteId
					,@DefaultLanguageId
					,@DefaultDynamicPageId
					,@PublicJobsSearch
					,@PublicMembersSearch
					,@PublicCompaniesSearch
					,@PublicSponsoredAdverts
					,@PrivateJobs
					,@PrivateMembers
					,@PrivateCompanies
					,@LastModifiedBy
					,@LastModified
					,@PageTitlePrefix
					,@PageTitleSuffix
					,@DefaultTitle
					,@HomeTitle
					,@DefaultDescription
					,@HomeDescription
					,@DefaultKeywords
					,@HomeKeywords
					,@ShowFaceBookButton
					,@UseAdvertiserFilter
					,@MerchantId
					,@ShowTwitterButton
					,@ShowJobAlertButton
					,@ShowLinkedInButton
					,@SiteFavIconId
					,@SiteDocType
					,@CurrencySymbol
					,@FtpFolderLocation
					,@MetaTags
					,@SystemMetaTags
					,@MemberRegistrationNotification
					,@LinkedInApi
					,@LinkedInLogo
					,@LinkedInCompanyId
					,@LinkedInEmail
					,@PrivacySettings
					,@WwwRedirect
					,@AllowAdvertiser
					,@LinkedInApiSecret
					,@GoogleClientId
					,@GoogleClientSecret
					,@FacebookAppId
					,@FacebookAppSecret
					,@LinkedInButtonSize
					,@DefaultCountryId
					,@PayPalUsername
					,@PayPalPassword
					,@PayPalSignature
					,@SecurePayMerchantId
					,@SecurePayPassword
					,@UsingSsl
					,@UseCustomProfessionRole
					,@GenerateJobXml
					,@IsPrivateSite
					,@PrivateRedirectUrl
					,@EnableJobCustomQuestionnaire
					,@JobApplicationTypeId
					,@JobScreeningProcess
					,@AdvertiserApprovalProcess
					,@SiteType
					,@EnableSsl
					,@Gst
					,@GstLabel
					,@NumberOfPremiumJobs
					,@PremiumJobDays
					,@DisplayPremiumJobsOnResults
					,@JobExpiryNotification
					,@CurrencyId
					,@PayPalClientId
					,@PayPalClientSecret
					,@PaypalUser
					,@PaypalProPassword
					,@PaypalVendor
					,@PaypalPartner
					,@InvoiceSiteInfo
					,@InvoiceSiteFooter
					,@EnableTermsAndConditions
					,@DefaultEmailLanguageId
					,@GoogleTagManager
					,@GoogleAnalytics
					,@GoogleWebMaster
					,@EnablePeopleSearch
					,@GlobalDateFormat
					,@TimeZone
					,@EnableScreeningQuestions
					)
				
				-- Get the identity value
				SET @GlobalSettingId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.GlobalSettings_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.GlobalSettings_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.GlobalSettings_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the GlobalSettings table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.GlobalSettings_Update
(

	@GlobalSettingId int   ,

	@SiteId int   ,

	@DefaultLanguageId int   ,

	@DefaultDynamicPageId int   ,

	@PublicJobsSearch bit   ,

	@PublicMembersSearch bit   ,

	@PublicCompaniesSearch bit   ,

	@PublicSponsoredAdverts bit   ,

	@PrivateJobs bit   ,

	@PrivateMembers bit   ,

	@PrivateCompanies bit   ,

	@LastModifiedBy int   ,

	@LastModified datetime   ,

	@PageTitlePrefix nvarchar (510)  ,

	@PageTitleSuffix nvarchar (510)  ,

	@DefaultTitle nvarchar (510)  ,

	@HomeTitle nvarchar (510)  ,

	@DefaultDescription nvarchar (510)  ,

	@HomeDescription nvarchar (510)  ,

	@DefaultKeywords nvarchar (510)  ,

	@HomeKeywords nvarchar (510)  ,

	@ShowFaceBookButton bit   ,

	@UseAdvertiserFilter int   ,

	@MerchantId int   ,

	@ShowTwitterButton bit   ,

	@ShowJobAlertButton bit   ,

	@ShowLinkedInButton bit   ,

	@SiteFavIconId int   ,

	@SiteDocType varchar (512)  ,

	@CurrencySymbol varchar (10)  ,

	@FtpFolderLocation varchar (255)  ,

	@MetaTags nvarchar (MAX)  ,

	@SystemMetaTags nvarchar (4000)  ,

	@MemberRegistrationNotification varchar (255)  ,

	@LinkedInApi varchar (255)  ,

	@LinkedInLogo varchar (255)  ,

	@LinkedInCompanyId int   ,

	@LinkedInEmail varchar (255)  ,

	@PrivacySettings nvarchar (4000)  ,

	@WwwRedirect bit   ,

	@AllowAdvertiser bit   ,

	@LinkedInApiSecret varchar (255)  ,

	@GoogleClientId varchar (255)  ,

	@GoogleClientSecret varchar (255)  ,

	@FacebookAppId varchar (255)  ,

	@FacebookAppSecret varchar (255)  ,

	@LinkedInButtonSize int   ,

	@DefaultCountryId int   ,

	@PayPalUsername varchar (100)  ,

	@PayPalPassword varchar (100)  ,

	@PayPalSignature varchar (100)  ,

	@SecurePayMerchantId varchar (100)  ,

	@SecurePayPassword varchar (100)  ,

	@UsingSsl bit   ,

	@UseCustomProfessionRole bit   ,

	@GenerateJobXml bit   ,

	@IsPrivateSite bit   ,

	@PrivateRedirectUrl varchar (255)  ,

	@EnableJobCustomQuestionnaire bit   ,

	@JobApplicationTypeId int   ,

	@JobScreeningProcess bit   ,

	@AdvertiserApprovalProcess int   ,

	@SiteType int   ,

	@EnableSsl bit   ,

	@Gst decimal (5, 2)  ,

	@GstLabel nvarchar (510)  ,

	@NumberOfPremiumJobs int   ,

	@PremiumJobDays int   ,

	@DisplayPremiumJobsOnResults bit   ,

	@JobExpiryNotification bit   ,

	@CurrencyId int   ,

	@PayPalClientId varchar (255)  ,

	@PayPalClientSecret varchar (255)  ,

	@PaypalUser varchar (255)  ,

	@PaypalProPassword varchar (255)  ,

	@PaypalVendor varchar (255)  ,

	@PaypalPartner varchar (255)  ,

	@InvoiceSiteInfo nvarchar (1000)  ,

	@InvoiceSiteFooter nvarchar (1500)  ,

	@EnableTermsAndConditions bit   ,

	@DefaultEmailLanguageId int   ,

	@GoogleTagManager varchar (100)  ,

	@GoogleAnalytics varchar (100)  ,

	@GoogleWebMaster varchar (100)  ,

	@EnablePeopleSearch bit   ,

	@GlobalDateFormat varchar (20)  ,

	@TimeZone varchar (255)  ,

	@EnableScreeningQuestions bit   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[GlobalSettings]
				SET
					[SiteID] = @SiteId
					,[DefaultLanguageID] = @DefaultLanguageId
					,[DefaultDynamicPageID] = @DefaultDynamicPageId
					,[PublicJobsSearch] = @PublicJobsSearch
					,[PublicMembersSearch] = @PublicMembersSearch
					,[PublicCompaniesSearch] = @PublicCompaniesSearch
					,[PublicSponsoredAdverts] = @PublicSponsoredAdverts
					,[PrivateJobs] = @PrivateJobs
					,[PrivateMembers] = @PrivateMembers
					,[PrivateCompanies] = @PrivateCompanies
					,[LastModifiedBy] = @LastModifiedBy
					,[LastModified] = @LastModified
					,[PageTitlePrefix] = @PageTitlePrefix
					,[PageTitleSuffix] = @PageTitleSuffix
					,[DefaultTitle] = @DefaultTitle
					,[HomeTitle] = @HomeTitle
					,[DefaultDescription] = @DefaultDescription
					,[HomeDescription] = @HomeDescription
					,[DefaultKeywords] = @DefaultKeywords
					,[HomeKeywords] = @HomeKeywords
					,[ShowFaceBookButton] = @ShowFaceBookButton
					,[UseAdvertiserFilter] = @UseAdvertiserFilter
					,[MerchantID] = @MerchantId
					,[ShowTwitterButton] = @ShowTwitterButton
					,[ShowJobAlertButton] = @ShowJobAlertButton
					,[ShowLinkedInButton] = @ShowLinkedInButton
					,[SiteFavIconID] = @SiteFavIconId
					,[SiteDocType] = @SiteDocType
					,[CurrencySymbol] = @CurrencySymbol
					,[FtpFolderLocation] = @FtpFolderLocation
					,[MetaTags] = @MetaTags
					,[SystemMetaTags] = @SystemMetaTags
					,[MemberRegistrationNotification] = @MemberRegistrationNotification
					,[LinkedInAPI] = @LinkedInApi
					,[LinkedInLogo] = @LinkedInLogo
					,[LinkedInCompanyID] = @LinkedInCompanyId
					,[LinkedInEmail] = @LinkedInEmail
					,[PrivacySettings] = @PrivacySettings
					,[WWWRedirect] = @WwwRedirect
					,[AllowAdvertiser] = @AllowAdvertiser
					,[LinkedInAPISecret] = @LinkedInApiSecret
					,[GoogleClientID] = @GoogleClientId
					,[GoogleClientSecret] = @GoogleClientSecret
					,[FacebookAppID] = @FacebookAppId
					,[FacebookAppSecret] = @FacebookAppSecret
					,[LinkedInButtonSize] = @LinkedInButtonSize
					,[DefaultCountryID] = @DefaultCountryId
					,[PayPalUsername] = @PayPalUsername
					,[PayPalPassword] = @PayPalPassword
					,[PayPalSignature] = @PayPalSignature
					,[SecurePayMerchantID] = @SecurePayMerchantId
					,[SecurePayPassword] = @SecurePayPassword
					,[UsingSSL] = @UsingSsl
					,[UseCustomProfessionRole] = @UseCustomProfessionRole
					,[GenerateJobXML] = @GenerateJobXml
					,[IsPrivateSite] = @IsPrivateSite
					,[PrivateRedirectUrl] = @PrivateRedirectUrl
					,[EnableJobCustomQuestionnaire] = @EnableJobCustomQuestionnaire
					,[JobApplicationTypeID] = @JobApplicationTypeId
					,[JobScreeningProcess] = @JobScreeningProcess
					,[AdvertiserApprovalProcess] = @AdvertiserApprovalProcess
					,[SiteType] = @SiteType
					,[EnableSSL] = @EnableSsl
					,[GST] = @Gst
					,[GSTLabel] = @GstLabel
					,[NumberOfPremiumJobs] = @NumberOfPremiumJobs
					,[PremiumJobDays] = @PremiumJobDays
					,[DisplayPremiumJobsOnResults] = @DisplayPremiumJobsOnResults
					,[JobExpiryNotification] = @JobExpiryNotification
					,[CurrencyID] = @CurrencyId
					,[PayPalClientID] = @PayPalClientId
					,[PayPalClientSecret] = @PayPalClientSecret
					,[PaypalUser] = @PaypalUser
					,[PaypalProPassword] = @PaypalProPassword
					,[PaypalVendor] = @PaypalVendor
					,[PaypalPartner] = @PaypalPartner
					,[InvoiceSiteInfo] = @InvoiceSiteInfo
					,[InvoiceSiteFooter] = @InvoiceSiteFooter
					,[EnableTermsAndConditions] = @EnableTermsAndConditions
					,[DefaultEmailLanguageId] = @DefaultEmailLanguageId
					,[GoogleTagManager] = @GoogleTagManager
					,[GoogleAnalytics] = @GoogleAnalytics
					,[GoogleWebMaster] = @GoogleWebMaster
					,[EnablePeopleSearch] = @EnablePeopleSearch
					,[GlobalDateFormat] = @GlobalDateFormat
					,[TimeZone] = @TimeZone
					,[EnableScreeningQuestions] = @EnableScreeningQuestions
				WHERE
[GlobalSettingID] = @GlobalSettingId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.GlobalSettings_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.GlobalSettings_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.GlobalSettings_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the GlobalSettings table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.GlobalSettings_Delete
(

	@GlobalSettingId int   
)
AS


				DELETE FROM [dbo].[GlobalSettings] WITH (ROWLOCK) 
				WHERE
					[GlobalSettingID] = @GlobalSettingId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.GlobalSettings_GetByDefaultCountryId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.GlobalSettings_GetByDefaultCountryId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.GlobalSettings_GetByDefaultCountryId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the GlobalSettings table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.GlobalSettings_GetByDefaultCountryId
(

	@DefaultCountryId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[GlobalSettingID],
					[SiteID],
					[DefaultLanguageID],
					[DefaultDynamicPageID],
					[PublicJobsSearch],
					[PublicMembersSearch],
					[PublicCompaniesSearch],
					[PublicSponsoredAdverts],
					[PrivateJobs],
					[PrivateMembers],
					[PrivateCompanies],
					[LastModifiedBy],
					[LastModified],
					[PageTitlePrefix],
					[PageTitleSuffix],
					[DefaultTitle],
					[HomeTitle],
					[DefaultDescription],
					[HomeDescription],
					[DefaultKeywords],
					[HomeKeywords],
					[ShowFaceBookButton],
					[UseAdvertiserFilter],
					[MerchantID],
					[ShowTwitterButton],
					[ShowJobAlertButton],
					[ShowLinkedInButton],
					[SiteFavIconID],
					[SiteDocType],
					[CurrencySymbol],
					[FtpFolderLocation],
					[MetaTags],
					[SystemMetaTags],
					[MemberRegistrationNotification],
					[LinkedInAPI],
					[LinkedInLogo],
					[LinkedInCompanyID],
					[LinkedInEmail],
					[PrivacySettings],
					[WWWRedirect],
					[AllowAdvertiser],
					[LinkedInAPISecret],
					[GoogleClientID],
					[GoogleClientSecret],
					[FacebookAppID],
					[FacebookAppSecret],
					[LinkedInButtonSize],
					[DefaultCountryID],
					[PayPalUsername],
					[PayPalPassword],
					[PayPalSignature],
					[SecurePayMerchantID],
					[SecurePayPassword],
					[UsingSSL],
					[UseCustomProfessionRole],
					[GenerateJobXML],
					[IsPrivateSite],
					[PrivateRedirectUrl],
					[EnableJobCustomQuestionnaire],
					[JobApplicationTypeID],
					[JobScreeningProcess],
					[AdvertiserApprovalProcess],
					[SiteType],
					[EnableSSL],
					[GST],
					[GSTLabel],
					[NumberOfPremiumJobs],
					[PremiumJobDays],
					[DisplayPremiumJobsOnResults],
					[JobExpiryNotification],
					[CurrencyID],
					[PayPalClientID],
					[PayPalClientSecret],
					[PaypalUser],
					[PaypalProPassword],
					[PaypalVendor],
					[PaypalPartner],
					[InvoiceSiteInfo],
					[InvoiceSiteFooter],
					[EnableTermsAndConditions],
					[DefaultEmailLanguageId],
					[GoogleTagManager],
					[GoogleAnalytics],
					[GoogleWebMaster],
					[EnablePeopleSearch],
					[GlobalDateFormat],
					[TimeZone],
					[EnableScreeningQuestions]
				FROM
					[dbo].[GlobalSettings]
				WHERE
					[DefaultCountryID] = @DefaultCountryId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.GlobalSettings_GetByDefaultLanguageId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.GlobalSettings_GetByDefaultLanguageId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.GlobalSettings_GetByDefaultLanguageId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the GlobalSettings table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.GlobalSettings_GetByDefaultLanguageId
(

	@DefaultLanguageId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[GlobalSettingID],
					[SiteID],
					[DefaultLanguageID],
					[DefaultDynamicPageID],
					[PublicJobsSearch],
					[PublicMembersSearch],
					[PublicCompaniesSearch],
					[PublicSponsoredAdverts],
					[PrivateJobs],
					[PrivateMembers],
					[PrivateCompanies],
					[LastModifiedBy],
					[LastModified],
					[PageTitlePrefix],
					[PageTitleSuffix],
					[DefaultTitle],
					[HomeTitle],
					[DefaultDescription],
					[HomeDescription],
					[DefaultKeywords],
					[HomeKeywords],
					[ShowFaceBookButton],
					[UseAdvertiserFilter],
					[MerchantID],
					[ShowTwitterButton],
					[ShowJobAlertButton],
					[ShowLinkedInButton],
					[SiteFavIconID],
					[SiteDocType],
					[CurrencySymbol],
					[FtpFolderLocation],
					[MetaTags],
					[SystemMetaTags],
					[MemberRegistrationNotification],
					[LinkedInAPI],
					[LinkedInLogo],
					[LinkedInCompanyID],
					[LinkedInEmail],
					[PrivacySettings],
					[WWWRedirect],
					[AllowAdvertiser],
					[LinkedInAPISecret],
					[GoogleClientID],
					[GoogleClientSecret],
					[FacebookAppID],
					[FacebookAppSecret],
					[LinkedInButtonSize],
					[DefaultCountryID],
					[PayPalUsername],
					[PayPalPassword],
					[PayPalSignature],
					[SecurePayMerchantID],
					[SecurePayPassword],
					[UsingSSL],
					[UseCustomProfessionRole],
					[GenerateJobXML],
					[IsPrivateSite],
					[PrivateRedirectUrl],
					[EnableJobCustomQuestionnaire],
					[JobApplicationTypeID],
					[JobScreeningProcess],
					[AdvertiserApprovalProcess],
					[SiteType],
					[EnableSSL],
					[GST],
					[GSTLabel],
					[NumberOfPremiumJobs],
					[PremiumJobDays],
					[DisplayPremiumJobsOnResults],
					[JobExpiryNotification],
					[CurrencyID],
					[PayPalClientID],
					[PayPalClientSecret],
					[PaypalUser],
					[PaypalProPassword],
					[PaypalVendor],
					[PaypalPartner],
					[InvoiceSiteInfo],
					[InvoiceSiteFooter],
					[EnableTermsAndConditions],
					[DefaultEmailLanguageId],
					[GoogleTagManager],
					[GoogleAnalytics],
					[GoogleWebMaster],
					[EnablePeopleSearch],
					[GlobalDateFormat],
					[TimeZone],
					[EnableScreeningQuestions]
				FROM
					[dbo].[GlobalSettings]
				WHERE
					[DefaultLanguageID] = @DefaultLanguageId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.GlobalSettings_GetByDefaultDynamicPageId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.GlobalSettings_GetByDefaultDynamicPageId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.GlobalSettings_GetByDefaultDynamicPageId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the GlobalSettings table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.GlobalSettings_GetByDefaultDynamicPageId
(

	@DefaultDynamicPageId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[GlobalSettingID],
					[SiteID],
					[DefaultLanguageID],
					[DefaultDynamicPageID],
					[PublicJobsSearch],
					[PublicMembersSearch],
					[PublicCompaniesSearch],
					[PublicSponsoredAdverts],
					[PrivateJobs],
					[PrivateMembers],
					[PrivateCompanies],
					[LastModifiedBy],
					[LastModified],
					[PageTitlePrefix],
					[PageTitleSuffix],
					[DefaultTitle],
					[HomeTitle],
					[DefaultDescription],
					[HomeDescription],
					[DefaultKeywords],
					[HomeKeywords],
					[ShowFaceBookButton],
					[UseAdvertiserFilter],
					[MerchantID],
					[ShowTwitterButton],
					[ShowJobAlertButton],
					[ShowLinkedInButton],
					[SiteFavIconID],
					[SiteDocType],
					[CurrencySymbol],
					[FtpFolderLocation],
					[MetaTags],
					[SystemMetaTags],
					[MemberRegistrationNotification],
					[LinkedInAPI],
					[LinkedInLogo],
					[LinkedInCompanyID],
					[LinkedInEmail],
					[PrivacySettings],
					[WWWRedirect],
					[AllowAdvertiser],
					[LinkedInAPISecret],
					[GoogleClientID],
					[GoogleClientSecret],
					[FacebookAppID],
					[FacebookAppSecret],
					[LinkedInButtonSize],
					[DefaultCountryID],
					[PayPalUsername],
					[PayPalPassword],
					[PayPalSignature],
					[SecurePayMerchantID],
					[SecurePayPassword],
					[UsingSSL],
					[UseCustomProfessionRole],
					[GenerateJobXML],
					[IsPrivateSite],
					[PrivateRedirectUrl],
					[EnableJobCustomQuestionnaire],
					[JobApplicationTypeID],
					[JobScreeningProcess],
					[AdvertiserApprovalProcess],
					[SiteType],
					[EnableSSL],
					[GST],
					[GSTLabel],
					[NumberOfPremiumJobs],
					[PremiumJobDays],
					[DisplayPremiumJobsOnResults],
					[JobExpiryNotification],
					[CurrencyID],
					[PayPalClientID],
					[PayPalClientSecret],
					[PaypalUser],
					[PaypalProPassword],
					[PaypalVendor],
					[PaypalPartner],
					[InvoiceSiteInfo],
					[InvoiceSiteFooter],
					[EnableTermsAndConditions],
					[DefaultEmailLanguageId],
					[GoogleTagManager],
					[GoogleAnalytics],
					[GoogleWebMaster],
					[EnablePeopleSearch],
					[GlobalDateFormat],
					[TimeZone],
					[EnableScreeningQuestions]
				FROM
					[dbo].[GlobalSettings]
				WHERE
					[DefaultDynamicPageID] = @DefaultDynamicPageId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.GlobalSettings_GetByLastModifiedBy procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.GlobalSettings_GetByLastModifiedBy') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.GlobalSettings_GetByLastModifiedBy
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the GlobalSettings table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.GlobalSettings_GetByLastModifiedBy
(

	@LastModifiedBy int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[GlobalSettingID],
					[SiteID],
					[DefaultLanguageID],
					[DefaultDynamicPageID],
					[PublicJobsSearch],
					[PublicMembersSearch],
					[PublicCompaniesSearch],
					[PublicSponsoredAdverts],
					[PrivateJobs],
					[PrivateMembers],
					[PrivateCompanies],
					[LastModifiedBy],
					[LastModified],
					[PageTitlePrefix],
					[PageTitleSuffix],
					[DefaultTitle],
					[HomeTitle],
					[DefaultDescription],
					[HomeDescription],
					[DefaultKeywords],
					[HomeKeywords],
					[ShowFaceBookButton],
					[UseAdvertiserFilter],
					[MerchantID],
					[ShowTwitterButton],
					[ShowJobAlertButton],
					[ShowLinkedInButton],
					[SiteFavIconID],
					[SiteDocType],
					[CurrencySymbol],
					[FtpFolderLocation],
					[MetaTags],
					[SystemMetaTags],
					[MemberRegistrationNotification],
					[LinkedInAPI],
					[LinkedInLogo],
					[LinkedInCompanyID],
					[LinkedInEmail],
					[PrivacySettings],
					[WWWRedirect],
					[AllowAdvertiser],
					[LinkedInAPISecret],
					[GoogleClientID],
					[GoogleClientSecret],
					[FacebookAppID],
					[FacebookAppSecret],
					[LinkedInButtonSize],
					[DefaultCountryID],
					[PayPalUsername],
					[PayPalPassword],
					[PayPalSignature],
					[SecurePayMerchantID],
					[SecurePayPassword],
					[UsingSSL],
					[UseCustomProfessionRole],
					[GenerateJobXML],
					[IsPrivateSite],
					[PrivateRedirectUrl],
					[EnableJobCustomQuestionnaire],
					[JobApplicationTypeID],
					[JobScreeningProcess],
					[AdvertiserApprovalProcess],
					[SiteType],
					[EnableSSL],
					[GST],
					[GSTLabel],
					[NumberOfPremiumJobs],
					[PremiumJobDays],
					[DisplayPremiumJobsOnResults],
					[JobExpiryNotification],
					[CurrencyID],
					[PayPalClientID],
					[PayPalClientSecret],
					[PaypalUser],
					[PaypalProPassword],
					[PaypalVendor],
					[PaypalPartner],
					[InvoiceSiteInfo],
					[InvoiceSiteFooter],
					[EnableTermsAndConditions],
					[DefaultEmailLanguageId],
					[GoogleTagManager],
					[GoogleAnalytics],
					[GoogleWebMaster],
					[EnablePeopleSearch],
					[GlobalDateFormat],
					[TimeZone],
					[EnableScreeningQuestions]
				FROM
					[dbo].[GlobalSettings]
				WHERE
					[LastModifiedBy] = @LastModifiedBy
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.GlobalSettings_GetBySiteFavIconId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.GlobalSettings_GetBySiteFavIconId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.GlobalSettings_GetBySiteFavIconId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the GlobalSettings table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.GlobalSettings_GetBySiteFavIconId
(

	@SiteFavIconId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[GlobalSettingID],
					[SiteID],
					[DefaultLanguageID],
					[DefaultDynamicPageID],
					[PublicJobsSearch],
					[PublicMembersSearch],
					[PublicCompaniesSearch],
					[PublicSponsoredAdverts],
					[PrivateJobs],
					[PrivateMembers],
					[PrivateCompanies],
					[LastModifiedBy],
					[LastModified],
					[PageTitlePrefix],
					[PageTitleSuffix],
					[DefaultTitle],
					[HomeTitle],
					[DefaultDescription],
					[HomeDescription],
					[DefaultKeywords],
					[HomeKeywords],
					[ShowFaceBookButton],
					[UseAdvertiserFilter],
					[MerchantID],
					[ShowTwitterButton],
					[ShowJobAlertButton],
					[ShowLinkedInButton],
					[SiteFavIconID],
					[SiteDocType],
					[CurrencySymbol],
					[FtpFolderLocation],
					[MetaTags],
					[SystemMetaTags],
					[MemberRegistrationNotification],
					[LinkedInAPI],
					[LinkedInLogo],
					[LinkedInCompanyID],
					[LinkedInEmail],
					[PrivacySettings],
					[WWWRedirect],
					[AllowAdvertiser],
					[LinkedInAPISecret],
					[GoogleClientID],
					[GoogleClientSecret],
					[FacebookAppID],
					[FacebookAppSecret],
					[LinkedInButtonSize],
					[DefaultCountryID],
					[PayPalUsername],
					[PayPalPassword],
					[PayPalSignature],
					[SecurePayMerchantID],
					[SecurePayPassword],
					[UsingSSL],
					[UseCustomProfessionRole],
					[GenerateJobXML],
					[IsPrivateSite],
					[PrivateRedirectUrl],
					[EnableJobCustomQuestionnaire],
					[JobApplicationTypeID],
					[JobScreeningProcess],
					[AdvertiserApprovalProcess],
					[SiteType],
					[EnableSSL],
					[GST],
					[GSTLabel],
					[NumberOfPremiumJobs],
					[PremiumJobDays],
					[DisplayPremiumJobsOnResults],
					[JobExpiryNotification],
					[CurrencyID],
					[PayPalClientID],
					[PayPalClientSecret],
					[PaypalUser],
					[PaypalProPassword],
					[PaypalVendor],
					[PaypalPartner],
					[InvoiceSiteInfo],
					[InvoiceSiteFooter],
					[EnableTermsAndConditions],
					[DefaultEmailLanguageId],
					[GoogleTagManager],
					[GoogleAnalytics],
					[GoogleWebMaster],
					[EnablePeopleSearch],
					[GlobalDateFormat],
					[TimeZone],
					[EnableScreeningQuestions]
				FROM
					[dbo].[GlobalSettings]
				WHERE
					[SiteFavIconID] = @SiteFavIconId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.GlobalSettings_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.GlobalSettings_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.GlobalSettings_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the GlobalSettings table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.GlobalSettings_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[GlobalSettingID],
					[SiteID],
					[DefaultLanguageID],
					[DefaultDynamicPageID],
					[PublicJobsSearch],
					[PublicMembersSearch],
					[PublicCompaniesSearch],
					[PublicSponsoredAdverts],
					[PrivateJobs],
					[PrivateMembers],
					[PrivateCompanies],
					[LastModifiedBy],
					[LastModified],
					[PageTitlePrefix],
					[PageTitleSuffix],
					[DefaultTitle],
					[HomeTitle],
					[DefaultDescription],
					[HomeDescription],
					[DefaultKeywords],
					[HomeKeywords],
					[ShowFaceBookButton],
					[UseAdvertiserFilter],
					[MerchantID],
					[ShowTwitterButton],
					[ShowJobAlertButton],
					[ShowLinkedInButton],
					[SiteFavIconID],
					[SiteDocType],
					[CurrencySymbol],
					[FtpFolderLocation],
					[MetaTags],
					[SystemMetaTags],
					[MemberRegistrationNotification],
					[LinkedInAPI],
					[LinkedInLogo],
					[LinkedInCompanyID],
					[LinkedInEmail],
					[PrivacySettings],
					[WWWRedirect],
					[AllowAdvertiser],
					[LinkedInAPISecret],
					[GoogleClientID],
					[GoogleClientSecret],
					[FacebookAppID],
					[FacebookAppSecret],
					[LinkedInButtonSize],
					[DefaultCountryID],
					[PayPalUsername],
					[PayPalPassword],
					[PayPalSignature],
					[SecurePayMerchantID],
					[SecurePayPassword],
					[UsingSSL],
					[UseCustomProfessionRole],
					[GenerateJobXML],
					[IsPrivateSite],
					[PrivateRedirectUrl],
					[EnableJobCustomQuestionnaire],
					[JobApplicationTypeID],
					[JobScreeningProcess],
					[AdvertiserApprovalProcess],
					[SiteType],
					[EnableSSL],
					[GST],
					[GSTLabel],
					[NumberOfPremiumJobs],
					[PremiumJobDays],
					[DisplayPremiumJobsOnResults],
					[JobExpiryNotification],
					[CurrencyID],
					[PayPalClientID],
					[PayPalClientSecret],
					[PaypalUser],
					[PaypalProPassword],
					[PaypalVendor],
					[PaypalPartner],
					[InvoiceSiteInfo],
					[InvoiceSiteFooter],
					[EnableTermsAndConditions],
					[DefaultEmailLanguageId],
					[GoogleTagManager],
					[GoogleAnalytics],
					[GoogleWebMaster],
					[EnablePeopleSearch],
					[GlobalDateFormat],
					[TimeZone],
					[EnableScreeningQuestions]
				FROM
					[dbo].[GlobalSettings]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.GlobalSettings_GetBySiteIdGlobalSettingId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.GlobalSettings_GetBySiteIdGlobalSettingId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.GlobalSettings_GetBySiteIdGlobalSettingId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the GlobalSettings table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.GlobalSettings_GetBySiteIdGlobalSettingId
(

	@SiteId int   ,

	@GlobalSettingId int   
)
AS


				SELECT
					[GlobalSettingID],
					[SiteID],
					[DefaultLanguageID],
					[DefaultDynamicPageID],
					[PublicJobsSearch],
					[PublicMembersSearch],
					[PublicCompaniesSearch],
					[PublicSponsoredAdverts],
					[PrivateJobs],
					[PrivateMembers],
					[PrivateCompanies],
					[LastModifiedBy],
					[LastModified],
					[PageTitlePrefix],
					[PageTitleSuffix],
					[DefaultTitle],
					[HomeTitle],
					[DefaultDescription],
					[HomeDescription],
					[DefaultKeywords],
					[HomeKeywords],
					[ShowFaceBookButton],
					[UseAdvertiserFilter],
					[MerchantID],
					[ShowTwitterButton],
					[ShowJobAlertButton],
					[ShowLinkedInButton],
					[SiteFavIconID],
					[SiteDocType],
					[CurrencySymbol],
					[FtpFolderLocation],
					[MetaTags],
					[SystemMetaTags],
					[MemberRegistrationNotification],
					[LinkedInAPI],
					[LinkedInLogo],
					[LinkedInCompanyID],
					[LinkedInEmail],
					[PrivacySettings],
					[WWWRedirect],
					[AllowAdvertiser],
					[LinkedInAPISecret],
					[GoogleClientID],
					[GoogleClientSecret],
					[FacebookAppID],
					[FacebookAppSecret],
					[LinkedInButtonSize],
					[DefaultCountryID],
					[PayPalUsername],
					[PayPalPassword],
					[PayPalSignature],
					[SecurePayMerchantID],
					[SecurePayPassword],
					[UsingSSL],
					[UseCustomProfessionRole],
					[GenerateJobXML],
					[IsPrivateSite],
					[PrivateRedirectUrl],
					[EnableJobCustomQuestionnaire],
					[JobApplicationTypeID],
					[JobScreeningProcess],
					[AdvertiserApprovalProcess],
					[SiteType],
					[EnableSSL],
					[GST],
					[GSTLabel],
					[NumberOfPremiumJobs],
					[PremiumJobDays],
					[DisplayPremiumJobsOnResults],
					[JobExpiryNotification],
					[CurrencyID],
					[PayPalClientID],
					[PayPalClientSecret],
					[PaypalUser],
					[PaypalProPassword],
					[PaypalVendor],
					[PaypalPartner],
					[InvoiceSiteInfo],
					[InvoiceSiteFooter],
					[EnableTermsAndConditions],
					[DefaultEmailLanguageId],
					[GoogleTagManager],
					[GoogleAnalytics],
					[GoogleWebMaster],
					[EnablePeopleSearch],
					[GlobalDateFormat],
					[TimeZone],
					[EnableScreeningQuestions]
				FROM
					[dbo].[GlobalSettings]
				WHERE
					[SiteID] = @SiteId
					AND [GlobalSettingID] = @GlobalSettingId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.GlobalSettings_GetBySiteIdPublicJobsSearch procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.GlobalSettings_GetBySiteIdPublicJobsSearch') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.GlobalSettings_GetBySiteIdPublicJobsSearch
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the GlobalSettings table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.GlobalSettings_GetBySiteIdPublicJobsSearch
(

	@SiteId int   ,

	@PublicJobsSearch bit   
)
AS


				SELECT
					[GlobalSettingID],
					[SiteID],
					[DefaultLanguageID],
					[DefaultDynamicPageID],
					[PublicJobsSearch],
					[PublicMembersSearch],
					[PublicCompaniesSearch],
					[PublicSponsoredAdverts],
					[PrivateJobs],
					[PrivateMembers],
					[PrivateCompanies],
					[LastModifiedBy],
					[LastModified],
					[PageTitlePrefix],
					[PageTitleSuffix],
					[DefaultTitle],
					[HomeTitle],
					[DefaultDescription],
					[HomeDescription],
					[DefaultKeywords],
					[HomeKeywords],
					[ShowFaceBookButton],
					[UseAdvertiserFilter],
					[MerchantID],
					[ShowTwitterButton],
					[ShowJobAlertButton],
					[ShowLinkedInButton],
					[SiteFavIconID],
					[SiteDocType],
					[CurrencySymbol],
					[FtpFolderLocation],
					[MetaTags],
					[SystemMetaTags],
					[MemberRegistrationNotification],
					[LinkedInAPI],
					[LinkedInLogo],
					[LinkedInCompanyID],
					[LinkedInEmail],
					[PrivacySettings],
					[WWWRedirect],
					[AllowAdvertiser],
					[LinkedInAPISecret],
					[GoogleClientID],
					[GoogleClientSecret],
					[FacebookAppID],
					[FacebookAppSecret],
					[LinkedInButtonSize],
					[DefaultCountryID],
					[PayPalUsername],
					[PayPalPassword],
					[PayPalSignature],
					[SecurePayMerchantID],
					[SecurePayPassword],
					[UsingSSL],
					[UseCustomProfessionRole],
					[GenerateJobXML],
					[IsPrivateSite],
					[PrivateRedirectUrl],
					[EnableJobCustomQuestionnaire],
					[JobApplicationTypeID],
					[JobScreeningProcess],
					[AdvertiserApprovalProcess],
					[SiteType],
					[EnableSSL],
					[GST],
					[GSTLabel],
					[NumberOfPremiumJobs],
					[PremiumJobDays],
					[DisplayPremiumJobsOnResults],
					[JobExpiryNotification],
					[CurrencyID],
					[PayPalClientID],
					[PayPalClientSecret],
					[PaypalUser],
					[PaypalProPassword],
					[PaypalVendor],
					[PaypalPartner],
					[InvoiceSiteInfo],
					[InvoiceSiteFooter],
					[EnableTermsAndConditions],
					[DefaultEmailLanguageId],
					[GoogleTagManager],
					[GoogleAnalytics],
					[GoogleWebMaster],
					[EnablePeopleSearch],
					[GlobalDateFormat],
					[TimeZone],
					[EnableScreeningQuestions]
				FROM
					[dbo].[GlobalSettings]
				WHERE
					[SiteID] = @SiteId
					AND [PublicJobsSearch] = @PublicJobsSearch
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.GlobalSettings_GetBySiteIdUseAdvertiserFilter procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.GlobalSettings_GetBySiteIdUseAdvertiserFilter') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.GlobalSettings_GetBySiteIdUseAdvertiserFilter
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the GlobalSettings table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.GlobalSettings_GetBySiteIdUseAdvertiserFilter
(

	@SiteId int   ,

	@UseAdvertiserFilter int   
)
AS


				SELECT
					[GlobalSettingID],
					[SiteID],
					[DefaultLanguageID],
					[DefaultDynamicPageID],
					[PublicJobsSearch],
					[PublicMembersSearch],
					[PublicCompaniesSearch],
					[PublicSponsoredAdverts],
					[PrivateJobs],
					[PrivateMembers],
					[PrivateCompanies],
					[LastModifiedBy],
					[LastModified],
					[PageTitlePrefix],
					[PageTitleSuffix],
					[DefaultTitle],
					[HomeTitle],
					[DefaultDescription],
					[HomeDescription],
					[DefaultKeywords],
					[HomeKeywords],
					[ShowFaceBookButton],
					[UseAdvertiserFilter],
					[MerchantID],
					[ShowTwitterButton],
					[ShowJobAlertButton],
					[ShowLinkedInButton],
					[SiteFavIconID],
					[SiteDocType],
					[CurrencySymbol],
					[FtpFolderLocation],
					[MetaTags],
					[SystemMetaTags],
					[MemberRegistrationNotification],
					[LinkedInAPI],
					[LinkedInLogo],
					[LinkedInCompanyID],
					[LinkedInEmail],
					[PrivacySettings],
					[WWWRedirect],
					[AllowAdvertiser],
					[LinkedInAPISecret],
					[GoogleClientID],
					[GoogleClientSecret],
					[FacebookAppID],
					[FacebookAppSecret],
					[LinkedInButtonSize],
					[DefaultCountryID],
					[PayPalUsername],
					[PayPalPassword],
					[PayPalSignature],
					[SecurePayMerchantID],
					[SecurePayPassword],
					[UsingSSL],
					[UseCustomProfessionRole],
					[GenerateJobXML],
					[IsPrivateSite],
					[PrivateRedirectUrl],
					[EnableJobCustomQuestionnaire],
					[JobApplicationTypeID],
					[JobScreeningProcess],
					[AdvertiserApprovalProcess],
					[SiteType],
					[EnableSSL],
					[GST],
					[GSTLabel],
					[NumberOfPremiumJobs],
					[PremiumJobDays],
					[DisplayPremiumJobsOnResults],
					[JobExpiryNotification],
					[CurrencyID],
					[PayPalClientID],
					[PayPalClientSecret],
					[PaypalUser],
					[PaypalProPassword],
					[PaypalVendor],
					[PaypalPartner],
					[InvoiceSiteInfo],
					[InvoiceSiteFooter],
					[EnableTermsAndConditions],
					[DefaultEmailLanguageId],
					[GoogleTagManager],
					[GoogleAnalytics],
					[GoogleWebMaster],
					[EnablePeopleSearch],
					[GlobalDateFormat],
					[TimeZone],
					[EnableScreeningQuestions]
				FROM
					[dbo].[GlobalSettings]
				WHERE
					[SiteID] = @SiteId
					AND [UseAdvertiserFilter] = @UseAdvertiserFilter
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.GlobalSettings_GetByPublicJobsSearchPrivateJobsSiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.GlobalSettings_GetByPublicJobsSearchPrivateJobsSiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.GlobalSettings_GetByPublicJobsSearchPrivateJobsSiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the GlobalSettings table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.GlobalSettings_GetByPublicJobsSearchPrivateJobsSiteId
(

	@PublicJobsSearch bit   ,

	@PrivateJobs bit   ,

	@SiteId int   
)
AS


				SELECT
					[GlobalSettingID],
					[SiteID],
					[DefaultLanguageID],
					[DefaultDynamicPageID],
					[PublicJobsSearch],
					[PublicMembersSearch],
					[PublicCompaniesSearch],
					[PublicSponsoredAdverts],
					[PrivateJobs],
					[PrivateMembers],
					[PrivateCompanies],
					[LastModifiedBy],
					[LastModified],
					[PageTitlePrefix],
					[PageTitleSuffix],
					[DefaultTitle],
					[HomeTitle],
					[DefaultDescription],
					[HomeDescription],
					[DefaultKeywords],
					[HomeKeywords],
					[ShowFaceBookButton],
					[UseAdvertiserFilter],
					[MerchantID],
					[ShowTwitterButton],
					[ShowJobAlertButton],
					[ShowLinkedInButton],
					[SiteFavIconID],
					[SiteDocType],
					[CurrencySymbol],
					[FtpFolderLocation],
					[MetaTags],
					[SystemMetaTags],
					[MemberRegistrationNotification],
					[LinkedInAPI],
					[LinkedInLogo],
					[LinkedInCompanyID],
					[LinkedInEmail],
					[PrivacySettings],
					[WWWRedirect],
					[AllowAdvertiser],
					[LinkedInAPISecret],
					[GoogleClientID],
					[GoogleClientSecret],
					[FacebookAppID],
					[FacebookAppSecret],
					[LinkedInButtonSize],
					[DefaultCountryID],
					[PayPalUsername],
					[PayPalPassword],
					[PayPalSignature],
					[SecurePayMerchantID],
					[SecurePayPassword],
					[UsingSSL],
					[UseCustomProfessionRole],
					[GenerateJobXML],
					[IsPrivateSite],
					[PrivateRedirectUrl],
					[EnableJobCustomQuestionnaire],
					[JobApplicationTypeID],
					[JobScreeningProcess],
					[AdvertiserApprovalProcess],
					[SiteType],
					[EnableSSL],
					[GST],
					[GSTLabel],
					[NumberOfPremiumJobs],
					[PremiumJobDays],
					[DisplayPremiumJobsOnResults],
					[JobExpiryNotification],
					[CurrencyID],
					[PayPalClientID],
					[PayPalClientSecret],
					[PaypalUser],
					[PaypalProPassword],
					[PaypalVendor],
					[PaypalPartner],
					[InvoiceSiteInfo],
					[InvoiceSiteFooter],
					[EnableTermsAndConditions],
					[DefaultEmailLanguageId],
					[GoogleTagManager],
					[GoogleAnalytics],
					[GoogleWebMaster],
					[EnablePeopleSearch],
					[GlobalDateFormat],
					[TimeZone],
					[EnableScreeningQuestions]
				FROM
					[dbo].[GlobalSettings]
				WHERE
					[PublicJobsSearch] = @PublicJobsSearch
					AND [PrivateJobs] = @PrivateJobs
					AND [SiteID] = @SiteId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.GlobalSettings_GetByGlobalSettingId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.GlobalSettings_GetByGlobalSettingId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.GlobalSettings_GetByGlobalSettingId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the GlobalSettings table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.GlobalSettings_GetByGlobalSettingId
(

	@GlobalSettingId int   
)
AS


				SELECT
					[GlobalSettingID],
					[SiteID],
					[DefaultLanguageID],
					[DefaultDynamicPageID],
					[PublicJobsSearch],
					[PublicMembersSearch],
					[PublicCompaniesSearch],
					[PublicSponsoredAdverts],
					[PrivateJobs],
					[PrivateMembers],
					[PrivateCompanies],
					[LastModifiedBy],
					[LastModified],
					[PageTitlePrefix],
					[PageTitleSuffix],
					[DefaultTitle],
					[HomeTitle],
					[DefaultDescription],
					[HomeDescription],
					[DefaultKeywords],
					[HomeKeywords],
					[ShowFaceBookButton],
					[UseAdvertiserFilter],
					[MerchantID],
					[ShowTwitterButton],
					[ShowJobAlertButton],
					[ShowLinkedInButton],
					[SiteFavIconID],
					[SiteDocType],
					[CurrencySymbol],
					[FtpFolderLocation],
					[MetaTags],
					[SystemMetaTags],
					[MemberRegistrationNotification],
					[LinkedInAPI],
					[LinkedInLogo],
					[LinkedInCompanyID],
					[LinkedInEmail],
					[PrivacySettings],
					[WWWRedirect],
					[AllowAdvertiser],
					[LinkedInAPISecret],
					[GoogleClientID],
					[GoogleClientSecret],
					[FacebookAppID],
					[FacebookAppSecret],
					[LinkedInButtonSize],
					[DefaultCountryID],
					[PayPalUsername],
					[PayPalPassword],
					[PayPalSignature],
					[SecurePayMerchantID],
					[SecurePayPassword],
					[UsingSSL],
					[UseCustomProfessionRole],
					[GenerateJobXML],
					[IsPrivateSite],
					[PrivateRedirectUrl],
					[EnableJobCustomQuestionnaire],
					[JobApplicationTypeID],
					[JobScreeningProcess],
					[AdvertiserApprovalProcess],
					[SiteType],
					[EnableSSL],
					[GST],
					[GSTLabel],
					[NumberOfPremiumJobs],
					[PremiumJobDays],
					[DisplayPremiumJobsOnResults],
					[JobExpiryNotification],
					[CurrencyID],
					[PayPalClientID],
					[PayPalClientSecret],
					[PaypalUser],
					[PaypalProPassword],
					[PaypalVendor],
					[PaypalPartner],
					[InvoiceSiteInfo],
					[InvoiceSiteFooter],
					[EnableTermsAndConditions],
					[DefaultEmailLanguageId],
					[GoogleTagManager],
					[GoogleAnalytics],
					[GoogleWebMaster],
					[EnablePeopleSearch],
					[GlobalDateFormat],
					[TimeZone],
					[EnableScreeningQuestions]
				FROM
					[dbo].[GlobalSettings]
				WHERE
					[GlobalSettingID] = @GlobalSettingId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.GlobalSettings_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.GlobalSettings_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.GlobalSettings_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the GlobalSettings table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.GlobalSettings_Find
(

	@SearchUsingOR bit   = null ,

	@GlobalSettingId int   = null ,

	@SiteId int   = null ,

	@DefaultLanguageId int   = null ,

	@DefaultDynamicPageId int   = null ,

	@PublicJobsSearch bit   = null ,

	@PublicMembersSearch bit   = null ,

	@PublicCompaniesSearch bit   = null ,

	@PublicSponsoredAdverts bit   = null ,

	@PrivateJobs bit   = null ,

	@PrivateMembers bit   = null ,

	@PrivateCompanies bit   = null ,

	@LastModifiedBy int   = null ,

	@LastModified datetime   = null ,

	@PageTitlePrefix nvarchar (510)  = null ,

	@PageTitleSuffix nvarchar (510)  = null ,

	@DefaultTitle nvarchar (510)  = null ,

	@HomeTitle nvarchar (510)  = null ,

	@DefaultDescription nvarchar (510)  = null ,

	@HomeDescription nvarchar (510)  = null ,

	@DefaultKeywords nvarchar (510)  = null ,

	@HomeKeywords nvarchar (510)  = null ,

	@ShowFaceBookButton bit   = null ,

	@UseAdvertiserFilter int   = null ,

	@MerchantId int   = null ,

	@ShowTwitterButton bit   = null ,

	@ShowJobAlertButton bit   = null ,

	@ShowLinkedInButton bit   = null ,

	@SiteFavIconId int   = null ,

	@SiteDocType varchar (512)  = null ,

	@CurrencySymbol varchar (10)  = null ,

	@FtpFolderLocation varchar (255)  = null ,

	@MetaTags nvarchar (MAX)  = null ,

	@SystemMetaTags nvarchar (4000)  = null ,

	@MemberRegistrationNotification varchar (255)  = null ,

	@LinkedInApi varchar (255)  = null ,

	@LinkedInLogo varchar (255)  = null ,

	@LinkedInCompanyId int   = null ,

	@LinkedInEmail varchar (255)  = null ,

	@PrivacySettings nvarchar (4000)  = null ,

	@WwwRedirect bit   = null ,

	@AllowAdvertiser bit   = null ,

	@LinkedInApiSecret varchar (255)  = null ,

	@GoogleClientId varchar (255)  = null ,

	@GoogleClientSecret varchar (255)  = null ,

	@FacebookAppId varchar (255)  = null ,

	@FacebookAppSecret varchar (255)  = null ,

	@LinkedInButtonSize int   = null ,

	@DefaultCountryId int   = null ,

	@PayPalUsername varchar (100)  = null ,

	@PayPalPassword varchar (100)  = null ,

	@PayPalSignature varchar (100)  = null ,

	@SecurePayMerchantId varchar (100)  = null ,

	@SecurePayPassword varchar (100)  = null ,

	@UsingSsl bit   = null ,

	@UseCustomProfessionRole bit   = null ,

	@GenerateJobXml bit   = null ,

	@IsPrivateSite bit   = null ,

	@PrivateRedirectUrl varchar (255)  = null ,

	@EnableJobCustomQuestionnaire bit   = null ,

	@JobApplicationTypeId int   = null ,

	@JobScreeningProcess bit   = null ,

	@AdvertiserApprovalProcess int   = null ,

	@SiteType int   = null ,

	@EnableSsl bit   = null ,

	@Gst decimal (5, 2)  = null ,

	@GstLabel nvarchar (510)  = null ,

	@NumberOfPremiumJobs int   = null ,

	@PremiumJobDays int   = null ,

	@DisplayPremiumJobsOnResults bit   = null ,

	@JobExpiryNotification bit   = null ,

	@CurrencyId int   = null ,

	@PayPalClientId varchar (255)  = null ,

	@PayPalClientSecret varchar (255)  = null ,

	@PaypalUser varchar (255)  = null ,

	@PaypalProPassword varchar (255)  = null ,

	@PaypalVendor varchar (255)  = null ,

	@PaypalPartner varchar (255)  = null ,

	@InvoiceSiteInfo nvarchar (1000)  = null ,

	@InvoiceSiteFooter nvarchar (1500)  = null ,

	@EnableTermsAndConditions bit   = null ,

	@DefaultEmailLanguageId int   = null ,

	@GoogleTagManager varchar (100)  = null ,

	@GoogleAnalytics varchar (100)  = null ,

	@GoogleWebMaster varchar (100)  = null ,

	@EnablePeopleSearch bit   = null ,

	@GlobalDateFormat varchar (20)  = null ,

	@TimeZone varchar (255)  = null ,

	@EnableScreeningQuestions bit   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [GlobalSettingID]
	, [SiteID]
	, [DefaultLanguageID]
	, [DefaultDynamicPageID]
	, [PublicJobsSearch]
	, [PublicMembersSearch]
	, [PublicCompaniesSearch]
	, [PublicSponsoredAdverts]
	, [PrivateJobs]
	, [PrivateMembers]
	, [PrivateCompanies]
	, [LastModifiedBy]
	, [LastModified]
	, [PageTitlePrefix]
	, [PageTitleSuffix]
	, [DefaultTitle]
	, [HomeTitle]
	, [DefaultDescription]
	, [HomeDescription]
	, [DefaultKeywords]
	, [HomeKeywords]
	, [ShowFaceBookButton]
	, [UseAdvertiserFilter]
	, [MerchantID]
	, [ShowTwitterButton]
	, [ShowJobAlertButton]
	, [ShowLinkedInButton]
	, [SiteFavIconID]
	, [SiteDocType]
	, [CurrencySymbol]
	, [FtpFolderLocation]
	, [MetaTags]
	, [SystemMetaTags]
	, [MemberRegistrationNotification]
	, [LinkedInAPI]
	, [LinkedInLogo]
	, [LinkedInCompanyID]
	, [LinkedInEmail]
	, [PrivacySettings]
	, [WWWRedirect]
	, [AllowAdvertiser]
	, [LinkedInAPISecret]
	, [GoogleClientID]
	, [GoogleClientSecret]
	, [FacebookAppID]
	, [FacebookAppSecret]
	, [LinkedInButtonSize]
	, [DefaultCountryID]
	, [PayPalUsername]
	, [PayPalPassword]
	, [PayPalSignature]
	, [SecurePayMerchantID]
	, [SecurePayPassword]
	, [UsingSSL]
	, [UseCustomProfessionRole]
	, [GenerateJobXML]
	, [IsPrivateSite]
	, [PrivateRedirectUrl]
	, [EnableJobCustomQuestionnaire]
	, [JobApplicationTypeID]
	, [JobScreeningProcess]
	, [AdvertiserApprovalProcess]
	, [SiteType]
	, [EnableSSL]
	, [GST]
	, [GSTLabel]
	, [NumberOfPremiumJobs]
	, [PremiumJobDays]
	, [DisplayPremiumJobsOnResults]
	, [JobExpiryNotification]
	, [CurrencyID]
	, [PayPalClientID]
	, [PayPalClientSecret]
	, [PaypalUser]
	, [PaypalProPassword]
	, [PaypalVendor]
	, [PaypalPartner]
	, [InvoiceSiteInfo]
	, [InvoiceSiteFooter]
	, [EnableTermsAndConditions]
	, [DefaultEmailLanguageId]
	, [GoogleTagManager]
	, [GoogleAnalytics]
	, [GoogleWebMaster]
	, [EnablePeopleSearch]
	, [GlobalDateFormat]
	, [TimeZone]
	, [EnableScreeningQuestions]
    FROM
	[dbo].[GlobalSettings]
    WHERE 
	 ([GlobalSettingID] = @GlobalSettingId OR @GlobalSettingId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([DefaultLanguageID] = @DefaultLanguageId OR @DefaultLanguageId IS NULL)
	AND ([DefaultDynamicPageID] = @DefaultDynamicPageId OR @DefaultDynamicPageId IS NULL)
	AND ([PublicJobsSearch] = @PublicJobsSearch OR @PublicJobsSearch IS NULL)
	AND ([PublicMembersSearch] = @PublicMembersSearch OR @PublicMembersSearch IS NULL)
	AND ([PublicCompaniesSearch] = @PublicCompaniesSearch OR @PublicCompaniesSearch IS NULL)
	AND ([PublicSponsoredAdverts] = @PublicSponsoredAdverts OR @PublicSponsoredAdverts IS NULL)
	AND ([PrivateJobs] = @PrivateJobs OR @PrivateJobs IS NULL)
	AND ([PrivateMembers] = @PrivateMembers OR @PrivateMembers IS NULL)
	AND ([PrivateCompanies] = @PrivateCompanies OR @PrivateCompanies IS NULL)
	AND ([LastModifiedBy] = @LastModifiedBy OR @LastModifiedBy IS NULL)
	AND ([LastModified] = @LastModified OR @LastModified IS NULL)
	AND ([PageTitlePrefix] = @PageTitlePrefix OR @PageTitlePrefix IS NULL)
	AND ([PageTitleSuffix] = @PageTitleSuffix OR @PageTitleSuffix IS NULL)
	AND ([DefaultTitle] = @DefaultTitle OR @DefaultTitle IS NULL)
	AND ([HomeTitle] = @HomeTitle OR @HomeTitle IS NULL)
	AND ([DefaultDescription] = @DefaultDescription OR @DefaultDescription IS NULL)
	AND ([HomeDescription] = @HomeDescription OR @HomeDescription IS NULL)
	AND ([DefaultKeywords] = @DefaultKeywords OR @DefaultKeywords IS NULL)
	AND ([HomeKeywords] = @HomeKeywords OR @HomeKeywords IS NULL)
	AND ([ShowFaceBookButton] = @ShowFaceBookButton OR @ShowFaceBookButton IS NULL)
	AND ([UseAdvertiserFilter] = @UseAdvertiserFilter OR @UseAdvertiserFilter IS NULL)
	AND ([MerchantID] = @MerchantId OR @MerchantId IS NULL)
	AND ([ShowTwitterButton] = @ShowTwitterButton OR @ShowTwitterButton IS NULL)
	AND ([ShowJobAlertButton] = @ShowJobAlertButton OR @ShowJobAlertButton IS NULL)
	AND ([ShowLinkedInButton] = @ShowLinkedInButton OR @ShowLinkedInButton IS NULL)
	AND ([SiteFavIconID] = @SiteFavIconId OR @SiteFavIconId IS NULL)
	AND ([SiteDocType] = @SiteDocType OR @SiteDocType IS NULL)
	AND ([CurrencySymbol] = @CurrencySymbol OR @CurrencySymbol IS NULL)
	AND ([FtpFolderLocation] = @FtpFolderLocation OR @FtpFolderLocation IS NULL)
	AND ([MetaTags] = @MetaTags OR @MetaTags IS NULL)
	AND ([SystemMetaTags] = @SystemMetaTags OR @SystemMetaTags IS NULL)
	AND ([MemberRegistrationNotification] = @MemberRegistrationNotification OR @MemberRegistrationNotification IS NULL)
	AND ([LinkedInAPI] = @LinkedInApi OR @LinkedInApi IS NULL)
	AND ([LinkedInLogo] = @LinkedInLogo OR @LinkedInLogo IS NULL)
	AND ([LinkedInCompanyID] = @LinkedInCompanyId OR @LinkedInCompanyId IS NULL)
	AND ([LinkedInEmail] = @LinkedInEmail OR @LinkedInEmail IS NULL)
	AND ([PrivacySettings] = @PrivacySettings OR @PrivacySettings IS NULL)
	AND ([WWWRedirect] = @WwwRedirect OR @WwwRedirect IS NULL)
	AND ([AllowAdvertiser] = @AllowAdvertiser OR @AllowAdvertiser IS NULL)
	AND ([LinkedInAPISecret] = @LinkedInApiSecret OR @LinkedInApiSecret IS NULL)
	AND ([GoogleClientID] = @GoogleClientId OR @GoogleClientId IS NULL)
	AND ([GoogleClientSecret] = @GoogleClientSecret OR @GoogleClientSecret IS NULL)
	AND ([FacebookAppID] = @FacebookAppId OR @FacebookAppId IS NULL)
	AND ([FacebookAppSecret] = @FacebookAppSecret OR @FacebookAppSecret IS NULL)
	AND ([LinkedInButtonSize] = @LinkedInButtonSize OR @LinkedInButtonSize IS NULL)
	AND ([DefaultCountryID] = @DefaultCountryId OR @DefaultCountryId IS NULL)
	AND ([PayPalUsername] = @PayPalUsername OR @PayPalUsername IS NULL)
	AND ([PayPalPassword] = @PayPalPassword OR @PayPalPassword IS NULL)
	AND ([PayPalSignature] = @PayPalSignature OR @PayPalSignature IS NULL)
	AND ([SecurePayMerchantID] = @SecurePayMerchantId OR @SecurePayMerchantId IS NULL)
	AND ([SecurePayPassword] = @SecurePayPassword OR @SecurePayPassword IS NULL)
	AND ([UsingSSL] = @UsingSsl OR @UsingSsl IS NULL)
	AND ([UseCustomProfessionRole] = @UseCustomProfessionRole OR @UseCustomProfessionRole IS NULL)
	AND ([GenerateJobXML] = @GenerateJobXml OR @GenerateJobXml IS NULL)
	AND ([IsPrivateSite] = @IsPrivateSite OR @IsPrivateSite IS NULL)
	AND ([PrivateRedirectUrl] = @PrivateRedirectUrl OR @PrivateRedirectUrl IS NULL)
	AND ([EnableJobCustomQuestionnaire] = @EnableJobCustomQuestionnaire OR @EnableJobCustomQuestionnaire IS NULL)
	AND ([JobApplicationTypeID] = @JobApplicationTypeId OR @JobApplicationTypeId IS NULL)
	AND ([JobScreeningProcess] = @JobScreeningProcess OR @JobScreeningProcess IS NULL)
	AND ([AdvertiserApprovalProcess] = @AdvertiserApprovalProcess OR @AdvertiserApprovalProcess IS NULL)
	AND ([SiteType] = @SiteType OR @SiteType IS NULL)
	AND ([EnableSSL] = @EnableSsl OR @EnableSsl IS NULL)
	AND ([GST] = @Gst OR @Gst IS NULL)
	AND ([GSTLabel] = @GstLabel OR @GstLabel IS NULL)
	AND ([NumberOfPremiumJobs] = @NumberOfPremiumJobs OR @NumberOfPremiumJobs IS NULL)
	AND ([PremiumJobDays] = @PremiumJobDays OR @PremiumJobDays IS NULL)
	AND ([DisplayPremiumJobsOnResults] = @DisplayPremiumJobsOnResults OR @DisplayPremiumJobsOnResults IS NULL)
	AND ([JobExpiryNotification] = @JobExpiryNotification OR @JobExpiryNotification IS NULL)
	AND ([CurrencyID] = @CurrencyId OR @CurrencyId IS NULL)
	AND ([PayPalClientID] = @PayPalClientId OR @PayPalClientId IS NULL)
	AND ([PayPalClientSecret] = @PayPalClientSecret OR @PayPalClientSecret IS NULL)
	AND ([PaypalUser] = @PaypalUser OR @PaypalUser IS NULL)
	AND ([PaypalProPassword] = @PaypalProPassword OR @PaypalProPassword IS NULL)
	AND ([PaypalVendor] = @PaypalVendor OR @PaypalVendor IS NULL)
	AND ([PaypalPartner] = @PaypalPartner OR @PaypalPartner IS NULL)
	AND ([InvoiceSiteInfo] = @InvoiceSiteInfo OR @InvoiceSiteInfo IS NULL)
	AND ([InvoiceSiteFooter] = @InvoiceSiteFooter OR @InvoiceSiteFooter IS NULL)
	AND ([EnableTermsAndConditions] = @EnableTermsAndConditions OR @EnableTermsAndConditions IS NULL)
	AND ([DefaultEmailLanguageId] = @DefaultEmailLanguageId OR @DefaultEmailLanguageId IS NULL)
	AND ([GoogleTagManager] = @GoogleTagManager OR @GoogleTagManager IS NULL)
	AND ([GoogleAnalytics] = @GoogleAnalytics OR @GoogleAnalytics IS NULL)
	AND ([GoogleWebMaster] = @GoogleWebMaster OR @GoogleWebMaster IS NULL)
	AND ([EnablePeopleSearch] = @EnablePeopleSearch OR @EnablePeopleSearch IS NULL)
	AND ([GlobalDateFormat] = @GlobalDateFormat OR @GlobalDateFormat IS NULL)
	AND ([TimeZone] = @TimeZone OR @TimeZone IS NULL)
	AND ([EnableScreeningQuestions] = @EnableScreeningQuestions OR @EnableScreeningQuestions IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [GlobalSettingID]
	, [SiteID]
	, [DefaultLanguageID]
	, [DefaultDynamicPageID]
	, [PublicJobsSearch]
	, [PublicMembersSearch]
	, [PublicCompaniesSearch]
	, [PublicSponsoredAdverts]
	, [PrivateJobs]
	, [PrivateMembers]
	, [PrivateCompanies]
	, [LastModifiedBy]
	, [LastModified]
	, [PageTitlePrefix]
	, [PageTitleSuffix]
	, [DefaultTitle]
	, [HomeTitle]
	, [DefaultDescription]
	, [HomeDescription]
	, [DefaultKeywords]
	, [HomeKeywords]
	, [ShowFaceBookButton]
	, [UseAdvertiserFilter]
	, [MerchantID]
	, [ShowTwitterButton]
	, [ShowJobAlertButton]
	, [ShowLinkedInButton]
	, [SiteFavIconID]
	, [SiteDocType]
	, [CurrencySymbol]
	, [FtpFolderLocation]
	, [MetaTags]
	, [SystemMetaTags]
	, [MemberRegistrationNotification]
	, [LinkedInAPI]
	, [LinkedInLogo]
	, [LinkedInCompanyID]
	, [LinkedInEmail]
	, [PrivacySettings]
	, [WWWRedirect]
	, [AllowAdvertiser]
	, [LinkedInAPISecret]
	, [GoogleClientID]
	, [GoogleClientSecret]
	, [FacebookAppID]
	, [FacebookAppSecret]
	, [LinkedInButtonSize]
	, [DefaultCountryID]
	, [PayPalUsername]
	, [PayPalPassword]
	, [PayPalSignature]
	, [SecurePayMerchantID]
	, [SecurePayPassword]
	, [UsingSSL]
	, [UseCustomProfessionRole]
	, [GenerateJobXML]
	, [IsPrivateSite]
	, [PrivateRedirectUrl]
	, [EnableJobCustomQuestionnaire]
	, [JobApplicationTypeID]
	, [JobScreeningProcess]
	, [AdvertiserApprovalProcess]
	, [SiteType]
	, [EnableSSL]
	, [GST]
	, [GSTLabel]
	, [NumberOfPremiumJobs]
	, [PremiumJobDays]
	, [DisplayPremiumJobsOnResults]
	, [JobExpiryNotification]
	, [CurrencyID]
	, [PayPalClientID]
	, [PayPalClientSecret]
	, [PaypalUser]
	, [PaypalProPassword]
	, [PaypalVendor]
	, [PaypalPartner]
	, [InvoiceSiteInfo]
	, [InvoiceSiteFooter]
	, [EnableTermsAndConditions]
	, [DefaultEmailLanguageId]
	, [GoogleTagManager]
	, [GoogleAnalytics]
	, [GoogleWebMaster]
	, [EnablePeopleSearch]
	, [GlobalDateFormat]
	, [TimeZone]
	, [EnableScreeningQuestions]
    FROM
	[dbo].[GlobalSettings]
    WHERE 
	 ([GlobalSettingID] = @GlobalSettingId AND @GlobalSettingId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([DefaultLanguageID] = @DefaultLanguageId AND @DefaultLanguageId is not null)
	OR ([DefaultDynamicPageID] = @DefaultDynamicPageId AND @DefaultDynamicPageId is not null)
	OR ([PublicJobsSearch] = @PublicJobsSearch AND @PublicJobsSearch is not null)
	OR ([PublicMembersSearch] = @PublicMembersSearch AND @PublicMembersSearch is not null)
	OR ([PublicCompaniesSearch] = @PublicCompaniesSearch AND @PublicCompaniesSearch is not null)
	OR ([PublicSponsoredAdverts] = @PublicSponsoredAdverts AND @PublicSponsoredAdverts is not null)
	OR ([PrivateJobs] = @PrivateJobs AND @PrivateJobs is not null)
	OR ([PrivateMembers] = @PrivateMembers AND @PrivateMembers is not null)
	OR ([PrivateCompanies] = @PrivateCompanies AND @PrivateCompanies is not null)
	OR ([LastModifiedBy] = @LastModifiedBy AND @LastModifiedBy is not null)
	OR ([LastModified] = @LastModified AND @LastModified is not null)
	OR ([PageTitlePrefix] = @PageTitlePrefix AND @PageTitlePrefix is not null)
	OR ([PageTitleSuffix] = @PageTitleSuffix AND @PageTitleSuffix is not null)
	OR ([DefaultTitle] = @DefaultTitle AND @DefaultTitle is not null)
	OR ([HomeTitle] = @HomeTitle AND @HomeTitle is not null)
	OR ([DefaultDescription] = @DefaultDescription AND @DefaultDescription is not null)
	OR ([HomeDescription] = @HomeDescription AND @HomeDescription is not null)
	OR ([DefaultKeywords] = @DefaultKeywords AND @DefaultKeywords is not null)
	OR ([HomeKeywords] = @HomeKeywords AND @HomeKeywords is not null)
	OR ([ShowFaceBookButton] = @ShowFaceBookButton AND @ShowFaceBookButton is not null)
	OR ([UseAdvertiserFilter] = @UseAdvertiserFilter AND @UseAdvertiserFilter is not null)
	OR ([MerchantID] = @MerchantId AND @MerchantId is not null)
	OR ([ShowTwitterButton] = @ShowTwitterButton AND @ShowTwitterButton is not null)
	OR ([ShowJobAlertButton] = @ShowJobAlertButton AND @ShowJobAlertButton is not null)
	OR ([ShowLinkedInButton] = @ShowLinkedInButton AND @ShowLinkedInButton is not null)
	OR ([SiteFavIconID] = @SiteFavIconId AND @SiteFavIconId is not null)
	OR ([SiteDocType] = @SiteDocType AND @SiteDocType is not null)
	OR ([CurrencySymbol] = @CurrencySymbol AND @CurrencySymbol is not null)
	OR ([FtpFolderLocation] = @FtpFolderLocation AND @FtpFolderLocation is not null)
	OR ([MetaTags] = @MetaTags AND @MetaTags is not null)
	OR ([SystemMetaTags] = @SystemMetaTags AND @SystemMetaTags is not null)
	OR ([MemberRegistrationNotification] = @MemberRegistrationNotification AND @MemberRegistrationNotification is not null)
	OR ([LinkedInAPI] = @LinkedInApi AND @LinkedInApi is not null)
	OR ([LinkedInLogo] = @LinkedInLogo AND @LinkedInLogo is not null)
	OR ([LinkedInCompanyID] = @LinkedInCompanyId AND @LinkedInCompanyId is not null)
	OR ([LinkedInEmail] = @LinkedInEmail AND @LinkedInEmail is not null)
	OR ([PrivacySettings] = @PrivacySettings AND @PrivacySettings is not null)
	OR ([WWWRedirect] = @WwwRedirect AND @WwwRedirect is not null)
	OR ([AllowAdvertiser] = @AllowAdvertiser AND @AllowAdvertiser is not null)
	OR ([LinkedInAPISecret] = @LinkedInApiSecret AND @LinkedInApiSecret is not null)
	OR ([GoogleClientID] = @GoogleClientId AND @GoogleClientId is not null)
	OR ([GoogleClientSecret] = @GoogleClientSecret AND @GoogleClientSecret is not null)
	OR ([FacebookAppID] = @FacebookAppId AND @FacebookAppId is not null)
	OR ([FacebookAppSecret] = @FacebookAppSecret AND @FacebookAppSecret is not null)
	OR ([LinkedInButtonSize] = @LinkedInButtonSize AND @LinkedInButtonSize is not null)
	OR ([DefaultCountryID] = @DefaultCountryId AND @DefaultCountryId is not null)
	OR ([PayPalUsername] = @PayPalUsername AND @PayPalUsername is not null)
	OR ([PayPalPassword] = @PayPalPassword AND @PayPalPassword is not null)
	OR ([PayPalSignature] = @PayPalSignature AND @PayPalSignature is not null)
	OR ([SecurePayMerchantID] = @SecurePayMerchantId AND @SecurePayMerchantId is not null)
	OR ([SecurePayPassword] = @SecurePayPassword AND @SecurePayPassword is not null)
	OR ([UsingSSL] = @UsingSsl AND @UsingSsl is not null)
	OR ([UseCustomProfessionRole] = @UseCustomProfessionRole AND @UseCustomProfessionRole is not null)
	OR ([GenerateJobXML] = @GenerateJobXml AND @GenerateJobXml is not null)
	OR ([IsPrivateSite] = @IsPrivateSite AND @IsPrivateSite is not null)
	OR ([PrivateRedirectUrl] = @PrivateRedirectUrl AND @PrivateRedirectUrl is not null)
	OR ([EnableJobCustomQuestionnaire] = @EnableJobCustomQuestionnaire AND @EnableJobCustomQuestionnaire is not null)
	OR ([JobApplicationTypeID] = @JobApplicationTypeId AND @JobApplicationTypeId is not null)
	OR ([JobScreeningProcess] = @JobScreeningProcess AND @JobScreeningProcess is not null)
	OR ([AdvertiserApprovalProcess] = @AdvertiserApprovalProcess AND @AdvertiserApprovalProcess is not null)
	OR ([SiteType] = @SiteType AND @SiteType is not null)
	OR ([EnableSSL] = @EnableSsl AND @EnableSsl is not null)
	OR ([GST] = @Gst AND @Gst is not null)
	OR ([GSTLabel] = @GstLabel AND @GstLabel is not null)
	OR ([NumberOfPremiumJobs] = @NumberOfPremiumJobs AND @NumberOfPremiumJobs is not null)
	OR ([PremiumJobDays] = @PremiumJobDays AND @PremiumJobDays is not null)
	OR ([DisplayPremiumJobsOnResults] = @DisplayPremiumJobsOnResults AND @DisplayPremiumJobsOnResults is not null)
	OR ([JobExpiryNotification] = @JobExpiryNotification AND @JobExpiryNotification is not null)
	OR ([CurrencyID] = @CurrencyId AND @CurrencyId is not null)
	OR ([PayPalClientID] = @PayPalClientId AND @PayPalClientId is not null)
	OR ([PayPalClientSecret] = @PayPalClientSecret AND @PayPalClientSecret is not null)
	OR ([PaypalUser] = @PaypalUser AND @PaypalUser is not null)
	OR ([PaypalProPassword] = @PaypalProPassword AND @PaypalProPassword is not null)
	OR ([PaypalVendor] = @PaypalVendor AND @PaypalVendor is not null)
	OR ([PaypalPartner] = @PaypalPartner AND @PaypalPartner is not null)
	OR ([InvoiceSiteInfo] = @InvoiceSiteInfo AND @InvoiceSiteInfo is not null)
	OR ([InvoiceSiteFooter] = @InvoiceSiteFooter AND @InvoiceSiteFooter is not null)
	OR ([EnableTermsAndConditions] = @EnableTermsAndConditions AND @EnableTermsAndConditions is not null)
	OR ([DefaultEmailLanguageId] = @DefaultEmailLanguageId AND @DefaultEmailLanguageId is not null)
	OR ([GoogleTagManager] = @GoogleTagManager AND @GoogleTagManager is not null)
	OR ([GoogleAnalytics] = @GoogleAnalytics AND @GoogleAnalytics is not null)
	OR ([GoogleWebMaster] = @GoogleWebMaster AND @GoogleWebMaster is not null)
	OR ([EnablePeopleSearch] = @EnablePeopleSearch AND @EnablePeopleSearch is not null)
	OR ([GlobalDateFormat] = @GlobalDateFormat AND @GlobalDateFormat is not null)
	OR ([TimeZone] = @TimeZone AND @TimeZone is not null)
	OR ([EnableScreeningQuestions] = @EnableScreeningQuestions AND @EnableScreeningQuestions is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Consultants_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Consultants_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Consultants_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the Consultants table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Consultants_Get_List

AS


				
				SELECT
					[ConsultantID],
					[SiteID],
					[LanguageID],
					[Title],
					[FirstName],
					[Email],
					[Phone],
					[Mobile],
					[PositionTitle],
					[OfficeLocation],
					[Categories],
					[Location],
					[FriendlyURL],
					[ShortDescription],
					[Testimonial],
					[FullDescription],
					[ConsultantData],
					[LinkedInURL],
					[TwitterURL],
					[FacebookURL],
					[GoogleURL],
					[Link],
					[WechatURL],
					[FeaturedTeamMember],
					[ImageURL],
					[VideoURL],
					[BlogRSS],
					[NewsRSS],
					[JobRSS],
					[TestimonialsRSS],
					[Valid],
					[MetaTitle],
					[MetaDescription],
					[MetaKeywords],
					[LastModifiedBy],
					[LastModified],
					[Sequence],
					[LastName],
					[ConsultantsXML],
					[ConsultantImageUrl]
				FROM
					[dbo].[Consultants]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Consultants_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Consultants_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Consultants_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the Consultants table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Consultants_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [ConsultantID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([ConsultantID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [ConsultantID]'
				SET @SQL = @SQL + ' FROM [dbo].[Consultants]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[ConsultantID], O.[SiteID], O.[LanguageID], O.[Title], O.[FirstName], O.[Email], O.[Phone], O.[Mobile], O.[PositionTitle], O.[OfficeLocation], O.[Categories], O.[Location], O.[FriendlyURL], O.[ShortDescription], O.[Testimonial], O.[FullDescription], O.[ConsultantData], O.[LinkedInURL], O.[TwitterURL], O.[FacebookURL], O.[GoogleURL], O.[Link], O.[WechatURL], O.[FeaturedTeamMember], O.[ImageURL], O.[VideoURL], O.[BlogRSS], O.[NewsRSS], O.[JobRSS], O.[TestimonialsRSS], O.[Valid], O.[MetaTitle], O.[MetaDescription], O.[MetaKeywords], O.[LastModifiedBy], O.[LastModified], O.[Sequence], O.[LastName], O.[ConsultantsXML], O.[ConsultantImageUrl]
				FROM
				    [dbo].[Consultants] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[ConsultantID] = PageIndex.[ConsultantID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[Consultants]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Consultants_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Consultants_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Consultants_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the Consultants table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Consultants_Insert
(

	@ConsultantId int    OUTPUT,

	@SiteId int   ,

	@LanguageId int   ,

	@Title nvarchar (128)  ,

	@FirstName nvarchar (512)  ,

	@Email varchar (255)  ,

	@Phone varchar (512)  ,

	@Mobile varchar (512)  ,

	@PositionTitle nvarchar (128)  ,

	@OfficeLocation nvarchar (1024)  ,

	@Categories nvarchar (1024)  ,

	@Location nvarchar (1024)  ,

	@FriendlyUrl varchar (128)  ,

	@ShortDescription nvarchar (MAX)  ,

	@Testimonial nvarchar (MAX)  ,

	@FullDescription nvarchar (MAX)  ,

	@ConsultantData nvarchar (MAX)  ,

	@LinkedInUrl varchar (512)  ,

	@TwitterUrl varchar (512)  ,

	@FacebookUrl varchar (512)  ,

	@GoogleUrl varchar (512)  ,

	@Link varchar (512)  ,

	@WechatUrl varchar (512)  ,

	@FeaturedTeamMember int   ,

	@ImageUrl image   ,

	@VideoUrl varchar (512)  ,

	@BlogRss varchar (512)  ,

	@NewsRss varchar (512)  ,

	@JobRss varchar (512)  ,

	@TestimonialsRss varchar (512)  ,

	@Valid int   ,

	@MetaTitle nvarchar (510)  ,

	@MetaDescription nvarchar (1024)  ,

	@MetaKeywords nvarchar (510)  ,

	@LastModifiedBy int   ,

	@LastModified datetime   ,

	@Sequence int   ,

	@LastName nvarchar (512)  ,

	@ConsultantsXml nvarchar (MAX)  ,

	@ConsultantImageUrl nvarchar (1000)  
)
AS


				
				INSERT INTO [dbo].[Consultants]
					(
					[SiteID]
					,[LanguageID]
					,[Title]
					,[FirstName]
					,[Email]
					,[Phone]
					,[Mobile]
					,[PositionTitle]
					,[OfficeLocation]
					,[Categories]
					,[Location]
					,[FriendlyURL]
					,[ShortDescription]
					,[Testimonial]
					,[FullDescription]
					,[ConsultantData]
					,[LinkedInURL]
					,[TwitterURL]
					,[FacebookURL]
					,[GoogleURL]
					,[Link]
					,[WechatURL]
					,[FeaturedTeamMember]
					,[ImageURL]
					,[VideoURL]
					,[BlogRSS]
					,[NewsRSS]
					,[JobRSS]
					,[TestimonialsRSS]
					,[Valid]
					,[MetaTitle]
					,[MetaDescription]
					,[MetaKeywords]
					,[LastModifiedBy]
					,[LastModified]
					,[Sequence]
					,[LastName]
					,[ConsultantsXML]
					,[ConsultantImageUrl]
					)
				VALUES
					(
					@SiteId
					,@LanguageId
					,@Title
					,@FirstName
					,@Email
					,@Phone
					,@Mobile
					,@PositionTitle
					,@OfficeLocation
					,@Categories
					,@Location
					,@FriendlyUrl
					,@ShortDescription
					,@Testimonial
					,@FullDescription
					,@ConsultantData
					,@LinkedInUrl
					,@TwitterUrl
					,@FacebookUrl
					,@GoogleUrl
					,@Link
					,@WechatUrl
					,@FeaturedTeamMember
					,@ImageUrl
					,@VideoUrl
					,@BlogRss
					,@NewsRss
					,@JobRss
					,@TestimonialsRss
					,@Valid
					,@MetaTitle
					,@MetaDescription
					,@MetaKeywords
					,@LastModifiedBy
					,@LastModified
					,@Sequence
					,@LastName
					,@ConsultantsXml
					,@ConsultantImageUrl
					)
				
				-- Get the identity value
				SET @ConsultantId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Consultants_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Consultants_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Consultants_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the Consultants table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Consultants_Update
(

	@ConsultantId int   ,

	@SiteId int   ,

	@LanguageId int   ,

	@Title nvarchar (128)  ,

	@FirstName nvarchar (512)  ,

	@Email varchar (255)  ,

	@Phone varchar (512)  ,

	@Mobile varchar (512)  ,

	@PositionTitle nvarchar (128)  ,

	@OfficeLocation nvarchar (1024)  ,

	@Categories nvarchar (1024)  ,

	@Location nvarchar (1024)  ,

	@FriendlyUrl varchar (128)  ,

	@ShortDescription nvarchar (MAX)  ,

	@Testimonial nvarchar (MAX)  ,

	@FullDescription nvarchar (MAX)  ,

	@ConsultantData nvarchar (MAX)  ,

	@LinkedInUrl varchar (512)  ,

	@TwitterUrl varchar (512)  ,

	@FacebookUrl varchar (512)  ,

	@GoogleUrl varchar (512)  ,

	@Link varchar (512)  ,

	@WechatUrl varchar (512)  ,

	@FeaturedTeamMember int   ,

	@ImageUrl image   ,

	@VideoUrl varchar (512)  ,

	@BlogRss varchar (512)  ,

	@NewsRss varchar (512)  ,

	@JobRss varchar (512)  ,

	@TestimonialsRss varchar (512)  ,

	@Valid int   ,

	@MetaTitle nvarchar (510)  ,

	@MetaDescription nvarchar (1024)  ,

	@MetaKeywords nvarchar (510)  ,

	@LastModifiedBy int   ,

	@LastModified datetime   ,

	@Sequence int   ,

	@LastName nvarchar (512)  ,

	@ConsultantsXml nvarchar (MAX)  ,

	@ConsultantImageUrl nvarchar (1000)  
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[Consultants]
				SET
					[SiteID] = @SiteId
					,[LanguageID] = @LanguageId
					,[Title] = @Title
					,[FirstName] = @FirstName
					,[Email] = @Email
					,[Phone] = @Phone
					,[Mobile] = @Mobile
					,[PositionTitle] = @PositionTitle
					,[OfficeLocation] = @OfficeLocation
					,[Categories] = @Categories
					,[Location] = @Location
					,[FriendlyURL] = @FriendlyUrl
					,[ShortDescription] = @ShortDescription
					,[Testimonial] = @Testimonial
					,[FullDescription] = @FullDescription
					,[ConsultantData] = @ConsultantData
					,[LinkedInURL] = @LinkedInUrl
					,[TwitterURL] = @TwitterUrl
					,[FacebookURL] = @FacebookUrl
					,[GoogleURL] = @GoogleUrl
					,[Link] = @Link
					,[WechatURL] = @WechatUrl
					,[FeaturedTeamMember] = @FeaturedTeamMember
					,[ImageURL] = @ImageUrl
					,[VideoURL] = @VideoUrl
					,[BlogRSS] = @BlogRss
					,[NewsRSS] = @NewsRss
					,[JobRSS] = @JobRss
					,[TestimonialsRSS] = @TestimonialsRss
					,[Valid] = @Valid
					,[MetaTitle] = @MetaTitle
					,[MetaDescription] = @MetaDescription
					,[MetaKeywords] = @MetaKeywords
					,[LastModifiedBy] = @LastModifiedBy
					,[LastModified] = @LastModified
					,[Sequence] = @Sequence
					,[LastName] = @LastName
					,[ConsultantsXML] = @ConsultantsXml
					,[ConsultantImageUrl] = @ConsultantImageUrl
				WHERE
[ConsultantID] = @ConsultantId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Consultants_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Consultants_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Consultants_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the Consultants table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Consultants_Delete
(

	@ConsultantId int   
)
AS


				DELETE FROM [dbo].[Consultants] WITH (ROWLOCK) 
				WHERE
					[ConsultantID] = @ConsultantId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Consultants_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Consultants_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Consultants_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Consultants table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Consultants_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[ConsultantID],
					[SiteID],
					[LanguageID],
					[Title],
					[FirstName],
					[Email],
					[Phone],
					[Mobile],
					[PositionTitle],
					[OfficeLocation],
					[Categories],
					[Location],
					[FriendlyURL],
					[ShortDescription],
					[Testimonial],
					[FullDescription],
					[ConsultantData],
					[LinkedInURL],
					[TwitterURL],
					[FacebookURL],
					[GoogleURL],
					[Link],
					[WechatURL],
					[FeaturedTeamMember],
					[ImageURL],
					[VideoURL],
					[BlogRSS],
					[NewsRSS],
					[JobRSS],
					[TestimonialsRSS],
					[Valid],
					[MetaTitle],
					[MetaDescription],
					[MetaKeywords],
					[LastModifiedBy],
					[LastModified],
					[Sequence],
					[LastName],
					[ConsultantsXML],
					[ConsultantImageUrl]
				FROM
					[dbo].[Consultants]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Consultants_GetByConsultantId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Consultants_GetByConsultantId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Consultants_GetByConsultantId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Consultants table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Consultants_GetByConsultantId
(

	@ConsultantId int   
)
AS


				SELECT
					[ConsultantID],
					[SiteID],
					[LanguageID],
					[Title],
					[FirstName],
					[Email],
					[Phone],
					[Mobile],
					[PositionTitle],
					[OfficeLocation],
					[Categories],
					[Location],
					[FriendlyURL],
					[ShortDescription],
					[Testimonial],
					[FullDescription],
					[ConsultantData],
					[LinkedInURL],
					[TwitterURL],
					[FacebookURL],
					[GoogleURL],
					[Link],
					[WechatURL],
					[FeaturedTeamMember],
					[ImageURL],
					[VideoURL],
					[BlogRSS],
					[NewsRSS],
					[JobRSS],
					[TestimonialsRSS],
					[Valid],
					[MetaTitle],
					[MetaDescription],
					[MetaKeywords],
					[LastModifiedBy],
					[LastModified],
					[Sequence],
					[LastName],
					[ConsultantsXML],
					[ConsultantImageUrl]
				FROM
					[dbo].[Consultants]
				WHERE
					[ConsultantID] = @ConsultantId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Consultants_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Consultants_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Consultants_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the Consultants table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Consultants_Find
(

	@SearchUsingOR bit   = null ,

	@ConsultantId int   = null ,

	@SiteId int   = null ,

	@LanguageId int   = null ,

	@Title nvarchar (128)  = null ,

	@FirstName nvarchar (512)  = null ,

	@Email varchar (255)  = null ,

	@Phone varchar (512)  = null ,

	@Mobile varchar (512)  = null ,

	@PositionTitle nvarchar (128)  = null ,

	@OfficeLocation nvarchar (1024)  = null ,

	@Categories nvarchar (1024)  = null ,

	@Location nvarchar (1024)  = null ,

	@FriendlyUrl varchar (128)  = null ,

	@ShortDescription nvarchar (MAX)  = null ,

	@Testimonial nvarchar (MAX)  = null ,

	@FullDescription nvarchar (MAX)  = null ,

	@ConsultantData nvarchar (MAX)  = null ,

	@LinkedInUrl varchar (512)  = null ,

	@TwitterUrl varchar (512)  = null ,

	@FacebookUrl varchar (512)  = null ,

	@GoogleUrl varchar (512)  = null ,

	@Link varchar (512)  = null ,

	@WechatUrl varchar (512)  = null ,

	@FeaturedTeamMember int   = null ,

	@ImageUrl image   = null ,

	@VideoUrl varchar (512)  = null ,

	@BlogRss varchar (512)  = null ,

	@NewsRss varchar (512)  = null ,

	@JobRss varchar (512)  = null ,

	@TestimonialsRss varchar (512)  = null ,

	@Valid int   = null ,

	@MetaTitle nvarchar (510)  = null ,

	@MetaDescription nvarchar (1024)  = null ,

	@MetaKeywords nvarchar (510)  = null ,

	@LastModifiedBy int   = null ,

	@LastModified datetime   = null ,

	@Sequence int   = null ,

	@LastName nvarchar (512)  = null ,

	@ConsultantsXml nvarchar (MAX)  = null ,

	@ConsultantImageUrl nvarchar (1000)  = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [ConsultantID]
	, [SiteID]
	, [LanguageID]
	, [Title]
	, [FirstName]
	, [Email]
	, [Phone]
	, [Mobile]
	, [PositionTitle]
	, [OfficeLocation]
	, [Categories]
	, [Location]
	, [FriendlyURL]
	, [ShortDescription]
	, [Testimonial]
	, [FullDescription]
	, [ConsultantData]
	, [LinkedInURL]
	, [TwitterURL]
	, [FacebookURL]
	, [GoogleURL]
	, [Link]
	, [WechatURL]
	, [FeaturedTeamMember]
	, [ImageURL]
	, [VideoURL]
	, [BlogRSS]
	, [NewsRSS]
	, [JobRSS]
	, [TestimonialsRSS]
	, [Valid]
	, [MetaTitle]
	, [MetaDescription]
	, [MetaKeywords]
	, [LastModifiedBy]
	, [LastModified]
	, [Sequence]
	, [LastName]
	, [ConsultantsXML]
	, [ConsultantImageUrl]
    FROM
	[dbo].[Consultants]
    WHERE 
	 ([ConsultantID] = @ConsultantId OR @ConsultantId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([LanguageID] = @LanguageId OR @LanguageId IS NULL)
	AND ([Title] = @Title OR @Title IS NULL)
	AND ([FirstName] = @FirstName OR @FirstName IS NULL)
	AND ([Email] = @Email OR @Email IS NULL)
	AND ([Phone] = @Phone OR @Phone IS NULL)
	AND ([Mobile] = @Mobile OR @Mobile IS NULL)
	AND ([PositionTitle] = @PositionTitle OR @PositionTitle IS NULL)
	AND ([OfficeLocation] = @OfficeLocation OR @OfficeLocation IS NULL)
	AND ([Categories] = @Categories OR @Categories IS NULL)
	AND ([Location] = @Location OR @Location IS NULL)
	AND ([FriendlyURL] = @FriendlyUrl OR @FriendlyUrl IS NULL)
	AND ([ShortDescription] = @ShortDescription OR @ShortDescription IS NULL)
	AND ([Testimonial] = @Testimonial OR @Testimonial IS NULL)
	AND ([FullDescription] = @FullDescription OR @FullDescription IS NULL)
	AND ([ConsultantData] = @ConsultantData OR @ConsultantData IS NULL)
	AND ([LinkedInURL] = @LinkedInUrl OR @LinkedInUrl IS NULL)
	AND ([TwitterURL] = @TwitterUrl OR @TwitterUrl IS NULL)
	AND ([FacebookURL] = @FacebookUrl OR @FacebookUrl IS NULL)
	AND ([GoogleURL] = @GoogleUrl OR @GoogleUrl IS NULL)
	AND ([Link] = @Link OR @Link IS NULL)
	AND ([WechatURL] = @WechatUrl OR @WechatUrl IS NULL)
	AND ([FeaturedTeamMember] = @FeaturedTeamMember OR @FeaturedTeamMember IS NULL)
	AND ([VideoURL] = @VideoUrl OR @VideoUrl IS NULL)
	AND ([BlogRSS] = @BlogRss OR @BlogRss IS NULL)
	AND ([NewsRSS] = @NewsRss OR @NewsRss IS NULL)
	AND ([JobRSS] = @JobRss OR @JobRss IS NULL)
	AND ([TestimonialsRSS] = @TestimonialsRss OR @TestimonialsRss IS NULL)
	AND ([Valid] = @Valid OR @Valid IS NULL)
	AND ([MetaTitle] = @MetaTitle OR @MetaTitle IS NULL)
	AND ([MetaDescription] = @MetaDescription OR @MetaDescription IS NULL)
	AND ([MetaKeywords] = @MetaKeywords OR @MetaKeywords IS NULL)
	AND ([LastModifiedBy] = @LastModifiedBy OR @LastModifiedBy IS NULL)
	AND ([LastModified] = @LastModified OR @LastModified IS NULL)
	AND ([Sequence] = @Sequence OR @Sequence IS NULL)
	AND ([LastName] = @LastName OR @LastName IS NULL)
	AND ([ConsultantsXML] = @ConsultantsXml OR @ConsultantsXml IS NULL)
	AND ([ConsultantImageUrl] = @ConsultantImageUrl OR @ConsultantImageUrl IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [ConsultantID]
	, [SiteID]
	, [LanguageID]
	, [Title]
	, [FirstName]
	, [Email]
	, [Phone]
	, [Mobile]
	, [PositionTitle]
	, [OfficeLocation]
	, [Categories]
	, [Location]
	, [FriendlyURL]
	, [ShortDescription]
	, [Testimonial]
	, [FullDescription]
	, [ConsultantData]
	, [LinkedInURL]
	, [TwitterURL]
	, [FacebookURL]
	, [GoogleURL]
	, [Link]
	, [WechatURL]
	, [FeaturedTeamMember]
	, [ImageURL]
	, [VideoURL]
	, [BlogRSS]
	, [NewsRSS]
	, [JobRSS]
	, [TestimonialsRSS]
	, [Valid]
	, [MetaTitle]
	, [MetaDescription]
	, [MetaKeywords]
	, [LastModifiedBy]
	, [LastModified]
	, [Sequence]
	, [LastName]
	, [ConsultantsXML]
	, [ConsultantImageUrl]
    FROM
	[dbo].[Consultants]
    WHERE 
	 ([ConsultantID] = @ConsultantId AND @ConsultantId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([LanguageID] = @LanguageId AND @LanguageId is not null)
	OR ([Title] = @Title AND @Title is not null)
	OR ([FirstName] = @FirstName AND @FirstName is not null)
	OR ([Email] = @Email AND @Email is not null)
	OR ([Phone] = @Phone AND @Phone is not null)
	OR ([Mobile] = @Mobile AND @Mobile is not null)
	OR ([PositionTitle] = @PositionTitle AND @PositionTitle is not null)
	OR ([OfficeLocation] = @OfficeLocation AND @OfficeLocation is not null)
	OR ([Categories] = @Categories AND @Categories is not null)
	OR ([Location] = @Location AND @Location is not null)
	OR ([FriendlyURL] = @FriendlyUrl AND @FriendlyUrl is not null)
	OR ([ShortDescription] = @ShortDescription AND @ShortDescription is not null)
	OR ([Testimonial] = @Testimonial AND @Testimonial is not null)
	OR ([FullDescription] = @FullDescription AND @FullDescription is not null)
	OR ([ConsultantData] = @ConsultantData AND @ConsultantData is not null)
	OR ([LinkedInURL] = @LinkedInUrl AND @LinkedInUrl is not null)
	OR ([TwitterURL] = @TwitterUrl AND @TwitterUrl is not null)
	OR ([FacebookURL] = @FacebookUrl AND @FacebookUrl is not null)
	OR ([GoogleURL] = @GoogleUrl AND @GoogleUrl is not null)
	OR ([Link] = @Link AND @Link is not null)
	OR ([WechatURL] = @WechatUrl AND @WechatUrl is not null)
	OR ([FeaturedTeamMember] = @FeaturedTeamMember AND @FeaturedTeamMember is not null)
	OR ([VideoURL] = @VideoUrl AND @VideoUrl is not null)
	OR ([BlogRSS] = @BlogRss AND @BlogRss is not null)
	OR ([NewsRSS] = @NewsRss AND @NewsRss is not null)
	OR ([JobRSS] = @JobRss AND @JobRss is not null)
	OR ([TestimonialsRSS] = @TestimonialsRss AND @TestimonialsRss is not null)
	OR ([Valid] = @Valid AND @Valid is not null)
	OR ([MetaTitle] = @MetaTitle AND @MetaTitle is not null)
	OR ([MetaDescription] = @MetaDescription AND @MetaDescription is not null)
	OR ([MetaKeywords] = @MetaKeywords AND @MetaKeywords is not null)
	OR ([LastModifiedBy] = @LastModifiedBy AND @LastModifiedBy is not null)
	OR ([LastModified] = @LastModified AND @LastModified is not null)
	OR ([Sequence] = @Sequence AND @Sequence is not null)
	OR ([LastName] = @LastName AND @LastName is not null)
	OR ([ConsultantsXML] = @ConsultantsXml AND @ConsultantsXml is not null)
	OR ([ConsultantImageUrl] = @ConsultantImageUrl AND @ConsultantImageUrl is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.EmailTemplates_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.EmailTemplates_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.EmailTemplates_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the EmailTemplates table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.EmailTemplates_Get_List

AS


				
				SELECT
					[EmailTemplateID],
					[SiteID],
					[EmailTemplateParentID],
					[EmailCode],
					[EmailDescription],
					[EmailSubject],
					[EmailBodyText],
					[EmailBodyHTML],
					[EmailFields],
					[EmailAddressName],
					[EmailAddressFrom],
					[EmailAddressCC],
					[EmailAddressBCC],
					[GlobalTemplate],
					[LastModifiedBy],
					[LastModified],
					[EmailAddressTo],
					[EmailAddressToName],
					[EmailAddressToMandatory],
					[LanguageID]
				FROM
					[dbo].[EmailTemplates]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.EmailTemplates_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.EmailTemplates_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.EmailTemplates_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the EmailTemplates table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.EmailTemplates_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [EmailTemplateID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([EmailTemplateID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [EmailTemplateID]'
				SET @SQL = @SQL + ' FROM [dbo].[EmailTemplates]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[EmailTemplateID], O.[SiteID], O.[EmailTemplateParentID], O.[EmailCode], O.[EmailDescription], O.[EmailSubject], O.[EmailBodyText], O.[EmailBodyHTML], O.[EmailFields], O.[EmailAddressName], O.[EmailAddressFrom], O.[EmailAddressCC], O.[EmailAddressBCC], O.[GlobalTemplate], O.[LastModifiedBy], O.[LastModified], O.[EmailAddressTo], O.[EmailAddressToName], O.[EmailAddressToMandatory], O.[LanguageID]
				FROM
				    [dbo].[EmailTemplates] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[EmailTemplateID] = PageIndex.[EmailTemplateID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[EmailTemplates]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.EmailTemplates_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.EmailTemplates_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.EmailTemplates_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the EmailTemplates table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.EmailTemplates_Insert
(

	@EmailTemplateId int    OUTPUT,

	@SiteId int   ,

	@EmailTemplateParentId int   ,

	@EmailCode varchar (255)  ,

	@EmailDescription varchar (255)  ,

	@EmailSubject nvarchar (510)  ,

	@EmailBodyText ntext   ,

	@EmailBodyHtml ntext   ,

	@EmailFields ntext   ,

	@EmailAddressName nvarchar (510)  ,

	@EmailAddressFrom varchar (255)  ,

	@EmailAddressCc varchar (512)  ,

	@EmailAddressBcc varchar (512)  ,

	@GlobalTemplate bit   ,

	@LastModifiedBy int   ,

	@LastModified datetime   ,

	@EmailAddressTo varchar (255)  ,

	@EmailAddressToName varchar (510)  ,

	@EmailAddressToMandatory bit   ,

	@LanguageId int   
)
AS


				
				INSERT INTO [dbo].[EmailTemplates]
					(
					[SiteID]
					,[EmailTemplateParentID]
					,[EmailCode]
					,[EmailDescription]
					,[EmailSubject]
					,[EmailBodyText]
					,[EmailBodyHTML]
					,[EmailFields]
					,[EmailAddressName]
					,[EmailAddressFrom]
					,[EmailAddressCC]
					,[EmailAddressBCC]
					,[GlobalTemplate]
					,[LastModifiedBy]
					,[LastModified]
					,[EmailAddressTo]
					,[EmailAddressToName]
					,[EmailAddressToMandatory]
					,[LanguageID]
					)
				VALUES
					(
					@SiteId
					,@EmailTemplateParentId
					,@EmailCode
					,@EmailDescription
					,@EmailSubject
					,@EmailBodyText
					,@EmailBodyHtml
					,@EmailFields
					,@EmailAddressName
					,@EmailAddressFrom
					,@EmailAddressCc
					,@EmailAddressBcc
					,@GlobalTemplate
					,@LastModifiedBy
					,@LastModified
					,@EmailAddressTo
					,@EmailAddressToName
					,@EmailAddressToMandatory
					,@LanguageId
					)
				
				-- Get the identity value
				SET @EmailTemplateId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.EmailTemplates_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.EmailTemplates_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.EmailTemplates_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the EmailTemplates table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.EmailTemplates_Update
(

	@EmailTemplateId int   ,

	@SiteId int   ,

	@EmailTemplateParentId int   ,

	@EmailCode varchar (255)  ,

	@EmailDescription varchar (255)  ,

	@EmailSubject nvarchar (510)  ,

	@EmailBodyText ntext   ,

	@EmailBodyHtml ntext   ,

	@EmailFields ntext   ,

	@EmailAddressName nvarchar (510)  ,

	@EmailAddressFrom varchar (255)  ,

	@EmailAddressCc varchar (512)  ,

	@EmailAddressBcc varchar (512)  ,

	@GlobalTemplate bit   ,

	@LastModifiedBy int   ,

	@LastModified datetime   ,

	@EmailAddressTo varchar (255)  ,

	@EmailAddressToName varchar (510)  ,

	@EmailAddressToMandatory bit   ,

	@LanguageId int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[EmailTemplates]
				SET
					[SiteID] = @SiteId
					,[EmailTemplateParentID] = @EmailTemplateParentId
					,[EmailCode] = @EmailCode
					,[EmailDescription] = @EmailDescription
					,[EmailSubject] = @EmailSubject
					,[EmailBodyText] = @EmailBodyText
					,[EmailBodyHTML] = @EmailBodyHtml
					,[EmailFields] = @EmailFields
					,[EmailAddressName] = @EmailAddressName
					,[EmailAddressFrom] = @EmailAddressFrom
					,[EmailAddressCC] = @EmailAddressCc
					,[EmailAddressBCC] = @EmailAddressBcc
					,[GlobalTemplate] = @GlobalTemplate
					,[LastModifiedBy] = @LastModifiedBy
					,[LastModified] = @LastModified
					,[EmailAddressTo] = @EmailAddressTo
					,[EmailAddressToName] = @EmailAddressToName
					,[EmailAddressToMandatory] = @EmailAddressToMandatory
					,[LanguageID] = @LanguageId
				WHERE
[EmailTemplateID] = @EmailTemplateId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.EmailTemplates_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.EmailTemplates_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.EmailTemplates_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the EmailTemplates table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.EmailTemplates_Delete
(

	@EmailTemplateId int   
)
AS


				DELETE FROM [dbo].[EmailTemplates] WITH (ROWLOCK) 
				WHERE
					[EmailTemplateID] = @EmailTemplateId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.EmailTemplates_GetByLastModifiedBy procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.EmailTemplates_GetByLastModifiedBy') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.EmailTemplates_GetByLastModifiedBy
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the EmailTemplates table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.EmailTemplates_GetByLastModifiedBy
(

	@LastModifiedBy int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[EmailTemplateID],
					[SiteID],
					[EmailTemplateParentID],
					[EmailCode],
					[EmailDescription],
					[EmailSubject],
					[EmailBodyText],
					[EmailBodyHTML],
					[EmailFields],
					[EmailAddressName],
					[EmailAddressFrom],
					[EmailAddressCC],
					[EmailAddressBCC],
					[GlobalTemplate],
					[LastModifiedBy],
					[LastModified],
					[EmailAddressTo],
					[EmailAddressToName],
					[EmailAddressToMandatory],
					[LanguageID]
				FROM
					[dbo].[EmailTemplates]
				WHERE
					[LastModifiedBy] = @LastModifiedBy
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.EmailTemplates_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.EmailTemplates_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.EmailTemplates_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the EmailTemplates table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.EmailTemplates_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[EmailTemplateID],
					[SiteID],
					[EmailTemplateParentID],
					[EmailCode],
					[EmailDescription],
					[EmailSubject],
					[EmailBodyText],
					[EmailBodyHTML],
					[EmailFields],
					[EmailAddressName],
					[EmailAddressFrom],
					[EmailAddressCC],
					[EmailAddressBCC],
					[GlobalTemplate],
					[LastModifiedBy],
					[LastModified],
					[EmailAddressTo],
					[EmailAddressToName],
					[EmailAddressToMandatory],
					[LanguageID]
				FROM
					[dbo].[EmailTemplates]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.EmailTemplates_GetByLanguageId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.EmailTemplates_GetByLanguageId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.EmailTemplates_GetByLanguageId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the EmailTemplates table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.EmailTemplates_GetByLanguageId
(

	@LanguageId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[EmailTemplateID],
					[SiteID],
					[EmailTemplateParentID],
					[EmailCode],
					[EmailDescription],
					[EmailSubject],
					[EmailBodyText],
					[EmailBodyHTML],
					[EmailFields],
					[EmailAddressName],
					[EmailAddressFrom],
					[EmailAddressCC],
					[EmailAddressBCC],
					[GlobalTemplate],
					[LastModifiedBy],
					[LastModified],
					[EmailAddressTo],
					[EmailAddressToName],
					[EmailAddressToMandatory],
					[LanguageID]
				FROM
					[dbo].[EmailTemplates]
				WHERE
					[LanguageID] = @LanguageId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.EmailTemplates_GetBySiteIdEmailCodeGlobalTemplateLanguageId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.EmailTemplates_GetBySiteIdEmailCodeGlobalTemplateLanguageId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.EmailTemplates_GetBySiteIdEmailCodeGlobalTemplateLanguageId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the EmailTemplates table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.EmailTemplates_GetBySiteIdEmailCodeGlobalTemplateLanguageId
(

	@SiteId int   ,

	@EmailCode varchar (255)  ,

	@GlobalTemplate bit   ,

	@LanguageId int   
)
AS


				SELECT
					[EmailTemplateID],
					[SiteID],
					[EmailTemplateParentID],
					[EmailCode],
					[EmailDescription],
					[EmailSubject],
					[EmailBodyText],
					[EmailBodyHTML],
					[EmailFields],
					[EmailAddressName],
					[EmailAddressFrom],
					[EmailAddressCC],
					[EmailAddressBCC],
					[GlobalTemplate],
					[LastModifiedBy],
					[LastModified],
					[EmailAddressTo],
					[EmailAddressToName],
					[EmailAddressToMandatory],
					[LanguageID]
				FROM
					[dbo].[EmailTemplates]
				WHERE
					[SiteID] = @SiteId
					AND [EmailCode] = @EmailCode
					AND [GlobalTemplate] = @GlobalTemplate
					AND [LanguageID] = @LanguageId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.EmailTemplates_GetByEmailTemplateId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.EmailTemplates_GetByEmailTemplateId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.EmailTemplates_GetByEmailTemplateId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the EmailTemplates table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.EmailTemplates_GetByEmailTemplateId
(

	@EmailTemplateId int   
)
AS


				SELECT
					[EmailTemplateID],
					[SiteID],
					[EmailTemplateParentID],
					[EmailCode],
					[EmailDescription],
					[EmailSubject],
					[EmailBodyText],
					[EmailBodyHTML],
					[EmailFields],
					[EmailAddressName],
					[EmailAddressFrom],
					[EmailAddressCC],
					[EmailAddressBCC],
					[GlobalTemplate],
					[LastModifiedBy],
					[LastModified],
					[EmailAddressTo],
					[EmailAddressToName],
					[EmailAddressToMandatory],
					[LanguageID]
				FROM
					[dbo].[EmailTemplates]
				WHERE
					[EmailTemplateID] = @EmailTemplateId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.EmailTemplates_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.EmailTemplates_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.EmailTemplates_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the EmailTemplates table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.EmailTemplates_Find
(

	@SearchUsingOR bit   = null ,

	@EmailTemplateId int   = null ,

	@SiteId int   = null ,

	@EmailTemplateParentId int   = null ,

	@EmailCode varchar (255)  = null ,

	@EmailDescription varchar (255)  = null ,

	@EmailSubject nvarchar (510)  = null ,

	@EmailBodyText ntext   = null ,

	@EmailBodyHtml ntext   = null ,

	@EmailFields ntext   = null ,

	@EmailAddressName nvarchar (510)  = null ,

	@EmailAddressFrom varchar (255)  = null ,

	@EmailAddressCc varchar (512)  = null ,

	@EmailAddressBcc varchar (512)  = null ,

	@GlobalTemplate bit   = null ,

	@LastModifiedBy int   = null ,

	@LastModified datetime   = null ,

	@EmailAddressTo varchar (255)  = null ,

	@EmailAddressToName varchar (510)  = null ,

	@EmailAddressToMandatory bit   = null ,

	@LanguageId int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [EmailTemplateID]
	, [SiteID]
	, [EmailTemplateParentID]
	, [EmailCode]
	, [EmailDescription]
	, [EmailSubject]
	, [EmailBodyText]
	, [EmailBodyHTML]
	, [EmailFields]
	, [EmailAddressName]
	, [EmailAddressFrom]
	, [EmailAddressCC]
	, [EmailAddressBCC]
	, [GlobalTemplate]
	, [LastModifiedBy]
	, [LastModified]
	, [EmailAddressTo]
	, [EmailAddressToName]
	, [EmailAddressToMandatory]
	, [LanguageID]
    FROM
	[dbo].[EmailTemplates]
    WHERE 
	 ([EmailTemplateID] = @EmailTemplateId OR @EmailTemplateId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([EmailTemplateParentID] = @EmailTemplateParentId OR @EmailTemplateParentId IS NULL)
	AND ([EmailCode] = @EmailCode OR @EmailCode IS NULL)
	AND ([EmailDescription] = @EmailDescription OR @EmailDescription IS NULL)
	AND ([EmailSubject] = @EmailSubject OR @EmailSubject IS NULL)
	AND ([EmailAddressName] = @EmailAddressName OR @EmailAddressName IS NULL)
	AND ([EmailAddressFrom] = @EmailAddressFrom OR @EmailAddressFrom IS NULL)
	AND ([EmailAddressCC] = @EmailAddressCc OR @EmailAddressCc IS NULL)
	AND ([EmailAddressBCC] = @EmailAddressBcc OR @EmailAddressBcc IS NULL)
	AND ([GlobalTemplate] = @GlobalTemplate OR @GlobalTemplate IS NULL)
	AND ([LastModifiedBy] = @LastModifiedBy OR @LastModifiedBy IS NULL)
	AND ([LastModified] = @LastModified OR @LastModified IS NULL)
	AND ([EmailAddressTo] = @EmailAddressTo OR @EmailAddressTo IS NULL)
	AND ([EmailAddressToName] = @EmailAddressToName OR @EmailAddressToName IS NULL)
	AND ([EmailAddressToMandatory] = @EmailAddressToMandatory OR @EmailAddressToMandatory IS NULL)
	AND ([LanguageID] = @LanguageId OR @LanguageId IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [EmailTemplateID]
	, [SiteID]
	, [EmailTemplateParentID]
	, [EmailCode]
	, [EmailDescription]
	, [EmailSubject]
	, [EmailBodyText]
	, [EmailBodyHTML]
	, [EmailFields]
	, [EmailAddressName]
	, [EmailAddressFrom]
	, [EmailAddressCC]
	, [EmailAddressBCC]
	, [GlobalTemplate]
	, [LastModifiedBy]
	, [LastModified]
	, [EmailAddressTo]
	, [EmailAddressToName]
	, [EmailAddressToMandatory]
	, [LanguageID]
    FROM
	[dbo].[EmailTemplates]
    WHERE 
	 ([EmailTemplateID] = @EmailTemplateId AND @EmailTemplateId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([EmailTemplateParentID] = @EmailTemplateParentId AND @EmailTemplateParentId is not null)
	OR ([EmailCode] = @EmailCode AND @EmailCode is not null)
	OR ([EmailDescription] = @EmailDescription AND @EmailDescription is not null)
	OR ([EmailSubject] = @EmailSubject AND @EmailSubject is not null)
	OR ([EmailAddressName] = @EmailAddressName AND @EmailAddressName is not null)
	OR ([EmailAddressFrom] = @EmailAddressFrom AND @EmailAddressFrom is not null)
	OR ([EmailAddressCC] = @EmailAddressCc AND @EmailAddressCc is not null)
	OR ([EmailAddressBCC] = @EmailAddressBcc AND @EmailAddressBcc is not null)
	OR ([GlobalTemplate] = @GlobalTemplate AND @GlobalTemplate is not null)
	OR ([LastModifiedBy] = @LastModifiedBy AND @LastModifiedBy is not null)
	OR ([LastModified] = @LastModified AND @LastModified is not null)
	OR ([EmailAddressTo] = @EmailAddressTo AND @EmailAddressTo is not null)
	OR ([EmailAddressToName] = @EmailAddressToName AND @EmailAddressToName is not null)
	OR ([EmailAddressToMandatory] = @EmailAddressToMandatory AND @EmailAddressToMandatory is not null)
	OR ([LanguageID] = @LanguageId AND @LanguageId is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.InvoiceOrder_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.InvoiceOrder_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.InvoiceOrder_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the InvoiceOrder table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.InvoiceOrder_Get_List

AS


				
				SELECT
					[OrderID],
					[AdvertiserUserID],
					[CreatedDate],
					[PaymentTypeID],
					[IsPayable],
					[IsPaid],
					[DatePaid],
					[PaidByAdvertiserUserID],
					[TotalAmount],
					[GST],
					[CurrencyID],
					[DiscountAmount],
					[DiscountGST],
					[responseCode],
					[responseText],
					[bankTransactionID],
					[ResponseXML],
					[Success],
					[CardName],
					[CardNumber],
					[ExpiryMonth],
					[ExpiryYear],
					[CVV]
				FROM
					[dbo].[InvoiceOrder]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.InvoiceOrder_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.InvoiceOrder_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.InvoiceOrder_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the InvoiceOrder table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.InvoiceOrder_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [OrderID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([OrderID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [OrderID]'
				SET @SQL = @SQL + ' FROM [dbo].[InvoiceOrder]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[OrderID], O.[AdvertiserUserID], O.[CreatedDate], O.[PaymentTypeID], O.[IsPayable], O.[IsPaid], O.[DatePaid], O.[PaidByAdvertiserUserID], O.[TotalAmount], O.[GST], O.[CurrencyID], O.[DiscountAmount], O.[DiscountGST], O.[responseCode], O.[responseText], O.[bankTransactionID], O.[ResponseXML], O.[Success], O.[CardName], O.[CardNumber], O.[ExpiryMonth], O.[ExpiryYear], O.[CVV]
				FROM
				    [dbo].[InvoiceOrder] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[OrderID] = PageIndex.[OrderID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[InvoiceOrder]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.InvoiceOrder_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.InvoiceOrder_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.InvoiceOrder_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the InvoiceOrder table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.InvoiceOrder_Insert
(

	@OrderId int    OUTPUT,

	@AdvertiserUserId int   ,

	@CreatedDate datetime   ,

	@PaymentTypeId int   ,

	@IsPayable bit   ,

	@IsPaid bit   ,

	@DatePaid datetime   ,

	@PaidByAdvertiserUserId int   ,

	@TotalAmount decimal (18, 2)  ,

	@Gst decimal (18, 2)  ,

	@CurrencyId int   ,

	@DiscountAmount decimal (18, 2)  ,

	@DiscountGst decimal (18, 2)  ,

	@ResponseCode varchar (255)  ,

	@ResponseText varchar (255)  ,

	@BankTransactionId varchar (255)  ,

	@ResponseXml varchar (MAX)  ,

	@Success int   ,

	@CardName nvarchar (255)  ,

	@CardNumber nvarchar (255)  ,

	@ExpiryMonth int   ,

	@ExpiryYear int   ,

	@Cvv varchar (4)  
)
AS


				
				INSERT INTO [dbo].[InvoiceOrder]
					(
					[AdvertiserUserID]
					,[CreatedDate]
					,[PaymentTypeID]
					,[IsPayable]
					,[IsPaid]
					,[DatePaid]
					,[PaidByAdvertiserUserID]
					,[TotalAmount]
					,[GST]
					,[CurrencyID]
					,[DiscountAmount]
					,[DiscountGST]
					,[responseCode]
					,[responseText]
					,[bankTransactionID]
					,[ResponseXML]
					,[Success]
					,[CardName]
					,[CardNumber]
					,[ExpiryMonth]
					,[ExpiryYear]
					,[CVV]
					)
				VALUES
					(
					@AdvertiserUserId
					,@CreatedDate
					,@PaymentTypeId
					,@IsPayable
					,@IsPaid
					,@DatePaid
					,@PaidByAdvertiserUserId
					,@TotalAmount
					,@Gst
					,@CurrencyId
					,@DiscountAmount
					,@DiscountGst
					,@ResponseCode
					,@ResponseText
					,@BankTransactionId
					,@ResponseXml
					,@Success
					,@CardName
					,@CardNumber
					,@ExpiryMonth
					,@ExpiryYear
					,@Cvv
					)
				
				-- Get the identity value
				SET @OrderId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.InvoiceOrder_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.InvoiceOrder_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.InvoiceOrder_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the InvoiceOrder table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.InvoiceOrder_Update
(

	@OrderId int   ,

	@AdvertiserUserId int   ,

	@CreatedDate datetime   ,

	@PaymentTypeId int   ,

	@IsPayable bit   ,

	@IsPaid bit   ,

	@DatePaid datetime   ,

	@PaidByAdvertiserUserId int   ,

	@TotalAmount decimal (18, 2)  ,

	@Gst decimal (18, 2)  ,

	@CurrencyId int   ,

	@DiscountAmount decimal (18, 2)  ,

	@DiscountGst decimal (18, 2)  ,

	@ResponseCode varchar (255)  ,

	@ResponseText varchar (255)  ,

	@BankTransactionId varchar (255)  ,

	@ResponseXml varchar (MAX)  ,

	@Success int   ,

	@CardName nvarchar (255)  ,

	@CardNumber nvarchar (255)  ,

	@ExpiryMonth int   ,

	@ExpiryYear int   ,

	@Cvv varchar (4)  
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[InvoiceOrder]
				SET
					[AdvertiserUserID] = @AdvertiserUserId
					,[CreatedDate] = @CreatedDate
					,[PaymentTypeID] = @PaymentTypeId
					,[IsPayable] = @IsPayable
					,[IsPaid] = @IsPaid
					,[DatePaid] = @DatePaid
					,[PaidByAdvertiserUserID] = @PaidByAdvertiserUserId
					,[TotalAmount] = @TotalAmount
					,[GST] = @Gst
					,[CurrencyID] = @CurrencyId
					,[DiscountAmount] = @DiscountAmount
					,[DiscountGST] = @DiscountGst
					,[responseCode] = @ResponseCode
					,[responseText] = @ResponseText
					,[bankTransactionID] = @BankTransactionId
					,[ResponseXML] = @ResponseXml
					,[Success] = @Success
					,[CardName] = @CardName
					,[CardNumber] = @CardNumber
					,[ExpiryMonth] = @ExpiryMonth
					,[ExpiryYear] = @ExpiryYear
					,[CVV] = @Cvv
				WHERE
[OrderID] = @OrderId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.InvoiceOrder_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.InvoiceOrder_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.InvoiceOrder_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the InvoiceOrder table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.InvoiceOrder_Delete
(

	@OrderId int   
)
AS


				DELETE FROM [dbo].[InvoiceOrder] WITH (ROWLOCK) 
				WHERE
					[OrderID] = @OrderId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.InvoiceOrder_GetByAdvertiserUserId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.InvoiceOrder_GetByAdvertiserUserId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.InvoiceOrder_GetByAdvertiserUserId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the InvoiceOrder table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.InvoiceOrder_GetByAdvertiserUserId
(

	@AdvertiserUserId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[OrderID],
					[AdvertiserUserID],
					[CreatedDate],
					[PaymentTypeID],
					[IsPayable],
					[IsPaid],
					[DatePaid],
					[PaidByAdvertiserUserID],
					[TotalAmount],
					[GST],
					[CurrencyID],
					[DiscountAmount],
					[DiscountGST],
					[responseCode],
					[responseText],
					[bankTransactionID],
					[ResponseXML],
					[Success],
					[CardName],
					[CardNumber],
					[ExpiryMonth],
					[ExpiryYear],
					[CVV]
				FROM
					[dbo].[InvoiceOrder]
				WHERE
					[AdvertiserUserID] = @AdvertiserUserId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.InvoiceOrder_GetByOrderId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.InvoiceOrder_GetByOrderId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.InvoiceOrder_GetByOrderId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the InvoiceOrder table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.InvoiceOrder_GetByOrderId
(

	@OrderId int   
)
AS


				SELECT
					[OrderID],
					[AdvertiserUserID],
					[CreatedDate],
					[PaymentTypeID],
					[IsPayable],
					[IsPaid],
					[DatePaid],
					[PaidByAdvertiserUserID],
					[TotalAmount],
					[GST],
					[CurrencyID],
					[DiscountAmount],
					[DiscountGST],
					[responseCode],
					[responseText],
					[bankTransactionID],
					[ResponseXML],
					[Success],
					[CardName],
					[CardNumber],
					[ExpiryMonth],
					[ExpiryYear],
					[CVV]
				FROM
					[dbo].[InvoiceOrder]
				WHERE
					[OrderID] = @OrderId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.InvoiceOrder_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.InvoiceOrder_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.InvoiceOrder_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the InvoiceOrder table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.InvoiceOrder_Find
(

	@SearchUsingOR bit   = null ,

	@OrderId int   = null ,

	@AdvertiserUserId int   = null ,

	@CreatedDate datetime   = null ,

	@PaymentTypeId int   = null ,

	@IsPayable bit   = null ,

	@IsPaid bit   = null ,

	@DatePaid datetime   = null ,

	@PaidByAdvertiserUserId int   = null ,

	@TotalAmount decimal (18, 2)  = null ,

	@Gst decimal (18, 2)  = null ,

	@CurrencyId int   = null ,

	@DiscountAmount decimal (18, 2)  = null ,

	@DiscountGst decimal (18, 2)  = null ,

	@ResponseCode varchar (255)  = null ,

	@ResponseText varchar (255)  = null ,

	@BankTransactionId varchar (255)  = null ,

	@ResponseXml varchar (MAX)  = null ,

	@Success int   = null ,

	@CardName nvarchar (255)  = null ,

	@CardNumber nvarchar (255)  = null ,

	@ExpiryMonth int   = null ,

	@ExpiryYear int   = null ,

	@Cvv varchar (4)  = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [OrderID]
	, [AdvertiserUserID]
	, [CreatedDate]
	, [PaymentTypeID]
	, [IsPayable]
	, [IsPaid]
	, [DatePaid]
	, [PaidByAdvertiserUserID]
	, [TotalAmount]
	, [GST]
	, [CurrencyID]
	, [DiscountAmount]
	, [DiscountGST]
	, [responseCode]
	, [responseText]
	, [bankTransactionID]
	, [ResponseXML]
	, [Success]
	, [CardName]
	, [CardNumber]
	, [ExpiryMonth]
	, [ExpiryYear]
	, [CVV]
    FROM
	[dbo].[InvoiceOrder]
    WHERE 
	 ([OrderID] = @OrderId OR @OrderId IS NULL)
	AND ([AdvertiserUserID] = @AdvertiserUserId OR @AdvertiserUserId IS NULL)
	AND ([CreatedDate] = @CreatedDate OR @CreatedDate IS NULL)
	AND ([PaymentTypeID] = @PaymentTypeId OR @PaymentTypeId IS NULL)
	AND ([IsPayable] = @IsPayable OR @IsPayable IS NULL)
	AND ([IsPaid] = @IsPaid OR @IsPaid IS NULL)
	AND ([DatePaid] = @DatePaid OR @DatePaid IS NULL)
	AND ([PaidByAdvertiserUserID] = @PaidByAdvertiserUserId OR @PaidByAdvertiserUserId IS NULL)
	AND ([TotalAmount] = @TotalAmount OR @TotalAmount IS NULL)
	AND ([GST] = @Gst OR @Gst IS NULL)
	AND ([CurrencyID] = @CurrencyId OR @CurrencyId IS NULL)
	AND ([DiscountAmount] = @DiscountAmount OR @DiscountAmount IS NULL)
	AND ([DiscountGST] = @DiscountGst OR @DiscountGst IS NULL)
	AND ([responseCode] = @ResponseCode OR @ResponseCode IS NULL)
	AND ([responseText] = @ResponseText OR @ResponseText IS NULL)
	AND ([bankTransactionID] = @BankTransactionId OR @BankTransactionId IS NULL)
	AND ([ResponseXML] = @ResponseXml OR @ResponseXml IS NULL)
	AND ([Success] = @Success OR @Success IS NULL)
	AND ([CardName] = @CardName OR @CardName IS NULL)
	AND ([CardNumber] = @CardNumber OR @CardNumber IS NULL)
	AND ([ExpiryMonth] = @ExpiryMonth OR @ExpiryMonth IS NULL)
	AND ([ExpiryYear] = @ExpiryYear OR @ExpiryYear IS NULL)
	AND ([CVV] = @Cvv OR @Cvv IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [OrderID]
	, [AdvertiserUserID]
	, [CreatedDate]
	, [PaymentTypeID]
	, [IsPayable]
	, [IsPaid]
	, [DatePaid]
	, [PaidByAdvertiserUserID]
	, [TotalAmount]
	, [GST]
	, [CurrencyID]
	, [DiscountAmount]
	, [DiscountGST]
	, [responseCode]
	, [responseText]
	, [bankTransactionID]
	, [ResponseXML]
	, [Success]
	, [CardName]
	, [CardNumber]
	, [ExpiryMonth]
	, [ExpiryYear]
	, [CVV]
    FROM
	[dbo].[InvoiceOrder]
    WHERE 
	 ([OrderID] = @OrderId AND @OrderId is not null)
	OR ([AdvertiserUserID] = @AdvertiserUserId AND @AdvertiserUserId is not null)
	OR ([CreatedDate] = @CreatedDate AND @CreatedDate is not null)
	OR ([PaymentTypeID] = @PaymentTypeId AND @PaymentTypeId is not null)
	OR ([IsPayable] = @IsPayable AND @IsPayable is not null)
	OR ([IsPaid] = @IsPaid AND @IsPaid is not null)
	OR ([DatePaid] = @DatePaid AND @DatePaid is not null)
	OR ([PaidByAdvertiserUserID] = @PaidByAdvertiserUserId AND @PaidByAdvertiserUserId is not null)
	OR ([TotalAmount] = @TotalAmount AND @TotalAmount is not null)
	OR ([GST] = @Gst AND @Gst is not null)
	OR ([CurrencyID] = @CurrencyId AND @CurrencyId is not null)
	OR ([DiscountAmount] = @DiscountAmount AND @DiscountAmount is not null)
	OR ([DiscountGST] = @DiscountGst AND @DiscountGst is not null)
	OR ([responseCode] = @ResponseCode AND @ResponseCode is not null)
	OR ([responseText] = @ResponseText AND @ResponseText is not null)
	OR ([bankTransactionID] = @BankTransactionId AND @BankTransactionId is not null)
	OR ([ResponseXML] = @ResponseXml AND @ResponseXml is not null)
	OR ([Success] = @Success AND @Success is not null)
	OR ([CardName] = @CardName AND @CardName is not null)
	OR ([CardNumber] = @CardNumber AND @CardNumber is not null)
	OR ([ExpiryMonth] = @ExpiryMonth AND @ExpiryMonth is not null)
	OR ([ExpiryYear] = @ExpiryYear AND @ExpiryYear is not null)
	OR ([CVV] = @Cvv AND @Cvv is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserUsers_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserUsers_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserUsers_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the AdvertiserUsers table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserUsers_Get_List

AS


				
				SELECT
					[AdvertiserUserID],
					[AdvertiserID],
					[PrimaryAccount],
					[UserName],
					[UserPassword],
					[FirstName],
					[Surname],
					[Email],
					[ApplicationEmailAddress],
					[Phone],
					[Fax],
					[AccountStatus],
					[Newsletter],
					[NewsletterFormat],
					[EmailFormat],
					[Validated],
					[ValidateGUID],
					[Description],
					[LastLoginDate],
					[LastModified],
					[LastModifiedBy],
					[JobExpiryNotification],
					[LoginAttempts],
					[LastAttemptDate],
					[Status],
					[LastTermsAndConditionsDate],
					[DefaultLanguageId],
					[ExternalAdvertiserUserID]
				FROM
					[dbo].[AdvertiserUsers]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserUsers_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserUsers_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserUsers_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the AdvertiserUsers table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserUsers_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [AdvertiserUserID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([AdvertiserUserID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [AdvertiserUserID]'
				SET @SQL = @SQL + ' FROM [dbo].[AdvertiserUsers]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[AdvertiserUserID], O.[AdvertiserID], O.[PrimaryAccount], O.[UserName], O.[UserPassword], O.[FirstName], O.[Surname], O.[Email], O.[ApplicationEmailAddress], O.[Phone], O.[Fax], O.[AccountStatus], O.[Newsletter], O.[NewsletterFormat], O.[EmailFormat], O.[Validated], O.[ValidateGUID], O.[Description], O.[LastLoginDate], O.[LastModified], O.[LastModifiedBy], O.[JobExpiryNotification], O.[LoginAttempts], O.[LastAttemptDate], O.[Status], O.[LastTermsAndConditionsDate], O.[DefaultLanguageId], O.[ExternalAdvertiserUserID]
				FROM
				    [dbo].[AdvertiserUsers] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[AdvertiserUserID] = PageIndex.[AdvertiserUserID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[AdvertiserUsers]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserUsers_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserUsers_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserUsers_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the AdvertiserUsers table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserUsers_Insert
(

	@AdvertiserUserId int    OUTPUT,

	@AdvertiserId int   ,

	@PrimaryAccount bit   ,

	@UserName varchar (255)  ,

	@UserPassword varchar (255)  ,

	@FirstName nvarchar (1000)  ,

	@Surname nvarchar (1000)  ,

	@Email varchar (255)  ,

	@ApplicationEmailAddress varchar (255)  ,

	@Phone char (40)  ,

	@Fax char (40)  ,

	@AccountStatus int   ,

	@Newsletter bit   ,

	@NewsletterFormat int   ,

	@EmailFormat int   ,

	@Validated bit   ,

	@ValidateGuid uniqueidentifier   ,

	@Description ntext   ,

	@LastLoginDate datetime   ,

	@LastModified datetime   ,

	@LastModifiedBy int   ,

	@JobExpiryNotification bit   ,

	@LoginAttempts int   ,

	@LastAttemptDate datetime   ,

	@Status int   ,

	@LastTermsAndConditionsDate datetime   ,

	@DefaultLanguageId int   ,

	@ExternalAdvertiserUserId varchar (50)  
)
AS


				
				INSERT INTO [dbo].[AdvertiserUsers]
					(
					[AdvertiserID]
					,[PrimaryAccount]
					,[UserName]
					,[UserPassword]
					,[FirstName]
					,[Surname]
					,[Email]
					,[ApplicationEmailAddress]
					,[Phone]
					,[Fax]
					,[AccountStatus]
					,[Newsletter]
					,[NewsletterFormat]
					,[EmailFormat]
					,[Validated]
					,[ValidateGUID]
					,[Description]
					,[LastLoginDate]
					,[LastModified]
					,[LastModifiedBy]
					,[JobExpiryNotification]
					,[LoginAttempts]
					,[LastAttemptDate]
					,[Status]
					,[LastTermsAndConditionsDate]
					,[DefaultLanguageId]
					,[ExternalAdvertiserUserID]
					)
				VALUES
					(
					@AdvertiserId
					,@PrimaryAccount
					,@UserName
					,@UserPassword
					,@FirstName
					,@Surname
					,@Email
					,@ApplicationEmailAddress
					,@Phone
					,@Fax
					,@AccountStatus
					,@Newsletter
					,@NewsletterFormat
					,@EmailFormat
					,@Validated
					,@ValidateGuid
					,@Description
					,@LastLoginDate
					,@LastModified
					,@LastModifiedBy
					,@JobExpiryNotification
					,@LoginAttempts
					,@LastAttemptDate
					,@Status
					,@LastTermsAndConditionsDate
					,@DefaultLanguageId
					,@ExternalAdvertiserUserId
					)
				
				-- Get the identity value
				SET @AdvertiserUserId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserUsers_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserUsers_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserUsers_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the AdvertiserUsers table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserUsers_Update
(

	@AdvertiserUserId int   ,

	@AdvertiserId int   ,

	@PrimaryAccount bit   ,

	@UserName varchar (255)  ,

	@UserPassword varchar (255)  ,

	@FirstName nvarchar (1000)  ,

	@Surname nvarchar (1000)  ,

	@Email varchar (255)  ,

	@ApplicationEmailAddress varchar (255)  ,

	@Phone char (40)  ,

	@Fax char (40)  ,

	@AccountStatus int   ,

	@Newsletter bit   ,

	@NewsletterFormat int   ,

	@EmailFormat int   ,

	@Validated bit   ,

	@ValidateGuid uniqueidentifier   ,

	@Description ntext   ,

	@LastLoginDate datetime   ,

	@LastModified datetime   ,

	@LastModifiedBy int   ,

	@JobExpiryNotification bit   ,

	@LoginAttempts int   ,

	@LastAttemptDate datetime   ,

	@Status int   ,

	@LastTermsAndConditionsDate datetime   ,

	@DefaultLanguageId int   ,

	@ExternalAdvertiserUserId varchar (50)  
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[AdvertiserUsers]
				SET
					[AdvertiserID] = @AdvertiserId
					,[PrimaryAccount] = @PrimaryAccount
					,[UserName] = @UserName
					,[UserPassword] = @UserPassword
					,[FirstName] = @FirstName
					,[Surname] = @Surname
					,[Email] = @Email
					,[ApplicationEmailAddress] = @ApplicationEmailAddress
					,[Phone] = @Phone
					,[Fax] = @Fax
					,[AccountStatus] = @AccountStatus
					,[Newsletter] = @Newsletter
					,[NewsletterFormat] = @NewsletterFormat
					,[EmailFormat] = @EmailFormat
					,[Validated] = @Validated
					,[ValidateGUID] = @ValidateGuid
					,[Description] = @Description
					,[LastLoginDate] = @LastLoginDate
					,[LastModified] = @LastModified
					,[LastModifiedBy] = @LastModifiedBy
					,[JobExpiryNotification] = @JobExpiryNotification
					,[LoginAttempts] = @LoginAttempts
					,[LastAttemptDate] = @LastAttemptDate
					,[Status] = @Status
					,[LastTermsAndConditionsDate] = @LastTermsAndConditionsDate
					,[DefaultLanguageId] = @DefaultLanguageId
					,[ExternalAdvertiserUserID] = @ExternalAdvertiserUserId
				WHERE
[AdvertiserUserID] = @AdvertiserUserId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserUsers_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserUsers_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserUsers_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the AdvertiserUsers table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserUsers_Delete
(

	@AdvertiserUserId int   
)
AS


				DELETE FROM [dbo].[AdvertiserUsers] WITH (ROWLOCK) 
				WHERE
					[AdvertiserUserID] = @AdvertiserUserId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserUsers_GetByAdvertiserId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserUsers_GetByAdvertiserId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserUsers_GetByAdvertiserId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the AdvertiserUsers table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserUsers_GetByAdvertiserId
(

	@AdvertiserId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[AdvertiserUserID],
					[AdvertiserID],
					[PrimaryAccount],
					[UserName],
					[UserPassword],
					[FirstName],
					[Surname],
					[Email],
					[ApplicationEmailAddress],
					[Phone],
					[Fax],
					[AccountStatus],
					[Newsletter],
					[NewsletterFormat],
					[EmailFormat],
					[Validated],
					[ValidateGUID],
					[Description],
					[LastLoginDate],
					[LastModified],
					[LastModifiedBy],
					[JobExpiryNotification],
					[LoginAttempts],
					[LastAttemptDate],
					[Status],
					[LastTermsAndConditionsDate],
					[DefaultLanguageId],
					[ExternalAdvertiserUserID]
				FROM
					[dbo].[AdvertiserUsers]
				WHERE
					[AdvertiserID] = @AdvertiserId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserUsers_GetByEmailFormat procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserUsers_GetByEmailFormat') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserUsers_GetByEmailFormat
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the AdvertiserUsers table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserUsers_GetByEmailFormat
(

	@EmailFormat int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[AdvertiserUserID],
					[AdvertiserID],
					[PrimaryAccount],
					[UserName],
					[UserPassword],
					[FirstName],
					[Surname],
					[Email],
					[ApplicationEmailAddress],
					[Phone],
					[Fax],
					[AccountStatus],
					[Newsletter],
					[NewsletterFormat],
					[EmailFormat],
					[Validated],
					[ValidateGUID],
					[Description],
					[LastLoginDate],
					[LastModified],
					[LastModifiedBy],
					[JobExpiryNotification],
					[LoginAttempts],
					[LastAttemptDate],
					[Status],
					[LastTermsAndConditionsDate],
					[DefaultLanguageId],
					[ExternalAdvertiserUserID]
				FROM
					[dbo].[AdvertiserUsers]
				WHERE
					[EmailFormat] = @EmailFormat
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserUsers_GetByLastModifiedBy procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserUsers_GetByLastModifiedBy') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserUsers_GetByLastModifiedBy
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the AdvertiserUsers table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserUsers_GetByLastModifiedBy
(

	@LastModifiedBy int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[AdvertiserUserID],
					[AdvertiserID],
					[PrimaryAccount],
					[UserName],
					[UserPassword],
					[FirstName],
					[Surname],
					[Email],
					[ApplicationEmailAddress],
					[Phone],
					[Fax],
					[AccountStatus],
					[Newsletter],
					[NewsletterFormat],
					[EmailFormat],
					[Validated],
					[ValidateGUID],
					[Description],
					[LastLoginDate],
					[LastModified],
					[LastModifiedBy],
					[JobExpiryNotification],
					[LoginAttempts],
					[LastAttemptDate],
					[Status],
					[LastTermsAndConditionsDate],
					[DefaultLanguageId],
					[ExternalAdvertiserUserID]
				FROM
					[dbo].[AdvertiserUsers]
				WHERE
					[LastModifiedBy] = @LastModifiedBy
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserUsers_GetByNewsletterFormat procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserUsers_GetByNewsletterFormat') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserUsers_GetByNewsletterFormat
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the AdvertiserUsers table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserUsers_GetByNewsletterFormat
(

	@NewsletterFormat int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[AdvertiserUserID],
					[AdvertiserID],
					[PrimaryAccount],
					[UserName],
					[UserPassword],
					[FirstName],
					[Surname],
					[Email],
					[ApplicationEmailAddress],
					[Phone],
					[Fax],
					[AccountStatus],
					[Newsletter],
					[NewsletterFormat],
					[EmailFormat],
					[Validated],
					[ValidateGUID],
					[Description],
					[LastLoginDate],
					[LastModified],
					[LastModifiedBy],
					[JobExpiryNotification],
					[LoginAttempts],
					[LastAttemptDate],
					[Status],
					[LastTermsAndConditionsDate],
					[DefaultLanguageId],
					[ExternalAdvertiserUserID]
				FROM
					[dbo].[AdvertiserUsers]
				WHERE
					[NewsletterFormat] = @NewsletterFormat
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserUsers_GetByUserNameAdvertiserId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserUsers_GetByUserNameAdvertiserId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserUsers_GetByUserNameAdvertiserId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the AdvertiserUsers table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserUsers_GetByUserNameAdvertiserId
(

	@UserName varchar (255)  ,

	@AdvertiserId int   
)
AS


				SELECT
					[AdvertiserUserID],
					[AdvertiserID],
					[PrimaryAccount],
					[UserName],
					[UserPassword],
					[FirstName],
					[Surname],
					[Email],
					[ApplicationEmailAddress],
					[Phone],
					[Fax],
					[AccountStatus],
					[Newsletter],
					[NewsletterFormat],
					[EmailFormat],
					[Validated],
					[ValidateGUID],
					[Description],
					[LastLoginDate],
					[LastModified],
					[LastModifiedBy],
					[JobExpiryNotification],
					[LoginAttempts],
					[LastAttemptDate],
					[Status],
					[LastTermsAndConditionsDate],
					[DefaultLanguageId],
					[ExternalAdvertiserUserID]
				FROM
					[dbo].[AdvertiserUsers]
				WHERE
					[UserName] = @UserName
					AND [AdvertiserID] = @AdvertiserId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserUsers_GetByAdvertiserUserId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserUsers_GetByAdvertiserUserId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserUsers_GetByAdvertiserUserId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the AdvertiserUsers table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserUsers_GetByAdvertiserUserId
(

	@AdvertiserUserId int   
)
AS


				SELECT
					[AdvertiserUserID],
					[AdvertiserID],
					[PrimaryAccount],
					[UserName],
					[UserPassword],
					[FirstName],
					[Surname],
					[Email],
					[ApplicationEmailAddress],
					[Phone],
					[Fax],
					[AccountStatus],
					[Newsletter],
					[NewsletterFormat],
					[EmailFormat],
					[Validated],
					[ValidateGUID],
					[Description],
					[LastLoginDate],
					[LastModified],
					[LastModifiedBy],
					[JobExpiryNotification],
					[LoginAttempts],
					[LastAttemptDate],
					[Status],
					[LastTermsAndConditionsDate],
					[DefaultLanguageId],
					[ExternalAdvertiserUserID]
				FROM
					[dbo].[AdvertiserUsers]
				WHERE
					[AdvertiserUserID] = @AdvertiserUserId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AdvertiserUsers_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AdvertiserUsers_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AdvertiserUsers_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the AdvertiserUsers table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AdvertiserUsers_Find
(

	@SearchUsingOR bit   = null ,

	@AdvertiserUserId int   = null ,

	@AdvertiserId int   = null ,

	@PrimaryAccount bit   = null ,

	@UserName varchar (255)  = null ,

	@UserPassword varchar (255)  = null ,

	@FirstName nvarchar (1000)  = null ,

	@Surname nvarchar (1000)  = null ,

	@Email varchar (255)  = null ,

	@ApplicationEmailAddress varchar (255)  = null ,

	@Phone char (40)  = null ,

	@Fax char (40)  = null ,

	@AccountStatus int   = null ,

	@Newsletter bit   = null ,

	@NewsletterFormat int   = null ,

	@EmailFormat int   = null ,

	@Validated bit   = null ,

	@ValidateGuid uniqueidentifier   = null ,

	@Description ntext   = null ,

	@LastLoginDate datetime   = null ,

	@LastModified datetime   = null ,

	@LastModifiedBy int   = null ,

	@JobExpiryNotification bit   = null ,

	@LoginAttempts int   = null ,

	@LastAttemptDate datetime   = null ,

	@Status int   = null ,

	@LastTermsAndConditionsDate datetime   = null ,

	@DefaultLanguageId int   = null ,

	@ExternalAdvertiserUserId varchar (50)  = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [AdvertiserUserID]
	, [AdvertiserID]
	, [PrimaryAccount]
	, [UserName]
	, [UserPassword]
	, [FirstName]
	, [Surname]
	, [Email]
	, [ApplicationEmailAddress]
	, [Phone]
	, [Fax]
	, [AccountStatus]
	, [Newsletter]
	, [NewsletterFormat]
	, [EmailFormat]
	, [Validated]
	, [ValidateGUID]
	, [Description]
	, [LastLoginDate]
	, [LastModified]
	, [LastModifiedBy]
	, [JobExpiryNotification]
	, [LoginAttempts]
	, [LastAttemptDate]
	, [Status]
	, [LastTermsAndConditionsDate]
	, [DefaultLanguageId]
	, [ExternalAdvertiserUserID]
    FROM
	[dbo].[AdvertiserUsers]
    WHERE 
	 ([AdvertiserUserID] = @AdvertiserUserId OR @AdvertiserUserId IS NULL)
	AND ([AdvertiserID] = @AdvertiserId OR @AdvertiserId IS NULL)
	AND ([PrimaryAccount] = @PrimaryAccount OR @PrimaryAccount IS NULL)
	AND ([UserName] = @UserName OR @UserName IS NULL)
	AND ([UserPassword] = @UserPassword OR @UserPassword IS NULL)
	AND ([FirstName] = @FirstName OR @FirstName IS NULL)
	AND ([Surname] = @Surname OR @Surname IS NULL)
	AND ([Email] = @Email OR @Email IS NULL)
	AND ([ApplicationEmailAddress] = @ApplicationEmailAddress OR @ApplicationEmailAddress IS NULL)
	AND ([Phone] = @Phone OR @Phone IS NULL)
	AND ([Fax] = @Fax OR @Fax IS NULL)
	AND ([AccountStatus] = @AccountStatus OR @AccountStatus IS NULL)
	AND ([Newsletter] = @Newsletter OR @Newsletter IS NULL)
	AND ([NewsletterFormat] = @NewsletterFormat OR @NewsletterFormat IS NULL)
	AND ([EmailFormat] = @EmailFormat OR @EmailFormat IS NULL)
	AND ([Validated] = @Validated OR @Validated IS NULL)
	AND ([ValidateGUID] = @ValidateGuid OR @ValidateGuid IS NULL)
	AND ([LastLoginDate] = @LastLoginDate OR @LastLoginDate IS NULL)
	AND ([LastModified] = @LastModified OR @LastModified IS NULL)
	AND ([LastModifiedBy] = @LastModifiedBy OR @LastModifiedBy IS NULL)
	AND ([JobExpiryNotification] = @JobExpiryNotification OR @JobExpiryNotification IS NULL)
	AND ([LoginAttempts] = @LoginAttempts OR @LoginAttempts IS NULL)
	AND ([LastAttemptDate] = @LastAttemptDate OR @LastAttemptDate IS NULL)
	AND ([Status] = @Status OR @Status IS NULL)
	AND ([LastTermsAndConditionsDate] = @LastTermsAndConditionsDate OR @LastTermsAndConditionsDate IS NULL)
	AND ([DefaultLanguageId] = @DefaultLanguageId OR @DefaultLanguageId IS NULL)
	AND ([ExternalAdvertiserUserID] = @ExternalAdvertiserUserId OR @ExternalAdvertiserUserId IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [AdvertiserUserID]
	, [AdvertiserID]
	, [PrimaryAccount]
	, [UserName]
	, [UserPassword]
	, [FirstName]
	, [Surname]
	, [Email]
	, [ApplicationEmailAddress]
	, [Phone]
	, [Fax]
	, [AccountStatus]
	, [Newsletter]
	, [NewsletterFormat]
	, [EmailFormat]
	, [Validated]
	, [ValidateGUID]
	, [Description]
	, [LastLoginDate]
	, [LastModified]
	, [LastModifiedBy]
	, [JobExpiryNotification]
	, [LoginAttempts]
	, [LastAttemptDate]
	, [Status]
	, [LastTermsAndConditionsDate]
	, [DefaultLanguageId]
	, [ExternalAdvertiserUserID]
    FROM
	[dbo].[AdvertiserUsers]
    WHERE 
	 ([AdvertiserUserID] = @AdvertiserUserId AND @AdvertiserUserId is not null)
	OR ([AdvertiserID] = @AdvertiserId AND @AdvertiserId is not null)
	OR ([PrimaryAccount] = @PrimaryAccount AND @PrimaryAccount is not null)
	OR ([UserName] = @UserName AND @UserName is not null)
	OR ([UserPassword] = @UserPassword AND @UserPassword is not null)
	OR ([FirstName] = @FirstName AND @FirstName is not null)
	OR ([Surname] = @Surname AND @Surname is not null)
	OR ([Email] = @Email AND @Email is not null)
	OR ([ApplicationEmailAddress] = @ApplicationEmailAddress AND @ApplicationEmailAddress is not null)
	OR ([Phone] = @Phone AND @Phone is not null)
	OR ([Fax] = @Fax AND @Fax is not null)
	OR ([AccountStatus] = @AccountStatus AND @AccountStatus is not null)
	OR ([Newsletter] = @Newsletter AND @Newsletter is not null)
	OR ([NewsletterFormat] = @NewsletterFormat AND @NewsletterFormat is not null)
	OR ([EmailFormat] = @EmailFormat AND @EmailFormat is not null)
	OR ([Validated] = @Validated AND @Validated is not null)
	OR ([ValidateGUID] = @ValidateGuid AND @ValidateGuid is not null)
	OR ([LastLoginDate] = @LastLoginDate AND @LastLoginDate is not null)
	OR ([LastModified] = @LastModified AND @LastModified is not null)
	OR ([LastModifiedBy] = @LastModifiedBy AND @LastModifiedBy is not null)
	OR ([JobExpiryNotification] = @JobExpiryNotification AND @JobExpiryNotification is not null)
	OR ([LoginAttempts] = @LoginAttempts AND @LoginAttempts is not null)
	OR ([LastAttemptDate] = @LastAttemptDate AND @LastAttemptDate is not null)
	OR ([Status] = @Status AND @Status is not null)
	OR ([LastTermsAndConditionsDate] = @LastTermsAndConditionsDate AND @LastTermsAndConditionsDate is not null)
	OR ([DefaultLanguageId] = @DefaultLanguageId AND @DefaultLanguageId is not null)
	OR ([ExternalAdvertiserUserID] = @ExternalAdvertiserUserId AND @ExternalAdvertiserUserId is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.CustomWidget_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.CustomWidget_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.CustomWidget_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the CustomWidget table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.CustomWidget_Get_List

AS


				
				SELECT
					[CustomWidgetID],
					[SiteID],
					[CustomWidgetCSSSelectorID],
					[CustomWidgetName],
					[Content],
					[DateCreated],
					[ModifiedDate],
					[ModifiedBy],
					[Active],
					[SourceID]
				FROM
					[dbo].[CustomWidget]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.CustomWidget_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.CustomWidget_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.CustomWidget_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the CustomWidget table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.CustomWidget_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [CustomWidgetID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([CustomWidgetID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [CustomWidgetID]'
				SET @SQL = @SQL + ' FROM [dbo].[CustomWidget]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[CustomWidgetID], O.[SiteID], O.[CustomWidgetCSSSelectorID], O.[CustomWidgetName], O.[Content], O.[DateCreated], O.[ModifiedDate], O.[ModifiedBy], O.[Active], O.[SourceID]
				FROM
				    [dbo].[CustomWidget] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[CustomWidgetID] = PageIndex.[CustomWidgetID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[CustomWidget]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.CustomWidget_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.CustomWidget_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.CustomWidget_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the CustomWidget table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.CustomWidget_Insert
(

	@CustomWidgetId int    OUTPUT,

	@SiteId int   ,

	@CustomWidgetCssSelectorId int   ,

	@CustomWidgetName varchar (255)  ,

	@Content ntext   ,

	@DateCreated datetime   ,

	@ModifiedDate datetime   ,

	@ModifiedBy int   ,

	@Active bit   ,

	@SourceId int   
)
AS


				
				INSERT INTO [dbo].[CustomWidget]
					(
					[SiteID]
					,[CustomWidgetCSSSelectorID]
					,[CustomWidgetName]
					,[Content]
					,[DateCreated]
					,[ModifiedDate]
					,[ModifiedBy]
					,[Active]
					,[SourceID]
					)
				VALUES
					(
					@SiteId
					,@CustomWidgetCssSelectorId
					,@CustomWidgetName
					,@Content
					,@DateCreated
					,@ModifiedDate
					,@ModifiedBy
					,@Active
					,@SourceId
					)
				
				-- Get the identity value
				SET @CustomWidgetId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.CustomWidget_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.CustomWidget_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.CustomWidget_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the CustomWidget table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.CustomWidget_Update
(

	@CustomWidgetId int   ,

	@SiteId int   ,

	@CustomWidgetCssSelectorId int   ,

	@CustomWidgetName varchar (255)  ,

	@Content ntext   ,

	@DateCreated datetime   ,

	@ModifiedDate datetime   ,

	@ModifiedBy int   ,

	@Active bit   ,

	@SourceId int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[CustomWidget]
				SET
					[SiteID] = @SiteId
					,[CustomWidgetCSSSelectorID] = @CustomWidgetCssSelectorId
					,[CustomWidgetName] = @CustomWidgetName
					,[Content] = @Content
					,[DateCreated] = @DateCreated
					,[ModifiedDate] = @ModifiedDate
					,[ModifiedBy] = @ModifiedBy
					,[Active] = @Active
					,[SourceID] = @SourceId
				WHERE
[CustomWidgetID] = @CustomWidgetId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.CustomWidget_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.CustomWidget_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.CustomWidget_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the CustomWidget table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.CustomWidget_Delete
(

	@CustomWidgetId int   
)
AS


				DELETE FROM [dbo].[CustomWidget] WITH (ROWLOCK) 
				WHERE
					[CustomWidgetID] = @CustomWidgetId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.CustomWidget_GetByCustomWidgetCssSelectorId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.CustomWidget_GetByCustomWidgetCssSelectorId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.CustomWidget_GetByCustomWidgetCssSelectorId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the CustomWidget table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.CustomWidget_GetByCustomWidgetCssSelectorId
(

	@CustomWidgetCssSelectorId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[CustomWidgetID],
					[SiteID],
					[CustomWidgetCSSSelectorID],
					[CustomWidgetName],
					[Content],
					[DateCreated],
					[ModifiedDate],
					[ModifiedBy],
					[Active],
					[SourceID]
				FROM
					[dbo].[CustomWidget]
				WHERE
					[CustomWidgetCSSSelectorID] = @CustomWidgetCssSelectorId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.CustomWidget_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.CustomWidget_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.CustomWidget_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the CustomWidget table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.CustomWidget_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[CustomWidgetID],
					[SiteID],
					[CustomWidgetCSSSelectorID],
					[CustomWidgetName],
					[Content],
					[DateCreated],
					[ModifiedDate],
					[ModifiedBy],
					[Active],
					[SourceID]
				FROM
					[dbo].[CustomWidget]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.CustomWidget_GetByCustomWidgetId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.CustomWidget_GetByCustomWidgetId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.CustomWidget_GetByCustomWidgetId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the CustomWidget table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.CustomWidget_GetByCustomWidgetId
(

	@CustomWidgetId int   
)
AS


				SELECT
					[CustomWidgetID],
					[SiteID],
					[CustomWidgetCSSSelectorID],
					[CustomWidgetName],
					[Content],
					[DateCreated],
					[ModifiedDate],
					[ModifiedBy],
					[Active],
					[SourceID]
				FROM
					[dbo].[CustomWidget]
				WHERE
					[CustomWidgetID] = @CustomWidgetId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.CustomWidget_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.CustomWidget_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.CustomWidget_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the CustomWidget table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.CustomWidget_Find
(

	@SearchUsingOR bit   = null ,

	@CustomWidgetId int   = null ,

	@SiteId int   = null ,

	@CustomWidgetCssSelectorId int   = null ,

	@CustomWidgetName varchar (255)  = null ,

	@Content ntext   = null ,

	@DateCreated datetime   = null ,

	@ModifiedDate datetime   = null ,

	@ModifiedBy int   = null ,

	@Active bit   = null ,

	@SourceId int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [CustomWidgetID]
	, [SiteID]
	, [CustomWidgetCSSSelectorID]
	, [CustomWidgetName]
	, [Content]
	, [DateCreated]
	, [ModifiedDate]
	, [ModifiedBy]
	, [Active]
	, [SourceID]
    FROM
	[dbo].[CustomWidget]
    WHERE 
	 ([CustomWidgetID] = @CustomWidgetId OR @CustomWidgetId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([CustomWidgetCSSSelectorID] = @CustomWidgetCssSelectorId OR @CustomWidgetCssSelectorId IS NULL)
	AND ([CustomWidgetName] = @CustomWidgetName OR @CustomWidgetName IS NULL)
	AND ([DateCreated] = @DateCreated OR @DateCreated IS NULL)
	AND ([ModifiedDate] = @ModifiedDate OR @ModifiedDate IS NULL)
	AND ([ModifiedBy] = @ModifiedBy OR @ModifiedBy IS NULL)
	AND ([Active] = @Active OR @Active IS NULL)
	AND ([SourceID] = @SourceId OR @SourceId IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [CustomWidgetID]
	, [SiteID]
	, [CustomWidgetCSSSelectorID]
	, [CustomWidgetName]
	, [Content]
	, [DateCreated]
	, [ModifiedDate]
	, [ModifiedBy]
	, [Active]
	, [SourceID]
    FROM
	[dbo].[CustomWidget]
    WHERE 
	 ([CustomWidgetID] = @CustomWidgetId AND @CustomWidgetId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([CustomWidgetCSSSelectorID] = @CustomWidgetCssSelectorId AND @CustomWidgetCssSelectorId is not null)
	OR ([CustomWidgetName] = @CustomWidgetName AND @CustomWidgetName is not null)
	OR ([DateCreated] = @DateCreated AND @DateCreated is not null)
	OR ([ModifiedDate] = @ModifiedDate AND @ModifiedDate is not null)
	OR ([ModifiedBy] = @ModifiedBy AND @ModifiedBy is not null)
	OR ([Active] = @Active AND @Active is not null)
	OR ([SourceID] = @SourceId AND @SourceId is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPageWebPartTemplates_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPageWebPartTemplates_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPageWebPartTemplates_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the DynamicPageWebPartTemplates table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPageWebPartTemplates_Get_List

AS


				
				SELECT
					[DynamicPageWebPartTemplateID],
					[DynamicPageWebPartName],
					[SiteID],
					[LastModified],
					[LastModifiedBy],
					[SourceID]
				FROM
					[dbo].[DynamicPageWebPartTemplates]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPageWebPartTemplates_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPageWebPartTemplates_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPageWebPartTemplates_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the DynamicPageWebPartTemplates table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPageWebPartTemplates_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [DynamicPageWebPartTemplateID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([DynamicPageWebPartTemplateID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [DynamicPageWebPartTemplateID]'
				SET @SQL = @SQL + ' FROM [dbo].[DynamicPageWebPartTemplates]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[DynamicPageWebPartTemplateID], O.[DynamicPageWebPartName], O.[SiteID], O.[LastModified], O.[LastModifiedBy], O.[SourceID]
				FROM
				    [dbo].[DynamicPageWebPartTemplates] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[DynamicPageWebPartTemplateID] = PageIndex.[DynamicPageWebPartTemplateID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[DynamicPageWebPartTemplates]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPageWebPartTemplates_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPageWebPartTemplates_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPageWebPartTemplates_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the DynamicPageWebPartTemplates table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPageWebPartTemplates_Insert
(

	@DynamicPageWebPartTemplateId int    OUTPUT,

	@DynamicPageWebPartName nvarchar (255)  ,

	@SiteId int   ,

	@LastModified datetime   ,

	@LastModifiedBy int   ,

	@SourceId int   
)
AS


				
				INSERT INTO [dbo].[DynamicPageWebPartTemplates]
					(
					[DynamicPageWebPartName]
					,[SiteID]
					,[LastModified]
					,[LastModifiedBy]
					,[SourceID]
					)
				VALUES
					(
					@DynamicPageWebPartName
					,@SiteId
					,@LastModified
					,@LastModifiedBy
					,@SourceId
					)
				
				-- Get the identity value
				SET @DynamicPageWebPartTemplateId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPageWebPartTemplates_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPageWebPartTemplates_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPageWebPartTemplates_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the DynamicPageWebPartTemplates table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPageWebPartTemplates_Update
(

	@DynamicPageWebPartTemplateId int   ,

	@DynamicPageWebPartName nvarchar (255)  ,

	@SiteId int   ,

	@LastModified datetime   ,

	@LastModifiedBy int   ,

	@SourceId int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[DynamicPageWebPartTemplates]
				SET
					[DynamicPageWebPartName] = @DynamicPageWebPartName
					,[SiteID] = @SiteId
					,[LastModified] = @LastModified
					,[LastModifiedBy] = @LastModifiedBy
					,[SourceID] = @SourceId
				WHERE
[DynamicPageWebPartTemplateID] = @DynamicPageWebPartTemplateId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPageWebPartTemplates_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPageWebPartTemplates_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPageWebPartTemplates_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the DynamicPageWebPartTemplates table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPageWebPartTemplates_Delete
(

	@DynamicPageWebPartTemplateId int   
)
AS


				DELETE FROM [dbo].[DynamicPageWebPartTemplates] WITH (ROWLOCK) 
				WHERE
					[DynamicPageWebPartTemplateID] = @DynamicPageWebPartTemplateId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPageWebPartTemplates_GetByLastModifiedBy procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPageWebPartTemplates_GetByLastModifiedBy') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPageWebPartTemplates_GetByLastModifiedBy
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the DynamicPageWebPartTemplates table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPageWebPartTemplates_GetByLastModifiedBy
(

	@LastModifiedBy int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[DynamicPageWebPartTemplateID],
					[DynamicPageWebPartName],
					[SiteID],
					[LastModified],
					[LastModifiedBy],
					[SourceID]
				FROM
					[dbo].[DynamicPageWebPartTemplates]
				WHERE
					[LastModifiedBy] = @LastModifiedBy
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPageWebPartTemplates_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPageWebPartTemplates_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPageWebPartTemplates_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the DynamicPageWebPartTemplates table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPageWebPartTemplates_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[DynamicPageWebPartTemplateID],
					[DynamicPageWebPartName],
					[SiteID],
					[LastModified],
					[LastModifiedBy],
					[SourceID]
				FROM
					[dbo].[DynamicPageWebPartTemplates]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPageWebPartTemplates_GetByDynamicPageWebPartTemplateId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPageWebPartTemplates_GetByDynamicPageWebPartTemplateId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPageWebPartTemplates_GetByDynamicPageWebPartTemplateId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the DynamicPageWebPartTemplates table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPageWebPartTemplates_GetByDynamicPageWebPartTemplateId
(

	@DynamicPageWebPartTemplateId int   
)
AS


				SELECT
					[DynamicPageWebPartTemplateID],
					[DynamicPageWebPartName],
					[SiteID],
					[LastModified],
					[LastModifiedBy],
					[SourceID]
				FROM
					[dbo].[DynamicPageWebPartTemplates]
				WHERE
					[DynamicPageWebPartTemplateID] = @DynamicPageWebPartTemplateId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPageWebPartTemplates_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPageWebPartTemplates_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPageWebPartTemplates_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the DynamicPageWebPartTemplates table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPageWebPartTemplates_Find
(

	@SearchUsingOR bit   = null ,

	@DynamicPageWebPartTemplateId int   = null ,

	@DynamicPageWebPartName nvarchar (255)  = null ,

	@SiteId int   = null ,

	@LastModified datetime   = null ,

	@LastModifiedBy int   = null ,

	@SourceId int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [DynamicPageWebPartTemplateID]
	, [DynamicPageWebPartName]
	, [SiteID]
	, [LastModified]
	, [LastModifiedBy]
	, [SourceID]
    FROM
	[dbo].[DynamicPageWebPartTemplates]
    WHERE 
	 ([DynamicPageWebPartTemplateID] = @DynamicPageWebPartTemplateId OR @DynamicPageWebPartTemplateId IS NULL)
	AND ([DynamicPageWebPartName] = @DynamicPageWebPartName OR @DynamicPageWebPartName IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([LastModified] = @LastModified OR @LastModified IS NULL)
	AND ([LastModifiedBy] = @LastModifiedBy OR @LastModifiedBy IS NULL)
	AND ([SourceID] = @SourceId OR @SourceId IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [DynamicPageWebPartTemplateID]
	, [DynamicPageWebPartName]
	, [SiteID]
	, [LastModified]
	, [LastModifiedBy]
	, [SourceID]
    FROM
	[dbo].[DynamicPageWebPartTemplates]
    WHERE 
	 ([DynamicPageWebPartTemplateID] = @DynamicPageWebPartTemplateId AND @DynamicPageWebPartTemplateId is not null)
	OR ([DynamicPageWebPartName] = @DynamicPageWebPartName AND @DynamicPageWebPartName is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([LastModified] = @LastModified AND @LastModified is not null)
	OR ([LastModifiedBy] = @LastModifiedBy AND @LastModifiedBy is not null)
	OR ([SourceID] = @SourceId AND @SourceId is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicContent_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicContent_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicContent_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the DynamicContent table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicContent_Get_List

AS


				
				SELECT
					[DynamicContentID],
					[SiteID],
					[LanguageID],
					[DynamicContentType],
					[Title],
					[Introduction],
					[Description],
					[LastModifiedBy],
					[LastModifiedDate],
					[Active]
				FROM
					[dbo].[DynamicContent]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicContent_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicContent_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicContent_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the DynamicContent table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicContent_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [DynamicContentID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([DynamicContentID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [DynamicContentID]'
				SET @SQL = @SQL + ' FROM [dbo].[DynamicContent]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[DynamicContentID], O.[SiteID], O.[LanguageID], O.[DynamicContentType], O.[Title], O.[Introduction], O.[Description], O.[LastModifiedBy], O.[LastModifiedDate], O.[Active]
				FROM
				    [dbo].[DynamicContent] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[DynamicContentID] = PageIndex.[DynamicContentID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[DynamicContent]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicContent_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicContent_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicContent_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the DynamicContent table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicContent_Insert
(

	@DynamicContentId int    OUTPUT,

	@SiteId int   ,

	@LanguageId int   ,

	@DynamicContentType int   ,

	@Title nvarchar (2000)  ,

	@Introduction nvarchar (2000)  ,

	@Description nvarchar (MAX)  ,

	@LastModifiedBy int   ,

	@LastModifiedDate datetime   ,

	@Active bit   
)
AS


				
				INSERT INTO [dbo].[DynamicContent]
					(
					[SiteID]
					,[LanguageID]
					,[DynamicContentType]
					,[Title]
					,[Introduction]
					,[Description]
					,[LastModifiedBy]
					,[LastModifiedDate]
					,[Active]
					)
				VALUES
					(
					@SiteId
					,@LanguageId
					,@DynamicContentType
					,@Title
					,@Introduction
					,@Description
					,@LastModifiedBy
					,@LastModifiedDate
					,@Active
					)
				
				-- Get the identity value
				SET @DynamicContentId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicContent_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicContent_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicContent_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the DynamicContent table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicContent_Update
(

	@DynamicContentId int   ,

	@SiteId int   ,

	@LanguageId int   ,

	@DynamicContentType int   ,

	@Title nvarchar (2000)  ,

	@Introduction nvarchar (2000)  ,

	@Description nvarchar (MAX)  ,

	@LastModifiedBy int   ,

	@LastModifiedDate datetime   ,

	@Active bit   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[DynamicContent]
				SET
					[SiteID] = @SiteId
					,[LanguageID] = @LanguageId
					,[DynamicContentType] = @DynamicContentType
					,[Title] = @Title
					,[Introduction] = @Introduction
					,[Description] = @Description
					,[LastModifiedBy] = @LastModifiedBy
					,[LastModifiedDate] = @LastModifiedDate
					,[Active] = @Active
				WHERE
[DynamicContentID] = @DynamicContentId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicContent_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicContent_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicContent_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the DynamicContent table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicContent_Delete
(

	@DynamicContentId int   
)
AS


				DELETE FROM [dbo].[DynamicContent] WITH (ROWLOCK) 
				WHERE
					[DynamicContentID] = @DynamicContentId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicContent_GetByLastModifiedBy procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicContent_GetByLastModifiedBy') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicContent_GetByLastModifiedBy
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the DynamicContent table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicContent_GetByLastModifiedBy
(

	@LastModifiedBy int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[DynamicContentID],
					[SiteID],
					[LanguageID],
					[DynamicContentType],
					[Title],
					[Introduction],
					[Description],
					[LastModifiedBy],
					[LastModifiedDate],
					[Active]
				FROM
					[dbo].[DynamicContent]
				WHERE
					[LastModifiedBy] = @LastModifiedBy
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicContent_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicContent_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicContent_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the DynamicContent table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicContent_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[DynamicContentID],
					[SiteID],
					[LanguageID],
					[DynamicContentType],
					[Title],
					[Introduction],
					[Description],
					[LastModifiedBy],
					[LastModifiedDate],
					[Active]
				FROM
					[dbo].[DynamicContent]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicContent_GetByDynamicContentId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicContent_GetByDynamicContentId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicContent_GetByDynamicContentId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the DynamicContent table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicContent_GetByDynamicContentId
(

	@DynamicContentId int   
)
AS


				SELECT
					[DynamicContentID],
					[SiteID],
					[LanguageID],
					[DynamicContentType],
					[Title],
					[Introduction],
					[Description],
					[LastModifiedBy],
					[LastModifiedDate],
					[Active]
				FROM
					[dbo].[DynamicContent]
				WHERE
					[DynamicContentID] = @DynamicContentId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicContent_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicContent_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicContent_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the DynamicContent table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicContent_Find
(

	@SearchUsingOR bit   = null ,

	@DynamicContentId int   = null ,

	@SiteId int   = null ,

	@LanguageId int   = null ,

	@DynamicContentType int   = null ,

	@Title nvarchar (2000)  = null ,

	@Introduction nvarchar (2000)  = null ,

	@Description nvarchar (MAX)  = null ,

	@LastModifiedBy int   = null ,

	@LastModifiedDate datetime   = null ,

	@Active bit   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [DynamicContentID]
	, [SiteID]
	, [LanguageID]
	, [DynamicContentType]
	, [Title]
	, [Introduction]
	, [Description]
	, [LastModifiedBy]
	, [LastModifiedDate]
	, [Active]
    FROM
	[dbo].[DynamicContent]
    WHERE 
	 ([DynamicContentID] = @DynamicContentId OR @DynamicContentId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([LanguageID] = @LanguageId OR @LanguageId IS NULL)
	AND ([DynamicContentType] = @DynamicContentType OR @DynamicContentType IS NULL)
	AND ([Title] = @Title OR @Title IS NULL)
	AND ([Introduction] = @Introduction OR @Introduction IS NULL)
	AND ([Description] = @Description OR @Description IS NULL)
	AND ([LastModifiedBy] = @LastModifiedBy OR @LastModifiedBy IS NULL)
	AND ([LastModifiedDate] = @LastModifiedDate OR @LastModifiedDate IS NULL)
	AND ([Active] = @Active OR @Active IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [DynamicContentID]
	, [SiteID]
	, [LanguageID]
	, [DynamicContentType]
	, [Title]
	, [Introduction]
	, [Description]
	, [LastModifiedBy]
	, [LastModifiedDate]
	, [Active]
    FROM
	[dbo].[DynamicContent]
    WHERE 
	 ([DynamicContentID] = @DynamicContentId AND @DynamicContentId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([LanguageID] = @LanguageId AND @LanguageId is not null)
	OR ([DynamicContentType] = @DynamicContentType AND @DynamicContentType is not null)
	OR ([Title] = @Title AND @Title is not null)
	OR ([Introduction] = @Introduction AND @Introduction is not null)
	OR ([Description] = @Description AND @Description is not null)
	OR ([LastModifiedBy] = @LastModifiedBy AND @LastModifiedBy is not null)
	OR ([LastModifiedDate] = @LastModifiedDate AND @LastModifiedDate is not null)
	OR ([Active] = @Active AND @Active is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Advertisers_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Advertisers_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Advertisers_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the Advertisers table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Advertisers_Get_List

AS


				
				SELECT
					[AdvertiserID],
					[SiteID],
					[AdvertiserAccountTypeID],
					[AdvertiserBusinessTypeID],
					[AdvertiserAccountStatusID],
					[CompanyName],
					[BusinessNumber],
					[StreetAddress1],
					[StreetAddress2],
					[LastModified],
					[LastModifiedBy],
					[PostalAddress1],
					[PostalAddress2],
					[WebAddress],
					[NoOfEmployees],
					[FirstApprovedDate],
					[Profile],
					[CharityNumber],
					[SearchField],
					[FreeTrialStartDate],
					[FreeTrialEndDate],
					[AccountsPayableEmail],
					[RequireLogonForExternalApplication],
					[AdvertiserLogo],
					[LinkedInLogo],
					[LinkedInCompanyId],
					[LinkedInEmail],
					[RegisterDate],
					[ExternalAdvertiserID],
					[VideoLink],
					[Industry],
					[NominatedCompanyRole],
					[NominatedCompanyFirstName],
					[NominatedCompanyLastName],
					[NominatedCompanyEmailAddress],
					[NominatedCompanyPhone],
					[PreferredContactMethod],
					[AdvertiserLogoUrl]
				FROM
					[dbo].[Advertisers]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Advertisers_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Advertisers_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Advertisers_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the Advertisers table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Advertisers_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [AdvertiserID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([AdvertiserID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [AdvertiserID]'
				SET @SQL = @SQL + ' FROM [dbo].[Advertisers]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[AdvertiserID], O.[SiteID], O.[AdvertiserAccountTypeID], O.[AdvertiserBusinessTypeID], O.[AdvertiserAccountStatusID], O.[CompanyName], O.[BusinessNumber], O.[StreetAddress1], O.[StreetAddress2], O.[LastModified], O.[LastModifiedBy], O.[PostalAddress1], O.[PostalAddress2], O.[WebAddress], O.[NoOfEmployees], O.[FirstApprovedDate], O.[Profile], O.[CharityNumber], O.[SearchField], O.[FreeTrialStartDate], O.[FreeTrialEndDate], O.[AccountsPayableEmail], O.[RequireLogonForExternalApplication], O.[AdvertiserLogo], O.[LinkedInLogo], O.[LinkedInCompanyId], O.[LinkedInEmail], O.[RegisterDate], O.[ExternalAdvertiserID], O.[VideoLink], O.[Industry], O.[NominatedCompanyRole], O.[NominatedCompanyFirstName], O.[NominatedCompanyLastName], O.[NominatedCompanyEmailAddress], O.[NominatedCompanyPhone], O.[PreferredContactMethod], O.[AdvertiserLogoUrl]
				FROM
				    [dbo].[Advertisers] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[AdvertiserID] = PageIndex.[AdvertiserID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[Advertisers]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Advertisers_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Advertisers_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Advertisers_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the Advertisers table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Advertisers_Insert
(

	@AdvertiserId int    OUTPUT,

	@SiteId int   ,

	@AdvertiserAccountTypeId int   ,

	@AdvertiserBusinessTypeId int   ,

	@AdvertiserAccountStatusId int   ,

	@CompanyName nvarchar (510)  ,

	@BusinessNumber nvarchar (255)  ,

	@StreetAddress1 nvarchar (255)  ,

	@StreetAddress2 nvarchar (255)  ,

	@LastModified datetime   ,

	@LastModifiedBy int   ,

	@PostalAddress1 nvarchar (255)  ,

	@PostalAddress2 nvarchar (255)  ,

	@WebAddress varchar (255)  ,

	@NoOfEmployees varchar (10)  ,

	@FirstApprovedDate smalldatetime   ,

	@Profile ntext   ,

	@CharityNumber varchar (50)  ,

	@SearchField nvarchar (MAX)  ,

	@FreeTrialStartDate smalldatetime   ,

	@FreeTrialEndDate smalldatetime   ,

	@AccountsPayableEmail varchar (255)  ,

	@RequireLogonForExternalApplication bit   ,

	@AdvertiserLogo image   ,

	@LinkedInLogo varchar (255)  ,

	@LinkedInCompanyId varchar (255)  ,

	@LinkedInEmail varchar (255)  ,

	@RegisterDate datetime   ,

	@ExternalAdvertiserId varchar (50)  ,

	@VideoLink varchar (500)  ,

	@Industry varchar (100)  ,

	@NominatedCompanyRole varchar (500)  ,

	@NominatedCompanyFirstName varchar (510)  ,

	@NominatedCompanyLastName nvarchar (510)  ,

	@NominatedCompanyEmailAddress nvarchar (255)  ,

	@NominatedCompanyPhone varchar (40)  ,

	@PreferredContactMethod int   ,

	@AdvertiserLogoUrl nvarchar (1000)  
)
AS


				
				INSERT INTO [dbo].[Advertisers]
					(
					[SiteID]
					,[AdvertiserAccountTypeID]
					,[AdvertiserBusinessTypeID]
					,[AdvertiserAccountStatusID]
					,[CompanyName]
					,[BusinessNumber]
					,[StreetAddress1]
					,[StreetAddress2]
					,[LastModified]
					,[LastModifiedBy]
					,[PostalAddress1]
					,[PostalAddress2]
					,[WebAddress]
					,[NoOfEmployees]
					,[FirstApprovedDate]
					,[Profile]
					,[CharityNumber]
					,[SearchField]
					,[FreeTrialStartDate]
					,[FreeTrialEndDate]
					,[AccountsPayableEmail]
					,[RequireLogonForExternalApplication]
					,[AdvertiserLogo]
					,[LinkedInLogo]
					,[LinkedInCompanyId]
					,[LinkedInEmail]
					,[RegisterDate]
					,[ExternalAdvertiserID]
					,[VideoLink]
					,[Industry]
					,[NominatedCompanyRole]
					,[NominatedCompanyFirstName]
					,[NominatedCompanyLastName]
					,[NominatedCompanyEmailAddress]
					,[NominatedCompanyPhone]
					,[PreferredContactMethod]
					,[AdvertiserLogoUrl]
					)
				VALUES
					(
					@SiteId
					,@AdvertiserAccountTypeId
					,@AdvertiserBusinessTypeId
					,@AdvertiserAccountStatusId
					,@CompanyName
					,@BusinessNumber
					,@StreetAddress1
					,@StreetAddress2
					,@LastModified
					,@LastModifiedBy
					,@PostalAddress1
					,@PostalAddress2
					,@WebAddress
					,@NoOfEmployees
					,@FirstApprovedDate
					,@Profile
					,@CharityNumber
					,@SearchField
					,@FreeTrialStartDate
					,@FreeTrialEndDate
					,@AccountsPayableEmail
					,@RequireLogonForExternalApplication
					,@AdvertiserLogo
					,@LinkedInLogo
					,@LinkedInCompanyId
					,@LinkedInEmail
					,@RegisterDate
					,@ExternalAdvertiserId
					,@VideoLink
					,@Industry
					,@NominatedCompanyRole
					,@NominatedCompanyFirstName
					,@NominatedCompanyLastName
					,@NominatedCompanyEmailAddress
					,@NominatedCompanyPhone
					,@PreferredContactMethod
					,@AdvertiserLogoUrl
					)
				
				-- Get the identity value
				SET @AdvertiserId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Advertisers_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Advertisers_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Advertisers_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the Advertisers table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Advertisers_Update
(

	@AdvertiserId int   ,

	@SiteId int   ,

	@AdvertiserAccountTypeId int   ,

	@AdvertiserBusinessTypeId int   ,

	@AdvertiserAccountStatusId int   ,

	@CompanyName nvarchar (510)  ,

	@BusinessNumber nvarchar (255)  ,

	@StreetAddress1 nvarchar (255)  ,

	@StreetAddress2 nvarchar (255)  ,

	@LastModified datetime   ,

	@LastModifiedBy int   ,

	@PostalAddress1 nvarchar (255)  ,

	@PostalAddress2 nvarchar (255)  ,

	@WebAddress varchar (255)  ,

	@NoOfEmployees varchar (10)  ,

	@FirstApprovedDate smalldatetime   ,

	@Profile ntext   ,

	@CharityNumber varchar (50)  ,

	@SearchField nvarchar (MAX)  ,

	@FreeTrialStartDate smalldatetime   ,

	@FreeTrialEndDate smalldatetime   ,

	@AccountsPayableEmail varchar (255)  ,

	@RequireLogonForExternalApplication bit   ,

	@AdvertiserLogo image   ,

	@LinkedInLogo varchar (255)  ,

	@LinkedInCompanyId varchar (255)  ,

	@LinkedInEmail varchar (255)  ,

	@RegisterDate datetime   ,

	@ExternalAdvertiserId varchar (50)  ,

	@VideoLink varchar (500)  ,

	@Industry varchar (100)  ,

	@NominatedCompanyRole varchar (500)  ,

	@NominatedCompanyFirstName varchar (510)  ,

	@NominatedCompanyLastName nvarchar (510)  ,

	@NominatedCompanyEmailAddress nvarchar (255)  ,

	@NominatedCompanyPhone varchar (40)  ,

	@PreferredContactMethod int   ,

	@AdvertiserLogoUrl nvarchar (1000)  
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[Advertisers]
				SET
					[SiteID] = @SiteId
					,[AdvertiserAccountTypeID] = @AdvertiserAccountTypeId
					,[AdvertiserBusinessTypeID] = @AdvertiserBusinessTypeId
					,[AdvertiserAccountStatusID] = @AdvertiserAccountStatusId
					,[CompanyName] = @CompanyName
					,[BusinessNumber] = @BusinessNumber
					,[StreetAddress1] = @StreetAddress1
					,[StreetAddress2] = @StreetAddress2
					,[LastModified] = @LastModified
					,[LastModifiedBy] = @LastModifiedBy
					,[PostalAddress1] = @PostalAddress1
					,[PostalAddress2] = @PostalAddress2
					,[WebAddress] = @WebAddress
					,[NoOfEmployees] = @NoOfEmployees
					,[FirstApprovedDate] = @FirstApprovedDate
					,[Profile] = @Profile
					,[CharityNumber] = @CharityNumber
					,[SearchField] = @SearchField
					,[FreeTrialStartDate] = @FreeTrialStartDate
					,[FreeTrialEndDate] = @FreeTrialEndDate
					,[AccountsPayableEmail] = @AccountsPayableEmail
					,[RequireLogonForExternalApplication] = @RequireLogonForExternalApplication
					,[AdvertiserLogo] = @AdvertiserLogo
					,[LinkedInLogo] = @LinkedInLogo
					,[LinkedInCompanyId] = @LinkedInCompanyId
					,[LinkedInEmail] = @LinkedInEmail
					,[RegisterDate] = @RegisterDate
					,[ExternalAdvertiserID] = @ExternalAdvertiserId
					,[VideoLink] = @VideoLink
					,[Industry] = @Industry
					,[NominatedCompanyRole] = @NominatedCompanyRole
					,[NominatedCompanyFirstName] = @NominatedCompanyFirstName
					,[NominatedCompanyLastName] = @NominatedCompanyLastName
					,[NominatedCompanyEmailAddress] = @NominatedCompanyEmailAddress
					,[NominatedCompanyPhone] = @NominatedCompanyPhone
					,[PreferredContactMethod] = @PreferredContactMethod
					,[AdvertiserLogoUrl] = @AdvertiserLogoUrl
				WHERE
[AdvertiserID] = @AdvertiserId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Advertisers_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Advertisers_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Advertisers_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the Advertisers table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Advertisers_Delete
(

	@AdvertiserId int   
)
AS


				DELETE FROM [dbo].[Advertisers] WITH (ROWLOCK) 
				WHERE
					[AdvertiserID] = @AdvertiserId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Advertisers_GetByAdvertiserAccountStatusId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Advertisers_GetByAdvertiserAccountStatusId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Advertisers_GetByAdvertiserAccountStatusId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Advertisers table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Advertisers_GetByAdvertiserAccountStatusId
(

	@AdvertiserAccountStatusId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[AdvertiserID],
					[SiteID],
					[AdvertiserAccountTypeID],
					[AdvertiserBusinessTypeID],
					[AdvertiserAccountStatusID],
					[CompanyName],
					[BusinessNumber],
					[StreetAddress1],
					[StreetAddress2],
					[LastModified],
					[LastModifiedBy],
					[PostalAddress1],
					[PostalAddress2],
					[WebAddress],
					[NoOfEmployees],
					[FirstApprovedDate],
					[Profile],
					[CharityNumber],
					[SearchField],
					[FreeTrialStartDate],
					[FreeTrialEndDate],
					[AccountsPayableEmail],
					[RequireLogonForExternalApplication],
					[AdvertiserLogo],
					[LinkedInLogo],
					[LinkedInCompanyId],
					[LinkedInEmail],
					[RegisterDate],
					[ExternalAdvertiserID],
					[VideoLink],
					[Industry],
					[NominatedCompanyRole],
					[NominatedCompanyFirstName],
					[NominatedCompanyLastName],
					[NominatedCompanyEmailAddress],
					[NominatedCompanyPhone],
					[PreferredContactMethod],
					[AdvertiserLogoUrl]
				FROM
					[dbo].[Advertisers]
				WHERE
					[AdvertiserAccountStatusID] = @AdvertiserAccountStatusId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Advertisers_GetByAdvertiserBusinessTypeId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Advertisers_GetByAdvertiserBusinessTypeId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Advertisers_GetByAdvertiserBusinessTypeId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Advertisers table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Advertisers_GetByAdvertiserBusinessTypeId
(

	@AdvertiserBusinessTypeId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[AdvertiserID],
					[SiteID],
					[AdvertiserAccountTypeID],
					[AdvertiserBusinessTypeID],
					[AdvertiserAccountStatusID],
					[CompanyName],
					[BusinessNumber],
					[StreetAddress1],
					[StreetAddress2],
					[LastModified],
					[LastModifiedBy],
					[PostalAddress1],
					[PostalAddress2],
					[WebAddress],
					[NoOfEmployees],
					[FirstApprovedDate],
					[Profile],
					[CharityNumber],
					[SearchField],
					[FreeTrialStartDate],
					[FreeTrialEndDate],
					[AccountsPayableEmail],
					[RequireLogonForExternalApplication],
					[AdvertiserLogo],
					[LinkedInLogo],
					[LinkedInCompanyId],
					[LinkedInEmail],
					[RegisterDate],
					[ExternalAdvertiserID],
					[VideoLink],
					[Industry],
					[NominatedCompanyRole],
					[NominatedCompanyFirstName],
					[NominatedCompanyLastName],
					[NominatedCompanyEmailAddress],
					[NominatedCompanyPhone],
					[PreferredContactMethod],
					[AdvertiserLogoUrl]
				FROM
					[dbo].[Advertisers]
				WHERE
					[AdvertiserBusinessTypeID] = @AdvertiserBusinessTypeId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Advertisers_GetByAdvertiserAccountTypeId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Advertisers_GetByAdvertiserAccountTypeId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Advertisers_GetByAdvertiserAccountTypeId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Advertisers table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Advertisers_GetByAdvertiserAccountTypeId
(

	@AdvertiserAccountTypeId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[AdvertiserID],
					[SiteID],
					[AdvertiserAccountTypeID],
					[AdvertiserBusinessTypeID],
					[AdvertiserAccountStatusID],
					[CompanyName],
					[BusinessNumber],
					[StreetAddress1],
					[StreetAddress2],
					[LastModified],
					[LastModifiedBy],
					[PostalAddress1],
					[PostalAddress2],
					[WebAddress],
					[NoOfEmployees],
					[FirstApprovedDate],
					[Profile],
					[CharityNumber],
					[SearchField],
					[FreeTrialStartDate],
					[FreeTrialEndDate],
					[AccountsPayableEmail],
					[RequireLogonForExternalApplication],
					[AdvertiserLogo],
					[LinkedInLogo],
					[LinkedInCompanyId],
					[LinkedInEmail],
					[RegisterDate],
					[ExternalAdvertiserID],
					[VideoLink],
					[Industry],
					[NominatedCompanyRole],
					[NominatedCompanyFirstName],
					[NominatedCompanyLastName],
					[NominatedCompanyEmailAddress],
					[NominatedCompanyPhone],
					[PreferredContactMethod],
					[AdvertiserLogoUrl]
				FROM
					[dbo].[Advertisers]
				WHERE
					[AdvertiserAccountTypeID] = @AdvertiserAccountTypeId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Advertisers_GetByLastModifiedBy procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Advertisers_GetByLastModifiedBy') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Advertisers_GetByLastModifiedBy
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Advertisers table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Advertisers_GetByLastModifiedBy
(

	@LastModifiedBy int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[AdvertiserID],
					[SiteID],
					[AdvertiserAccountTypeID],
					[AdvertiserBusinessTypeID],
					[AdvertiserAccountStatusID],
					[CompanyName],
					[BusinessNumber],
					[StreetAddress1],
					[StreetAddress2],
					[LastModified],
					[LastModifiedBy],
					[PostalAddress1],
					[PostalAddress2],
					[WebAddress],
					[NoOfEmployees],
					[FirstApprovedDate],
					[Profile],
					[CharityNumber],
					[SearchField],
					[FreeTrialStartDate],
					[FreeTrialEndDate],
					[AccountsPayableEmail],
					[RequireLogonForExternalApplication],
					[AdvertiserLogo],
					[LinkedInLogo],
					[LinkedInCompanyId],
					[LinkedInEmail],
					[RegisterDate],
					[ExternalAdvertiserID],
					[VideoLink],
					[Industry],
					[NominatedCompanyRole],
					[NominatedCompanyFirstName],
					[NominatedCompanyLastName],
					[NominatedCompanyEmailAddress],
					[NominatedCompanyPhone],
					[PreferredContactMethod],
					[AdvertiserLogoUrl]
				FROM
					[dbo].[Advertisers]
				WHERE
					[LastModifiedBy] = @LastModifiedBy
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Advertisers_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Advertisers_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Advertisers_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Advertisers table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Advertisers_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[AdvertiserID],
					[SiteID],
					[AdvertiserAccountTypeID],
					[AdvertiserBusinessTypeID],
					[AdvertiserAccountStatusID],
					[CompanyName],
					[BusinessNumber],
					[StreetAddress1],
					[StreetAddress2],
					[LastModified],
					[LastModifiedBy],
					[PostalAddress1],
					[PostalAddress2],
					[WebAddress],
					[NoOfEmployees],
					[FirstApprovedDate],
					[Profile],
					[CharityNumber],
					[SearchField],
					[FreeTrialStartDate],
					[FreeTrialEndDate],
					[AccountsPayableEmail],
					[RequireLogonForExternalApplication],
					[AdvertiserLogo],
					[LinkedInLogo],
					[LinkedInCompanyId],
					[LinkedInEmail],
					[RegisterDate],
					[ExternalAdvertiserID],
					[VideoLink],
					[Industry],
					[NominatedCompanyRole],
					[NominatedCompanyFirstName],
					[NominatedCompanyLastName],
					[NominatedCompanyEmailAddress],
					[NominatedCompanyPhone],
					[PreferredContactMethod],
					[AdvertiserLogoUrl]
				FROM
					[dbo].[Advertisers]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Advertisers_GetByAdvertiserId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Advertisers_GetByAdvertiserId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Advertisers_GetByAdvertiserId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Advertisers table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Advertisers_GetByAdvertiserId
(

	@AdvertiserId int   
)
AS


				SELECT
					[AdvertiserID],
					[SiteID],
					[AdvertiserAccountTypeID],
					[AdvertiserBusinessTypeID],
					[AdvertiserAccountStatusID],
					[CompanyName],
					[BusinessNumber],
					[StreetAddress1],
					[StreetAddress2],
					[LastModified],
					[LastModifiedBy],
					[PostalAddress1],
					[PostalAddress2],
					[WebAddress],
					[NoOfEmployees],
					[FirstApprovedDate],
					[Profile],
					[CharityNumber],
					[SearchField],
					[FreeTrialStartDate],
					[FreeTrialEndDate],
					[AccountsPayableEmail],
					[RequireLogonForExternalApplication],
					[AdvertiserLogo],
					[LinkedInLogo],
					[LinkedInCompanyId],
					[LinkedInEmail],
					[RegisterDate],
					[ExternalAdvertiserID],
					[VideoLink],
					[Industry],
					[NominatedCompanyRole],
					[NominatedCompanyFirstName],
					[NominatedCompanyLastName],
					[NominatedCompanyEmailAddress],
					[NominatedCompanyPhone],
					[PreferredContactMethod],
					[AdvertiserLogoUrl]
				FROM
					[dbo].[Advertisers]
				WHERE
					[AdvertiserID] = @AdvertiserId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Advertisers_GetByJobItemsTypeIdFromAdvertiserJobPricing procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Advertisers_GetByJobItemsTypeIdFromAdvertiserJobPricing') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Advertisers_GetByJobItemsTypeIdFromAdvertiserJobPricing
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records through a junction table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Advertisers_GetByJobItemsTypeIdFromAdvertiserJobPricing
(

	@JobItemsTypeId int   
)
AS


SELECT dbo.[Advertisers].[AdvertiserID]
       ,dbo.[Advertisers].[SiteID]
       ,dbo.[Advertisers].[AdvertiserAccountTypeID]
       ,dbo.[Advertisers].[AdvertiserBusinessTypeID]
       ,dbo.[Advertisers].[AdvertiserAccountStatusID]
       ,dbo.[Advertisers].[CompanyName]
       ,dbo.[Advertisers].[BusinessNumber]
       ,dbo.[Advertisers].[StreetAddress1]
       ,dbo.[Advertisers].[StreetAddress2]
       ,dbo.[Advertisers].[LastModified]
       ,dbo.[Advertisers].[LastModifiedBy]
       ,dbo.[Advertisers].[PostalAddress1]
       ,dbo.[Advertisers].[PostalAddress2]
       ,dbo.[Advertisers].[WebAddress]
       ,dbo.[Advertisers].[NoOfEmployees]
       ,dbo.[Advertisers].[FirstApprovedDate]
       ,dbo.[Advertisers].[Profile]
       ,dbo.[Advertisers].[CharityNumber]
       ,dbo.[Advertisers].[SearchField]
       ,dbo.[Advertisers].[FreeTrialStartDate]
       ,dbo.[Advertisers].[FreeTrialEndDate]
       ,dbo.[Advertisers].[AccountsPayableEmail]
       ,dbo.[Advertisers].[RequireLogonForExternalApplication]
       ,dbo.[Advertisers].[AdvertiserLogo]
       ,dbo.[Advertisers].[LinkedInLogo]
       ,dbo.[Advertisers].[LinkedInCompanyId]
       ,dbo.[Advertisers].[LinkedInEmail]
       ,dbo.[Advertisers].[RegisterDate]
       ,dbo.[Advertisers].[ExternalAdvertiserID]
       ,dbo.[Advertisers].[VideoLink]
       ,dbo.[Advertisers].[Industry]
       ,dbo.[Advertisers].[NominatedCompanyRole]
       ,dbo.[Advertisers].[NominatedCompanyFirstName]
       ,dbo.[Advertisers].[NominatedCompanyLastName]
       ,dbo.[Advertisers].[NominatedCompanyEmailAddress]
       ,dbo.[Advertisers].[NominatedCompanyPhone]
       ,dbo.[Advertisers].[PreferredContactMethod]
       ,dbo.[Advertisers].[AdvertiserLogoUrl]
  FROM dbo.[Advertisers]
 WHERE EXISTS (SELECT 1
                 FROM dbo.[AdvertiserJobPricing] 
                WHERE dbo.[AdvertiserJobPricing].[JobItemsTypeID] = @JobItemsTypeId
                  AND dbo.[AdvertiserJobPricing].[AdvertiserID] = dbo.[Advertisers].[AdvertiserID]
                  )
				SELECT @@ROWCOUNT			
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Advertisers_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Advertisers_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Advertisers_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the Advertisers table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Advertisers_Find
(

	@SearchUsingOR bit   = null ,

	@AdvertiserId int   = null ,

	@SiteId int   = null ,

	@AdvertiserAccountTypeId int   = null ,

	@AdvertiserBusinessTypeId int   = null ,

	@AdvertiserAccountStatusId int   = null ,

	@CompanyName nvarchar (510)  = null ,

	@BusinessNumber nvarchar (255)  = null ,

	@StreetAddress1 nvarchar (255)  = null ,

	@StreetAddress2 nvarchar (255)  = null ,

	@LastModified datetime   = null ,

	@LastModifiedBy int   = null ,

	@PostalAddress1 nvarchar (255)  = null ,

	@PostalAddress2 nvarchar (255)  = null ,

	@WebAddress varchar (255)  = null ,

	@NoOfEmployees varchar (10)  = null ,

	@FirstApprovedDate smalldatetime   = null ,

	@Profile ntext   = null ,

	@CharityNumber varchar (50)  = null ,

	@SearchField nvarchar (MAX)  = null ,

	@FreeTrialStartDate smalldatetime   = null ,

	@FreeTrialEndDate smalldatetime   = null ,

	@AccountsPayableEmail varchar (255)  = null ,

	@RequireLogonForExternalApplication bit   = null ,

	@AdvertiserLogo image   = null ,

	@LinkedInLogo varchar (255)  = null ,

	@LinkedInCompanyId varchar (255)  = null ,

	@LinkedInEmail varchar (255)  = null ,

	@RegisterDate datetime   = null ,

	@ExternalAdvertiserId varchar (50)  = null ,

	@VideoLink varchar (500)  = null ,

	@Industry varchar (100)  = null ,

	@NominatedCompanyRole varchar (500)  = null ,

	@NominatedCompanyFirstName varchar (510)  = null ,

	@NominatedCompanyLastName nvarchar (510)  = null ,

	@NominatedCompanyEmailAddress nvarchar (255)  = null ,

	@NominatedCompanyPhone varchar (40)  = null ,

	@PreferredContactMethod int   = null ,

	@AdvertiserLogoUrl nvarchar (1000)  = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [AdvertiserID]
	, [SiteID]
	, [AdvertiserAccountTypeID]
	, [AdvertiserBusinessTypeID]
	, [AdvertiserAccountStatusID]
	, [CompanyName]
	, [BusinessNumber]
	, [StreetAddress1]
	, [StreetAddress2]
	, [LastModified]
	, [LastModifiedBy]
	, [PostalAddress1]
	, [PostalAddress2]
	, [WebAddress]
	, [NoOfEmployees]
	, [FirstApprovedDate]
	, [Profile]
	, [CharityNumber]
	, [SearchField]
	, [FreeTrialStartDate]
	, [FreeTrialEndDate]
	, [AccountsPayableEmail]
	, [RequireLogonForExternalApplication]
	, [AdvertiserLogo]
	, [LinkedInLogo]
	, [LinkedInCompanyId]
	, [LinkedInEmail]
	, [RegisterDate]
	, [ExternalAdvertiserID]
	, [VideoLink]
	, [Industry]
	, [NominatedCompanyRole]
	, [NominatedCompanyFirstName]
	, [NominatedCompanyLastName]
	, [NominatedCompanyEmailAddress]
	, [NominatedCompanyPhone]
	, [PreferredContactMethod]
	, [AdvertiserLogoUrl]
    FROM
	[dbo].[Advertisers]
    WHERE 
	 ([AdvertiserID] = @AdvertiserId OR @AdvertiserId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([AdvertiserAccountTypeID] = @AdvertiserAccountTypeId OR @AdvertiserAccountTypeId IS NULL)
	AND ([AdvertiserBusinessTypeID] = @AdvertiserBusinessTypeId OR @AdvertiserBusinessTypeId IS NULL)
	AND ([AdvertiserAccountStatusID] = @AdvertiserAccountStatusId OR @AdvertiserAccountStatusId IS NULL)
	AND ([CompanyName] = @CompanyName OR @CompanyName IS NULL)
	AND ([BusinessNumber] = @BusinessNumber OR @BusinessNumber IS NULL)
	AND ([StreetAddress1] = @StreetAddress1 OR @StreetAddress1 IS NULL)
	AND ([StreetAddress2] = @StreetAddress2 OR @StreetAddress2 IS NULL)
	AND ([LastModified] = @LastModified OR @LastModified IS NULL)
	AND ([LastModifiedBy] = @LastModifiedBy OR @LastModifiedBy IS NULL)
	AND ([PostalAddress1] = @PostalAddress1 OR @PostalAddress1 IS NULL)
	AND ([PostalAddress2] = @PostalAddress2 OR @PostalAddress2 IS NULL)
	AND ([WebAddress] = @WebAddress OR @WebAddress IS NULL)
	AND ([NoOfEmployees] = @NoOfEmployees OR @NoOfEmployees IS NULL)
	AND ([FirstApprovedDate] = @FirstApprovedDate OR @FirstApprovedDate IS NULL)
	AND ([CharityNumber] = @CharityNumber OR @CharityNumber IS NULL)
	AND ([SearchField] = @SearchField OR @SearchField IS NULL)
	AND ([FreeTrialStartDate] = @FreeTrialStartDate OR @FreeTrialStartDate IS NULL)
	AND ([FreeTrialEndDate] = @FreeTrialEndDate OR @FreeTrialEndDate IS NULL)
	AND ([AccountsPayableEmail] = @AccountsPayableEmail OR @AccountsPayableEmail IS NULL)
	AND ([RequireLogonForExternalApplication] = @RequireLogonForExternalApplication OR @RequireLogonForExternalApplication IS NULL)
	AND ([LinkedInLogo] = @LinkedInLogo OR @LinkedInLogo IS NULL)
	AND ([LinkedInCompanyId] = @LinkedInCompanyId OR @LinkedInCompanyId IS NULL)
	AND ([LinkedInEmail] = @LinkedInEmail OR @LinkedInEmail IS NULL)
	AND ([RegisterDate] = @RegisterDate OR @RegisterDate IS NULL)
	AND ([ExternalAdvertiserID] = @ExternalAdvertiserId OR @ExternalAdvertiserId IS NULL)
	AND ([VideoLink] = @VideoLink OR @VideoLink IS NULL)
	AND ([Industry] = @Industry OR @Industry IS NULL)
	AND ([NominatedCompanyRole] = @NominatedCompanyRole OR @NominatedCompanyRole IS NULL)
	AND ([NominatedCompanyFirstName] = @NominatedCompanyFirstName OR @NominatedCompanyFirstName IS NULL)
	AND ([NominatedCompanyLastName] = @NominatedCompanyLastName OR @NominatedCompanyLastName IS NULL)
	AND ([NominatedCompanyEmailAddress] = @NominatedCompanyEmailAddress OR @NominatedCompanyEmailAddress IS NULL)
	AND ([NominatedCompanyPhone] = @NominatedCompanyPhone OR @NominatedCompanyPhone IS NULL)
	AND ([PreferredContactMethod] = @PreferredContactMethod OR @PreferredContactMethod IS NULL)
	AND ([AdvertiserLogoUrl] = @AdvertiserLogoUrl OR @AdvertiserLogoUrl IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [AdvertiserID]
	, [SiteID]
	, [AdvertiserAccountTypeID]
	, [AdvertiserBusinessTypeID]
	, [AdvertiserAccountStatusID]
	, [CompanyName]
	, [BusinessNumber]
	, [StreetAddress1]
	, [StreetAddress2]
	, [LastModified]
	, [LastModifiedBy]
	, [PostalAddress1]
	, [PostalAddress2]
	, [WebAddress]
	, [NoOfEmployees]
	, [FirstApprovedDate]
	, [Profile]
	, [CharityNumber]
	, [SearchField]
	, [FreeTrialStartDate]
	, [FreeTrialEndDate]
	, [AccountsPayableEmail]
	, [RequireLogonForExternalApplication]
	, [AdvertiserLogo]
	, [LinkedInLogo]
	, [LinkedInCompanyId]
	, [LinkedInEmail]
	, [RegisterDate]
	, [ExternalAdvertiserID]
	, [VideoLink]
	, [Industry]
	, [NominatedCompanyRole]
	, [NominatedCompanyFirstName]
	, [NominatedCompanyLastName]
	, [NominatedCompanyEmailAddress]
	, [NominatedCompanyPhone]
	, [PreferredContactMethod]
	, [AdvertiserLogoUrl]
    FROM
	[dbo].[Advertisers]
    WHERE 
	 ([AdvertiserID] = @AdvertiserId AND @AdvertiserId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([AdvertiserAccountTypeID] = @AdvertiserAccountTypeId AND @AdvertiserAccountTypeId is not null)
	OR ([AdvertiserBusinessTypeID] = @AdvertiserBusinessTypeId AND @AdvertiserBusinessTypeId is not null)
	OR ([AdvertiserAccountStatusID] = @AdvertiserAccountStatusId AND @AdvertiserAccountStatusId is not null)
	OR ([CompanyName] = @CompanyName AND @CompanyName is not null)
	OR ([BusinessNumber] = @BusinessNumber AND @BusinessNumber is not null)
	OR ([StreetAddress1] = @StreetAddress1 AND @StreetAddress1 is not null)
	OR ([StreetAddress2] = @StreetAddress2 AND @StreetAddress2 is not null)
	OR ([LastModified] = @LastModified AND @LastModified is not null)
	OR ([LastModifiedBy] = @LastModifiedBy AND @LastModifiedBy is not null)
	OR ([PostalAddress1] = @PostalAddress1 AND @PostalAddress1 is not null)
	OR ([PostalAddress2] = @PostalAddress2 AND @PostalAddress2 is not null)
	OR ([WebAddress] = @WebAddress AND @WebAddress is not null)
	OR ([NoOfEmployees] = @NoOfEmployees AND @NoOfEmployees is not null)
	OR ([FirstApprovedDate] = @FirstApprovedDate AND @FirstApprovedDate is not null)
	OR ([CharityNumber] = @CharityNumber AND @CharityNumber is not null)
	OR ([SearchField] = @SearchField AND @SearchField is not null)
	OR ([FreeTrialStartDate] = @FreeTrialStartDate AND @FreeTrialStartDate is not null)
	OR ([FreeTrialEndDate] = @FreeTrialEndDate AND @FreeTrialEndDate is not null)
	OR ([AccountsPayableEmail] = @AccountsPayableEmail AND @AccountsPayableEmail is not null)
	OR ([RequireLogonForExternalApplication] = @RequireLogonForExternalApplication AND @RequireLogonForExternalApplication is not null)
	OR ([LinkedInLogo] = @LinkedInLogo AND @LinkedInLogo is not null)
	OR ([LinkedInCompanyId] = @LinkedInCompanyId AND @LinkedInCompanyId is not null)
	OR ([LinkedInEmail] = @LinkedInEmail AND @LinkedInEmail is not null)
	OR ([RegisterDate] = @RegisterDate AND @RegisterDate is not null)
	OR ([ExternalAdvertiserID] = @ExternalAdvertiserId AND @ExternalAdvertiserId is not null)
	OR ([VideoLink] = @VideoLink AND @VideoLink is not null)
	OR ([Industry] = @Industry AND @Industry is not null)
	OR ([NominatedCompanyRole] = @NominatedCompanyRole AND @NominatedCompanyRole is not null)
	OR ([NominatedCompanyFirstName] = @NominatedCompanyFirstName AND @NominatedCompanyFirstName is not null)
	OR ([NominatedCompanyLastName] = @NominatedCompanyLastName AND @NominatedCompanyLastName is not null)
	OR ([NominatedCompanyEmailAddress] = @NominatedCompanyEmailAddress AND @NominatedCompanyEmailAddress is not null)
	OR ([NominatedCompanyPhone] = @NominatedCompanyPhone AND @NominatedCompanyPhone is not null)
	OR ([PreferredContactMethod] = @PreferredContactMethod AND @PreferredContactMethod is not null)
	OR ([AdvertiserLogoUrl] = @AdvertiserLogoUrl AND @AdvertiserLogoUrl is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPageFiles_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPageFiles_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPageFiles_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the DynamicPageFiles table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPageFiles_Get_List

AS


				
				SELECT
					[DynamicPageFileID],
					[SiteID],
					[PageName],
					[FileID]
				FROM
					[dbo].[DynamicPageFiles]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPageFiles_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPageFiles_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPageFiles_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the DynamicPageFiles table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPageFiles_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [DynamicPageFileID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([DynamicPageFileID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [DynamicPageFileID]'
				SET @SQL = @SQL + ' FROM [dbo].[DynamicPageFiles]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[DynamicPageFileID], O.[SiteID], O.[PageName], O.[FileID]
				FROM
				    [dbo].[DynamicPageFiles] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[DynamicPageFileID] = PageIndex.[DynamicPageFileID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[DynamicPageFiles]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPageFiles_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPageFiles_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPageFiles_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the DynamicPageFiles table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPageFiles_Insert
(

	@DynamicPageFileId int    OUTPUT,

	@SiteId int   ,

	@PageName varchar (255)  ,

	@FileId int   
)
AS


				
				INSERT INTO [dbo].[DynamicPageFiles]
					(
					[SiteID]
					,[PageName]
					,[FileID]
					)
				VALUES
					(
					@SiteId
					,@PageName
					,@FileId
					)
				
				-- Get the identity value
				SET @DynamicPageFileId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPageFiles_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPageFiles_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPageFiles_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the DynamicPageFiles table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPageFiles_Update
(

	@DynamicPageFileId int   ,

	@SiteId int   ,

	@PageName varchar (255)  ,

	@FileId int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[DynamicPageFiles]
				SET
					[SiteID] = @SiteId
					,[PageName] = @PageName
					,[FileID] = @FileId
				WHERE
[DynamicPageFileID] = @DynamicPageFileId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPageFiles_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPageFiles_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPageFiles_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the DynamicPageFiles table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPageFiles_Delete
(

	@DynamicPageFileId int   
)
AS


				DELETE FROM [dbo].[DynamicPageFiles] WITH (ROWLOCK) 
				WHERE
					[DynamicPageFileID] = @DynamicPageFileId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPageFiles_GetByFileId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPageFiles_GetByFileId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPageFiles_GetByFileId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the DynamicPageFiles table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPageFiles_GetByFileId
(

	@FileId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[DynamicPageFileID],
					[SiteID],
					[PageName],
					[FileID]
				FROM
					[dbo].[DynamicPageFiles]
				WHERE
					[FileID] = @FileId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPageFiles_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPageFiles_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPageFiles_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the DynamicPageFiles table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPageFiles_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[DynamicPageFileID],
					[SiteID],
					[PageName],
					[FileID]
				FROM
					[dbo].[DynamicPageFiles]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPageFiles_GetBySiteIdPageNameFileId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPageFiles_GetBySiteIdPageNameFileId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPageFiles_GetBySiteIdPageNameFileId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the DynamicPageFiles table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPageFiles_GetBySiteIdPageNameFileId
(

	@SiteId int   ,

	@PageName varchar (255)  ,

	@FileId int   
)
AS


				SELECT
					[DynamicPageFileID],
					[SiteID],
					[PageName],
					[FileID]
				FROM
					[dbo].[DynamicPageFiles]
				WHERE
					[SiteID] = @SiteId
					AND [PageName] = @PageName
					AND [FileID] = @FileId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPageFiles_GetByDynamicPageFileId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPageFiles_GetByDynamicPageFileId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPageFiles_GetByDynamicPageFileId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the DynamicPageFiles table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPageFiles_GetByDynamicPageFileId
(

	@DynamicPageFileId int   
)
AS


				SELECT
					[DynamicPageFileID],
					[SiteID],
					[PageName],
					[FileID]
				FROM
					[dbo].[DynamicPageFiles]
				WHERE
					[DynamicPageFileID] = @DynamicPageFileId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPageFiles_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPageFiles_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPageFiles_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the DynamicPageFiles table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPageFiles_Find
(

	@SearchUsingOR bit   = null ,

	@DynamicPageFileId int   = null ,

	@SiteId int   = null ,

	@PageName varchar (255)  = null ,

	@FileId int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [DynamicPageFileID]
	, [SiteID]
	, [PageName]
	, [FileID]
    FROM
	[dbo].[DynamicPageFiles]
    WHERE 
	 ([DynamicPageFileID] = @DynamicPageFileId OR @DynamicPageFileId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([PageName] = @PageName OR @PageName IS NULL)
	AND ([FileID] = @FileId OR @FileId IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [DynamicPageFileID]
	, [SiteID]
	, [PageName]
	, [FileID]
    FROM
	[dbo].[DynamicPageFiles]
    WHERE 
	 ([DynamicPageFileID] = @DynamicPageFileId AND @DynamicPageFileId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([PageName] = @PageName AND @PageName is not null)
	OR ([FileID] = @FileId AND @FileId is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPageWebPartTemplatesLink_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPageWebPartTemplatesLink_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPageWebPartTemplatesLink_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the DynamicPageWebPartTemplatesLink table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPageWebPartTemplatesLink_Get_List

AS


				
				SELECT
					[DynamicPageWebPartTemplatesLinkID],
					[DynamicPageWebPartTemplateID],
					[SiteWebPartID],
					[Sequence]
				FROM
					[dbo].[DynamicPageWebPartTemplatesLink]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPageWebPartTemplatesLink_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPageWebPartTemplatesLink_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPageWebPartTemplatesLink_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the DynamicPageWebPartTemplatesLink table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPageWebPartTemplatesLink_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [DynamicPageWebPartTemplatesLinkID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([DynamicPageWebPartTemplatesLinkID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [DynamicPageWebPartTemplatesLinkID]'
				SET @SQL = @SQL + ' FROM [dbo].[DynamicPageWebPartTemplatesLink]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[DynamicPageWebPartTemplatesLinkID], O.[DynamicPageWebPartTemplateID], O.[SiteWebPartID], O.[Sequence]
				FROM
				    [dbo].[DynamicPageWebPartTemplatesLink] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[DynamicPageWebPartTemplatesLinkID] = PageIndex.[DynamicPageWebPartTemplatesLinkID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[DynamicPageWebPartTemplatesLink]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPageWebPartTemplatesLink_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPageWebPartTemplatesLink_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPageWebPartTemplatesLink_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the DynamicPageWebPartTemplatesLink table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPageWebPartTemplatesLink_Insert
(

	@DynamicPageWebPartTemplatesLinkId int    OUTPUT,

	@DynamicPageWebPartTemplateId int   ,

	@SiteWebPartId int   ,

	@Sequence int   
)
AS


				
				INSERT INTO [dbo].[DynamicPageWebPartTemplatesLink]
					(
					[DynamicPageWebPartTemplateID]
					,[SiteWebPartID]
					,[Sequence]
					)
				VALUES
					(
					@DynamicPageWebPartTemplateId
					,@SiteWebPartId
					,@Sequence
					)
				
				-- Get the identity value
				SET @DynamicPageWebPartTemplatesLinkId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPageWebPartTemplatesLink_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPageWebPartTemplatesLink_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPageWebPartTemplatesLink_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the DynamicPageWebPartTemplatesLink table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPageWebPartTemplatesLink_Update
(

	@DynamicPageWebPartTemplatesLinkId int   ,

	@DynamicPageWebPartTemplateId int   ,

	@SiteWebPartId int   ,

	@Sequence int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[DynamicPageWebPartTemplatesLink]
				SET
					[DynamicPageWebPartTemplateID] = @DynamicPageWebPartTemplateId
					,[SiteWebPartID] = @SiteWebPartId
					,[Sequence] = @Sequence
				WHERE
[DynamicPageWebPartTemplatesLinkID] = @DynamicPageWebPartTemplatesLinkId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPageWebPartTemplatesLink_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPageWebPartTemplatesLink_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPageWebPartTemplatesLink_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the DynamicPageWebPartTemplatesLink table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPageWebPartTemplatesLink_Delete
(

	@DynamicPageWebPartTemplatesLinkId int   
)
AS


				DELETE FROM [dbo].[DynamicPageWebPartTemplatesLink] WITH (ROWLOCK) 
				WHERE
					[DynamicPageWebPartTemplatesLinkID] = @DynamicPageWebPartTemplatesLinkId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPageWebPartTemplatesLink_GetByDynamicPageWebPartTemplateId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPageWebPartTemplatesLink_GetByDynamicPageWebPartTemplateId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPageWebPartTemplatesLink_GetByDynamicPageWebPartTemplateId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the DynamicPageWebPartTemplatesLink table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPageWebPartTemplatesLink_GetByDynamicPageWebPartTemplateId
(

	@DynamicPageWebPartTemplateId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[DynamicPageWebPartTemplatesLinkID],
					[DynamicPageWebPartTemplateID],
					[SiteWebPartID],
					[Sequence]
				FROM
					[dbo].[DynamicPageWebPartTemplatesLink]
				WHERE
					[DynamicPageWebPartTemplateID] = @DynamicPageWebPartTemplateId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPageWebPartTemplatesLink_GetBySiteWebPartId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPageWebPartTemplatesLink_GetBySiteWebPartId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPageWebPartTemplatesLink_GetBySiteWebPartId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the DynamicPageWebPartTemplatesLink table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPageWebPartTemplatesLink_GetBySiteWebPartId
(

	@SiteWebPartId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[DynamicPageWebPartTemplatesLinkID],
					[DynamicPageWebPartTemplateID],
					[SiteWebPartID],
					[Sequence]
				FROM
					[dbo].[DynamicPageWebPartTemplatesLink]
				WHERE
					[SiteWebPartID] = @SiteWebPartId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPageWebPartTemplatesLink_GetByDynamicPageWebPartTemplateIdSiteWebPartId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPageWebPartTemplatesLink_GetByDynamicPageWebPartTemplateIdSiteWebPartId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPageWebPartTemplatesLink_GetByDynamicPageWebPartTemplateIdSiteWebPartId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the DynamicPageWebPartTemplatesLink table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPageWebPartTemplatesLink_GetByDynamicPageWebPartTemplateIdSiteWebPartId
(

	@DynamicPageWebPartTemplateId int   ,

	@SiteWebPartId int   
)
AS


				SELECT
					[DynamicPageWebPartTemplatesLinkID],
					[DynamicPageWebPartTemplateID],
					[SiteWebPartID],
					[Sequence]
				FROM
					[dbo].[DynamicPageWebPartTemplatesLink]
				WHERE
					[DynamicPageWebPartTemplateID] = @DynamicPageWebPartTemplateId
					AND [SiteWebPartID] = @SiteWebPartId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPageWebPartTemplatesLink_GetByDynamicPageWebPartTemplatesLinkId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPageWebPartTemplatesLink_GetByDynamicPageWebPartTemplatesLinkId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPageWebPartTemplatesLink_GetByDynamicPageWebPartTemplatesLinkId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the DynamicPageWebPartTemplatesLink table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPageWebPartTemplatesLink_GetByDynamicPageWebPartTemplatesLinkId
(

	@DynamicPageWebPartTemplatesLinkId int   
)
AS


				SELECT
					[DynamicPageWebPartTemplatesLinkID],
					[DynamicPageWebPartTemplateID],
					[SiteWebPartID],
					[Sequence]
				FROM
					[dbo].[DynamicPageWebPartTemplatesLink]
				WHERE
					[DynamicPageWebPartTemplatesLinkID] = @DynamicPageWebPartTemplatesLinkId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPageWebPartTemplatesLink_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPageWebPartTemplatesLink_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPageWebPartTemplatesLink_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the DynamicPageWebPartTemplatesLink table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPageWebPartTemplatesLink_Find
(

	@SearchUsingOR bit   = null ,

	@DynamicPageWebPartTemplatesLinkId int   = null ,

	@DynamicPageWebPartTemplateId int   = null ,

	@SiteWebPartId int   = null ,

	@Sequence int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [DynamicPageWebPartTemplatesLinkID]
	, [DynamicPageWebPartTemplateID]
	, [SiteWebPartID]
	, [Sequence]
    FROM
	[dbo].[DynamicPageWebPartTemplatesLink]
    WHERE 
	 ([DynamicPageWebPartTemplatesLinkID] = @DynamicPageWebPartTemplatesLinkId OR @DynamicPageWebPartTemplatesLinkId IS NULL)
	AND ([DynamicPageWebPartTemplateID] = @DynamicPageWebPartTemplateId OR @DynamicPageWebPartTemplateId IS NULL)
	AND ([SiteWebPartID] = @SiteWebPartId OR @SiteWebPartId IS NULL)
	AND ([Sequence] = @Sequence OR @Sequence IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [DynamicPageWebPartTemplatesLinkID]
	, [DynamicPageWebPartTemplateID]
	, [SiteWebPartID]
	, [Sequence]
    FROM
	[dbo].[DynamicPageWebPartTemplatesLink]
    WHERE 
	 ([DynamicPageWebPartTemplatesLinkID] = @DynamicPageWebPartTemplatesLinkId AND @DynamicPageWebPartTemplatesLinkId is not null)
	OR ([DynamicPageWebPartTemplateID] = @DynamicPageWebPartTemplateId AND @DynamicPageWebPartTemplateId is not null)
	OR ([SiteWebPartID] = @SiteWebPartId AND @SiteWebPartId is not null)
	OR ([Sequence] = @Sequence AND @Sequence is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPages_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPages_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPages_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the DynamicPages table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPages_Get_List

AS


				
				SELECT
					[DynamicPageID],
					[SiteID],
					[LanguageID],
					[ParentDynamicPageID],
					[PageName],
					[PageTitle],
					[PageContent],
					[DynamicPageWebPartTemplateID],
					[HyperLink],
					[Valid],
					[OpenInNewWindow],
					[Sequence],
					[FullScreen],
					[OnTopNav],
					[OnLeftNav],
					[OnBottomNav],
					[OnSiteMap],
					[Searchable],
					[MetaKeywords],
					[MetaDescription],
					[PageFriendlyName],
					[LastModified],
					[LastModifiedBy],
					[SearchField],
					[SourceID],
					[Secured],
					[CustomUrl],
					[MetaTitle],
					[GenerateBreadcrumb],
					[PublishOn],
					[Visible]
				FROM
					[dbo].[DynamicPages]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPages_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPages_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPages_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the DynamicPages table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPages_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [DynamicPageID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([DynamicPageID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [DynamicPageID]'
				SET @SQL = @SQL + ' FROM [dbo].[DynamicPages]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[DynamicPageID], O.[SiteID], O.[LanguageID], O.[ParentDynamicPageID], O.[PageName], O.[PageTitle], O.[PageContent], O.[DynamicPageWebPartTemplateID], O.[HyperLink], O.[Valid], O.[OpenInNewWindow], O.[Sequence], O.[FullScreen], O.[OnTopNav], O.[OnLeftNav], O.[OnBottomNav], O.[OnSiteMap], O.[Searchable], O.[MetaKeywords], O.[MetaDescription], O.[PageFriendlyName], O.[LastModified], O.[LastModifiedBy], O.[SearchField], O.[SourceID], O.[Secured], O.[CustomUrl], O.[MetaTitle], O.[GenerateBreadcrumb], O.[PublishOn], O.[Visible]
				FROM
				    [dbo].[DynamicPages] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[DynamicPageID] = PageIndex.[DynamicPageID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[DynamicPages]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPages_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPages_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPages_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the DynamicPages table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPages_Insert
(

	@DynamicPageId int    OUTPUT,

	@SiteId int   ,

	@LanguageId int   ,

	@ParentDynamicPageId int   ,

	@PageName varchar (255)  ,

	@PageTitle nvarchar (510)  ,

	@PageContent ntext   ,

	@DynamicPageWebPartTemplateId int   ,

	@HyperLink varchar (255)  ,

	@Valid bit   ,

	@OpenInNewWindow bit   ,

	@Sequence int   ,

	@FullScreen bit   ,

	@OnTopNav bit   ,

	@OnLeftNav bit   ,

	@OnBottomNav bit   ,

	@OnSiteMap bit   ,

	@Searchable bit   ,

	@MetaKeywords nvarchar (510)  ,

	@MetaDescription nvarchar (1024)  ,

	@PageFriendlyName varchar (255)  ,

	@LastModified datetime   ,

	@LastModifiedBy int   ,

	@SearchField nvarchar (MAX)  ,

	@SourceId int   ,

	@Secured bit   ,

	@CustomUrl varchar (512)  ,

	@MetaTitle nvarchar (510)  ,

	@GenerateBreadcrumb bit   ,

	@PublishOn datetime   ,

	@Visible bit   
)
AS


				
				INSERT INTO [dbo].[DynamicPages]
					(
					[SiteID]
					,[LanguageID]
					,[ParentDynamicPageID]
					,[PageName]
					,[PageTitle]
					,[PageContent]
					,[DynamicPageWebPartTemplateID]
					,[HyperLink]
					,[Valid]
					,[OpenInNewWindow]
					,[Sequence]
					,[FullScreen]
					,[OnTopNav]
					,[OnLeftNav]
					,[OnBottomNav]
					,[OnSiteMap]
					,[Searchable]
					,[MetaKeywords]
					,[MetaDescription]
					,[PageFriendlyName]
					,[LastModified]
					,[LastModifiedBy]
					,[SearchField]
					,[SourceID]
					,[Secured]
					,[CustomUrl]
					,[MetaTitle]
					,[GenerateBreadcrumb]
					,[PublishOn]
					,[Visible]
					)
				VALUES
					(
					@SiteId
					,@LanguageId
					,@ParentDynamicPageId
					,@PageName
					,@PageTitle
					,@PageContent
					,@DynamicPageWebPartTemplateId
					,@HyperLink
					,@Valid
					,@OpenInNewWindow
					,@Sequence
					,@FullScreen
					,@OnTopNav
					,@OnLeftNav
					,@OnBottomNav
					,@OnSiteMap
					,@Searchable
					,@MetaKeywords
					,@MetaDescription
					,@PageFriendlyName
					,@LastModified
					,@LastModifiedBy
					,@SearchField
					,@SourceId
					,@Secured
					,@CustomUrl
					,@MetaTitle
					,@GenerateBreadcrumb
					,@PublishOn
					,@Visible
					)
				
				-- Get the identity value
				SET @DynamicPageId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPages_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPages_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPages_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the DynamicPages table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPages_Update
(

	@DynamicPageId int   ,

	@SiteId int   ,

	@LanguageId int   ,

	@ParentDynamicPageId int   ,

	@PageName varchar (255)  ,

	@PageTitle nvarchar (510)  ,

	@PageContent ntext   ,

	@DynamicPageWebPartTemplateId int   ,

	@HyperLink varchar (255)  ,

	@Valid bit   ,

	@OpenInNewWindow bit   ,

	@Sequence int   ,

	@FullScreen bit   ,

	@OnTopNav bit   ,

	@OnLeftNav bit   ,

	@OnBottomNav bit   ,

	@OnSiteMap bit   ,

	@Searchable bit   ,

	@MetaKeywords nvarchar (510)  ,

	@MetaDescription nvarchar (1024)  ,

	@PageFriendlyName varchar (255)  ,

	@LastModified datetime   ,

	@LastModifiedBy int   ,

	@SearchField nvarchar (MAX)  ,

	@SourceId int   ,

	@Secured bit   ,

	@CustomUrl varchar (512)  ,

	@MetaTitle nvarchar (510)  ,

	@GenerateBreadcrumb bit   ,

	@PublishOn datetime   ,

	@Visible bit   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[DynamicPages]
				SET
					[SiteID] = @SiteId
					,[LanguageID] = @LanguageId
					,[ParentDynamicPageID] = @ParentDynamicPageId
					,[PageName] = @PageName
					,[PageTitle] = @PageTitle
					,[PageContent] = @PageContent
					,[DynamicPageWebPartTemplateID] = @DynamicPageWebPartTemplateId
					,[HyperLink] = @HyperLink
					,[Valid] = @Valid
					,[OpenInNewWindow] = @OpenInNewWindow
					,[Sequence] = @Sequence
					,[FullScreen] = @FullScreen
					,[OnTopNav] = @OnTopNav
					,[OnLeftNav] = @OnLeftNav
					,[OnBottomNav] = @OnBottomNav
					,[OnSiteMap] = @OnSiteMap
					,[Searchable] = @Searchable
					,[MetaKeywords] = @MetaKeywords
					,[MetaDescription] = @MetaDescription
					,[PageFriendlyName] = @PageFriendlyName
					,[LastModified] = @LastModified
					,[LastModifiedBy] = @LastModifiedBy
					,[SearchField] = @SearchField
					,[SourceID] = @SourceId
					,[Secured] = @Secured
					,[CustomUrl] = @CustomUrl
					,[MetaTitle] = @MetaTitle
					,[GenerateBreadcrumb] = @GenerateBreadcrumb
					,[PublishOn] = @PublishOn
					,[Visible] = @Visible
				WHERE
[DynamicPageID] = @DynamicPageId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPages_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPages_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPages_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the DynamicPages table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPages_Delete
(

	@DynamicPageId int   
)
AS


				DELETE FROM [dbo].[DynamicPages] WITH (ROWLOCK) 
				WHERE
					[DynamicPageID] = @DynamicPageId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPages_GetByDynamicPageWebPartTemplateId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPages_GetByDynamicPageWebPartTemplateId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPages_GetByDynamicPageWebPartTemplateId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the DynamicPages table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPages_GetByDynamicPageWebPartTemplateId
(

	@DynamicPageWebPartTemplateId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[DynamicPageID],
					[SiteID],
					[LanguageID],
					[ParentDynamicPageID],
					[PageName],
					[PageTitle],
					[PageContent],
					[DynamicPageWebPartTemplateID],
					[HyperLink],
					[Valid],
					[OpenInNewWindow],
					[Sequence],
					[FullScreen],
					[OnTopNav],
					[OnLeftNav],
					[OnBottomNav],
					[OnSiteMap],
					[Searchable],
					[MetaKeywords],
					[MetaDescription],
					[PageFriendlyName],
					[LastModified],
					[LastModifiedBy],
					[SearchField],
					[SourceID],
					[Secured],
					[CustomUrl],
					[MetaTitle],
					[GenerateBreadcrumb],
					[PublishOn],
					[Visible]
				FROM
					[dbo].[DynamicPages]
				WHERE
					[DynamicPageWebPartTemplateID] = @DynamicPageWebPartTemplateId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPages_GetByLanguageId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPages_GetByLanguageId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPages_GetByLanguageId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the DynamicPages table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPages_GetByLanguageId
(

	@LanguageId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[DynamicPageID],
					[SiteID],
					[LanguageID],
					[ParentDynamicPageID],
					[PageName],
					[PageTitle],
					[PageContent],
					[DynamicPageWebPartTemplateID],
					[HyperLink],
					[Valid],
					[OpenInNewWindow],
					[Sequence],
					[FullScreen],
					[OnTopNav],
					[OnLeftNav],
					[OnBottomNav],
					[OnSiteMap],
					[Searchable],
					[MetaKeywords],
					[MetaDescription],
					[PageFriendlyName],
					[LastModified],
					[LastModifiedBy],
					[SearchField],
					[SourceID],
					[Secured],
					[CustomUrl],
					[MetaTitle],
					[GenerateBreadcrumb],
					[PublishOn],
					[Visible]
				FROM
					[dbo].[DynamicPages]
				WHERE
					[LanguageID] = @LanguageId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPages_GetByLastModifiedBy procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPages_GetByLastModifiedBy') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPages_GetByLastModifiedBy
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the DynamicPages table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPages_GetByLastModifiedBy
(

	@LastModifiedBy int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[DynamicPageID],
					[SiteID],
					[LanguageID],
					[ParentDynamicPageID],
					[PageName],
					[PageTitle],
					[PageContent],
					[DynamicPageWebPartTemplateID],
					[HyperLink],
					[Valid],
					[OpenInNewWindow],
					[Sequence],
					[FullScreen],
					[OnTopNav],
					[OnLeftNav],
					[OnBottomNav],
					[OnSiteMap],
					[Searchable],
					[MetaKeywords],
					[MetaDescription],
					[PageFriendlyName],
					[LastModified],
					[LastModifiedBy],
					[SearchField],
					[SourceID],
					[Secured],
					[CustomUrl],
					[MetaTitle],
					[GenerateBreadcrumb],
					[PublishOn],
					[Visible]
				FROM
					[dbo].[DynamicPages]
				WHERE
					[LastModifiedBy] = @LastModifiedBy
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPages_GetByLastModifiedBy procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPages_GetByLastModifiedBy') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPages_GetByLastModifiedBy
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the DynamicPages table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPages_GetByLastModifiedBy
(

	@LastModifiedBy int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[DynamicPageID],
					[SiteID],
					[LanguageID],
					[ParentDynamicPageID],
					[PageName],
					[PageTitle],
					[PageContent],
					[DynamicPageWebPartTemplateID],
					[HyperLink],
					[Valid],
					[OpenInNewWindow],
					[Sequence],
					[FullScreen],
					[OnTopNav],
					[OnLeftNav],
					[OnBottomNav],
					[OnSiteMap],
					[Searchable],
					[MetaKeywords],
					[MetaDescription],
					[PageFriendlyName],
					[LastModified],
					[LastModifiedBy],
					[SearchField],
					[SourceID],
					[Secured],
					[CustomUrl],
					[MetaTitle],
					[GenerateBreadcrumb],
					[PublishOn],
					[Visible]
				FROM
					[dbo].[DynamicPages]
				WHERE
					[LastModifiedBy] = @LastModifiedBy
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPages_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPages_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPages_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the DynamicPages table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPages_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[DynamicPageID],
					[SiteID],
					[LanguageID],
					[ParentDynamicPageID],
					[PageName],
					[PageTitle],
					[PageContent],
					[DynamicPageWebPartTemplateID],
					[HyperLink],
					[Valid],
					[OpenInNewWindow],
					[Sequence],
					[FullScreen],
					[OnTopNav],
					[OnLeftNav],
					[OnBottomNav],
					[OnSiteMap],
					[Searchable],
					[MetaKeywords],
					[MetaDescription],
					[PageFriendlyName],
					[LastModified],
					[LastModifiedBy],
					[SearchField],
					[SourceID],
					[Secured],
					[CustomUrl],
					[MetaTitle],
					[GenerateBreadcrumb],
					[PublishOn],
					[Visible]
				FROM
					[dbo].[DynamicPages]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPages_GetBySiteIdPageNameLanguageId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPages_GetBySiteIdPageNameLanguageId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPages_GetBySiteIdPageNameLanguageId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the DynamicPages table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPages_GetBySiteIdPageNameLanguageId
(

	@SiteId int   ,

	@PageName varchar (255)  ,

	@LanguageId int   
)
AS


				SELECT
					[DynamicPageID],
					[SiteID],
					[LanguageID],
					[ParentDynamicPageID],
					[PageName],
					[PageTitle],
					[PageContent],
					[DynamicPageWebPartTemplateID],
					[HyperLink],
					[Valid],
					[OpenInNewWindow],
					[Sequence],
					[FullScreen],
					[OnTopNav],
					[OnLeftNav],
					[OnBottomNav],
					[OnSiteMap],
					[Searchable],
					[MetaKeywords],
					[MetaDescription],
					[PageFriendlyName],
					[LastModified],
					[LastModifiedBy],
					[SearchField],
					[SourceID],
					[Secured],
					[CustomUrl],
					[MetaTitle],
					[GenerateBreadcrumb],
					[PublishOn],
					[Visible]
				FROM
					[dbo].[DynamicPages]
				WHERE
					[SiteID] = @SiteId
					AND [PageName] = @PageName
					AND [LanguageID] = @LanguageId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPages_GetBySiteIdLanguageIdPageFriendlyName procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPages_GetBySiteIdLanguageIdPageFriendlyName') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPages_GetBySiteIdLanguageIdPageFriendlyName
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the DynamicPages table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPages_GetBySiteIdLanguageIdPageFriendlyName
(

	@SiteId int   ,

	@LanguageId int   ,

	@PageFriendlyName varchar (255)  
)
AS


				SELECT
					[DynamicPageID],
					[SiteID],
					[LanguageID],
					[ParentDynamicPageID],
					[PageName],
					[PageTitle],
					[PageContent],
					[DynamicPageWebPartTemplateID],
					[HyperLink],
					[Valid],
					[OpenInNewWindow],
					[Sequence],
					[FullScreen],
					[OnTopNav],
					[OnLeftNav],
					[OnBottomNav],
					[OnSiteMap],
					[Searchable],
					[MetaKeywords],
					[MetaDescription],
					[PageFriendlyName],
					[LastModified],
					[LastModifiedBy],
					[SearchField],
					[SourceID],
					[Secured],
					[CustomUrl],
					[MetaTitle],
					[GenerateBreadcrumb],
					[PublishOn],
					[Visible]
				FROM
					[dbo].[DynamicPages]
				WHERE
					[SiteID] = @SiteId
					AND [LanguageID] = @LanguageId
					AND [PageFriendlyName] = @PageFriendlyName
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPages_GetByDynamicPageId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPages_GetByDynamicPageId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPages_GetByDynamicPageId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the DynamicPages table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPages_GetByDynamicPageId
(

	@DynamicPageId int   
)
AS


				SELECT
					[DynamicPageID],
					[SiteID],
					[LanguageID],
					[ParentDynamicPageID],
					[PageName],
					[PageTitle],
					[PageContent],
					[DynamicPageWebPartTemplateID],
					[HyperLink],
					[Valid],
					[OpenInNewWindow],
					[Sequence],
					[FullScreen],
					[OnTopNav],
					[OnLeftNav],
					[OnBottomNav],
					[OnSiteMap],
					[Searchable],
					[MetaKeywords],
					[MetaDescription],
					[PageFriendlyName],
					[LastModified],
					[LastModifiedBy],
					[SearchField],
					[SourceID],
					[Secured],
					[CustomUrl],
					[MetaTitle],
					[GenerateBreadcrumb],
					[PublishOn],
					[Visible]
				FROM
					[dbo].[DynamicPages]
				WHERE
					[DynamicPageID] = @DynamicPageId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPages_GetByRelatedDynamicPageIdFromRelatedDynamicPages procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPages_GetByRelatedDynamicPageIdFromRelatedDynamicPages') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPages_GetByRelatedDynamicPageIdFromRelatedDynamicPages
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records through a junction table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPages_GetByRelatedDynamicPageIdFromRelatedDynamicPages
(

	@RelatedDynamicPageId int   
)
AS


SELECT dbo.[DynamicPages].[DynamicPageID]
       ,dbo.[DynamicPages].[SiteID]
       ,dbo.[DynamicPages].[LanguageID]
       ,dbo.[DynamicPages].[ParentDynamicPageID]
       ,dbo.[DynamicPages].[PageName]
       ,dbo.[DynamicPages].[PageTitle]
       ,dbo.[DynamicPages].[PageContent]
       ,dbo.[DynamicPages].[DynamicPageWebPartTemplateID]
       ,dbo.[DynamicPages].[HyperLink]
       ,dbo.[DynamicPages].[Valid]
       ,dbo.[DynamicPages].[OpenInNewWindow]
       ,dbo.[DynamicPages].[Sequence]
       ,dbo.[DynamicPages].[FullScreen]
       ,dbo.[DynamicPages].[OnTopNav]
       ,dbo.[DynamicPages].[OnLeftNav]
       ,dbo.[DynamicPages].[OnBottomNav]
       ,dbo.[DynamicPages].[OnSiteMap]
       ,dbo.[DynamicPages].[Searchable]
       ,dbo.[DynamicPages].[MetaKeywords]
       ,dbo.[DynamicPages].[MetaDescription]
       ,dbo.[DynamicPages].[PageFriendlyName]
       ,dbo.[DynamicPages].[LastModified]
       ,dbo.[DynamicPages].[LastModifiedBy]
       ,dbo.[DynamicPages].[SearchField]
       ,dbo.[DynamicPages].[SourceID]
       ,dbo.[DynamicPages].[Secured]
       ,dbo.[DynamicPages].[CustomUrl]
       ,dbo.[DynamicPages].[MetaTitle]
       ,dbo.[DynamicPages].[GenerateBreadcrumb]
       ,dbo.[DynamicPages].[PublishOn]
       ,dbo.[DynamicPages].[Visible]
  FROM dbo.[DynamicPages]
 WHERE EXISTS (SELECT 1
                 FROM dbo.[RelatedDynamicPages] 
                WHERE dbo.[RelatedDynamicPages].[RelatedDynamicPageID] = @RelatedDynamicPageId
                  AND dbo.[RelatedDynamicPages].[DynamicPageID] = dbo.[DynamicPages].[DynamicPageID]
                  )
				SELECT @@ROWCOUNT			
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPages_GetByDynamicPageIdFromRelatedDynamicPages procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPages_GetByDynamicPageIdFromRelatedDynamicPages') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPages_GetByDynamicPageIdFromRelatedDynamicPages
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records through a junction table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPages_GetByDynamicPageIdFromRelatedDynamicPages
(

	@DynamicPageId int   
)
AS


SELECT dbo.[DynamicPages].[DynamicPageID]
       ,dbo.[DynamicPages].[SiteID]
       ,dbo.[DynamicPages].[LanguageID]
       ,dbo.[DynamicPages].[ParentDynamicPageID]
       ,dbo.[DynamicPages].[PageName]
       ,dbo.[DynamicPages].[PageTitle]
       ,dbo.[DynamicPages].[PageContent]
       ,dbo.[DynamicPages].[DynamicPageWebPartTemplateID]
       ,dbo.[DynamicPages].[HyperLink]
       ,dbo.[DynamicPages].[Valid]
       ,dbo.[DynamicPages].[OpenInNewWindow]
       ,dbo.[DynamicPages].[Sequence]
       ,dbo.[DynamicPages].[FullScreen]
       ,dbo.[DynamicPages].[OnTopNav]
       ,dbo.[DynamicPages].[OnLeftNav]
       ,dbo.[DynamicPages].[OnBottomNav]
       ,dbo.[DynamicPages].[OnSiteMap]
       ,dbo.[DynamicPages].[Searchable]
       ,dbo.[DynamicPages].[MetaKeywords]
       ,dbo.[DynamicPages].[MetaDescription]
       ,dbo.[DynamicPages].[PageFriendlyName]
       ,dbo.[DynamicPages].[LastModified]
       ,dbo.[DynamicPages].[LastModifiedBy]
       ,dbo.[DynamicPages].[SearchField]
       ,dbo.[DynamicPages].[SourceID]
       ,dbo.[DynamicPages].[Secured]
       ,dbo.[DynamicPages].[CustomUrl]
       ,dbo.[DynamicPages].[MetaTitle]
       ,dbo.[DynamicPages].[GenerateBreadcrumb]
       ,dbo.[DynamicPages].[PublishOn]
       ,dbo.[DynamicPages].[Visible]
  FROM dbo.[DynamicPages]
 WHERE EXISTS (SELECT 1
                 FROM dbo.[RelatedDynamicPages] 
                WHERE dbo.[RelatedDynamicPages].[DynamicPageID] = @DynamicPageId
                  AND dbo.[RelatedDynamicPages].[RelatedDynamicPageID] = dbo.[DynamicPages].[DynamicPageID]
                  )
				SELECT @@ROWCOUNT			
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicPages_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicPages_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicPages_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the DynamicPages table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicPages_Find
(

	@SearchUsingOR bit   = null ,

	@DynamicPageId int   = null ,

	@SiteId int   = null ,

	@LanguageId int   = null ,

	@ParentDynamicPageId int   = null ,

	@PageName varchar (255)  = null ,

	@PageTitle nvarchar (510)  = null ,

	@PageContent ntext   = null ,

	@DynamicPageWebPartTemplateId int   = null ,

	@HyperLink varchar (255)  = null ,

	@Valid bit   = null ,

	@OpenInNewWindow bit   = null ,

	@Sequence int   = null ,

	@FullScreen bit   = null ,

	@OnTopNav bit   = null ,

	@OnLeftNav bit   = null ,

	@OnBottomNav bit   = null ,

	@OnSiteMap bit   = null ,

	@Searchable bit   = null ,

	@MetaKeywords nvarchar (510)  = null ,

	@MetaDescription nvarchar (1024)  = null ,

	@PageFriendlyName varchar (255)  = null ,

	@LastModified datetime   = null ,

	@LastModifiedBy int   = null ,

	@SearchField nvarchar (MAX)  = null ,

	@SourceId int   = null ,

	@Secured bit   = null ,

	@CustomUrl varchar (512)  = null ,

	@MetaTitle nvarchar (510)  = null ,

	@GenerateBreadcrumb bit   = null ,

	@PublishOn datetime   = null ,

	@Visible bit   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [DynamicPageID]
	, [SiteID]
	, [LanguageID]
	, [ParentDynamicPageID]
	, [PageName]
	, [PageTitle]
	, [PageContent]
	, [DynamicPageWebPartTemplateID]
	, [HyperLink]
	, [Valid]
	, [OpenInNewWindow]
	, [Sequence]
	, [FullScreen]
	, [OnTopNav]
	, [OnLeftNav]
	, [OnBottomNav]
	, [OnSiteMap]
	, [Searchable]
	, [MetaKeywords]
	, [MetaDescription]
	, [PageFriendlyName]
	, [LastModified]
	, [LastModifiedBy]
	, [SearchField]
	, [SourceID]
	, [Secured]
	, [CustomUrl]
	, [MetaTitle]
	, [GenerateBreadcrumb]
	, [PublishOn]
	, [Visible]
    FROM
	[dbo].[DynamicPages]
    WHERE 
	 ([DynamicPageID] = @DynamicPageId OR @DynamicPageId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([LanguageID] = @LanguageId OR @LanguageId IS NULL)
	AND ([ParentDynamicPageID] = @ParentDynamicPageId OR @ParentDynamicPageId IS NULL)
	AND ([PageName] = @PageName OR @PageName IS NULL)
	AND ([PageTitle] = @PageTitle OR @PageTitle IS NULL)
	AND ([DynamicPageWebPartTemplateID] = @DynamicPageWebPartTemplateId OR @DynamicPageWebPartTemplateId IS NULL)
	AND ([HyperLink] = @HyperLink OR @HyperLink IS NULL)
	AND ([Valid] = @Valid OR @Valid IS NULL)
	AND ([OpenInNewWindow] = @OpenInNewWindow OR @OpenInNewWindow IS NULL)
	AND ([Sequence] = @Sequence OR @Sequence IS NULL)
	AND ([FullScreen] = @FullScreen OR @FullScreen IS NULL)
	AND ([OnTopNav] = @OnTopNav OR @OnTopNav IS NULL)
	AND ([OnLeftNav] = @OnLeftNav OR @OnLeftNav IS NULL)
	AND ([OnBottomNav] = @OnBottomNav OR @OnBottomNav IS NULL)
	AND ([OnSiteMap] = @OnSiteMap OR @OnSiteMap IS NULL)
	AND ([Searchable] = @Searchable OR @Searchable IS NULL)
	AND ([MetaKeywords] = @MetaKeywords OR @MetaKeywords IS NULL)
	AND ([MetaDescription] = @MetaDescription OR @MetaDescription IS NULL)
	AND ([PageFriendlyName] = @PageFriendlyName OR @PageFriendlyName IS NULL)
	AND ([LastModified] = @LastModified OR @LastModified IS NULL)
	AND ([LastModifiedBy] = @LastModifiedBy OR @LastModifiedBy IS NULL)
	AND ([SearchField] = @SearchField OR @SearchField IS NULL)
	AND ([SourceID] = @SourceId OR @SourceId IS NULL)
	AND ([Secured] = @Secured OR @Secured IS NULL)
	AND ([CustomUrl] = @CustomUrl OR @CustomUrl IS NULL)
	AND ([MetaTitle] = @MetaTitle OR @MetaTitle IS NULL)
	AND ([GenerateBreadcrumb] = @GenerateBreadcrumb OR @GenerateBreadcrumb IS NULL)
	AND ([PublishOn] = @PublishOn OR @PublishOn IS NULL)
	AND ([Visible] = @Visible OR @Visible IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [DynamicPageID]
	, [SiteID]
	, [LanguageID]
	, [ParentDynamicPageID]
	, [PageName]
	, [PageTitle]
	, [PageContent]
	, [DynamicPageWebPartTemplateID]
	, [HyperLink]
	, [Valid]
	, [OpenInNewWindow]
	, [Sequence]
	, [FullScreen]
	, [OnTopNav]
	, [OnLeftNav]
	, [OnBottomNav]
	, [OnSiteMap]
	, [Searchable]
	, [MetaKeywords]
	, [MetaDescription]
	, [PageFriendlyName]
	, [LastModified]
	, [LastModifiedBy]
	, [SearchField]
	, [SourceID]
	, [Secured]
	, [CustomUrl]
	, [MetaTitle]
	, [GenerateBreadcrumb]
	, [PublishOn]
	, [Visible]
    FROM
	[dbo].[DynamicPages]
    WHERE 
	 ([DynamicPageID] = @DynamicPageId AND @DynamicPageId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([LanguageID] = @LanguageId AND @LanguageId is not null)
	OR ([ParentDynamicPageID] = @ParentDynamicPageId AND @ParentDynamicPageId is not null)
	OR ([PageName] = @PageName AND @PageName is not null)
	OR ([PageTitle] = @PageTitle AND @PageTitle is not null)
	OR ([DynamicPageWebPartTemplateID] = @DynamicPageWebPartTemplateId AND @DynamicPageWebPartTemplateId is not null)
	OR ([HyperLink] = @HyperLink AND @HyperLink is not null)
	OR ([Valid] = @Valid AND @Valid is not null)
	OR ([OpenInNewWindow] = @OpenInNewWindow AND @OpenInNewWindow is not null)
	OR ([Sequence] = @Sequence AND @Sequence is not null)
	OR ([FullScreen] = @FullScreen AND @FullScreen is not null)
	OR ([OnTopNav] = @OnTopNav AND @OnTopNav is not null)
	OR ([OnLeftNav] = @OnLeftNav AND @OnLeftNav is not null)
	OR ([OnBottomNav] = @OnBottomNav AND @OnBottomNav is not null)
	OR ([OnSiteMap] = @OnSiteMap AND @OnSiteMap is not null)
	OR ([Searchable] = @Searchable AND @Searchable is not null)
	OR ([MetaKeywords] = @MetaKeywords AND @MetaKeywords is not null)
	OR ([MetaDescription] = @MetaDescription AND @MetaDescription is not null)
	OR ([PageFriendlyName] = @PageFriendlyName AND @PageFriendlyName is not null)
	OR ([LastModified] = @LastModified AND @LastModified is not null)
	OR ([LastModifiedBy] = @LastModifiedBy AND @LastModifiedBy is not null)
	OR ([SearchField] = @SearchField AND @SearchField is not null)
	OR ([SourceID] = @SourceId AND @SourceId is not null)
	OR ([Secured] = @Secured AND @Secured is not null)
	OR ([CustomUrl] = @CustomUrl AND @CustomUrl is not null)
	OR ([MetaTitle] = @MetaTitle AND @MetaTitle is not null)
	OR ([GenerateBreadcrumb] = @GenerateBreadcrumb AND @GenerateBreadcrumb is not null)
	OR ([PublishOn] = @PublishOn AND @PublishOn is not null)
	OR ([Visible] = @Visible AND @Visible is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicpagesCustomWidget_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicpagesCustomWidget_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicpagesCustomWidget_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the DynamicpagesCustomWidget table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicpagesCustomWidget_Get_List

AS


				
				SELECT
					[DynamicPageID],
					[CustomWidgetID],
					[Position],
					[Sequence]
				FROM
					[dbo].[DynamicpagesCustomWidget]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicpagesCustomWidget_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicpagesCustomWidget_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicpagesCustomWidget_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the DynamicpagesCustomWidget table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicpagesCustomWidget_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [DynamicPageID] int, [CustomWidgetID] int, [Position] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([DynamicPageID], [CustomWidgetID], [Position])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [DynamicPageID], [CustomWidgetID], [Position]'
				SET @SQL = @SQL + ' FROM [dbo].[DynamicpagesCustomWidget]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[DynamicPageID], O.[CustomWidgetID], O.[Position], O.[Sequence]
				FROM
				    [dbo].[DynamicpagesCustomWidget] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[DynamicPageID] = PageIndex.[DynamicPageID]
					AND O.[CustomWidgetID] = PageIndex.[CustomWidgetID]
					AND O.[Position] = PageIndex.[Position]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[DynamicpagesCustomWidget]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicpagesCustomWidget_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicpagesCustomWidget_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicpagesCustomWidget_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the DynamicpagesCustomWidget table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicpagesCustomWidget_Insert
(

	@DynamicPageId int   ,

	@CustomWidgetId int   ,

	@Position int   ,

	@Sequence int   
)
AS


				
				INSERT INTO [dbo].[DynamicpagesCustomWidget]
					(
					[DynamicPageID]
					,[CustomWidgetID]
					,[Position]
					,[Sequence]
					)
				VALUES
					(
					@DynamicPageId
					,@CustomWidgetId
					,@Position
					,@Sequence
					)
				
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicpagesCustomWidget_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicpagesCustomWidget_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicpagesCustomWidget_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the DynamicpagesCustomWidget table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicpagesCustomWidget_Update
(

	@DynamicPageId int   ,

	@OriginalDynamicPageId int   ,

	@CustomWidgetId int   ,

	@OriginalCustomWidgetId int   ,

	@Position int   ,

	@OriginalPosition int   ,

	@Sequence int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[DynamicpagesCustomWidget]
				SET
					[DynamicPageID] = @DynamicPageId
					,[CustomWidgetID] = @CustomWidgetId
					,[Position] = @Position
					,[Sequence] = @Sequence
				WHERE
[DynamicPageID] = @OriginalDynamicPageId 
AND [CustomWidgetID] = @OriginalCustomWidgetId 
AND [Position] = @OriginalPosition 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicpagesCustomWidget_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicpagesCustomWidget_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicpagesCustomWidget_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the DynamicpagesCustomWidget table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicpagesCustomWidget_Delete
(

	@DynamicPageId int   ,

	@CustomWidgetId int   ,

	@Position int   
)
AS


				DELETE FROM [dbo].[DynamicpagesCustomWidget] WITH (ROWLOCK) 
				WHERE
					[DynamicPageID] = @DynamicPageId
					AND [CustomWidgetID] = @CustomWidgetId
					AND [Position] = @Position
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicpagesCustomWidget_GetByCustomWidgetId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicpagesCustomWidget_GetByCustomWidgetId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicpagesCustomWidget_GetByCustomWidgetId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the DynamicpagesCustomWidget table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicpagesCustomWidget_GetByCustomWidgetId
(

	@CustomWidgetId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[DynamicPageID],
					[CustomWidgetID],
					[Position],
					[Sequence]
				FROM
					[dbo].[DynamicpagesCustomWidget]
				WHERE
					[CustomWidgetID] = @CustomWidgetId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicpagesCustomWidget_GetByDynamicPageId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicpagesCustomWidget_GetByDynamicPageId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicpagesCustomWidget_GetByDynamicPageId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the DynamicpagesCustomWidget table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicpagesCustomWidget_GetByDynamicPageId
(

	@DynamicPageId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[DynamicPageID],
					[CustomWidgetID],
					[Position],
					[Sequence]
				FROM
					[dbo].[DynamicpagesCustomWidget]
				WHERE
					[DynamicPageID] = @DynamicPageId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicpagesCustomWidget_GetByDynamicPageIdCustomWidgetIdPosition procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicpagesCustomWidget_GetByDynamicPageIdCustomWidgetIdPosition') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicpagesCustomWidget_GetByDynamicPageIdCustomWidgetIdPosition
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the DynamicpagesCustomWidget table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicpagesCustomWidget_GetByDynamicPageIdCustomWidgetIdPosition
(

	@DynamicPageId int   ,

	@CustomWidgetId int   ,

	@Position int   
)
AS


				SELECT
					[DynamicPageID],
					[CustomWidgetID],
					[Position],
					[Sequence]
				FROM
					[dbo].[DynamicpagesCustomWidget]
				WHERE
					[DynamicPageID] = @DynamicPageId
					AND [CustomWidgetID] = @CustomWidgetId
					AND [Position] = @Position
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.DynamicpagesCustomWidget_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.DynamicpagesCustomWidget_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.DynamicpagesCustomWidget_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the DynamicpagesCustomWidget table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.DynamicpagesCustomWidget_Find
(

	@SearchUsingOR bit   = null ,

	@DynamicPageId int   = null ,

	@CustomWidgetId int   = null ,

	@Position int   = null ,

	@Sequence int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [DynamicPageID]
	, [CustomWidgetID]
	, [Position]
	, [Sequence]
    FROM
	[dbo].[DynamicpagesCustomWidget]
    WHERE 
	 ([DynamicPageID] = @DynamicPageId OR @DynamicPageId IS NULL)
	AND ([CustomWidgetID] = @CustomWidgetId OR @CustomWidgetId IS NULL)
	AND ([Position] = @Position OR @Position IS NULL)
	AND ([Sequence] = @Sequence OR @Sequence IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [DynamicPageID]
	, [CustomWidgetID]
	, [Position]
	, [Sequence]
    FROM
	[dbo].[DynamicpagesCustomWidget]
    WHERE 
	 ([DynamicPageID] = @DynamicPageId AND @DynamicPageId is not null)
	OR ([CustomWidgetID] = @CustomWidgetId AND @CustomWidgetId is not null)
	OR ([Position] = @Position AND @Position is not null)
	OR ([Sequence] = @Sequence AND @Sequence is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Industry_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Industry_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Industry_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the Industry table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Industry_Get_List

AS


				
				SELECT
					[IndustryID],
					[SiteID],
					[IndustryName],
					[Sequence],
					[Valid],
					[IndustryLanguageXML],
					[LastModifiedBy],
					[LastModified]
				FROM
					[dbo].[Industry]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Industry_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Industry_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Industry_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the Industry table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Industry_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [IndustryID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([IndustryID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [IndustryID]'
				SET @SQL = @SQL + ' FROM [dbo].[Industry]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[IndustryID], O.[SiteID], O.[IndustryName], O.[Sequence], O.[Valid], O.[IndustryLanguageXML], O.[LastModifiedBy], O.[LastModified]
				FROM
				    [dbo].[Industry] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[IndustryID] = PageIndex.[IndustryID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[Industry]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Industry_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Industry_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Industry_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the Industry table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Industry_Insert
(

	@IndustryId int    OUTPUT,

	@SiteId int   ,

	@IndustryName nvarchar (150)  ,

	@Sequence int   ,

	@Valid bit   ,

	@IndustryLanguageXml nvarchar (MAX)  ,

	@LastModifiedBy int   ,

	@LastModified datetime   
)
AS


				
				INSERT INTO [dbo].[Industry]
					(
					[SiteID]
					,[IndustryName]
					,[Sequence]
					,[Valid]
					,[IndustryLanguageXML]
					,[LastModifiedBy]
					,[LastModified]
					)
				VALUES
					(
					@SiteId
					,@IndustryName
					,@Sequence
					,@Valid
					,@IndustryLanguageXml
					,@LastModifiedBy
					,@LastModified
					)
				
				-- Get the identity value
				SET @IndustryId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Industry_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Industry_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Industry_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the Industry table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Industry_Update
(

	@IndustryId int   ,

	@SiteId int   ,

	@IndustryName nvarchar (150)  ,

	@Sequence int   ,

	@Valid bit   ,

	@IndustryLanguageXml nvarchar (MAX)  ,

	@LastModifiedBy int   ,

	@LastModified datetime   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[Industry]
				SET
					[SiteID] = @SiteId
					,[IndustryName] = @IndustryName
					,[Sequence] = @Sequence
					,[Valid] = @Valid
					,[IndustryLanguageXML] = @IndustryLanguageXml
					,[LastModifiedBy] = @LastModifiedBy
					,[LastModified] = @LastModified
				WHERE
[IndustryID] = @IndustryId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Industry_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Industry_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Industry_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the Industry table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Industry_Delete
(

	@IndustryId int   
)
AS


				DELETE FROM [dbo].[Industry] WITH (ROWLOCK) 
				WHERE
					[IndustryID] = @IndustryId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Industry_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Industry_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Industry_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Industry table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Industry_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[IndustryID],
					[SiteID],
					[IndustryName],
					[Sequence],
					[Valid],
					[IndustryLanguageXML],
					[LastModifiedBy],
					[LastModified]
				FROM
					[dbo].[Industry]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Industry_GetByIndustryId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Industry_GetByIndustryId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Industry_GetByIndustryId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Industry table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Industry_GetByIndustryId
(

	@IndustryId int   
)
AS


				SELECT
					[IndustryID],
					[SiteID],
					[IndustryName],
					[Sequence],
					[Valid],
					[IndustryLanguageXML],
					[LastModifiedBy],
					[LastModified]
				FROM
					[dbo].[Industry]
				WHERE
					[IndustryID] = @IndustryId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Industry_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Industry_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Industry_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the Industry table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Industry_Find
(

	@SearchUsingOR bit   = null ,

	@IndustryId int   = null ,

	@SiteId int   = null ,

	@IndustryName nvarchar (150)  = null ,

	@Sequence int   = null ,

	@Valid bit   = null ,

	@IndustryLanguageXml nvarchar (MAX)  = null ,

	@LastModifiedBy int   = null ,

	@LastModified datetime   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [IndustryID]
	, [SiteID]
	, [IndustryName]
	, [Sequence]
	, [Valid]
	, [IndustryLanguageXML]
	, [LastModifiedBy]
	, [LastModified]
    FROM
	[dbo].[Industry]
    WHERE 
	 ([IndustryID] = @IndustryId OR @IndustryId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([IndustryName] = @IndustryName OR @IndustryName IS NULL)
	AND ([Sequence] = @Sequence OR @Sequence IS NULL)
	AND ([Valid] = @Valid OR @Valid IS NULL)
	AND ([IndustryLanguageXML] = @IndustryLanguageXml OR @IndustryLanguageXml IS NULL)
	AND ([LastModifiedBy] = @LastModifiedBy OR @LastModifiedBy IS NULL)
	AND ([LastModified] = @LastModified OR @LastModified IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [IndustryID]
	, [SiteID]
	, [IndustryName]
	, [Sequence]
	, [Valid]
	, [IndustryLanguageXML]
	, [LastModifiedBy]
	, [LastModified]
    FROM
	[dbo].[Industry]
    WHERE 
	 ([IndustryID] = @IndustryId AND @IndustryId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([IndustryName] = @IndustryName AND @IndustryName is not null)
	OR ([Sequence] = @Sequence AND @Sequence is not null)
	OR ([Valid] = @Valid AND @Valid is not null)
	OR ([IndustryLanguageXML] = @IndustryLanguageXml AND @IndustryLanguageXml is not null)
	OR ([LastModifiedBy] = @LastModifiedBy AND @LastModifiedBy is not null)
	OR ([LastModified] = @LastModified AND @LastModified is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.IntegrationMappings_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.IntegrationMappings_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.IntegrationMappings_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the IntegrationMappings table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.IntegrationMappings_Get_List

AS


				
				SELECT
					[IntegrationMappingID],
					[SiteID],
					[IntegrationMappingTypeID],
					[JXTEntity],
					[JXTColumn],
					[JXTType],
					[JXTSize],
					[ThirdPartyEntity],
					[ThirdPartyColumn],
					[ThirdPartyType],
					[ThirdPartySize],
					[Sequence],
					[Sync],
					[GlobalMapping],
					[LastModifiedBy],
					[LastModifiedDate]
				FROM
					[dbo].[IntegrationMappings]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.IntegrationMappings_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.IntegrationMappings_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.IntegrationMappings_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the IntegrationMappings table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.IntegrationMappings_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [IntegrationMappingID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([IntegrationMappingID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [IntegrationMappingID]'
				SET @SQL = @SQL + ' FROM [dbo].[IntegrationMappings]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[IntegrationMappingID], O.[SiteID], O.[IntegrationMappingTypeID], O.[JXTEntity], O.[JXTColumn], O.[JXTType], O.[JXTSize], O.[ThirdPartyEntity], O.[ThirdPartyColumn], O.[ThirdPartyType], O.[ThirdPartySize], O.[Sequence], O.[Sync], O.[GlobalMapping], O.[LastModifiedBy], O.[LastModifiedDate]
				FROM
				    [dbo].[IntegrationMappings] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[IntegrationMappingID] = PageIndex.[IntegrationMappingID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[IntegrationMappings]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.IntegrationMappings_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.IntegrationMappings_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.IntegrationMappings_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the IntegrationMappings table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.IntegrationMappings_Insert
(

	@IntegrationMappingId int    OUTPUT,

	@SiteId int   ,

	@IntegrationMappingTypeId int   ,

	@JxtEntity varchar (75)  ,

	@JxtColumn varchar (75)  ,

	@JxtType varchar (75)  ,

	@JxtSize int   ,

	@ThirdPartyEntity varchar (75)  ,

	@ThirdPartyColumn varchar (75)  ,

	@ThirdPartyType varchar (75)  ,

	@ThirdPartySize int   ,

	@Sequence int   ,

	@Sync int   ,

	@GlobalMapping bit   ,

	@LastModifiedBy int   ,

	@LastModifiedDate datetime   
)
AS


				
				INSERT INTO [dbo].[IntegrationMappings]
					(
					[SiteID]
					,[IntegrationMappingTypeID]
					,[JXTEntity]
					,[JXTColumn]
					,[JXTType]
					,[JXTSize]
					,[ThirdPartyEntity]
					,[ThirdPartyColumn]
					,[ThirdPartyType]
					,[ThirdPartySize]
					,[Sequence]
					,[Sync]
					,[GlobalMapping]
					,[LastModifiedBy]
					,[LastModifiedDate]
					)
				VALUES
					(
					@SiteId
					,@IntegrationMappingTypeId
					,@JxtEntity
					,@JxtColumn
					,@JxtType
					,@JxtSize
					,@ThirdPartyEntity
					,@ThirdPartyColumn
					,@ThirdPartyType
					,@ThirdPartySize
					,@Sequence
					,@Sync
					,@GlobalMapping
					,@LastModifiedBy
					,@LastModifiedDate
					)
				
				-- Get the identity value
				SET @IntegrationMappingId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.IntegrationMappings_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.IntegrationMappings_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.IntegrationMappings_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the IntegrationMappings table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.IntegrationMappings_Update
(

	@IntegrationMappingId int   ,

	@SiteId int   ,

	@IntegrationMappingTypeId int   ,

	@JxtEntity varchar (75)  ,

	@JxtColumn varchar (75)  ,

	@JxtType varchar (75)  ,

	@JxtSize int   ,

	@ThirdPartyEntity varchar (75)  ,

	@ThirdPartyColumn varchar (75)  ,

	@ThirdPartyType varchar (75)  ,

	@ThirdPartySize int   ,

	@Sequence int   ,

	@Sync int   ,

	@GlobalMapping bit   ,

	@LastModifiedBy int   ,

	@LastModifiedDate datetime   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[IntegrationMappings]
				SET
					[SiteID] = @SiteId
					,[IntegrationMappingTypeID] = @IntegrationMappingTypeId
					,[JXTEntity] = @JxtEntity
					,[JXTColumn] = @JxtColumn
					,[JXTType] = @JxtType
					,[JXTSize] = @JxtSize
					,[ThirdPartyEntity] = @ThirdPartyEntity
					,[ThirdPartyColumn] = @ThirdPartyColumn
					,[ThirdPartyType] = @ThirdPartyType
					,[ThirdPartySize] = @ThirdPartySize
					,[Sequence] = @Sequence
					,[Sync] = @Sync
					,[GlobalMapping] = @GlobalMapping
					,[LastModifiedBy] = @LastModifiedBy
					,[LastModifiedDate] = @LastModifiedDate
				WHERE
[IntegrationMappingID] = @IntegrationMappingId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.IntegrationMappings_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.IntegrationMappings_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.IntegrationMappings_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the IntegrationMappings table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.IntegrationMappings_Delete
(

	@IntegrationMappingId int   
)
AS


				DELETE FROM [dbo].[IntegrationMappings] WITH (ROWLOCK) 
				WHERE
					[IntegrationMappingID] = @IntegrationMappingId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.IntegrationMappings_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.IntegrationMappings_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.IntegrationMappings_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the IntegrationMappings table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.IntegrationMappings_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[IntegrationMappingID],
					[SiteID],
					[IntegrationMappingTypeID],
					[JXTEntity],
					[JXTColumn],
					[JXTType],
					[JXTSize],
					[ThirdPartyEntity],
					[ThirdPartyColumn],
					[ThirdPartyType],
					[ThirdPartySize],
					[Sequence],
					[Sync],
					[GlobalMapping],
					[LastModifiedBy],
					[LastModifiedDate]
				FROM
					[dbo].[IntegrationMappings]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.IntegrationMappings_GetByIntegrationMappingId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.IntegrationMappings_GetByIntegrationMappingId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.IntegrationMappings_GetByIntegrationMappingId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the IntegrationMappings table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.IntegrationMappings_GetByIntegrationMappingId
(

	@IntegrationMappingId int   
)
AS


				SELECT
					[IntegrationMappingID],
					[SiteID],
					[IntegrationMappingTypeID],
					[JXTEntity],
					[JXTColumn],
					[JXTType],
					[JXTSize],
					[ThirdPartyEntity],
					[ThirdPartyColumn],
					[ThirdPartyType],
					[ThirdPartySize],
					[Sequence],
					[Sync],
					[GlobalMapping],
					[LastModifiedBy],
					[LastModifiedDate]
				FROM
					[dbo].[IntegrationMappings]
				WHERE
					[IntegrationMappingID] = @IntegrationMappingId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.IntegrationMappings_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.IntegrationMappings_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.IntegrationMappings_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the IntegrationMappings table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.IntegrationMappings_Find
(

	@SearchUsingOR bit   = null ,

	@IntegrationMappingId int   = null ,

	@SiteId int   = null ,

	@IntegrationMappingTypeId int   = null ,

	@JxtEntity varchar (75)  = null ,

	@JxtColumn varchar (75)  = null ,

	@JxtType varchar (75)  = null ,

	@JxtSize int   = null ,

	@ThirdPartyEntity varchar (75)  = null ,

	@ThirdPartyColumn varchar (75)  = null ,

	@ThirdPartyType varchar (75)  = null ,

	@ThirdPartySize int   = null ,

	@Sequence int   = null ,

	@Sync int   = null ,

	@GlobalMapping bit   = null ,

	@LastModifiedBy int   = null ,

	@LastModifiedDate datetime   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [IntegrationMappingID]
	, [SiteID]
	, [IntegrationMappingTypeID]
	, [JXTEntity]
	, [JXTColumn]
	, [JXTType]
	, [JXTSize]
	, [ThirdPartyEntity]
	, [ThirdPartyColumn]
	, [ThirdPartyType]
	, [ThirdPartySize]
	, [Sequence]
	, [Sync]
	, [GlobalMapping]
	, [LastModifiedBy]
	, [LastModifiedDate]
    FROM
	[dbo].[IntegrationMappings]
    WHERE 
	 ([IntegrationMappingID] = @IntegrationMappingId OR @IntegrationMappingId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([IntegrationMappingTypeID] = @IntegrationMappingTypeId OR @IntegrationMappingTypeId IS NULL)
	AND ([JXTEntity] = @JxtEntity OR @JxtEntity IS NULL)
	AND ([JXTColumn] = @JxtColumn OR @JxtColumn IS NULL)
	AND ([JXTType] = @JxtType OR @JxtType IS NULL)
	AND ([JXTSize] = @JxtSize OR @JxtSize IS NULL)
	AND ([ThirdPartyEntity] = @ThirdPartyEntity OR @ThirdPartyEntity IS NULL)
	AND ([ThirdPartyColumn] = @ThirdPartyColumn OR @ThirdPartyColumn IS NULL)
	AND ([ThirdPartyType] = @ThirdPartyType OR @ThirdPartyType IS NULL)
	AND ([ThirdPartySize] = @ThirdPartySize OR @ThirdPartySize IS NULL)
	AND ([Sequence] = @Sequence OR @Sequence IS NULL)
	AND ([Sync] = @Sync OR @Sync IS NULL)
	AND ([GlobalMapping] = @GlobalMapping OR @GlobalMapping IS NULL)
	AND ([LastModifiedBy] = @LastModifiedBy OR @LastModifiedBy IS NULL)
	AND ([LastModifiedDate] = @LastModifiedDate OR @LastModifiedDate IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [IntegrationMappingID]
	, [SiteID]
	, [IntegrationMappingTypeID]
	, [JXTEntity]
	, [JXTColumn]
	, [JXTType]
	, [JXTSize]
	, [ThirdPartyEntity]
	, [ThirdPartyColumn]
	, [ThirdPartyType]
	, [ThirdPartySize]
	, [Sequence]
	, [Sync]
	, [GlobalMapping]
	, [LastModifiedBy]
	, [LastModifiedDate]
    FROM
	[dbo].[IntegrationMappings]
    WHERE 
	 ([IntegrationMappingID] = @IntegrationMappingId AND @IntegrationMappingId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([IntegrationMappingTypeID] = @IntegrationMappingTypeId AND @IntegrationMappingTypeId is not null)
	OR ([JXTEntity] = @JxtEntity AND @JxtEntity is not null)
	OR ([JXTColumn] = @JxtColumn AND @JxtColumn is not null)
	OR ([JXTType] = @JxtType AND @JxtType is not null)
	OR ([JXTSize] = @JxtSize AND @JxtSize is not null)
	OR ([ThirdPartyEntity] = @ThirdPartyEntity AND @ThirdPartyEntity is not null)
	OR ([ThirdPartyColumn] = @ThirdPartyColumn AND @ThirdPartyColumn is not null)
	OR ([ThirdPartyType] = @ThirdPartyType AND @ThirdPartyType is not null)
	OR ([ThirdPartySize] = @ThirdPartySize AND @ThirdPartySize is not null)
	OR ([Sequence] = @Sequence AND @Sequence is not null)
	OR ([Sync] = @Sync AND @Sync is not null)
	OR ([GlobalMapping] = @GlobalMapping AND @GlobalMapping is not null)
	OR ([LastModifiedBy] = @LastModifiedBy AND @LastModifiedBy is not null)
	OR ([LastModifiedDate] = @LastModifiedDate AND @LastModifiedDate is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobTemplates_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobTemplates_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobTemplates_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the JobTemplates table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobTemplates_Get_List

AS


				
				SELECT
					[JobTemplateID],
					[SiteID],
					[JobTemplateDescription],
					[JobTemplateHTML],
					[GlobalTemplate],
					[LastModifiedBy],
					[LastModified],
					[JobTemplateLogo],
					[AdvertiserID],
					[JobTemplateLogoUrl]
				FROM
					[dbo].[JobTemplates]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobTemplates_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobTemplates_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobTemplates_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the JobTemplates table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobTemplates_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [JobTemplateID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([JobTemplateID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [JobTemplateID]'
				SET @SQL = @SQL + ' FROM [dbo].[JobTemplates]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[JobTemplateID], O.[SiteID], O.[JobTemplateDescription], O.[JobTemplateHTML], O.[GlobalTemplate], O.[LastModifiedBy], O.[LastModified], O.[JobTemplateLogo], O.[AdvertiserID], O.[JobTemplateLogoUrl]
				FROM
				    [dbo].[JobTemplates] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[JobTemplateID] = PageIndex.[JobTemplateID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[JobTemplates]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobTemplates_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobTemplates_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobTemplates_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the JobTemplates table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobTemplates_Insert
(

	@JobTemplateId int    OUTPUT,

	@SiteId int   ,

	@JobTemplateDescription varchar (255)  ,

	@JobTemplateHtml ntext   ,

	@GlobalTemplate bit   ,

	@LastModifiedBy int   ,

	@LastModified datetime   ,

	@JobTemplateLogo image   ,

	@AdvertiserId int   ,

	@JobTemplateLogoUrl nvarchar (1000)  
)
AS


				
				INSERT INTO [dbo].[JobTemplates]
					(
					[SiteID]
					,[JobTemplateDescription]
					,[JobTemplateHTML]
					,[GlobalTemplate]
					,[LastModifiedBy]
					,[LastModified]
					,[JobTemplateLogo]
					,[AdvertiserID]
					,[JobTemplateLogoUrl]
					)
				VALUES
					(
					@SiteId
					,@JobTemplateDescription
					,@JobTemplateHtml
					,@GlobalTemplate
					,@LastModifiedBy
					,@LastModified
					,@JobTemplateLogo
					,@AdvertiserId
					,@JobTemplateLogoUrl
					)
				
				-- Get the identity value
				SET @JobTemplateId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobTemplates_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobTemplates_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobTemplates_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the JobTemplates table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobTemplates_Update
(

	@JobTemplateId int   ,

	@SiteId int   ,

	@JobTemplateDescription varchar (255)  ,

	@JobTemplateHtml ntext   ,

	@GlobalTemplate bit   ,

	@LastModifiedBy int   ,

	@LastModified datetime   ,

	@JobTemplateLogo image   ,

	@AdvertiserId int   ,

	@JobTemplateLogoUrl nvarchar (1000)  
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[JobTemplates]
				SET
					[SiteID] = @SiteId
					,[JobTemplateDescription] = @JobTemplateDescription
					,[JobTemplateHTML] = @JobTemplateHtml
					,[GlobalTemplate] = @GlobalTemplate
					,[LastModifiedBy] = @LastModifiedBy
					,[LastModified] = @LastModified
					,[JobTemplateLogo] = @JobTemplateLogo
					,[AdvertiserID] = @AdvertiserId
					,[JobTemplateLogoUrl] = @JobTemplateLogoUrl
				WHERE
[JobTemplateID] = @JobTemplateId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobTemplates_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobTemplates_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobTemplates_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the JobTemplates table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobTemplates_Delete
(

	@JobTemplateId int   
)
AS


				DELETE FROM [dbo].[JobTemplates] WITH (ROWLOCK) 
				WHERE
					[JobTemplateID] = @JobTemplateId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobTemplates_GetByAdvertiserId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobTemplates_GetByAdvertiserId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobTemplates_GetByAdvertiserId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobTemplates table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobTemplates_GetByAdvertiserId
(

	@AdvertiserId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobTemplateID],
					[SiteID],
					[JobTemplateDescription],
					[JobTemplateHTML],
					[GlobalTemplate],
					[LastModifiedBy],
					[LastModified],
					[JobTemplateLogo],
					[AdvertiserID],
					[JobTemplateLogoUrl]
				FROM
					[dbo].[JobTemplates]
				WHERE
					[AdvertiserID] = @AdvertiserId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobTemplates_GetByLastModifiedBy procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobTemplates_GetByLastModifiedBy') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobTemplates_GetByLastModifiedBy
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobTemplates table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobTemplates_GetByLastModifiedBy
(

	@LastModifiedBy int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobTemplateID],
					[SiteID],
					[JobTemplateDescription],
					[JobTemplateHTML],
					[GlobalTemplate],
					[LastModifiedBy],
					[LastModified],
					[JobTemplateLogo],
					[AdvertiserID],
					[JobTemplateLogoUrl]
				FROM
					[dbo].[JobTemplates]
				WHERE
					[LastModifiedBy] = @LastModifiedBy
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobTemplates_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobTemplates_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobTemplates_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobTemplates table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobTemplates_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobTemplateID],
					[SiteID],
					[JobTemplateDescription],
					[JobTemplateHTML],
					[GlobalTemplate],
					[LastModifiedBy],
					[LastModified],
					[JobTemplateLogo],
					[AdvertiserID],
					[JobTemplateLogoUrl]
				FROM
					[dbo].[JobTemplates]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobTemplates_GetByJobTemplateId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobTemplates_GetByJobTemplateId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobTemplates_GetByJobTemplateId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobTemplates table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobTemplates_GetByJobTemplateId
(

	@JobTemplateId int   
)
AS


				SELECT
					[JobTemplateID],
					[SiteID],
					[JobTemplateDescription],
					[JobTemplateHTML],
					[GlobalTemplate],
					[LastModifiedBy],
					[LastModified],
					[JobTemplateLogo],
					[AdvertiserID],
					[JobTemplateLogoUrl]
				FROM
					[dbo].[JobTemplates]
				WHERE
					[JobTemplateID] = @JobTemplateId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobTemplates_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobTemplates_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobTemplates_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the JobTemplates table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobTemplates_Find
(

	@SearchUsingOR bit   = null ,

	@JobTemplateId int   = null ,

	@SiteId int   = null ,

	@JobTemplateDescription varchar (255)  = null ,

	@JobTemplateHtml ntext   = null ,

	@GlobalTemplate bit   = null ,

	@LastModifiedBy int   = null ,

	@LastModified datetime   = null ,

	@JobTemplateLogo image   = null ,

	@AdvertiserId int   = null ,

	@JobTemplateLogoUrl nvarchar (1000)  = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [JobTemplateID]
	, [SiteID]
	, [JobTemplateDescription]
	, [JobTemplateHTML]
	, [GlobalTemplate]
	, [LastModifiedBy]
	, [LastModified]
	, [JobTemplateLogo]
	, [AdvertiserID]
	, [JobTemplateLogoUrl]
    FROM
	[dbo].[JobTemplates]
    WHERE 
	 ([JobTemplateID] = @JobTemplateId OR @JobTemplateId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([JobTemplateDescription] = @JobTemplateDescription OR @JobTemplateDescription IS NULL)
	AND ([GlobalTemplate] = @GlobalTemplate OR @GlobalTemplate IS NULL)
	AND ([LastModifiedBy] = @LastModifiedBy OR @LastModifiedBy IS NULL)
	AND ([LastModified] = @LastModified OR @LastModified IS NULL)
	AND ([AdvertiserID] = @AdvertiserId OR @AdvertiserId IS NULL)
	AND ([JobTemplateLogoUrl] = @JobTemplateLogoUrl OR @JobTemplateLogoUrl IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [JobTemplateID]
	, [SiteID]
	, [JobTemplateDescription]
	, [JobTemplateHTML]
	, [GlobalTemplate]
	, [LastModifiedBy]
	, [LastModified]
	, [JobTemplateLogo]
	, [AdvertiserID]
	, [JobTemplateLogoUrl]
    FROM
	[dbo].[JobTemplates]
    WHERE 
	 ([JobTemplateID] = @JobTemplateId AND @JobTemplateId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([JobTemplateDescription] = @JobTemplateDescription AND @JobTemplateDescription is not null)
	OR ([GlobalTemplate] = @GlobalTemplate AND @GlobalTemplate is not null)
	OR ([LastModifiedBy] = @LastModifiedBy AND @LastModifiedBy is not null)
	OR ([LastModified] = @LastModified AND @LastModified is not null)
	OR ([AdvertiserID] = @AdvertiserId AND @AdvertiserId is not null)
	OR ([JobTemplateLogoUrl] = @JobTemplateLogoUrl AND @JobTemplateLogoUrl is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Integrations_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Integrations_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Integrations_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the Integrations table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Integrations_Get_List

AS


				
				SELECT
					[IntegrationID],
					[SiteID],
					[IntegrationType],
					[JSONText],
					[Valid],
					[CreatedDate],
					[LastModified],
					[LastModifiedBy]
				FROM
					[dbo].[Integrations]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Integrations_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Integrations_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Integrations_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the Integrations table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Integrations_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [IntegrationID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([IntegrationID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [IntegrationID]'
				SET @SQL = @SQL + ' FROM [dbo].[Integrations]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[IntegrationID], O.[SiteID], O.[IntegrationType], O.[JSONText], O.[Valid], O.[CreatedDate], O.[LastModified], O.[LastModifiedBy]
				FROM
				    [dbo].[Integrations] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[IntegrationID] = PageIndex.[IntegrationID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[Integrations]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Integrations_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Integrations_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Integrations_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the Integrations table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Integrations_Insert
(

	@IntegrationId int    OUTPUT,

	@SiteId int   ,

	@IntegrationType int   ,

	@JsonText varchar (1000)  ,

	@Valid bit   ,

	@CreatedDate datetime   ,

	@LastModified datetime   ,

	@LastModifiedBy int   
)
AS


				
				INSERT INTO [dbo].[Integrations]
					(
					[SiteID]
					,[IntegrationType]
					,[JSONText]
					,[Valid]
					,[CreatedDate]
					,[LastModified]
					,[LastModifiedBy]
					)
				VALUES
					(
					@SiteId
					,@IntegrationType
					,@JsonText
					,@Valid
					,@CreatedDate
					,@LastModified
					,@LastModifiedBy
					)
				
				-- Get the identity value
				SET @IntegrationId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Integrations_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Integrations_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Integrations_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the Integrations table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Integrations_Update
(

	@IntegrationId int   ,

	@SiteId int   ,

	@IntegrationType int   ,

	@JsonText varchar (1000)  ,

	@Valid bit   ,

	@CreatedDate datetime   ,

	@LastModified datetime   ,

	@LastModifiedBy int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[Integrations]
				SET
					[SiteID] = @SiteId
					,[IntegrationType] = @IntegrationType
					,[JSONText] = @JsonText
					,[Valid] = @Valid
					,[CreatedDate] = @CreatedDate
					,[LastModified] = @LastModified
					,[LastModifiedBy] = @LastModifiedBy
				WHERE
[IntegrationID] = @IntegrationId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Integrations_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Integrations_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Integrations_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the Integrations table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Integrations_Delete
(

	@IntegrationId int   
)
AS


				DELETE FROM [dbo].[Integrations] WITH (ROWLOCK) 
				WHERE
					[IntegrationID] = @IntegrationId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Integrations_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Integrations_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Integrations_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Integrations table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Integrations_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[IntegrationID],
					[SiteID],
					[IntegrationType],
					[JSONText],
					[Valid],
					[CreatedDate],
					[LastModified],
					[LastModifiedBy]
				FROM
					[dbo].[Integrations]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Integrations_GetByIntegrationId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Integrations_GetByIntegrationId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Integrations_GetByIntegrationId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Integrations table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Integrations_GetByIntegrationId
(

	@IntegrationId int   
)
AS


				SELECT
					[IntegrationID],
					[SiteID],
					[IntegrationType],
					[JSONText],
					[Valid],
					[CreatedDate],
					[LastModified],
					[LastModifiedBy]
				FROM
					[dbo].[Integrations]
				WHERE
					[IntegrationID] = @IntegrationId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Integrations_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Integrations_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Integrations_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the Integrations table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Integrations_Find
(

	@SearchUsingOR bit   = null ,

	@IntegrationId int   = null ,

	@SiteId int   = null ,

	@IntegrationType int   = null ,

	@JsonText varchar (1000)  = null ,

	@Valid bit   = null ,

	@CreatedDate datetime   = null ,

	@LastModified datetime   = null ,

	@LastModifiedBy int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [IntegrationID]
	, [SiteID]
	, [IntegrationType]
	, [JSONText]
	, [Valid]
	, [CreatedDate]
	, [LastModified]
	, [LastModifiedBy]
    FROM
	[dbo].[Integrations]
    WHERE 
	 ([IntegrationID] = @IntegrationId OR @IntegrationId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([IntegrationType] = @IntegrationType OR @IntegrationType IS NULL)
	AND ([JSONText] = @JsonText OR @JsonText IS NULL)
	AND ([Valid] = @Valid OR @Valid IS NULL)
	AND ([CreatedDate] = @CreatedDate OR @CreatedDate IS NULL)
	AND ([LastModified] = @LastModified OR @LastModified IS NULL)
	AND ([LastModifiedBy] = @LastModifiedBy OR @LastModifiedBy IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [IntegrationID]
	, [SiteID]
	, [IntegrationType]
	, [JSONText]
	, [Valid]
	, [CreatedDate]
	, [LastModified]
	, [LastModifiedBy]
    FROM
	[dbo].[Integrations]
    WHERE 
	 ([IntegrationID] = @IntegrationId AND @IntegrationId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([IntegrationType] = @IntegrationType AND @IntegrationType is not null)
	OR ([JSONText] = @JsonText AND @JsonText is not null)
	OR ([Valid] = @Valid AND @Valid is not null)
	OR ([CreatedDate] = @CreatedDate AND @CreatedDate is not null)
	OR ([LastModified] = @LastModified AND @LastModified is not null)
	OR ([LastModifiedBy] = @LastModifiedBy AND @LastModifiedBy is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Jobs_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Jobs_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Jobs_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the Jobs table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Jobs_Get_List

AS


				
				SELECT
					[JobID],
					[SiteID],
					[WorkTypeID],
					[JobName],
					[Description],
					[FullDescription],
					[WebServiceProcessed],
					[ApplicationEmailAddress],
					[RefNo],
					[Visible],
					[DatePosted],
					[ExpiryDate],
					[Expired],
					[JobItemPrice],
					[Billed],
					[LastModified],
					[ShowSalaryDetails],
					[SalaryText],
					[AdvertiserID],
					[LastModifiedByAdvertiserUserId],
					[LastModifiedByAdminUserId],
					[JobItemTypeID],
					[ApplicationMethod],
					[ApplicationURL],
					[UploadMethod],
					[Tags],
					[JobTemplateID],
					[SearchFieldExtension],
					[AdvertiserJobTemplateLogoID],
					[CompanyName],
					[HashValue],
					[RequireLogonForExternalApplications],
					[ShowLocationDetails],
					[PublicTransport],
					[Address],
					[ContactDetails],
					[JobContactPhone],
					[JobContactName],
					[QualificationsRecognised],
					[ResidentOnly],
					[DocumentLink],
					[BulletPoint1],
					[BulletPoint2],
					[BulletPoint3],
					[HotJob],
					[JobFriendlyName],
					[SearchField],
					[ShowSalaryRange],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[EnteredByAdvertiserUserID],
					[JobLatitude],
					[JobLongitude],
					[AddressStatus],
					[JobExternalId],
					[ScreeningQuestionsTemplateId]
				FROM
					[dbo].[Jobs]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Jobs_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Jobs_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Jobs_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the Jobs table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Jobs_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [JobID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([JobID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [JobID]'
				SET @SQL = @SQL + ' FROM [dbo].[Jobs]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[JobID], O.[SiteID], O.[WorkTypeID], O.[JobName], O.[Description], O.[FullDescription], O.[WebServiceProcessed], O.[ApplicationEmailAddress], O.[RefNo], O.[Visible], O.[DatePosted], O.[ExpiryDate], O.[Expired], O.[JobItemPrice], O.[Billed], O.[LastModified], O.[ShowSalaryDetails], O.[SalaryText], O.[AdvertiserID], O.[LastModifiedByAdvertiserUserId], O.[LastModifiedByAdminUserId], O.[JobItemTypeID], O.[ApplicationMethod], O.[ApplicationURL], O.[UploadMethod], O.[Tags], O.[JobTemplateID], O.[SearchFieldExtension], O.[AdvertiserJobTemplateLogoID], O.[CompanyName], O.[HashValue], O.[RequireLogonForExternalApplications], O.[ShowLocationDetails], O.[PublicTransport], O.[Address], O.[ContactDetails], O.[JobContactPhone], O.[JobContactName], O.[QualificationsRecognised], O.[ResidentOnly], O.[DocumentLink], O.[BulletPoint1], O.[BulletPoint2], O.[BulletPoint3], O.[HotJob], O.[JobFriendlyName], O.[SearchField], O.[ShowSalaryRange], O.[SalaryLowerBand], O.[SalaryUpperBand], O.[CurrencyID], O.[SalaryTypeID], O.[EnteredByAdvertiserUserID], O.[JobLatitude], O.[JobLongitude], O.[AddressStatus], O.[JobExternalId], O.[ScreeningQuestionsTemplateId]
				FROM
				    [dbo].[Jobs] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[JobID] = PageIndex.[JobID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[Jobs]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Jobs_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Jobs_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Jobs_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the Jobs table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Jobs_Insert
(

	@JobId int    OUTPUT,

	@SiteId int   ,

	@WorkTypeId int   ,

	@JobName nvarchar (510)  ,

	@Description nvarchar (2000)  ,

	@FullDescription nvarchar (MAX)  ,

	@WebServiceProcessed bit   ,

	@ApplicationEmailAddress varchar (255)  ,

	@RefNo varchar (255)  ,

	@Visible bit   ,

	@DatePosted smalldatetime   ,

	@ExpiryDate smalldatetime   ,

	@Expired int   ,

	@JobItemPrice money   ,

	@Billed bit   ,

	@LastModified datetime   ,

	@ShowSalaryDetails bit   ,

	@SalaryText varchar (500)  ,

	@AdvertiserId int   ,

	@LastModifiedByAdvertiserUserId int   ,

	@LastModifiedByAdminUserId int   ,

	@JobItemTypeId int   ,

	@ApplicationMethod int   ,

	@ApplicationUrl varchar (8000)  ,

	@UploadMethod int   ,

	@Tags text   ,

	@JobTemplateId int   ,

	@SearchFieldExtension varchar (8)  ,

	@AdvertiserJobTemplateLogoId int   ,

	@CompanyName varchar (255)  ,

	@HashValue varbinary (MAX)  ,

	@RequireLogonForExternalApplications bit   ,

	@ShowLocationDetails bit   ,

	@PublicTransport nvarchar (500)  ,

	@Address varchar (255)  ,

	@ContactDetails nvarchar (510)  ,

	@JobContactPhone varchar (50)  ,

	@JobContactName varchar (255)  ,

	@QualificationsRecognised bit   ,

	@ResidentOnly bit   ,

	@DocumentLink varchar (255)  ,

	@BulletPoint1 nvarchar (160)  ,

	@BulletPoint2 nvarchar (160)  ,

	@BulletPoint3 nvarchar (160)  ,

	@HotJob bit   ,

	@JobFriendlyName varchar (512)  ,

	@SearchField nvarchar (MAX)  ,

	@ShowSalaryRange bit   ,

	@SalaryLowerBand numeric (15, 2)  ,

	@SalaryUpperBand numeric (15, 2)  ,

	@CurrencyId int   ,

	@SalaryTypeId int   ,

	@EnteredByAdvertiserUserId int   ,

	@JobLatitude float   ,

	@JobLongitude float   ,

	@AddressStatus int   ,

	@JobExternalId varchar (50)  ,

	@ScreeningQuestionsTemplateId int   
)
AS


				
				INSERT INTO [dbo].[Jobs]
					(
					[SiteID]
					,[WorkTypeID]
					,[JobName]
					,[Description]
					,[FullDescription]
					,[WebServiceProcessed]
					,[ApplicationEmailAddress]
					,[RefNo]
					,[Visible]
					,[DatePosted]
					,[ExpiryDate]
					,[Expired]
					,[JobItemPrice]
					,[Billed]
					,[LastModified]
					,[ShowSalaryDetails]
					,[SalaryText]
					,[AdvertiserID]
					,[LastModifiedByAdvertiserUserId]
					,[LastModifiedByAdminUserId]
					,[JobItemTypeID]
					,[ApplicationMethod]
					,[ApplicationURL]
					,[UploadMethod]
					,[Tags]
					,[JobTemplateID]
					,[SearchFieldExtension]
					,[AdvertiserJobTemplateLogoID]
					,[CompanyName]
					,[HashValue]
					,[RequireLogonForExternalApplications]
					,[ShowLocationDetails]
					,[PublicTransport]
					,[Address]
					,[ContactDetails]
					,[JobContactPhone]
					,[JobContactName]
					,[QualificationsRecognised]
					,[ResidentOnly]
					,[DocumentLink]
					,[BulletPoint1]
					,[BulletPoint2]
					,[BulletPoint3]
					,[HotJob]
					,[JobFriendlyName]
					,[SearchField]
					,[ShowSalaryRange]
					,[SalaryLowerBand]
					,[SalaryUpperBand]
					,[CurrencyID]
					,[SalaryTypeID]
					,[EnteredByAdvertiserUserID]
					,[JobLatitude]
					,[JobLongitude]
					,[AddressStatus]
					,[JobExternalId]
					,[ScreeningQuestionsTemplateId]
					)
				VALUES
					(
					@SiteId
					,@WorkTypeId
					,@JobName
					,@Description
					,@FullDescription
					,@WebServiceProcessed
					,@ApplicationEmailAddress
					,@RefNo
					,@Visible
					,@DatePosted
					,@ExpiryDate
					,@Expired
					,@JobItemPrice
					,@Billed
					,@LastModified
					,@ShowSalaryDetails
					,@SalaryText
					,@AdvertiserId
					,@LastModifiedByAdvertiserUserId
					,@LastModifiedByAdminUserId
					,@JobItemTypeId
					,@ApplicationMethod
					,@ApplicationUrl
					,@UploadMethod
					,@Tags
					,@JobTemplateId
					,@SearchFieldExtension
					,@AdvertiserJobTemplateLogoId
					,@CompanyName
					,@HashValue
					,@RequireLogonForExternalApplications
					,@ShowLocationDetails
					,@PublicTransport
					,@Address
					,@ContactDetails
					,@JobContactPhone
					,@JobContactName
					,@QualificationsRecognised
					,@ResidentOnly
					,@DocumentLink
					,@BulletPoint1
					,@BulletPoint2
					,@BulletPoint3
					,@HotJob
					,@JobFriendlyName
					,@SearchField
					,@ShowSalaryRange
					,@SalaryLowerBand
					,@SalaryUpperBand
					,@CurrencyId
					,@SalaryTypeId
					,@EnteredByAdvertiserUserId
					,@JobLatitude
					,@JobLongitude
					,@AddressStatus
					,@JobExternalId
					,@ScreeningQuestionsTemplateId
					)
				
				-- Get the identity value
				SET @JobId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Jobs_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Jobs_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Jobs_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the Jobs table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Jobs_Update
(

	@JobId int   ,

	@SiteId int   ,

	@WorkTypeId int   ,

	@JobName nvarchar (510)  ,

	@Description nvarchar (2000)  ,

	@FullDescription nvarchar (MAX)  ,

	@WebServiceProcessed bit   ,

	@ApplicationEmailAddress varchar (255)  ,

	@RefNo varchar (255)  ,

	@Visible bit   ,

	@DatePosted smalldatetime   ,

	@ExpiryDate smalldatetime   ,

	@Expired int   ,

	@JobItemPrice money   ,

	@Billed bit   ,

	@LastModified datetime   ,

	@ShowSalaryDetails bit   ,

	@SalaryText varchar (500)  ,

	@AdvertiserId int   ,

	@LastModifiedByAdvertiserUserId int   ,

	@LastModifiedByAdminUserId int   ,

	@JobItemTypeId int   ,

	@ApplicationMethod int   ,

	@ApplicationUrl varchar (8000)  ,

	@UploadMethod int   ,

	@Tags text   ,

	@JobTemplateId int   ,

	@SearchFieldExtension varchar (8)  ,

	@AdvertiserJobTemplateLogoId int   ,

	@CompanyName varchar (255)  ,

	@HashValue varbinary (MAX)  ,

	@RequireLogonForExternalApplications bit   ,

	@ShowLocationDetails bit   ,

	@PublicTransport nvarchar (500)  ,

	@Address varchar (255)  ,

	@ContactDetails nvarchar (510)  ,

	@JobContactPhone varchar (50)  ,

	@JobContactName varchar (255)  ,

	@QualificationsRecognised bit   ,

	@ResidentOnly bit   ,

	@DocumentLink varchar (255)  ,

	@BulletPoint1 nvarchar (160)  ,

	@BulletPoint2 nvarchar (160)  ,

	@BulletPoint3 nvarchar (160)  ,

	@HotJob bit   ,

	@JobFriendlyName varchar (512)  ,

	@SearchField nvarchar (MAX)  ,

	@ShowSalaryRange bit   ,

	@SalaryLowerBand numeric (15, 2)  ,

	@SalaryUpperBand numeric (15, 2)  ,

	@CurrencyId int   ,

	@SalaryTypeId int   ,

	@EnteredByAdvertiserUserId int   ,

	@JobLatitude float   ,

	@JobLongitude float   ,

	@AddressStatus int   ,

	@JobExternalId varchar (50)  ,

	@ScreeningQuestionsTemplateId int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[Jobs]
				SET
					[SiteID] = @SiteId
					,[WorkTypeID] = @WorkTypeId
					,[JobName] = @JobName
					,[Description] = @Description
					,[FullDescription] = @FullDescription
					,[WebServiceProcessed] = @WebServiceProcessed
					,[ApplicationEmailAddress] = @ApplicationEmailAddress
					,[RefNo] = @RefNo
					,[Visible] = @Visible
					,[DatePosted] = @DatePosted
					,[ExpiryDate] = @ExpiryDate
					,[Expired] = @Expired
					,[JobItemPrice] = @JobItemPrice
					,[Billed] = @Billed
					,[LastModified] = @LastModified
					,[ShowSalaryDetails] = @ShowSalaryDetails
					,[SalaryText] = @SalaryText
					,[AdvertiserID] = @AdvertiserId
					,[LastModifiedByAdvertiserUserId] = @LastModifiedByAdvertiserUserId
					,[LastModifiedByAdminUserId] = @LastModifiedByAdminUserId
					,[JobItemTypeID] = @JobItemTypeId
					,[ApplicationMethod] = @ApplicationMethod
					,[ApplicationURL] = @ApplicationUrl
					,[UploadMethod] = @UploadMethod
					,[Tags] = @Tags
					,[JobTemplateID] = @JobTemplateId
					,[SearchFieldExtension] = @SearchFieldExtension
					,[AdvertiserJobTemplateLogoID] = @AdvertiserJobTemplateLogoId
					,[CompanyName] = @CompanyName
					,[HashValue] = @HashValue
					,[RequireLogonForExternalApplications] = @RequireLogonForExternalApplications
					,[ShowLocationDetails] = @ShowLocationDetails
					,[PublicTransport] = @PublicTransport
					,[Address] = @Address
					,[ContactDetails] = @ContactDetails
					,[JobContactPhone] = @JobContactPhone
					,[JobContactName] = @JobContactName
					,[QualificationsRecognised] = @QualificationsRecognised
					,[ResidentOnly] = @ResidentOnly
					,[DocumentLink] = @DocumentLink
					,[BulletPoint1] = @BulletPoint1
					,[BulletPoint2] = @BulletPoint2
					,[BulletPoint3] = @BulletPoint3
					,[HotJob] = @HotJob
					,[JobFriendlyName] = @JobFriendlyName
					,[SearchField] = @SearchField
					,[ShowSalaryRange] = @ShowSalaryRange
					,[SalaryLowerBand] = @SalaryLowerBand
					,[SalaryUpperBand] = @SalaryUpperBand
					,[CurrencyID] = @CurrencyId
					,[SalaryTypeID] = @SalaryTypeId
					,[EnteredByAdvertiserUserID] = @EnteredByAdvertiserUserId
					,[JobLatitude] = @JobLatitude
					,[JobLongitude] = @JobLongitude
					,[AddressStatus] = @AddressStatus
					,[JobExternalId] = @JobExternalId
					,[ScreeningQuestionsTemplateId] = @ScreeningQuestionsTemplateId
				WHERE
[JobID] = @JobId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Jobs_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Jobs_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Jobs_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the Jobs table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Jobs_Delete
(

	@JobId int   
)
AS


				DELETE FROM [dbo].[Jobs] WITH (ROWLOCK) 
				WHERE
					[JobID] = @JobId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Jobs_GetByAdvertiserId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Jobs_GetByAdvertiserId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Jobs_GetByAdvertiserId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Jobs table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Jobs_GetByAdvertiserId
(

	@AdvertiserId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobID],
					[SiteID],
					[WorkTypeID],
					[JobName],
					[Description],
					[FullDescription],
					[WebServiceProcessed],
					[ApplicationEmailAddress],
					[RefNo],
					[Visible],
					[DatePosted],
					[ExpiryDate],
					[Expired],
					[JobItemPrice],
					[Billed],
					[LastModified],
					[ShowSalaryDetails],
					[SalaryText],
					[AdvertiserID],
					[LastModifiedByAdvertiserUserId],
					[LastModifiedByAdminUserId],
					[JobItemTypeID],
					[ApplicationMethod],
					[ApplicationURL],
					[UploadMethod],
					[Tags],
					[JobTemplateID],
					[SearchFieldExtension],
					[AdvertiserJobTemplateLogoID],
					[CompanyName],
					[HashValue],
					[RequireLogonForExternalApplications],
					[ShowLocationDetails],
					[PublicTransport],
					[Address],
					[ContactDetails],
					[JobContactPhone],
					[JobContactName],
					[QualificationsRecognised],
					[ResidentOnly],
					[DocumentLink],
					[BulletPoint1],
					[BulletPoint2],
					[BulletPoint3],
					[HotJob],
					[JobFriendlyName],
					[SearchField],
					[ShowSalaryRange],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[EnteredByAdvertiserUserID],
					[JobLatitude],
					[JobLongitude],
					[AddressStatus],
					[JobExternalId],
					[ScreeningQuestionsTemplateId]
				FROM
					[dbo].[Jobs]
				WHERE
					[AdvertiserID] = @AdvertiserId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Jobs_GetByCurrencyId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Jobs_GetByCurrencyId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Jobs_GetByCurrencyId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Jobs table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Jobs_GetByCurrencyId
(

	@CurrencyId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobID],
					[SiteID],
					[WorkTypeID],
					[JobName],
					[Description],
					[FullDescription],
					[WebServiceProcessed],
					[ApplicationEmailAddress],
					[RefNo],
					[Visible],
					[DatePosted],
					[ExpiryDate],
					[Expired],
					[JobItemPrice],
					[Billed],
					[LastModified],
					[ShowSalaryDetails],
					[SalaryText],
					[AdvertiserID],
					[LastModifiedByAdvertiserUserId],
					[LastModifiedByAdminUserId],
					[JobItemTypeID],
					[ApplicationMethod],
					[ApplicationURL],
					[UploadMethod],
					[Tags],
					[JobTemplateID],
					[SearchFieldExtension],
					[AdvertiserJobTemplateLogoID],
					[CompanyName],
					[HashValue],
					[RequireLogonForExternalApplications],
					[ShowLocationDetails],
					[PublicTransport],
					[Address],
					[ContactDetails],
					[JobContactPhone],
					[JobContactName],
					[QualificationsRecognised],
					[ResidentOnly],
					[DocumentLink],
					[BulletPoint1],
					[BulletPoint2],
					[BulletPoint3],
					[HotJob],
					[JobFriendlyName],
					[SearchField],
					[ShowSalaryRange],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[EnteredByAdvertiserUserID],
					[JobLatitude],
					[JobLongitude],
					[AddressStatus],
					[JobExternalId],
					[ScreeningQuestionsTemplateId]
				FROM
					[dbo].[Jobs]
				WHERE
					[CurrencyID] = @CurrencyId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Jobs_GetByJobTemplateId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Jobs_GetByJobTemplateId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Jobs_GetByJobTemplateId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Jobs table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Jobs_GetByJobTemplateId
(

	@JobTemplateId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobID],
					[SiteID],
					[WorkTypeID],
					[JobName],
					[Description],
					[FullDescription],
					[WebServiceProcessed],
					[ApplicationEmailAddress],
					[RefNo],
					[Visible],
					[DatePosted],
					[ExpiryDate],
					[Expired],
					[JobItemPrice],
					[Billed],
					[LastModified],
					[ShowSalaryDetails],
					[SalaryText],
					[AdvertiserID],
					[LastModifiedByAdvertiserUserId],
					[LastModifiedByAdminUserId],
					[JobItemTypeID],
					[ApplicationMethod],
					[ApplicationURL],
					[UploadMethod],
					[Tags],
					[JobTemplateID],
					[SearchFieldExtension],
					[AdvertiserJobTemplateLogoID],
					[CompanyName],
					[HashValue],
					[RequireLogonForExternalApplications],
					[ShowLocationDetails],
					[PublicTransport],
					[Address],
					[ContactDetails],
					[JobContactPhone],
					[JobContactName],
					[QualificationsRecognised],
					[ResidentOnly],
					[DocumentLink],
					[BulletPoint1],
					[BulletPoint2],
					[BulletPoint3],
					[HotJob],
					[JobFriendlyName],
					[SearchField],
					[ShowSalaryRange],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[EnteredByAdvertiserUserID],
					[JobLatitude],
					[JobLongitude],
					[AddressStatus],
					[JobExternalId],
					[ScreeningQuestionsTemplateId]
				FROM
					[dbo].[Jobs]
				WHERE
					[JobTemplateID] = @JobTemplateId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Jobs_GetByLastModifiedByAdvertiserUserId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Jobs_GetByLastModifiedByAdvertiserUserId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Jobs_GetByLastModifiedByAdvertiserUserId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Jobs table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Jobs_GetByLastModifiedByAdvertiserUserId
(

	@LastModifiedByAdvertiserUserId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobID],
					[SiteID],
					[WorkTypeID],
					[JobName],
					[Description],
					[FullDescription],
					[WebServiceProcessed],
					[ApplicationEmailAddress],
					[RefNo],
					[Visible],
					[DatePosted],
					[ExpiryDate],
					[Expired],
					[JobItemPrice],
					[Billed],
					[LastModified],
					[ShowSalaryDetails],
					[SalaryText],
					[AdvertiserID],
					[LastModifiedByAdvertiserUserId],
					[LastModifiedByAdminUserId],
					[JobItemTypeID],
					[ApplicationMethod],
					[ApplicationURL],
					[UploadMethod],
					[Tags],
					[JobTemplateID],
					[SearchFieldExtension],
					[AdvertiserJobTemplateLogoID],
					[CompanyName],
					[HashValue],
					[RequireLogonForExternalApplications],
					[ShowLocationDetails],
					[PublicTransport],
					[Address],
					[ContactDetails],
					[JobContactPhone],
					[JobContactName],
					[QualificationsRecognised],
					[ResidentOnly],
					[DocumentLink],
					[BulletPoint1],
					[BulletPoint2],
					[BulletPoint3],
					[HotJob],
					[JobFriendlyName],
					[SearchField],
					[ShowSalaryRange],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[EnteredByAdvertiserUserID],
					[JobLatitude],
					[JobLongitude],
					[AddressStatus],
					[JobExternalId],
					[ScreeningQuestionsTemplateId]
				FROM
					[dbo].[Jobs]
				WHERE
					[LastModifiedByAdvertiserUserId] = @LastModifiedByAdvertiserUserId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Jobs_GetByLastModifiedByAdminUserId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Jobs_GetByLastModifiedByAdminUserId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Jobs_GetByLastModifiedByAdminUserId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Jobs table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Jobs_GetByLastModifiedByAdminUserId
(

	@LastModifiedByAdminUserId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobID],
					[SiteID],
					[WorkTypeID],
					[JobName],
					[Description],
					[FullDescription],
					[WebServiceProcessed],
					[ApplicationEmailAddress],
					[RefNo],
					[Visible],
					[DatePosted],
					[ExpiryDate],
					[Expired],
					[JobItemPrice],
					[Billed],
					[LastModified],
					[ShowSalaryDetails],
					[SalaryText],
					[AdvertiserID],
					[LastModifiedByAdvertiserUserId],
					[LastModifiedByAdminUserId],
					[JobItemTypeID],
					[ApplicationMethod],
					[ApplicationURL],
					[UploadMethod],
					[Tags],
					[JobTemplateID],
					[SearchFieldExtension],
					[AdvertiserJobTemplateLogoID],
					[CompanyName],
					[HashValue],
					[RequireLogonForExternalApplications],
					[ShowLocationDetails],
					[PublicTransport],
					[Address],
					[ContactDetails],
					[JobContactPhone],
					[JobContactName],
					[QualificationsRecognised],
					[ResidentOnly],
					[DocumentLink],
					[BulletPoint1],
					[BulletPoint2],
					[BulletPoint3],
					[HotJob],
					[JobFriendlyName],
					[SearchField],
					[ShowSalaryRange],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[EnteredByAdvertiserUserID],
					[JobLatitude],
					[JobLongitude],
					[AddressStatus],
					[JobExternalId],
					[ScreeningQuestionsTemplateId]
				FROM
					[dbo].[Jobs]
				WHERE
					[LastModifiedByAdminUserId] = @LastModifiedByAdminUserId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Jobs_GetBySalaryTypeId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Jobs_GetBySalaryTypeId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Jobs_GetBySalaryTypeId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Jobs table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Jobs_GetBySalaryTypeId
(

	@SalaryTypeId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobID],
					[SiteID],
					[WorkTypeID],
					[JobName],
					[Description],
					[FullDescription],
					[WebServiceProcessed],
					[ApplicationEmailAddress],
					[RefNo],
					[Visible],
					[DatePosted],
					[ExpiryDate],
					[Expired],
					[JobItemPrice],
					[Billed],
					[LastModified],
					[ShowSalaryDetails],
					[SalaryText],
					[AdvertiserID],
					[LastModifiedByAdvertiserUserId],
					[LastModifiedByAdminUserId],
					[JobItemTypeID],
					[ApplicationMethod],
					[ApplicationURL],
					[UploadMethod],
					[Tags],
					[JobTemplateID],
					[SearchFieldExtension],
					[AdvertiserJobTemplateLogoID],
					[CompanyName],
					[HashValue],
					[RequireLogonForExternalApplications],
					[ShowLocationDetails],
					[PublicTransport],
					[Address],
					[ContactDetails],
					[JobContactPhone],
					[JobContactName],
					[QualificationsRecognised],
					[ResidentOnly],
					[DocumentLink],
					[BulletPoint1],
					[BulletPoint2],
					[BulletPoint3],
					[HotJob],
					[JobFriendlyName],
					[SearchField],
					[ShowSalaryRange],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[EnteredByAdvertiserUserID],
					[JobLatitude],
					[JobLongitude],
					[AddressStatus],
					[JobExternalId],
					[ScreeningQuestionsTemplateId]
				FROM
					[dbo].[Jobs]
				WHERE
					[SalaryTypeID] = @SalaryTypeId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Jobs_GetByScreeningQuestionsTemplateId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Jobs_GetByScreeningQuestionsTemplateId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Jobs_GetByScreeningQuestionsTemplateId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Jobs table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Jobs_GetByScreeningQuestionsTemplateId
(

	@ScreeningQuestionsTemplateId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobID],
					[SiteID],
					[WorkTypeID],
					[JobName],
					[Description],
					[FullDescription],
					[WebServiceProcessed],
					[ApplicationEmailAddress],
					[RefNo],
					[Visible],
					[DatePosted],
					[ExpiryDate],
					[Expired],
					[JobItemPrice],
					[Billed],
					[LastModified],
					[ShowSalaryDetails],
					[SalaryText],
					[AdvertiserID],
					[LastModifiedByAdvertiserUserId],
					[LastModifiedByAdminUserId],
					[JobItemTypeID],
					[ApplicationMethod],
					[ApplicationURL],
					[UploadMethod],
					[Tags],
					[JobTemplateID],
					[SearchFieldExtension],
					[AdvertiserJobTemplateLogoID],
					[CompanyName],
					[HashValue],
					[RequireLogonForExternalApplications],
					[ShowLocationDetails],
					[PublicTransport],
					[Address],
					[ContactDetails],
					[JobContactPhone],
					[JobContactName],
					[QualificationsRecognised],
					[ResidentOnly],
					[DocumentLink],
					[BulletPoint1],
					[BulletPoint2],
					[BulletPoint3],
					[HotJob],
					[JobFriendlyName],
					[SearchField],
					[ShowSalaryRange],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[EnteredByAdvertiserUserID],
					[JobLatitude],
					[JobLongitude],
					[AddressStatus],
					[JobExternalId],
					[ScreeningQuestionsTemplateId]
				FROM
					[dbo].[Jobs]
				WHERE
					[ScreeningQuestionsTemplateId] = @ScreeningQuestionsTemplateId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Jobs_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Jobs_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Jobs_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Jobs table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Jobs_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobID],
					[SiteID],
					[WorkTypeID],
					[JobName],
					[Description],
					[FullDescription],
					[WebServiceProcessed],
					[ApplicationEmailAddress],
					[RefNo],
					[Visible],
					[DatePosted],
					[ExpiryDate],
					[Expired],
					[JobItemPrice],
					[Billed],
					[LastModified],
					[ShowSalaryDetails],
					[SalaryText],
					[AdvertiserID],
					[LastModifiedByAdvertiserUserId],
					[LastModifiedByAdminUserId],
					[JobItemTypeID],
					[ApplicationMethod],
					[ApplicationURL],
					[UploadMethod],
					[Tags],
					[JobTemplateID],
					[SearchFieldExtension],
					[AdvertiserJobTemplateLogoID],
					[CompanyName],
					[HashValue],
					[RequireLogonForExternalApplications],
					[ShowLocationDetails],
					[PublicTransport],
					[Address],
					[ContactDetails],
					[JobContactPhone],
					[JobContactName],
					[QualificationsRecognised],
					[ResidentOnly],
					[DocumentLink],
					[BulletPoint1],
					[BulletPoint2],
					[BulletPoint3],
					[HotJob],
					[JobFriendlyName],
					[SearchField],
					[ShowSalaryRange],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[EnteredByAdvertiserUserID],
					[JobLatitude],
					[JobLongitude],
					[AddressStatus],
					[JobExternalId],
					[ScreeningQuestionsTemplateId]
				FROM
					[dbo].[Jobs]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Jobs_GetByWorkTypeId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Jobs_GetByWorkTypeId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Jobs_GetByWorkTypeId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Jobs table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Jobs_GetByWorkTypeId
(

	@WorkTypeId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobID],
					[SiteID],
					[WorkTypeID],
					[JobName],
					[Description],
					[FullDescription],
					[WebServiceProcessed],
					[ApplicationEmailAddress],
					[RefNo],
					[Visible],
					[DatePosted],
					[ExpiryDate],
					[Expired],
					[JobItemPrice],
					[Billed],
					[LastModified],
					[ShowSalaryDetails],
					[SalaryText],
					[AdvertiserID],
					[LastModifiedByAdvertiserUserId],
					[LastModifiedByAdminUserId],
					[JobItemTypeID],
					[ApplicationMethod],
					[ApplicationURL],
					[UploadMethod],
					[Tags],
					[JobTemplateID],
					[SearchFieldExtension],
					[AdvertiserJobTemplateLogoID],
					[CompanyName],
					[HashValue],
					[RequireLogonForExternalApplications],
					[ShowLocationDetails],
					[PublicTransport],
					[Address],
					[ContactDetails],
					[JobContactPhone],
					[JobContactName],
					[QualificationsRecognised],
					[ResidentOnly],
					[DocumentLink],
					[BulletPoint1],
					[BulletPoint2],
					[BulletPoint3],
					[HotJob],
					[JobFriendlyName],
					[SearchField],
					[ShowSalaryRange],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[EnteredByAdvertiserUserID],
					[JobLatitude],
					[JobLongitude],
					[AddressStatus],
					[JobExternalId],
					[ScreeningQuestionsTemplateId]
				FROM
					[dbo].[Jobs]
				WHERE
					[WorkTypeID] = @WorkTypeId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Jobs_GetByExpiredAdvertiserIdExpiryDate procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Jobs_GetByExpiredAdvertiserIdExpiryDate') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Jobs_GetByExpiredAdvertiserIdExpiryDate
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Jobs table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Jobs_GetByExpiredAdvertiserIdExpiryDate
(

	@Expired int   ,

	@AdvertiserId int   ,

	@ExpiryDate smalldatetime   
)
AS


				SELECT
					[JobID],
					[SiteID],
					[WorkTypeID],
					[JobName],
					[Description],
					[FullDescription],
					[WebServiceProcessed],
					[ApplicationEmailAddress],
					[RefNo],
					[Visible],
					[DatePosted],
					[ExpiryDate],
					[Expired],
					[JobItemPrice],
					[Billed],
					[LastModified],
					[ShowSalaryDetails],
					[SalaryText],
					[AdvertiserID],
					[LastModifiedByAdvertiserUserId],
					[LastModifiedByAdminUserId],
					[JobItemTypeID],
					[ApplicationMethod],
					[ApplicationURL],
					[UploadMethod],
					[Tags],
					[JobTemplateID],
					[SearchFieldExtension],
					[AdvertiserJobTemplateLogoID],
					[CompanyName],
					[HashValue],
					[RequireLogonForExternalApplications],
					[ShowLocationDetails],
					[PublicTransport],
					[Address],
					[ContactDetails],
					[JobContactPhone],
					[JobContactName],
					[QualificationsRecognised],
					[ResidentOnly],
					[DocumentLink],
					[BulletPoint1],
					[BulletPoint2],
					[BulletPoint3],
					[HotJob],
					[JobFriendlyName],
					[SearchField],
					[ShowSalaryRange],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[EnteredByAdvertiserUserID],
					[JobLatitude],
					[JobLongitude],
					[AddressStatus],
					[JobExternalId],
					[ScreeningQuestionsTemplateId]
				FROM
					[dbo].[Jobs]
				WHERE
					[Expired] = @Expired
					AND [AdvertiserID] = @AdvertiserId
					AND [ExpiryDate] = @ExpiryDate
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Jobs_GetByExpiredBilledExpiryDate procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Jobs_GetByExpiredBilledExpiryDate') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Jobs_GetByExpiredBilledExpiryDate
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Jobs table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Jobs_GetByExpiredBilledExpiryDate
(

	@Expired int   ,

	@Billed bit   ,

	@ExpiryDate smalldatetime   
)
AS


				SELECT
					[JobID],
					[SiteID],
					[WorkTypeID],
					[JobName],
					[Description],
					[FullDescription],
					[WebServiceProcessed],
					[ApplicationEmailAddress],
					[RefNo],
					[Visible],
					[DatePosted],
					[ExpiryDate],
					[Expired],
					[JobItemPrice],
					[Billed],
					[LastModified],
					[ShowSalaryDetails],
					[SalaryText],
					[AdvertiserID],
					[LastModifiedByAdvertiserUserId],
					[LastModifiedByAdminUserId],
					[JobItemTypeID],
					[ApplicationMethod],
					[ApplicationURL],
					[UploadMethod],
					[Tags],
					[JobTemplateID],
					[SearchFieldExtension],
					[AdvertiserJobTemplateLogoID],
					[CompanyName],
					[HashValue],
					[RequireLogonForExternalApplications],
					[ShowLocationDetails],
					[PublicTransport],
					[Address],
					[ContactDetails],
					[JobContactPhone],
					[JobContactName],
					[QualificationsRecognised],
					[ResidentOnly],
					[DocumentLink],
					[BulletPoint1],
					[BulletPoint2],
					[BulletPoint3],
					[HotJob],
					[JobFriendlyName],
					[SearchField],
					[ShowSalaryRange],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[EnteredByAdvertiserUserID],
					[JobLatitude],
					[JobLongitude],
					[AddressStatus],
					[JobExternalId],
					[ScreeningQuestionsTemplateId]
				FROM
					[dbo].[Jobs]
				WHERE
					[Expired] = @Expired
					AND [Billed] = @Billed
					AND [ExpiryDate] = @ExpiryDate
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Jobs_GetByExpiredExpiryDate procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Jobs_GetByExpiredExpiryDate') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Jobs_GetByExpiredExpiryDate
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Jobs table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Jobs_GetByExpiredExpiryDate
(

	@Expired int   ,

	@ExpiryDate smalldatetime   
)
AS


				SELECT
					[JobID],
					[SiteID],
					[WorkTypeID],
					[JobName],
					[Description],
					[FullDescription],
					[WebServiceProcessed],
					[ApplicationEmailAddress],
					[RefNo],
					[Visible],
					[DatePosted],
					[ExpiryDate],
					[Expired],
					[JobItemPrice],
					[Billed],
					[LastModified],
					[ShowSalaryDetails],
					[SalaryText],
					[AdvertiserID],
					[LastModifiedByAdvertiserUserId],
					[LastModifiedByAdminUserId],
					[JobItemTypeID],
					[ApplicationMethod],
					[ApplicationURL],
					[UploadMethod],
					[Tags],
					[JobTemplateID],
					[SearchFieldExtension],
					[AdvertiserJobTemplateLogoID],
					[CompanyName],
					[HashValue],
					[RequireLogonForExternalApplications],
					[ShowLocationDetails],
					[PublicTransport],
					[Address],
					[ContactDetails],
					[JobContactPhone],
					[JobContactName],
					[QualificationsRecognised],
					[ResidentOnly],
					[DocumentLink],
					[BulletPoint1],
					[BulletPoint2],
					[BulletPoint3],
					[HotJob],
					[JobFriendlyName],
					[SearchField],
					[ShowSalaryRange],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[EnteredByAdvertiserUserID],
					[JobLatitude],
					[JobLongitude],
					[AddressStatus],
					[JobExternalId],
					[ScreeningQuestionsTemplateId]
				FROM
					[dbo].[Jobs]
				WHERE
					[Expired] = @Expired
					AND [ExpiryDate] = @ExpiryDate
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Jobs_GetByWorkTypeIdJobIdAdvertiserIdCurrencyIdSalaryTypeIdSalaryLowerBandSalaryUpperBandExpiredExpiryDate procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Jobs_GetByWorkTypeIdJobIdAdvertiserIdCurrencyIdSalaryTypeIdSalaryLowerBandSalaryUpperBandExpiredExpiryDate') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Jobs_GetByWorkTypeIdJobIdAdvertiserIdCurrencyIdSalaryTypeIdSalaryLowerBandSalaryUpperBandExpiredExpiryDate
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Jobs table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Jobs_GetByWorkTypeIdJobIdAdvertiserIdCurrencyIdSalaryTypeIdSalaryLowerBandSalaryUpperBandExpiredExpiryDate
(

	@WorkTypeId int   ,

	@JobId int   ,

	@AdvertiserId int   ,

	@CurrencyId int   ,

	@SalaryTypeId int   ,

	@SalaryLowerBand numeric (15, 2)  ,

	@SalaryUpperBand numeric (15, 2)  ,

	@Expired int   ,

	@ExpiryDate smalldatetime   
)
AS


				SELECT
					[JobID],
					[SiteID],
					[WorkTypeID],
					[JobName],
					[Description],
					[FullDescription],
					[WebServiceProcessed],
					[ApplicationEmailAddress],
					[RefNo],
					[Visible],
					[DatePosted],
					[ExpiryDate],
					[Expired],
					[JobItemPrice],
					[Billed],
					[LastModified],
					[ShowSalaryDetails],
					[SalaryText],
					[AdvertiserID],
					[LastModifiedByAdvertiserUserId],
					[LastModifiedByAdminUserId],
					[JobItemTypeID],
					[ApplicationMethod],
					[ApplicationURL],
					[UploadMethod],
					[Tags],
					[JobTemplateID],
					[SearchFieldExtension],
					[AdvertiserJobTemplateLogoID],
					[CompanyName],
					[HashValue],
					[RequireLogonForExternalApplications],
					[ShowLocationDetails],
					[PublicTransport],
					[Address],
					[ContactDetails],
					[JobContactPhone],
					[JobContactName],
					[QualificationsRecognised],
					[ResidentOnly],
					[DocumentLink],
					[BulletPoint1],
					[BulletPoint2],
					[BulletPoint3],
					[HotJob],
					[JobFriendlyName],
					[SearchField],
					[ShowSalaryRange],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[EnteredByAdvertiserUserID],
					[JobLatitude],
					[JobLongitude],
					[AddressStatus],
					[JobExternalId],
					[ScreeningQuestionsTemplateId]
				FROM
					[dbo].[Jobs]
				WHERE
					[WorkTypeID] = @WorkTypeId
					AND [JobID] = @JobId
					AND [AdvertiserID] = @AdvertiserId
					AND [CurrencyID] = @CurrencyId
					AND [SalaryTypeID] = @SalaryTypeId
					AND [SalaryLowerBand] = @SalaryLowerBand
					AND [SalaryUpperBand] = @SalaryUpperBand
					AND [Expired] = @Expired
					AND [ExpiryDate] = @ExpiryDate
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Jobs_GetBySiteIdBilledAdvertiserId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Jobs_GetBySiteIdBilledAdvertiserId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Jobs_GetBySiteIdBilledAdvertiserId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Jobs table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Jobs_GetBySiteIdBilledAdvertiserId
(

	@SiteId int   ,

	@Billed bit   ,

	@AdvertiserId int   
)
AS


				SELECT
					[JobID],
					[SiteID],
					[WorkTypeID],
					[JobName],
					[Description],
					[FullDescription],
					[WebServiceProcessed],
					[ApplicationEmailAddress],
					[RefNo],
					[Visible],
					[DatePosted],
					[ExpiryDate],
					[Expired],
					[JobItemPrice],
					[Billed],
					[LastModified],
					[ShowSalaryDetails],
					[SalaryText],
					[AdvertiserID],
					[LastModifiedByAdvertiserUserId],
					[LastModifiedByAdminUserId],
					[JobItemTypeID],
					[ApplicationMethod],
					[ApplicationURL],
					[UploadMethod],
					[Tags],
					[JobTemplateID],
					[SearchFieldExtension],
					[AdvertiserJobTemplateLogoID],
					[CompanyName],
					[HashValue],
					[RequireLogonForExternalApplications],
					[ShowLocationDetails],
					[PublicTransport],
					[Address],
					[ContactDetails],
					[JobContactPhone],
					[JobContactName],
					[QualificationsRecognised],
					[ResidentOnly],
					[DocumentLink],
					[BulletPoint1],
					[BulletPoint2],
					[BulletPoint3],
					[HotJob],
					[JobFriendlyName],
					[SearchField],
					[ShowSalaryRange],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[EnteredByAdvertiserUserID],
					[JobLatitude],
					[JobLongitude],
					[AddressStatus],
					[JobExternalId],
					[ScreeningQuestionsTemplateId]
				FROM
					[dbo].[Jobs]
				WHERE
					[SiteID] = @SiteId
					AND [Billed] = @Billed
					AND [AdvertiserID] = @AdvertiserId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Jobs_GetBySiteIdExpiredBilledAdvertiserIdEnteredByAdvertiserUserId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Jobs_GetBySiteIdExpiredBilledAdvertiserIdEnteredByAdvertiserUserId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Jobs_GetBySiteIdExpiredBilledAdvertiserIdEnteredByAdvertiserUserId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Jobs table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Jobs_GetBySiteIdExpiredBilledAdvertiserIdEnteredByAdvertiserUserId
(

	@SiteId int   ,

	@Expired int   ,

	@Billed bit   ,

	@AdvertiserId int   ,

	@EnteredByAdvertiserUserId int   
)
AS


				SELECT
					[JobID],
					[SiteID],
					[WorkTypeID],
					[JobName],
					[Description],
					[FullDescription],
					[WebServiceProcessed],
					[ApplicationEmailAddress],
					[RefNo],
					[Visible],
					[DatePosted],
					[ExpiryDate],
					[Expired],
					[JobItemPrice],
					[Billed],
					[LastModified],
					[ShowSalaryDetails],
					[SalaryText],
					[AdvertiserID],
					[LastModifiedByAdvertiserUserId],
					[LastModifiedByAdminUserId],
					[JobItemTypeID],
					[ApplicationMethod],
					[ApplicationURL],
					[UploadMethod],
					[Tags],
					[JobTemplateID],
					[SearchFieldExtension],
					[AdvertiserJobTemplateLogoID],
					[CompanyName],
					[HashValue],
					[RequireLogonForExternalApplications],
					[ShowLocationDetails],
					[PublicTransport],
					[Address],
					[ContactDetails],
					[JobContactPhone],
					[JobContactName],
					[QualificationsRecognised],
					[ResidentOnly],
					[DocumentLink],
					[BulletPoint1],
					[BulletPoint2],
					[BulletPoint3],
					[HotJob],
					[JobFriendlyName],
					[SearchField],
					[ShowSalaryRange],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[EnteredByAdvertiserUserID],
					[JobLatitude],
					[JobLongitude],
					[AddressStatus],
					[JobExternalId],
					[ScreeningQuestionsTemplateId]
				FROM
					[dbo].[Jobs]
				WHERE
					[SiteID] = @SiteId
					AND [Expired] = @Expired
					AND [Billed] = @Billed
					AND [AdvertiserID] = @AdvertiserId
					AND [EnteredByAdvertiserUserID] = @EnteredByAdvertiserUserId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Jobs_GetByJobId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Jobs_GetByJobId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Jobs_GetByJobId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Jobs table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Jobs_GetByJobId
(

	@JobId int   
)
AS


				SELECT
					[JobID],
					[SiteID],
					[WorkTypeID],
					[JobName],
					[Description],
					[FullDescription],
					[WebServiceProcessed],
					[ApplicationEmailAddress],
					[RefNo],
					[Visible],
					[DatePosted],
					[ExpiryDate],
					[Expired],
					[JobItemPrice],
					[Billed],
					[LastModified],
					[ShowSalaryDetails],
					[SalaryText],
					[AdvertiserID],
					[LastModifiedByAdvertiserUserId],
					[LastModifiedByAdminUserId],
					[JobItemTypeID],
					[ApplicationMethod],
					[ApplicationURL],
					[UploadMethod],
					[Tags],
					[JobTemplateID],
					[SearchFieldExtension],
					[AdvertiserJobTemplateLogoID],
					[CompanyName],
					[HashValue],
					[RequireLogonForExternalApplications],
					[ShowLocationDetails],
					[PublicTransport],
					[Address],
					[ContactDetails],
					[JobContactPhone],
					[JobContactName],
					[QualificationsRecognised],
					[ResidentOnly],
					[DocumentLink],
					[BulletPoint1],
					[BulletPoint2],
					[BulletPoint3],
					[HotJob],
					[JobFriendlyName],
					[SearchField],
					[ShowSalaryRange],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[EnteredByAdvertiserUserID],
					[JobLatitude],
					[JobLongitude],
					[AddressStatus],
					[JobExternalId],
					[ScreeningQuestionsTemplateId]
				FROM
					[dbo].[Jobs]
				WHERE
					[JobID] = @JobId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Jobs_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Jobs_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Jobs_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the Jobs table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Jobs_Find
(

	@SearchUsingOR bit   = null ,

	@JobId int   = null ,

	@SiteId int   = null ,

	@WorkTypeId int   = null ,

	@JobName nvarchar (510)  = null ,

	@Description nvarchar (2000)  = null ,

	@FullDescription nvarchar (MAX)  = null ,

	@WebServiceProcessed bit   = null ,

	@ApplicationEmailAddress varchar (255)  = null ,

	@RefNo varchar (255)  = null ,

	@Visible bit   = null ,

	@DatePosted smalldatetime   = null ,

	@ExpiryDate smalldatetime   = null ,

	@Expired int   = null ,

	@JobItemPrice money   = null ,

	@Billed bit   = null ,

	@LastModified datetime   = null ,

	@ShowSalaryDetails bit   = null ,

	@SalaryText varchar (500)  = null ,

	@AdvertiserId int   = null ,

	@LastModifiedByAdvertiserUserId int   = null ,

	@LastModifiedByAdminUserId int   = null ,

	@JobItemTypeId int   = null ,

	@ApplicationMethod int   = null ,

	@ApplicationUrl varchar (8000)  = null ,

	@UploadMethod int   = null ,

	@Tags text   = null ,

	@JobTemplateId int   = null ,

	@SearchFieldExtension varchar (8)  = null ,

	@AdvertiserJobTemplateLogoId int   = null ,

	@CompanyName varchar (255)  = null ,

	@HashValue varbinary (MAX)  = null ,

	@RequireLogonForExternalApplications bit   = null ,

	@ShowLocationDetails bit   = null ,

	@PublicTransport nvarchar (500)  = null ,

	@Address varchar (255)  = null ,

	@ContactDetails nvarchar (510)  = null ,

	@JobContactPhone varchar (50)  = null ,

	@JobContactName varchar (255)  = null ,

	@QualificationsRecognised bit   = null ,

	@ResidentOnly bit   = null ,

	@DocumentLink varchar (255)  = null ,

	@BulletPoint1 nvarchar (160)  = null ,

	@BulletPoint2 nvarchar (160)  = null ,

	@BulletPoint3 nvarchar (160)  = null ,

	@HotJob bit   = null ,

	@JobFriendlyName varchar (512)  = null ,

	@SearchField nvarchar (MAX)  = null ,

	@ShowSalaryRange bit   = null ,

	@SalaryLowerBand numeric (15, 2)  = null ,

	@SalaryUpperBand numeric (15, 2)  = null ,

	@CurrencyId int   = null ,

	@SalaryTypeId int   = null ,

	@EnteredByAdvertiserUserId int   = null ,

	@JobLatitude float   = null ,

	@JobLongitude float   = null ,

	@AddressStatus int   = null ,

	@JobExternalId varchar (50)  = null ,

	@ScreeningQuestionsTemplateId int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [JobID]
	, [SiteID]
	, [WorkTypeID]
	, [JobName]
	, [Description]
	, [FullDescription]
	, [WebServiceProcessed]
	, [ApplicationEmailAddress]
	, [RefNo]
	, [Visible]
	, [DatePosted]
	, [ExpiryDate]
	, [Expired]
	, [JobItemPrice]
	, [Billed]
	, [LastModified]
	, [ShowSalaryDetails]
	, [SalaryText]
	, [AdvertiserID]
	, [LastModifiedByAdvertiserUserId]
	, [LastModifiedByAdminUserId]
	, [JobItemTypeID]
	, [ApplicationMethod]
	, [ApplicationURL]
	, [UploadMethod]
	, [Tags]
	, [JobTemplateID]
	, [SearchFieldExtension]
	, [AdvertiserJobTemplateLogoID]
	, [CompanyName]
	, [HashValue]
	, [RequireLogonForExternalApplications]
	, [ShowLocationDetails]
	, [PublicTransport]
	, [Address]
	, [ContactDetails]
	, [JobContactPhone]
	, [JobContactName]
	, [QualificationsRecognised]
	, [ResidentOnly]
	, [DocumentLink]
	, [BulletPoint1]
	, [BulletPoint2]
	, [BulletPoint3]
	, [HotJob]
	, [JobFriendlyName]
	, [SearchField]
	, [ShowSalaryRange]
	, [SalaryLowerBand]
	, [SalaryUpperBand]
	, [CurrencyID]
	, [SalaryTypeID]
	, [EnteredByAdvertiserUserID]
	, [JobLatitude]
	, [JobLongitude]
	, [AddressStatus]
	, [JobExternalId]
	, [ScreeningQuestionsTemplateId]
    FROM
	[dbo].[Jobs]
    WHERE 
	 ([JobID] = @JobId OR @JobId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([WorkTypeID] = @WorkTypeId OR @WorkTypeId IS NULL)
	AND ([JobName] = @JobName OR @JobName IS NULL)
	AND ([Description] = @Description OR @Description IS NULL)
	AND ([FullDescription] = @FullDescription OR @FullDescription IS NULL)
	AND ([WebServiceProcessed] = @WebServiceProcessed OR @WebServiceProcessed IS NULL)
	AND ([ApplicationEmailAddress] = @ApplicationEmailAddress OR @ApplicationEmailAddress IS NULL)
	AND ([RefNo] = @RefNo OR @RefNo IS NULL)
	AND ([Visible] = @Visible OR @Visible IS NULL)
	AND ([DatePosted] = @DatePosted OR @DatePosted IS NULL)
	AND ([ExpiryDate] = @ExpiryDate OR @ExpiryDate IS NULL)
	AND ([Expired] = @Expired OR @Expired IS NULL)
	AND ([JobItemPrice] = @JobItemPrice OR @JobItemPrice IS NULL)
	AND ([Billed] = @Billed OR @Billed IS NULL)
	AND ([LastModified] = @LastModified OR @LastModified IS NULL)
	AND ([ShowSalaryDetails] = @ShowSalaryDetails OR @ShowSalaryDetails IS NULL)
	AND ([SalaryText] = @SalaryText OR @SalaryText IS NULL)
	AND ([AdvertiserID] = @AdvertiserId OR @AdvertiserId IS NULL)
	AND ([LastModifiedByAdvertiserUserId] = @LastModifiedByAdvertiserUserId OR @LastModifiedByAdvertiserUserId IS NULL)
	AND ([LastModifiedByAdminUserId] = @LastModifiedByAdminUserId OR @LastModifiedByAdminUserId IS NULL)
	AND ([JobItemTypeID] = @JobItemTypeId OR @JobItemTypeId IS NULL)
	AND ([ApplicationMethod] = @ApplicationMethod OR @ApplicationMethod IS NULL)
	AND ([ApplicationURL] = @ApplicationUrl OR @ApplicationUrl IS NULL)
	AND ([UploadMethod] = @UploadMethod OR @UploadMethod IS NULL)
	AND ([JobTemplateID] = @JobTemplateId OR @JobTemplateId IS NULL)
	AND ([SearchFieldExtension] = @SearchFieldExtension OR @SearchFieldExtension IS NULL)
	AND ([AdvertiserJobTemplateLogoID] = @AdvertiserJobTemplateLogoId OR @AdvertiserJobTemplateLogoId IS NULL)
	AND ([CompanyName] = @CompanyName OR @CompanyName IS NULL)
	AND ([RequireLogonForExternalApplications] = @RequireLogonForExternalApplications OR @RequireLogonForExternalApplications IS NULL)
	AND ([ShowLocationDetails] = @ShowLocationDetails OR @ShowLocationDetails IS NULL)
	AND ([PublicTransport] = @PublicTransport OR @PublicTransport IS NULL)
	AND ([Address] = @Address OR @Address IS NULL)
	AND ([ContactDetails] = @ContactDetails OR @ContactDetails IS NULL)
	AND ([JobContactPhone] = @JobContactPhone OR @JobContactPhone IS NULL)
	AND ([JobContactName] = @JobContactName OR @JobContactName IS NULL)
	AND ([QualificationsRecognised] = @QualificationsRecognised OR @QualificationsRecognised IS NULL)
	AND ([ResidentOnly] = @ResidentOnly OR @ResidentOnly IS NULL)
	AND ([DocumentLink] = @DocumentLink OR @DocumentLink IS NULL)
	AND ([BulletPoint1] = @BulletPoint1 OR @BulletPoint1 IS NULL)
	AND ([BulletPoint2] = @BulletPoint2 OR @BulletPoint2 IS NULL)
	AND ([BulletPoint3] = @BulletPoint3 OR @BulletPoint3 IS NULL)
	AND ([HotJob] = @HotJob OR @HotJob IS NULL)
	AND ([JobFriendlyName] = @JobFriendlyName OR @JobFriendlyName IS NULL)
	AND ([SearchField] = @SearchField OR @SearchField IS NULL)
	AND ([ShowSalaryRange] = @ShowSalaryRange OR @ShowSalaryRange IS NULL)
	AND ([SalaryLowerBand] = @SalaryLowerBand OR @SalaryLowerBand IS NULL)
	AND ([SalaryUpperBand] = @SalaryUpperBand OR @SalaryUpperBand IS NULL)
	AND ([CurrencyID] = @CurrencyId OR @CurrencyId IS NULL)
	AND ([SalaryTypeID] = @SalaryTypeId OR @SalaryTypeId IS NULL)
	AND ([EnteredByAdvertiserUserID] = @EnteredByAdvertiserUserId OR @EnteredByAdvertiserUserId IS NULL)
	AND ([JobLatitude] = @JobLatitude OR @JobLatitude IS NULL)
	AND ([JobLongitude] = @JobLongitude OR @JobLongitude IS NULL)
	AND ([AddressStatus] = @AddressStatus OR @AddressStatus IS NULL)
	AND ([JobExternalId] = @JobExternalId OR @JobExternalId IS NULL)
	AND ([ScreeningQuestionsTemplateId] = @ScreeningQuestionsTemplateId OR @ScreeningQuestionsTemplateId IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [JobID]
	, [SiteID]
	, [WorkTypeID]
	, [JobName]
	, [Description]
	, [FullDescription]
	, [WebServiceProcessed]
	, [ApplicationEmailAddress]
	, [RefNo]
	, [Visible]
	, [DatePosted]
	, [ExpiryDate]
	, [Expired]
	, [JobItemPrice]
	, [Billed]
	, [LastModified]
	, [ShowSalaryDetails]
	, [SalaryText]
	, [AdvertiserID]
	, [LastModifiedByAdvertiserUserId]
	, [LastModifiedByAdminUserId]
	, [JobItemTypeID]
	, [ApplicationMethod]
	, [ApplicationURL]
	, [UploadMethod]
	, [Tags]
	, [JobTemplateID]
	, [SearchFieldExtension]
	, [AdvertiserJobTemplateLogoID]
	, [CompanyName]
	, [HashValue]
	, [RequireLogonForExternalApplications]
	, [ShowLocationDetails]
	, [PublicTransport]
	, [Address]
	, [ContactDetails]
	, [JobContactPhone]
	, [JobContactName]
	, [QualificationsRecognised]
	, [ResidentOnly]
	, [DocumentLink]
	, [BulletPoint1]
	, [BulletPoint2]
	, [BulletPoint3]
	, [HotJob]
	, [JobFriendlyName]
	, [SearchField]
	, [ShowSalaryRange]
	, [SalaryLowerBand]
	, [SalaryUpperBand]
	, [CurrencyID]
	, [SalaryTypeID]
	, [EnteredByAdvertiserUserID]
	, [JobLatitude]
	, [JobLongitude]
	, [AddressStatus]
	, [JobExternalId]
	, [ScreeningQuestionsTemplateId]
    FROM
	[dbo].[Jobs]
    WHERE 
	 ([JobID] = @JobId AND @JobId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([WorkTypeID] = @WorkTypeId AND @WorkTypeId is not null)
	OR ([JobName] = @JobName AND @JobName is not null)
	OR ([Description] = @Description AND @Description is not null)
	OR ([FullDescription] = @FullDescription AND @FullDescription is not null)
	OR ([WebServiceProcessed] = @WebServiceProcessed AND @WebServiceProcessed is not null)
	OR ([ApplicationEmailAddress] = @ApplicationEmailAddress AND @ApplicationEmailAddress is not null)
	OR ([RefNo] = @RefNo AND @RefNo is not null)
	OR ([Visible] = @Visible AND @Visible is not null)
	OR ([DatePosted] = @DatePosted AND @DatePosted is not null)
	OR ([ExpiryDate] = @ExpiryDate AND @ExpiryDate is not null)
	OR ([Expired] = @Expired AND @Expired is not null)
	OR ([JobItemPrice] = @JobItemPrice AND @JobItemPrice is not null)
	OR ([Billed] = @Billed AND @Billed is not null)
	OR ([LastModified] = @LastModified AND @LastModified is not null)
	OR ([ShowSalaryDetails] = @ShowSalaryDetails AND @ShowSalaryDetails is not null)
	OR ([SalaryText] = @SalaryText AND @SalaryText is not null)
	OR ([AdvertiserID] = @AdvertiserId AND @AdvertiserId is not null)
	OR ([LastModifiedByAdvertiserUserId] = @LastModifiedByAdvertiserUserId AND @LastModifiedByAdvertiserUserId is not null)
	OR ([LastModifiedByAdminUserId] = @LastModifiedByAdminUserId AND @LastModifiedByAdminUserId is not null)
	OR ([JobItemTypeID] = @JobItemTypeId AND @JobItemTypeId is not null)
	OR ([ApplicationMethod] = @ApplicationMethod AND @ApplicationMethod is not null)
	OR ([ApplicationURL] = @ApplicationUrl AND @ApplicationUrl is not null)
	OR ([UploadMethod] = @UploadMethod AND @UploadMethod is not null)
	OR ([JobTemplateID] = @JobTemplateId AND @JobTemplateId is not null)
	OR ([SearchFieldExtension] = @SearchFieldExtension AND @SearchFieldExtension is not null)
	OR ([AdvertiserJobTemplateLogoID] = @AdvertiserJobTemplateLogoId AND @AdvertiserJobTemplateLogoId is not null)
	OR ([CompanyName] = @CompanyName AND @CompanyName is not null)
	OR ([RequireLogonForExternalApplications] = @RequireLogonForExternalApplications AND @RequireLogonForExternalApplications is not null)
	OR ([ShowLocationDetails] = @ShowLocationDetails AND @ShowLocationDetails is not null)
	OR ([PublicTransport] = @PublicTransport AND @PublicTransport is not null)
	OR ([Address] = @Address AND @Address is not null)
	OR ([ContactDetails] = @ContactDetails AND @ContactDetails is not null)
	OR ([JobContactPhone] = @JobContactPhone AND @JobContactPhone is not null)
	OR ([JobContactName] = @JobContactName AND @JobContactName is not null)
	OR ([QualificationsRecognised] = @QualificationsRecognised AND @QualificationsRecognised is not null)
	OR ([ResidentOnly] = @ResidentOnly AND @ResidentOnly is not null)
	OR ([DocumentLink] = @DocumentLink AND @DocumentLink is not null)
	OR ([BulletPoint1] = @BulletPoint1 AND @BulletPoint1 is not null)
	OR ([BulletPoint2] = @BulletPoint2 AND @BulletPoint2 is not null)
	OR ([BulletPoint3] = @BulletPoint3 AND @BulletPoint3 is not null)
	OR ([HotJob] = @HotJob AND @HotJob is not null)
	OR ([JobFriendlyName] = @JobFriendlyName AND @JobFriendlyName is not null)
	OR ([SearchField] = @SearchField AND @SearchField is not null)
	OR ([ShowSalaryRange] = @ShowSalaryRange AND @ShowSalaryRange is not null)
	OR ([SalaryLowerBand] = @SalaryLowerBand AND @SalaryLowerBand is not null)
	OR ([SalaryUpperBand] = @SalaryUpperBand AND @SalaryUpperBand is not null)
	OR ([CurrencyID] = @CurrencyId AND @CurrencyId is not null)
	OR ([SalaryTypeID] = @SalaryTypeId AND @SalaryTypeId is not null)
	OR ([EnteredByAdvertiserUserID] = @EnteredByAdvertiserUserId AND @EnteredByAdvertiserUserId is not null)
	OR ([JobLatitude] = @JobLatitude AND @JobLatitude is not null)
	OR ([JobLongitude] = @JobLongitude AND @JobLongitude is not null)
	OR ([AddressStatus] = @AddressStatus AND @AddressStatus is not null)
	OR ([JobExternalId] = @JobExternalId AND @JobExternalId is not null)
	OR ([ScreeningQuestionsTemplateId] = @ScreeningQuestionsTemplateId AND @ScreeningQuestionsTemplateId is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Area_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Area_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Area_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the Area table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Area_Get_List

AS


				
				SELECT
					[AreaID],
					[AreaName],
					[LocationID],
					[Valid],
					[Sequence]
				FROM
					[dbo].[Area]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Area_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Area_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Area_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the Area table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Area_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [AreaID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([AreaID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [AreaID]'
				SET @SQL = @SQL + ' FROM [dbo].[Area]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[AreaID], O.[AreaName], O.[LocationID], O.[Valid], O.[Sequence]
				FROM
				    [dbo].[Area] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[AreaID] = PageIndex.[AreaID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[Area]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Area_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Area_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Area_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the Area table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Area_Insert
(

	@AreaId int    OUTPUT,

	@AreaName nvarchar (1020)  ,

	@LocationId int   ,

	@Valid bit   ,

	@Sequence int   
)
AS


				
				INSERT INTO [dbo].[Area]
					(
					[AreaName]
					,[LocationID]
					,[Valid]
					,[Sequence]
					)
				VALUES
					(
					@AreaName
					,@LocationId
					,@Valid
					,@Sequence
					)
				
				-- Get the identity value
				SET @AreaId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Area_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Area_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Area_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the Area table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Area_Update
(

	@AreaId int   ,

	@AreaName nvarchar (1020)  ,

	@LocationId int   ,

	@Valid bit   ,

	@Sequence int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[Area]
				SET
					[AreaName] = @AreaName
					,[LocationID] = @LocationId
					,[Valid] = @Valid
					,[Sequence] = @Sequence
				WHERE
[AreaID] = @AreaId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Area_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Area_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Area_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the Area table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Area_Delete
(

	@AreaId int   
)
AS


				DELETE FROM [dbo].[Area] WITH (ROWLOCK) 
				WHERE
					[AreaID] = @AreaId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Area_GetByLocationId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Area_GetByLocationId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Area_GetByLocationId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Area table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Area_GetByLocationId
(

	@LocationId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[AreaID],
					[AreaName],
					[LocationID],
					[Valid],
					[Sequence]
				FROM
					[dbo].[Area]
				WHERE
					[LocationID] = @LocationId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Area_GetByAreaIdLocationId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Area_GetByAreaIdLocationId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Area_GetByAreaIdLocationId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Area table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Area_GetByAreaIdLocationId
(

	@AreaId int   ,

	@LocationId int   
)
AS


				SELECT
					[AreaID],
					[AreaName],
					[LocationID],
					[Valid],
					[Sequence]
				FROM
					[dbo].[Area]
				WHERE
					[AreaID] = @AreaId
					AND [LocationID] = @LocationId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Area_GetByAreaId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Area_GetByAreaId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Area_GetByAreaId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Area table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Area_GetByAreaId
(

	@AreaId int   
)
AS


				SELECT
					[AreaID],
					[AreaName],
					[LocationID],
					[Valid],
					[Sequence]
				FROM
					[dbo].[Area]
				WHERE
					[AreaID] = @AreaId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Area_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Area_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Area_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the Area table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Area_Find
(

	@SearchUsingOR bit   = null ,

	@AreaId int   = null ,

	@AreaName nvarchar (1020)  = null ,

	@LocationId int   = null ,

	@Valid bit   = null ,

	@Sequence int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [AreaID]
	, [AreaName]
	, [LocationID]
	, [Valid]
	, [Sequence]
    FROM
	[dbo].[Area]
    WHERE 
	 ([AreaID] = @AreaId OR @AreaId IS NULL)
	AND ([AreaName] = @AreaName OR @AreaName IS NULL)
	AND ([LocationID] = @LocationId OR @LocationId IS NULL)
	AND ([Valid] = @Valid OR @Valid IS NULL)
	AND ([Sequence] = @Sequence OR @Sequence IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [AreaID]
	, [AreaName]
	, [LocationID]
	, [Valid]
	, [Sequence]
    FROM
	[dbo].[Area]
    WHERE 
	 ([AreaID] = @AreaId AND @AreaId is not null)
	OR ([AreaName] = @AreaName AND @AreaName is not null)
	OR ([LocationID] = @LocationId AND @LocationId is not null)
	OR ([Valid] = @Valid AND @Valid is not null)
	OR ([Sequence] = @Sequence AND @Sequence is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobsArchive_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobsArchive_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobsArchive_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the JobsArchive table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobsArchive_Get_List

AS


				
				SELECT
					[JobID],
					[SiteID],
					[WorkTypeID],
					[JobName],
					[Description],
					[FullDescription],
					[WebServiceProcessed],
					[ApplicationEmailAddress],
					[RefNo],
					[Visible],
					[DatePosted],
					[ExpiryDate],
					[Expired],
					[JobItemPrice],
					[Billed],
					[LastModified],
					[ShowSalaryDetails],
					[SalaryText],
					[AdvertiserID],
					[LastModifiedByAdvertiserUserId],
					[LastModifiedByAdminUserId],
					[JobItemTypeID],
					[ApplicationMethod],
					[ApplicationURL],
					[UploadMethod],
					[Tags],
					[JobTemplateID],
					[SearchFieldExtension],
					[AdvertiserJobTemplateLogoID],
					[CompanyName],
					[HashValue],
					[RequireLogonForExternalApplications],
					[ShowLocationDetails],
					[PublicTransport],
					[Address],
					[ContactDetails],
					[JobContactPhone],
					[JobContactName],
					[QualificationsRecognised],
					[ResidentOnly],
					[DocumentLink],
					[BulletPoint1],
					[BulletPoint2],
					[BulletPoint3],
					[HotJob],
					[JobFriendlyName],
					[SearchField],
					[ShowSalaryRange],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[EnteredByAdvertiserUserID],
					[JobLatitude],
					[JobLongitude],
					[AddressStatus],
					[JobExternalId],
					[ScreeningQuestionsTemplateId]
				FROM
					[dbo].[JobsArchive]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobsArchive_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobsArchive_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobsArchive_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the JobsArchive table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobsArchive_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [JobID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([JobID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [JobID]'
				SET @SQL = @SQL + ' FROM [dbo].[JobsArchive]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[JobID], O.[SiteID], O.[WorkTypeID], O.[JobName], O.[Description], O.[FullDescription], O.[WebServiceProcessed], O.[ApplicationEmailAddress], O.[RefNo], O.[Visible], O.[DatePosted], O.[ExpiryDate], O.[Expired], O.[JobItemPrice], O.[Billed], O.[LastModified], O.[ShowSalaryDetails], O.[SalaryText], O.[AdvertiserID], O.[LastModifiedByAdvertiserUserId], O.[LastModifiedByAdminUserId], O.[JobItemTypeID], O.[ApplicationMethod], O.[ApplicationURL], O.[UploadMethod], O.[Tags], O.[JobTemplateID], O.[SearchFieldExtension], O.[AdvertiserJobTemplateLogoID], O.[CompanyName], O.[HashValue], O.[RequireLogonForExternalApplications], O.[ShowLocationDetails], O.[PublicTransport], O.[Address], O.[ContactDetails], O.[JobContactPhone], O.[JobContactName], O.[QualificationsRecognised], O.[ResidentOnly], O.[DocumentLink], O.[BulletPoint1], O.[BulletPoint2], O.[BulletPoint3], O.[HotJob], O.[JobFriendlyName], O.[SearchField], O.[ShowSalaryRange], O.[SalaryLowerBand], O.[SalaryUpperBand], O.[CurrencyID], O.[SalaryTypeID], O.[EnteredByAdvertiserUserID], O.[JobLatitude], O.[JobLongitude], O.[AddressStatus], O.[JobExternalId], O.[ScreeningQuestionsTemplateId]
				FROM
				    [dbo].[JobsArchive] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[JobID] = PageIndex.[JobID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[JobsArchive]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobsArchive_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobsArchive_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobsArchive_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the JobsArchive table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobsArchive_Insert
(

	@JobId int   ,

	@SiteId int   ,

	@WorkTypeId int   ,

	@JobName nvarchar (510)  ,

	@Description nvarchar (2000)  ,

	@FullDescription nvarchar (MAX)  ,

	@WebServiceProcessed bit   ,

	@ApplicationEmailAddress varchar (255)  ,

	@RefNo varchar (255)  ,

	@Visible bit   ,

	@DatePosted smalldatetime   ,

	@ExpiryDate smalldatetime   ,

	@Expired int   ,

	@JobItemPrice money   ,

	@Billed bit   ,

	@LastModified datetime   ,

	@ShowSalaryDetails bit   ,

	@SalaryText varchar (500)  ,

	@AdvertiserId int   ,

	@LastModifiedByAdvertiserUserId int   ,

	@LastModifiedByAdminUserId int   ,

	@JobItemTypeId int   ,

	@ApplicationMethod int   ,

	@ApplicationUrl varchar (8000)  ,

	@UploadMethod int   ,

	@Tags text   ,

	@JobTemplateId int   ,

	@SearchFieldExtension varchar (8)  ,

	@AdvertiserJobTemplateLogoId int   ,

	@CompanyName varchar (255)  ,

	@HashValue varbinary (MAX)  ,

	@RequireLogonForExternalApplications bit   ,

	@ShowLocationDetails bit   ,

	@PublicTransport nvarchar (500)  ,

	@Address varchar (255)  ,

	@ContactDetails nvarchar (510)  ,

	@JobContactPhone varchar (50)  ,

	@JobContactName varchar (255)  ,

	@QualificationsRecognised bit   ,

	@ResidentOnly bit   ,

	@DocumentLink varchar (255)  ,

	@BulletPoint1 nvarchar (160)  ,

	@BulletPoint2 nvarchar (160)  ,

	@BulletPoint3 nvarchar (160)  ,

	@HotJob bit   ,

	@JobFriendlyName varchar (512)  ,

	@SearchField nvarchar (MAX)  ,

	@ShowSalaryRange bit   ,

	@SalaryLowerBand numeric (15, 2)  ,

	@SalaryUpperBand numeric (15, 2)  ,

	@CurrencyId int   ,

	@SalaryTypeId int   ,

	@EnteredByAdvertiserUserId int   ,

	@JobLatitude float   ,

	@JobLongitude float   ,

	@AddressStatus int   ,

	@JobExternalId varchar (50)  ,

	@ScreeningQuestionsTemplateId int   
)
AS


				
				INSERT INTO [dbo].[JobsArchive]
					(
					[JobID]
					,[SiteID]
					,[WorkTypeID]
					,[JobName]
					,[Description]
					,[FullDescription]
					,[WebServiceProcessed]
					,[ApplicationEmailAddress]
					,[RefNo]
					,[Visible]
					,[DatePosted]
					,[ExpiryDate]
					,[Expired]
					,[JobItemPrice]
					,[Billed]
					,[LastModified]
					,[ShowSalaryDetails]
					,[SalaryText]
					,[AdvertiserID]
					,[LastModifiedByAdvertiserUserId]
					,[LastModifiedByAdminUserId]
					,[JobItemTypeID]
					,[ApplicationMethod]
					,[ApplicationURL]
					,[UploadMethod]
					,[Tags]
					,[JobTemplateID]
					,[SearchFieldExtension]
					,[AdvertiserJobTemplateLogoID]
					,[CompanyName]
					,[HashValue]
					,[RequireLogonForExternalApplications]
					,[ShowLocationDetails]
					,[PublicTransport]
					,[Address]
					,[ContactDetails]
					,[JobContactPhone]
					,[JobContactName]
					,[QualificationsRecognised]
					,[ResidentOnly]
					,[DocumentLink]
					,[BulletPoint1]
					,[BulletPoint2]
					,[BulletPoint3]
					,[HotJob]
					,[JobFriendlyName]
					,[SearchField]
					,[ShowSalaryRange]
					,[SalaryLowerBand]
					,[SalaryUpperBand]
					,[CurrencyID]
					,[SalaryTypeID]
					,[EnteredByAdvertiserUserID]
					,[JobLatitude]
					,[JobLongitude]
					,[AddressStatus]
					,[JobExternalId]
					,[ScreeningQuestionsTemplateId]
					)
				VALUES
					(
					@JobId
					,@SiteId
					,@WorkTypeId
					,@JobName
					,@Description
					,@FullDescription
					,@WebServiceProcessed
					,@ApplicationEmailAddress
					,@RefNo
					,@Visible
					,@DatePosted
					,@ExpiryDate
					,@Expired
					,@JobItemPrice
					,@Billed
					,@LastModified
					,@ShowSalaryDetails
					,@SalaryText
					,@AdvertiserId
					,@LastModifiedByAdvertiserUserId
					,@LastModifiedByAdminUserId
					,@JobItemTypeId
					,@ApplicationMethod
					,@ApplicationUrl
					,@UploadMethod
					,@Tags
					,@JobTemplateId
					,@SearchFieldExtension
					,@AdvertiserJobTemplateLogoId
					,@CompanyName
					,@HashValue
					,@RequireLogonForExternalApplications
					,@ShowLocationDetails
					,@PublicTransport
					,@Address
					,@ContactDetails
					,@JobContactPhone
					,@JobContactName
					,@QualificationsRecognised
					,@ResidentOnly
					,@DocumentLink
					,@BulletPoint1
					,@BulletPoint2
					,@BulletPoint3
					,@HotJob
					,@JobFriendlyName
					,@SearchField
					,@ShowSalaryRange
					,@SalaryLowerBand
					,@SalaryUpperBand
					,@CurrencyId
					,@SalaryTypeId
					,@EnteredByAdvertiserUserId
					,@JobLatitude
					,@JobLongitude
					,@AddressStatus
					,@JobExternalId
					,@ScreeningQuestionsTemplateId
					)
				
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobsArchive_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobsArchive_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobsArchive_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the JobsArchive table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobsArchive_Update
(

	@JobId int   ,

	@OriginalJobId int   ,

	@SiteId int   ,

	@WorkTypeId int   ,

	@JobName nvarchar (510)  ,

	@Description nvarchar (2000)  ,

	@FullDescription nvarchar (MAX)  ,

	@WebServiceProcessed bit   ,

	@ApplicationEmailAddress varchar (255)  ,

	@RefNo varchar (255)  ,

	@Visible bit   ,

	@DatePosted smalldatetime   ,

	@ExpiryDate smalldatetime   ,

	@Expired int   ,

	@JobItemPrice money   ,

	@Billed bit   ,

	@LastModified datetime   ,

	@ShowSalaryDetails bit   ,

	@SalaryText varchar (500)  ,

	@AdvertiserId int   ,

	@LastModifiedByAdvertiserUserId int   ,

	@LastModifiedByAdminUserId int   ,

	@JobItemTypeId int   ,

	@ApplicationMethod int   ,

	@ApplicationUrl varchar (8000)  ,

	@UploadMethod int   ,

	@Tags text   ,

	@JobTemplateId int   ,

	@SearchFieldExtension varchar (8)  ,

	@AdvertiserJobTemplateLogoId int   ,

	@CompanyName varchar (255)  ,

	@HashValue varbinary (MAX)  ,

	@RequireLogonForExternalApplications bit   ,

	@ShowLocationDetails bit   ,

	@PublicTransport nvarchar (500)  ,

	@Address varchar (255)  ,

	@ContactDetails nvarchar (510)  ,

	@JobContactPhone varchar (50)  ,

	@JobContactName varchar (255)  ,

	@QualificationsRecognised bit   ,

	@ResidentOnly bit   ,

	@DocumentLink varchar (255)  ,

	@BulletPoint1 nvarchar (160)  ,

	@BulletPoint2 nvarchar (160)  ,

	@BulletPoint3 nvarchar (160)  ,

	@HotJob bit   ,

	@JobFriendlyName varchar (512)  ,

	@SearchField nvarchar (MAX)  ,

	@ShowSalaryRange bit   ,

	@SalaryLowerBand numeric (15, 2)  ,

	@SalaryUpperBand numeric (15, 2)  ,

	@CurrencyId int   ,

	@SalaryTypeId int   ,

	@EnteredByAdvertiserUserId int   ,

	@JobLatitude float   ,

	@JobLongitude float   ,

	@AddressStatus int   ,

	@JobExternalId varchar (50)  ,

	@ScreeningQuestionsTemplateId int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[JobsArchive]
				SET
					[JobID] = @JobId
					,[SiteID] = @SiteId
					,[WorkTypeID] = @WorkTypeId
					,[JobName] = @JobName
					,[Description] = @Description
					,[FullDescription] = @FullDescription
					,[WebServiceProcessed] = @WebServiceProcessed
					,[ApplicationEmailAddress] = @ApplicationEmailAddress
					,[RefNo] = @RefNo
					,[Visible] = @Visible
					,[DatePosted] = @DatePosted
					,[ExpiryDate] = @ExpiryDate
					,[Expired] = @Expired
					,[JobItemPrice] = @JobItemPrice
					,[Billed] = @Billed
					,[LastModified] = @LastModified
					,[ShowSalaryDetails] = @ShowSalaryDetails
					,[SalaryText] = @SalaryText
					,[AdvertiserID] = @AdvertiserId
					,[LastModifiedByAdvertiserUserId] = @LastModifiedByAdvertiserUserId
					,[LastModifiedByAdminUserId] = @LastModifiedByAdminUserId
					,[JobItemTypeID] = @JobItemTypeId
					,[ApplicationMethod] = @ApplicationMethod
					,[ApplicationURL] = @ApplicationUrl
					,[UploadMethod] = @UploadMethod
					,[Tags] = @Tags
					,[JobTemplateID] = @JobTemplateId
					,[SearchFieldExtension] = @SearchFieldExtension
					,[AdvertiserJobTemplateLogoID] = @AdvertiserJobTemplateLogoId
					,[CompanyName] = @CompanyName
					,[HashValue] = @HashValue
					,[RequireLogonForExternalApplications] = @RequireLogonForExternalApplications
					,[ShowLocationDetails] = @ShowLocationDetails
					,[PublicTransport] = @PublicTransport
					,[Address] = @Address
					,[ContactDetails] = @ContactDetails
					,[JobContactPhone] = @JobContactPhone
					,[JobContactName] = @JobContactName
					,[QualificationsRecognised] = @QualificationsRecognised
					,[ResidentOnly] = @ResidentOnly
					,[DocumentLink] = @DocumentLink
					,[BulletPoint1] = @BulletPoint1
					,[BulletPoint2] = @BulletPoint2
					,[BulletPoint3] = @BulletPoint3
					,[HotJob] = @HotJob
					,[JobFriendlyName] = @JobFriendlyName
					,[SearchField] = @SearchField
					,[ShowSalaryRange] = @ShowSalaryRange
					,[SalaryLowerBand] = @SalaryLowerBand
					,[SalaryUpperBand] = @SalaryUpperBand
					,[CurrencyID] = @CurrencyId
					,[SalaryTypeID] = @SalaryTypeId
					,[EnteredByAdvertiserUserID] = @EnteredByAdvertiserUserId
					,[JobLatitude] = @JobLatitude
					,[JobLongitude] = @JobLongitude
					,[AddressStatus] = @AddressStatus
					,[JobExternalId] = @JobExternalId
					,[ScreeningQuestionsTemplateId] = @ScreeningQuestionsTemplateId
				WHERE
[JobID] = @OriginalJobId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobsArchive_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobsArchive_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobsArchive_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the JobsArchive table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobsArchive_Delete
(

	@JobId int   
)
AS


				DELETE FROM [dbo].[JobsArchive] WITH (ROWLOCK) 
				WHERE
					[JobID] = @JobId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobsArchive_GetByAdvertiserId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobsArchive_GetByAdvertiserId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobsArchive_GetByAdvertiserId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobsArchive table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobsArchive_GetByAdvertiserId
(

	@AdvertiserId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobID],
					[SiteID],
					[WorkTypeID],
					[JobName],
					[Description],
					[FullDescription],
					[WebServiceProcessed],
					[ApplicationEmailAddress],
					[RefNo],
					[Visible],
					[DatePosted],
					[ExpiryDate],
					[Expired],
					[JobItemPrice],
					[Billed],
					[LastModified],
					[ShowSalaryDetails],
					[SalaryText],
					[AdvertiserID],
					[LastModifiedByAdvertiserUserId],
					[LastModifiedByAdminUserId],
					[JobItemTypeID],
					[ApplicationMethod],
					[ApplicationURL],
					[UploadMethod],
					[Tags],
					[JobTemplateID],
					[SearchFieldExtension],
					[AdvertiserJobTemplateLogoID],
					[CompanyName],
					[HashValue],
					[RequireLogonForExternalApplications],
					[ShowLocationDetails],
					[PublicTransport],
					[Address],
					[ContactDetails],
					[JobContactPhone],
					[JobContactName],
					[QualificationsRecognised],
					[ResidentOnly],
					[DocumentLink],
					[BulletPoint1],
					[BulletPoint2],
					[BulletPoint3],
					[HotJob],
					[JobFriendlyName],
					[SearchField],
					[ShowSalaryRange],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[EnteredByAdvertiserUserID],
					[JobLatitude],
					[JobLongitude],
					[AddressStatus],
					[JobExternalId],
					[ScreeningQuestionsTemplateId]
				FROM
					[dbo].[JobsArchive]
				WHERE
					[AdvertiserID] = @AdvertiserId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobsArchive_GetByCurrencyId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobsArchive_GetByCurrencyId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobsArchive_GetByCurrencyId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobsArchive table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobsArchive_GetByCurrencyId
(

	@CurrencyId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobID],
					[SiteID],
					[WorkTypeID],
					[JobName],
					[Description],
					[FullDescription],
					[WebServiceProcessed],
					[ApplicationEmailAddress],
					[RefNo],
					[Visible],
					[DatePosted],
					[ExpiryDate],
					[Expired],
					[JobItemPrice],
					[Billed],
					[LastModified],
					[ShowSalaryDetails],
					[SalaryText],
					[AdvertiserID],
					[LastModifiedByAdvertiserUserId],
					[LastModifiedByAdminUserId],
					[JobItemTypeID],
					[ApplicationMethod],
					[ApplicationURL],
					[UploadMethod],
					[Tags],
					[JobTemplateID],
					[SearchFieldExtension],
					[AdvertiserJobTemplateLogoID],
					[CompanyName],
					[HashValue],
					[RequireLogonForExternalApplications],
					[ShowLocationDetails],
					[PublicTransport],
					[Address],
					[ContactDetails],
					[JobContactPhone],
					[JobContactName],
					[QualificationsRecognised],
					[ResidentOnly],
					[DocumentLink],
					[BulletPoint1],
					[BulletPoint2],
					[BulletPoint3],
					[HotJob],
					[JobFriendlyName],
					[SearchField],
					[ShowSalaryRange],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[EnteredByAdvertiserUserID],
					[JobLatitude],
					[JobLongitude],
					[AddressStatus],
					[JobExternalId],
					[ScreeningQuestionsTemplateId]
				FROM
					[dbo].[JobsArchive]
				WHERE
					[CurrencyID] = @CurrencyId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobsArchive_GetByJobTemplateId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobsArchive_GetByJobTemplateId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobsArchive_GetByJobTemplateId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobsArchive table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobsArchive_GetByJobTemplateId
(

	@JobTemplateId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobID],
					[SiteID],
					[WorkTypeID],
					[JobName],
					[Description],
					[FullDescription],
					[WebServiceProcessed],
					[ApplicationEmailAddress],
					[RefNo],
					[Visible],
					[DatePosted],
					[ExpiryDate],
					[Expired],
					[JobItemPrice],
					[Billed],
					[LastModified],
					[ShowSalaryDetails],
					[SalaryText],
					[AdvertiserID],
					[LastModifiedByAdvertiserUserId],
					[LastModifiedByAdminUserId],
					[JobItemTypeID],
					[ApplicationMethod],
					[ApplicationURL],
					[UploadMethod],
					[Tags],
					[JobTemplateID],
					[SearchFieldExtension],
					[AdvertiserJobTemplateLogoID],
					[CompanyName],
					[HashValue],
					[RequireLogonForExternalApplications],
					[ShowLocationDetails],
					[PublicTransport],
					[Address],
					[ContactDetails],
					[JobContactPhone],
					[JobContactName],
					[QualificationsRecognised],
					[ResidentOnly],
					[DocumentLink],
					[BulletPoint1],
					[BulletPoint2],
					[BulletPoint3],
					[HotJob],
					[JobFriendlyName],
					[SearchField],
					[ShowSalaryRange],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[EnteredByAdvertiserUserID],
					[JobLatitude],
					[JobLongitude],
					[AddressStatus],
					[JobExternalId],
					[ScreeningQuestionsTemplateId]
				FROM
					[dbo].[JobsArchive]
				WHERE
					[JobTemplateID] = @JobTemplateId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobsArchive_GetByLastModifiedByAdvertiserUserId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobsArchive_GetByLastModifiedByAdvertiserUserId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobsArchive_GetByLastModifiedByAdvertiserUserId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobsArchive table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobsArchive_GetByLastModifiedByAdvertiserUserId
(

	@LastModifiedByAdvertiserUserId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobID],
					[SiteID],
					[WorkTypeID],
					[JobName],
					[Description],
					[FullDescription],
					[WebServiceProcessed],
					[ApplicationEmailAddress],
					[RefNo],
					[Visible],
					[DatePosted],
					[ExpiryDate],
					[Expired],
					[JobItemPrice],
					[Billed],
					[LastModified],
					[ShowSalaryDetails],
					[SalaryText],
					[AdvertiserID],
					[LastModifiedByAdvertiserUserId],
					[LastModifiedByAdminUserId],
					[JobItemTypeID],
					[ApplicationMethod],
					[ApplicationURL],
					[UploadMethod],
					[Tags],
					[JobTemplateID],
					[SearchFieldExtension],
					[AdvertiserJobTemplateLogoID],
					[CompanyName],
					[HashValue],
					[RequireLogonForExternalApplications],
					[ShowLocationDetails],
					[PublicTransport],
					[Address],
					[ContactDetails],
					[JobContactPhone],
					[JobContactName],
					[QualificationsRecognised],
					[ResidentOnly],
					[DocumentLink],
					[BulletPoint1],
					[BulletPoint2],
					[BulletPoint3],
					[HotJob],
					[JobFriendlyName],
					[SearchField],
					[ShowSalaryRange],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[EnteredByAdvertiserUserID],
					[JobLatitude],
					[JobLongitude],
					[AddressStatus],
					[JobExternalId],
					[ScreeningQuestionsTemplateId]
				FROM
					[dbo].[JobsArchive]
				WHERE
					[LastModifiedByAdvertiserUserId] = @LastModifiedByAdvertiserUserId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobsArchive_GetByLastModifiedByAdminUserId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobsArchive_GetByLastModifiedByAdminUserId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobsArchive_GetByLastModifiedByAdminUserId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobsArchive table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobsArchive_GetByLastModifiedByAdminUserId
(

	@LastModifiedByAdminUserId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobID],
					[SiteID],
					[WorkTypeID],
					[JobName],
					[Description],
					[FullDescription],
					[WebServiceProcessed],
					[ApplicationEmailAddress],
					[RefNo],
					[Visible],
					[DatePosted],
					[ExpiryDate],
					[Expired],
					[JobItemPrice],
					[Billed],
					[LastModified],
					[ShowSalaryDetails],
					[SalaryText],
					[AdvertiserID],
					[LastModifiedByAdvertiserUserId],
					[LastModifiedByAdminUserId],
					[JobItemTypeID],
					[ApplicationMethod],
					[ApplicationURL],
					[UploadMethod],
					[Tags],
					[JobTemplateID],
					[SearchFieldExtension],
					[AdvertiserJobTemplateLogoID],
					[CompanyName],
					[HashValue],
					[RequireLogonForExternalApplications],
					[ShowLocationDetails],
					[PublicTransport],
					[Address],
					[ContactDetails],
					[JobContactPhone],
					[JobContactName],
					[QualificationsRecognised],
					[ResidentOnly],
					[DocumentLink],
					[BulletPoint1],
					[BulletPoint2],
					[BulletPoint3],
					[HotJob],
					[JobFriendlyName],
					[SearchField],
					[ShowSalaryRange],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[EnteredByAdvertiserUserID],
					[JobLatitude],
					[JobLongitude],
					[AddressStatus],
					[JobExternalId],
					[ScreeningQuestionsTemplateId]
				FROM
					[dbo].[JobsArchive]
				WHERE
					[LastModifiedByAdminUserId] = @LastModifiedByAdminUserId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobsArchive_GetBySalaryTypeId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobsArchive_GetBySalaryTypeId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobsArchive_GetBySalaryTypeId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobsArchive table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobsArchive_GetBySalaryTypeId
(

	@SalaryTypeId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobID],
					[SiteID],
					[WorkTypeID],
					[JobName],
					[Description],
					[FullDescription],
					[WebServiceProcessed],
					[ApplicationEmailAddress],
					[RefNo],
					[Visible],
					[DatePosted],
					[ExpiryDate],
					[Expired],
					[JobItemPrice],
					[Billed],
					[LastModified],
					[ShowSalaryDetails],
					[SalaryText],
					[AdvertiserID],
					[LastModifiedByAdvertiserUserId],
					[LastModifiedByAdminUserId],
					[JobItemTypeID],
					[ApplicationMethod],
					[ApplicationURL],
					[UploadMethod],
					[Tags],
					[JobTemplateID],
					[SearchFieldExtension],
					[AdvertiserJobTemplateLogoID],
					[CompanyName],
					[HashValue],
					[RequireLogonForExternalApplications],
					[ShowLocationDetails],
					[PublicTransport],
					[Address],
					[ContactDetails],
					[JobContactPhone],
					[JobContactName],
					[QualificationsRecognised],
					[ResidentOnly],
					[DocumentLink],
					[BulletPoint1],
					[BulletPoint2],
					[BulletPoint3],
					[HotJob],
					[JobFriendlyName],
					[SearchField],
					[ShowSalaryRange],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[EnteredByAdvertiserUserID],
					[JobLatitude],
					[JobLongitude],
					[AddressStatus],
					[JobExternalId],
					[ScreeningQuestionsTemplateId]
				FROM
					[dbo].[JobsArchive]
				WHERE
					[SalaryTypeID] = @SalaryTypeId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobsArchive_GetByScreeningQuestionsTemplateId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobsArchive_GetByScreeningQuestionsTemplateId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobsArchive_GetByScreeningQuestionsTemplateId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobsArchive table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobsArchive_GetByScreeningQuestionsTemplateId
(

	@ScreeningQuestionsTemplateId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobID],
					[SiteID],
					[WorkTypeID],
					[JobName],
					[Description],
					[FullDescription],
					[WebServiceProcessed],
					[ApplicationEmailAddress],
					[RefNo],
					[Visible],
					[DatePosted],
					[ExpiryDate],
					[Expired],
					[JobItemPrice],
					[Billed],
					[LastModified],
					[ShowSalaryDetails],
					[SalaryText],
					[AdvertiserID],
					[LastModifiedByAdvertiserUserId],
					[LastModifiedByAdminUserId],
					[JobItemTypeID],
					[ApplicationMethod],
					[ApplicationURL],
					[UploadMethod],
					[Tags],
					[JobTemplateID],
					[SearchFieldExtension],
					[AdvertiserJobTemplateLogoID],
					[CompanyName],
					[HashValue],
					[RequireLogonForExternalApplications],
					[ShowLocationDetails],
					[PublicTransport],
					[Address],
					[ContactDetails],
					[JobContactPhone],
					[JobContactName],
					[QualificationsRecognised],
					[ResidentOnly],
					[DocumentLink],
					[BulletPoint1],
					[BulletPoint2],
					[BulletPoint3],
					[HotJob],
					[JobFriendlyName],
					[SearchField],
					[ShowSalaryRange],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[EnteredByAdvertiserUserID],
					[JobLatitude],
					[JobLongitude],
					[AddressStatus],
					[JobExternalId],
					[ScreeningQuestionsTemplateId]
				FROM
					[dbo].[JobsArchive]
				WHERE
					[ScreeningQuestionsTemplateId] = @ScreeningQuestionsTemplateId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobsArchive_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobsArchive_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobsArchive_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobsArchive table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobsArchive_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobID],
					[SiteID],
					[WorkTypeID],
					[JobName],
					[Description],
					[FullDescription],
					[WebServiceProcessed],
					[ApplicationEmailAddress],
					[RefNo],
					[Visible],
					[DatePosted],
					[ExpiryDate],
					[Expired],
					[JobItemPrice],
					[Billed],
					[LastModified],
					[ShowSalaryDetails],
					[SalaryText],
					[AdvertiserID],
					[LastModifiedByAdvertiserUserId],
					[LastModifiedByAdminUserId],
					[JobItemTypeID],
					[ApplicationMethod],
					[ApplicationURL],
					[UploadMethod],
					[Tags],
					[JobTemplateID],
					[SearchFieldExtension],
					[AdvertiserJobTemplateLogoID],
					[CompanyName],
					[HashValue],
					[RequireLogonForExternalApplications],
					[ShowLocationDetails],
					[PublicTransport],
					[Address],
					[ContactDetails],
					[JobContactPhone],
					[JobContactName],
					[QualificationsRecognised],
					[ResidentOnly],
					[DocumentLink],
					[BulletPoint1],
					[BulletPoint2],
					[BulletPoint3],
					[HotJob],
					[JobFriendlyName],
					[SearchField],
					[ShowSalaryRange],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[EnteredByAdvertiserUserID],
					[JobLatitude],
					[JobLongitude],
					[AddressStatus],
					[JobExternalId],
					[ScreeningQuestionsTemplateId]
				FROM
					[dbo].[JobsArchive]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobsArchive_GetByWorkTypeId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobsArchive_GetByWorkTypeId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobsArchive_GetByWorkTypeId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobsArchive table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobsArchive_GetByWorkTypeId
(

	@WorkTypeId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobID],
					[SiteID],
					[WorkTypeID],
					[JobName],
					[Description],
					[FullDescription],
					[WebServiceProcessed],
					[ApplicationEmailAddress],
					[RefNo],
					[Visible],
					[DatePosted],
					[ExpiryDate],
					[Expired],
					[JobItemPrice],
					[Billed],
					[LastModified],
					[ShowSalaryDetails],
					[SalaryText],
					[AdvertiserID],
					[LastModifiedByAdvertiserUserId],
					[LastModifiedByAdminUserId],
					[JobItemTypeID],
					[ApplicationMethod],
					[ApplicationURL],
					[UploadMethod],
					[Tags],
					[JobTemplateID],
					[SearchFieldExtension],
					[AdvertiserJobTemplateLogoID],
					[CompanyName],
					[HashValue],
					[RequireLogonForExternalApplications],
					[ShowLocationDetails],
					[PublicTransport],
					[Address],
					[ContactDetails],
					[JobContactPhone],
					[JobContactName],
					[QualificationsRecognised],
					[ResidentOnly],
					[DocumentLink],
					[BulletPoint1],
					[BulletPoint2],
					[BulletPoint3],
					[HotJob],
					[JobFriendlyName],
					[SearchField],
					[ShowSalaryRange],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[EnteredByAdvertiserUserID],
					[JobLatitude],
					[JobLongitude],
					[AddressStatus],
					[JobExternalId],
					[ScreeningQuestionsTemplateId]
				FROM
					[dbo].[JobsArchive]
				WHERE
					[WorkTypeID] = @WorkTypeId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobsArchive_GetByAddressStatus procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobsArchive_GetByAddressStatus') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobsArchive_GetByAddressStatus
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobsArchive table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobsArchive_GetByAddressStatus
(

	@AddressStatus int   
)
AS


				SELECT
					[JobID],
					[SiteID],
					[WorkTypeID],
					[JobName],
					[Description],
					[FullDescription],
					[WebServiceProcessed],
					[ApplicationEmailAddress],
					[RefNo],
					[Visible],
					[DatePosted],
					[ExpiryDate],
					[Expired],
					[JobItemPrice],
					[Billed],
					[LastModified],
					[ShowSalaryDetails],
					[SalaryText],
					[AdvertiserID],
					[LastModifiedByAdvertiserUserId],
					[LastModifiedByAdminUserId],
					[JobItemTypeID],
					[ApplicationMethod],
					[ApplicationURL],
					[UploadMethod],
					[Tags],
					[JobTemplateID],
					[SearchFieldExtension],
					[AdvertiserJobTemplateLogoID],
					[CompanyName],
					[HashValue],
					[RequireLogonForExternalApplications],
					[ShowLocationDetails],
					[PublicTransport],
					[Address],
					[ContactDetails],
					[JobContactPhone],
					[JobContactName],
					[QualificationsRecognised],
					[ResidentOnly],
					[DocumentLink],
					[BulletPoint1],
					[BulletPoint2],
					[BulletPoint3],
					[HotJob],
					[JobFriendlyName],
					[SearchField],
					[ShowSalaryRange],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[EnteredByAdvertiserUserID],
					[JobLatitude],
					[JobLongitude],
					[AddressStatus],
					[JobExternalId],
					[ScreeningQuestionsTemplateId]
				FROM
					[dbo].[JobsArchive]
				WHERE
					[AddressStatus] = @AddressStatus
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobsArchive_GetByAdvertiserIdCurrencyIdSalaryTypeIdSalaryLowerBandSalaryUpperBandWorkTypeIdExpiredExpiryDate procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobsArchive_GetByAdvertiserIdCurrencyIdSalaryTypeIdSalaryLowerBandSalaryUpperBandWorkTypeIdExpiredExpiryDate') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobsArchive_GetByAdvertiserIdCurrencyIdSalaryTypeIdSalaryLowerBandSalaryUpperBandWorkTypeIdExpiredExpiryDate
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobsArchive table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobsArchive_GetByAdvertiserIdCurrencyIdSalaryTypeIdSalaryLowerBandSalaryUpperBandWorkTypeIdExpiredExpiryDate
(

	@AdvertiserId int   ,

	@CurrencyId int   ,

	@SalaryTypeId int   ,

	@SalaryLowerBand numeric (15, 2)  ,

	@SalaryUpperBand numeric (15, 2)  ,

	@WorkTypeId int   ,

	@Expired int   ,

	@ExpiryDate smalldatetime   
)
AS


				SELECT
					[JobID],
					[SiteID],
					[WorkTypeID],
					[JobName],
					[Description],
					[FullDescription],
					[WebServiceProcessed],
					[ApplicationEmailAddress],
					[RefNo],
					[Visible],
					[DatePosted],
					[ExpiryDate],
					[Expired],
					[JobItemPrice],
					[Billed],
					[LastModified],
					[ShowSalaryDetails],
					[SalaryText],
					[AdvertiserID],
					[LastModifiedByAdvertiserUserId],
					[LastModifiedByAdminUserId],
					[JobItemTypeID],
					[ApplicationMethod],
					[ApplicationURL],
					[UploadMethod],
					[Tags],
					[JobTemplateID],
					[SearchFieldExtension],
					[AdvertiserJobTemplateLogoID],
					[CompanyName],
					[HashValue],
					[RequireLogonForExternalApplications],
					[ShowLocationDetails],
					[PublicTransport],
					[Address],
					[ContactDetails],
					[JobContactPhone],
					[JobContactName],
					[QualificationsRecognised],
					[ResidentOnly],
					[DocumentLink],
					[BulletPoint1],
					[BulletPoint2],
					[BulletPoint3],
					[HotJob],
					[JobFriendlyName],
					[SearchField],
					[ShowSalaryRange],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[EnteredByAdvertiserUserID],
					[JobLatitude],
					[JobLongitude],
					[AddressStatus],
					[JobExternalId],
					[ScreeningQuestionsTemplateId]
				FROM
					[dbo].[JobsArchive]
				WHERE
					[AdvertiserID] = @AdvertiserId
					AND [CurrencyID] = @CurrencyId
					AND [SalaryTypeID] = @SalaryTypeId
					AND [SalaryLowerBand] = @SalaryLowerBand
					AND [SalaryUpperBand] = @SalaryUpperBand
					AND [WorkTypeID] = @WorkTypeId
					AND [Expired] = @Expired
					AND [ExpiryDate] = @ExpiryDate
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobsArchive_GetBySiteIdBilledAdvertiserId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobsArchive_GetBySiteIdBilledAdvertiserId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobsArchive_GetBySiteIdBilledAdvertiserId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobsArchive table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobsArchive_GetBySiteIdBilledAdvertiserId
(

	@SiteId int   ,

	@Billed bit   ,

	@AdvertiserId int   
)
AS


				SELECT
					[JobID],
					[SiteID],
					[WorkTypeID],
					[JobName],
					[Description],
					[FullDescription],
					[WebServiceProcessed],
					[ApplicationEmailAddress],
					[RefNo],
					[Visible],
					[DatePosted],
					[ExpiryDate],
					[Expired],
					[JobItemPrice],
					[Billed],
					[LastModified],
					[ShowSalaryDetails],
					[SalaryText],
					[AdvertiserID],
					[LastModifiedByAdvertiserUserId],
					[LastModifiedByAdminUserId],
					[JobItemTypeID],
					[ApplicationMethod],
					[ApplicationURL],
					[UploadMethod],
					[Tags],
					[JobTemplateID],
					[SearchFieldExtension],
					[AdvertiserJobTemplateLogoID],
					[CompanyName],
					[HashValue],
					[RequireLogonForExternalApplications],
					[ShowLocationDetails],
					[PublicTransport],
					[Address],
					[ContactDetails],
					[JobContactPhone],
					[JobContactName],
					[QualificationsRecognised],
					[ResidentOnly],
					[DocumentLink],
					[BulletPoint1],
					[BulletPoint2],
					[BulletPoint3],
					[HotJob],
					[JobFriendlyName],
					[SearchField],
					[ShowSalaryRange],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[EnteredByAdvertiserUserID],
					[JobLatitude],
					[JobLongitude],
					[AddressStatus],
					[JobExternalId],
					[ScreeningQuestionsTemplateId]
				FROM
					[dbo].[JobsArchive]
				WHERE
					[SiteID] = @SiteId
					AND [Billed] = @Billed
					AND [AdvertiserID] = @AdvertiserId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobsArchive_GetBySiteIdBilledAdvertiserIdDatePosted procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobsArchive_GetBySiteIdBilledAdvertiserIdDatePosted') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobsArchive_GetBySiteIdBilledAdvertiserIdDatePosted
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobsArchive table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobsArchive_GetBySiteIdBilledAdvertiserIdDatePosted
(

	@SiteId int   ,

	@Billed bit   ,

	@AdvertiserId int   ,

	@DatePosted smalldatetime   
)
AS


				SELECT
					[JobID],
					[SiteID],
					[WorkTypeID],
					[JobName],
					[Description],
					[FullDescription],
					[WebServiceProcessed],
					[ApplicationEmailAddress],
					[RefNo],
					[Visible],
					[DatePosted],
					[ExpiryDate],
					[Expired],
					[JobItemPrice],
					[Billed],
					[LastModified],
					[ShowSalaryDetails],
					[SalaryText],
					[AdvertiserID],
					[LastModifiedByAdvertiserUserId],
					[LastModifiedByAdminUserId],
					[JobItemTypeID],
					[ApplicationMethod],
					[ApplicationURL],
					[UploadMethod],
					[Tags],
					[JobTemplateID],
					[SearchFieldExtension],
					[AdvertiserJobTemplateLogoID],
					[CompanyName],
					[HashValue],
					[RequireLogonForExternalApplications],
					[ShowLocationDetails],
					[PublicTransport],
					[Address],
					[ContactDetails],
					[JobContactPhone],
					[JobContactName],
					[QualificationsRecognised],
					[ResidentOnly],
					[DocumentLink],
					[BulletPoint1],
					[BulletPoint2],
					[BulletPoint3],
					[HotJob],
					[JobFriendlyName],
					[SearchField],
					[ShowSalaryRange],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[EnteredByAdvertiserUserID],
					[JobLatitude],
					[JobLongitude],
					[AddressStatus],
					[JobExternalId],
					[ScreeningQuestionsTemplateId]
				FROM
					[dbo].[JobsArchive]
				WHERE
					[SiteID] = @SiteId
					AND [Billed] = @Billed
					AND [AdvertiserID] = @AdvertiserId
					AND [DatePosted] = @DatePosted
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobsArchive_GetByJobId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobsArchive_GetByJobId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobsArchive_GetByJobId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobsArchive table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobsArchive_GetByJobId
(

	@JobId int   
)
AS


				SELECT
					[JobID],
					[SiteID],
					[WorkTypeID],
					[JobName],
					[Description],
					[FullDescription],
					[WebServiceProcessed],
					[ApplicationEmailAddress],
					[RefNo],
					[Visible],
					[DatePosted],
					[ExpiryDate],
					[Expired],
					[JobItemPrice],
					[Billed],
					[LastModified],
					[ShowSalaryDetails],
					[SalaryText],
					[AdvertiserID],
					[LastModifiedByAdvertiserUserId],
					[LastModifiedByAdminUserId],
					[JobItemTypeID],
					[ApplicationMethod],
					[ApplicationURL],
					[UploadMethod],
					[Tags],
					[JobTemplateID],
					[SearchFieldExtension],
					[AdvertiserJobTemplateLogoID],
					[CompanyName],
					[HashValue],
					[RequireLogonForExternalApplications],
					[ShowLocationDetails],
					[PublicTransport],
					[Address],
					[ContactDetails],
					[JobContactPhone],
					[JobContactName],
					[QualificationsRecognised],
					[ResidentOnly],
					[DocumentLink],
					[BulletPoint1],
					[BulletPoint2],
					[BulletPoint3],
					[HotJob],
					[JobFriendlyName],
					[SearchField],
					[ShowSalaryRange],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[EnteredByAdvertiserUserID],
					[JobLatitude],
					[JobLongitude],
					[AddressStatus],
					[JobExternalId],
					[ScreeningQuestionsTemplateId]
				FROM
					[dbo].[JobsArchive]
				WHERE
					[JobID] = @JobId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobsArchive_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobsArchive_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobsArchive_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the JobsArchive table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobsArchive_Find
(

	@SearchUsingOR bit   = null ,

	@JobId int   = null ,

	@SiteId int   = null ,

	@WorkTypeId int   = null ,

	@JobName nvarchar (510)  = null ,

	@Description nvarchar (2000)  = null ,

	@FullDescription nvarchar (MAX)  = null ,

	@WebServiceProcessed bit   = null ,

	@ApplicationEmailAddress varchar (255)  = null ,

	@RefNo varchar (255)  = null ,

	@Visible bit   = null ,

	@DatePosted smalldatetime   = null ,

	@ExpiryDate smalldatetime   = null ,

	@Expired int   = null ,

	@JobItemPrice money   = null ,

	@Billed bit   = null ,

	@LastModified datetime   = null ,

	@ShowSalaryDetails bit   = null ,

	@SalaryText varchar (500)  = null ,

	@AdvertiserId int   = null ,

	@LastModifiedByAdvertiserUserId int   = null ,

	@LastModifiedByAdminUserId int   = null ,

	@JobItemTypeId int   = null ,

	@ApplicationMethod int   = null ,

	@ApplicationUrl varchar (8000)  = null ,

	@UploadMethod int   = null ,

	@Tags text   = null ,

	@JobTemplateId int   = null ,

	@SearchFieldExtension varchar (8)  = null ,

	@AdvertiserJobTemplateLogoId int   = null ,

	@CompanyName varchar (255)  = null ,

	@HashValue varbinary (MAX)  = null ,

	@RequireLogonForExternalApplications bit   = null ,

	@ShowLocationDetails bit   = null ,

	@PublicTransport nvarchar (500)  = null ,

	@Address varchar (255)  = null ,

	@ContactDetails nvarchar (510)  = null ,

	@JobContactPhone varchar (50)  = null ,

	@JobContactName varchar (255)  = null ,

	@QualificationsRecognised bit   = null ,

	@ResidentOnly bit   = null ,

	@DocumentLink varchar (255)  = null ,

	@BulletPoint1 nvarchar (160)  = null ,

	@BulletPoint2 nvarchar (160)  = null ,

	@BulletPoint3 nvarchar (160)  = null ,

	@HotJob bit   = null ,

	@JobFriendlyName varchar (512)  = null ,

	@SearchField nvarchar (MAX)  = null ,

	@ShowSalaryRange bit   = null ,

	@SalaryLowerBand numeric (15, 2)  = null ,

	@SalaryUpperBand numeric (15, 2)  = null ,

	@CurrencyId int   = null ,

	@SalaryTypeId int   = null ,

	@EnteredByAdvertiserUserId int   = null ,

	@JobLatitude float   = null ,

	@JobLongitude float   = null ,

	@AddressStatus int   = null ,

	@JobExternalId varchar (50)  = null ,

	@ScreeningQuestionsTemplateId int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [JobID]
	, [SiteID]
	, [WorkTypeID]
	, [JobName]
	, [Description]
	, [FullDescription]
	, [WebServiceProcessed]
	, [ApplicationEmailAddress]
	, [RefNo]
	, [Visible]
	, [DatePosted]
	, [ExpiryDate]
	, [Expired]
	, [JobItemPrice]
	, [Billed]
	, [LastModified]
	, [ShowSalaryDetails]
	, [SalaryText]
	, [AdvertiserID]
	, [LastModifiedByAdvertiserUserId]
	, [LastModifiedByAdminUserId]
	, [JobItemTypeID]
	, [ApplicationMethod]
	, [ApplicationURL]
	, [UploadMethod]
	, [Tags]
	, [JobTemplateID]
	, [SearchFieldExtension]
	, [AdvertiserJobTemplateLogoID]
	, [CompanyName]
	, [HashValue]
	, [RequireLogonForExternalApplications]
	, [ShowLocationDetails]
	, [PublicTransport]
	, [Address]
	, [ContactDetails]
	, [JobContactPhone]
	, [JobContactName]
	, [QualificationsRecognised]
	, [ResidentOnly]
	, [DocumentLink]
	, [BulletPoint1]
	, [BulletPoint2]
	, [BulletPoint3]
	, [HotJob]
	, [JobFriendlyName]
	, [SearchField]
	, [ShowSalaryRange]
	, [SalaryLowerBand]
	, [SalaryUpperBand]
	, [CurrencyID]
	, [SalaryTypeID]
	, [EnteredByAdvertiserUserID]
	, [JobLatitude]
	, [JobLongitude]
	, [AddressStatus]
	, [JobExternalId]
	, [ScreeningQuestionsTemplateId]
    FROM
	[dbo].[JobsArchive]
    WHERE 
	 ([JobID] = @JobId OR @JobId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([WorkTypeID] = @WorkTypeId OR @WorkTypeId IS NULL)
	AND ([JobName] = @JobName OR @JobName IS NULL)
	AND ([Description] = @Description OR @Description IS NULL)
	AND ([FullDescription] = @FullDescription OR @FullDescription IS NULL)
	AND ([WebServiceProcessed] = @WebServiceProcessed OR @WebServiceProcessed IS NULL)
	AND ([ApplicationEmailAddress] = @ApplicationEmailAddress OR @ApplicationEmailAddress IS NULL)
	AND ([RefNo] = @RefNo OR @RefNo IS NULL)
	AND ([Visible] = @Visible OR @Visible IS NULL)
	AND ([DatePosted] = @DatePosted OR @DatePosted IS NULL)
	AND ([ExpiryDate] = @ExpiryDate OR @ExpiryDate IS NULL)
	AND ([Expired] = @Expired OR @Expired IS NULL)
	AND ([JobItemPrice] = @JobItemPrice OR @JobItemPrice IS NULL)
	AND ([Billed] = @Billed OR @Billed IS NULL)
	AND ([LastModified] = @LastModified OR @LastModified IS NULL)
	AND ([ShowSalaryDetails] = @ShowSalaryDetails OR @ShowSalaryDetails IS NULL)
	AND ([SalaryText] = @SalaryText OR @SalaryText IS NULL)
	AND ([AdvertiserID] = @AdvertiserId OR @AdvertiserId IS NULL)
	AND ([LastModifiedByAdvertiserUserId] = @LastModifiedByAdvertiserUserId OR @LastModifiedByAdvertiserUserId IS NULL)
	AND ([LastModifiedByAdminUserId] = @LastModifiedByAdminUserId OR @LastModifiedByAdminUserId IS NULL)
	AND ([JobItemTypeID] = @JobItemTypeId OR @JobItemTypeId IS NULL)
	AND ([ApplicationMethod] = @ApplicationMethod OR @ApplicationMethod IS NULL)
	AND ([ApplicationURL] = @ApplicationUrl OR @ApplicationUrl IS NULL)
	AND ([UploadMethod] = @UploadMethod OR @UploadMethod IS NULL)
	AND ([JobTemplateID] = @JobTemplateId OR @JobTemplateId IS NULL)
	AND ([SearchFieldExtension] = @SearchFieldExtension OR @SearchFieldExtension IS NULL)
	AND ([AdvertiserJobTemplateLogoID] = @AdvertiserJobTemplateLogoId OR @AdvertiserJobTemplateLogoId IS NULL)
	AND ([CompanyName] = @CompanyName OR @CompanyName IS NULL)
	AND ([RequireLogonForExternalApplications] = @RequireLogonForExternalApplications OR @RequireLogonForExternalApplications IS NULL)
	AND ([ShowLocationDetails] = @ShowLocationDetails OR @ShowLocationDetails IS NULL)
	AND ([PublicTransport] = @PublicTransport OR @PublicTransport IS NULL)
	AND ([Address] = @Address OR @Address IS NULL)
	AND ([ContactDetails] = @ContactDetails OR @ContactDetails IS NULL)
	AND ([JobContactPhone] = @JobContactPhone OR @JobContactPhone IS NULL)
	AND ([JobContactName] = @JobContactName OR @JobContactName IS NULL)
	AND ([QualificationsRecognised] = @QualificationsRecognised OR @QualificationsRecognised IS NULL)
	AND ([ResidentOnly] = @ResidentOnly OR @ResidentOnly IS NULL)
	AND ([DocumentLink] = @DocumentLink OR @DocumentLink IS NULL)
	AND ([BulletPoint1] = @BulletPoint1 OR @BulletPoint1 IS NULL)
	AND ([BulletPoint2] = @BulletPoint2 OR @BulletPoint2 IS NULL)
	AND ([BulletPoint3] = @BulletPoint3 OR @BulletPoint3 IS NULL)
	AND ([HotJob] = @HotJob OR @HotJob IS NULL)
	AND ([JobFriendlyName] = @JobFriendlyName OR @JobFriendlyName IS NULL)
	AND ([SearchField] = @SearchField OR @SearchField IS NULL)
	AND ([ShowSalaryRange] = @ShowSalaryRange OR @ShowSalaryRange IS NULL)
	AND ([SalaryLowerBand] = @SalaryLowerBand OR @SalaryLowerBand IS NULL)
	AND ([SalaryUpperBand] = @SalaryUpperBand OR @SalaryUpperBand IS NULL)
	AND ([CurrencyID] = @CurrencyId OR @CurrencyId IS NULL)
	AND ([SalaryTypeID] = @SalaryTypeId OR @SalaryTypeId IS NULL)
	AND ([EnteredByAdvertiserUserID] = @EnteredByAdvertiserUserId OR @EnteredByAdvertiserUserId IS NULL)
	AND ([JobLatitude] = @JobLatitude OR @JobLatitude IS NULL)
	AND ([JobLongitude] = @JobLongitude OR @JobLongitude IS NULL)
	AND ([AddressStatus] = @AddressStatus OR @AddressStatus IS NULL)
	AND ([JobExternalId] = @JobExternalId OR @JobExternalId IS NULL)
	AND ([ScreeningQuestionsTemplateId] = @ScreeningQuestionsTemplateId OR @ScreeningQuestionsTemplateId IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [JobID]
	, [SiteID]
	, [WorkTypeID]
	, [JobName]
	, [Description]
	, [FullDescription]
	, [WebServiceProcessed]
	, [ApplicationEmailAddress]
	, [RefNo]
	, [Visible]
	, [DatePosted]
	, [ExpiryDate]
	, [Expired]
	, [JobItemPrice]
	, [Billed]
	, [LastModified]
	, [ShowSalaryDetails]
	, [SalaryText]
	, [AdvertiserID]
	, [LastModifiedByAdvertiserUserId]
	, [LastModifiedByAdminUserId]
	, [JobItemTypeID]
	, [ApplicationMethod]
	, [ApplicationURL]
	, [UploadMethod]
	, [Tags]
	, [JobTemplateID]
	, [SearchFieldExtension]
	, [AdvertiserJobTemplateLogoID]
	, [CompanyName]
	, [HashValue]
	, [RequireLogonForExternalApplications]
	, [ShowLocationDetails]
	, [PublicTransport]
	, [Address]
	, [ContactDetails]
	, [JobContactPhone]
	, [JobContactName]
	, [QualificationsRecognised]
	, [ResidentOnly]
	, [DocumentLink]
	, [BulletPoint1]
	, [BulletPoint2]
	, [BulletPoint3]
	, [HotJob]
	, [JobFriendlyName]
	, [SearchField]
	, [ShowSalaryRange]
	, [SalaryLowerBand]
	, [SalaryUpperBand]
	, [CurrencyID]
	, [SalaryTypeID]
	, [EnteredByAdvertiserUserID]
	, [JobLatitude]
	, [JobLongitude]
	, [AddressStatus]
	, [JobExternalId]
	, [ScreeningQuestionsTemplateId]
    FROM
	[dbo].[JobsArchive]
    WHERE 
	 ([JobID] = @JobId AND @JobId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([WorkTypeID] = @WorkTypeId AND @WorkTypeId is not null)
	OR ([JobName] = @JobName AND @JobName is not null)
	OR ([Description] = @Description AND @Description is not null)
	OR ([FullDescription] = @FullDescription AND @FullDescription is not null)
	OR ([WebServiceProcessed] = @WebServiceProcessed AND @WebServiceProcessed is not null)
	OR ([ApplicationEmailAddress] = @ApplicationEmailAddress AND @ApplicationEmailAddress is not null)
	OR ([RefNo] = @RefNo AND @RefNo is not null)
	OR ([Visible] = @Visible AND @Visible is not null)
	OR ([DatePosted] = @DatePosted AND @DatePosted is not null)
	OR ([ExpiryDate] = @ExpiryDate AND @ExpiryDate is not null)
	OR ([Expired] = @Expired AND @Expired is not null)
	OR ([JobItemPrice] = @JobItemPrice AND @JobItemPrice is not null)
	OR ([Billed] = @Billed AND @Billed is not null)
	OR ([LastModified] = @LastModified AND @LastModified is not null)
	OR ([ShowSalaryDetails] = @ShowSalaryDetails AND @ShowSalaryDetails is not null)
	OR ([SalaryText] = @SalaryText AND @SalaryText is not null)
	OR ([AdvertiserID] = @AdvertiserId AND @AdvertiserId is not null)
	OR ([LastModifiedByAdvertiserUserId] = @LastModifiedByAdvertiserUserId AND @LastModifiedByAdvertiserUserId is not null)
	OR ([LastModifiedByAdminUserId] = @LastModifiedByAdminUserId AND @LastModifiedByAdminUserId is not null)
	OR ([JobItemTypeID] = @JobItemTypeId AND @JobItemTypeId is not null)
	OR ([ApplicationMethod] = @ApplicationMethod AND @ApplicationMethod is not null)
	OR ([ApplicationURL] = @ApplicationUrl AND @ApplicationUrl is not null)
	OR ([UploadMethod] = @UploadMethod AND @UploadMethod is not null)
	OR ([JobTemplateID] = @JobTemplateId AND @JobTemplateId is not null)
	OR ([SearchFieldExtension] = @SearchFieldExtension AND @SearchFieldExtension is not null)
	OR ([AdvertiserJobTemplateLogoID] = @AdvertiserJobTemplateLogoId AND @AdvertiserJobTemplateLogoId is not null)
	OR ([CompanyName] = @CompanyName AND @CompanyName is not null)
	OR ([RequireLogonForExternalApplications] = @RequireLogonForExternalApplications AND @RequireLogonForExternalApplications is not null)
	OR ([ShowLocationDetails] = @ShowLocationDetails AND @ShowLocationDetails is not null)
	OR ([PublicTransport] = @PublicTransport AND @PublicTransport is not null)
	OR ([Address] = @Address AND @Address is not null)
	OR ([ContactDetails] = @ContactDetails AND @ContactDetails is not null)
	OR ([JobContactPhone] = @JobContactPhone AND @JobContactPhone is not null)
	OR ([JobContactName] = @JobContactName AND @JobContactName is not null)
	OR ([QualificationsRecognised] = @QualificationsRecognised AND @QualificationsRecognised is not null)
	OR ([ResidentOnly] = @ResidentOnly AND @ResidentOnly is not null)
	OR ([DocumentLink] = @DocumentLink AND @DocumentLink is not null)
	OR ([BulletPoint1] = @BulletPoint1 AND @BulletPoint1 is not null)
	OR ([BulletPoint2] = @BulletPoint2 AND @BulletPoint2 is not null)
	OR ([BulletPoint3] = @BulletPoint3 AND @BulletPoint3 is not null)
	OR ([HotJob] = @HotJob AND @HotJob is not null)
	OR ([JobFriendlyName] = @JobFriendlyName AND @JobFriendlyName is not null)
	OR ([SearchField] = @SearchField AND @SearchField is not null)
	OR ([ShowSalaryRange] = @ShowSalaryRange AND @ShowSalaryRange is not null)
	OR ([SalaryLowerBand] = @SalaryLowerBand AND @SalaryLowerBand is not null)
	OR ([SalaryUpperBand] = @SalaryUpperBand AND @SalaryUpperBand is not null)
	OR ([CurrencyID] = @CurrencyId AND @CurrencyId is not null)
	OR ([SalaryTypeID] = @SalaryTypeId AND @SalaryTypeId is not null)
	OR ([EnteredByAdvertiserUserID] = @EnteredByAdvertiserUserId AND @EnteredByAdvertiserUserId is not null)
	OR ([JobLatitude] = @JobLatitude AND @JobLatitude is not null)
	OR ([JobLongitude] = @JobLongitude AND @JobLongitude is not null)
	OR ([AddressStatus] = @AddressStatus AND @AddressStatus is not null)
	OR ([JobExternalId] = @JobExternalId AND @JobExternalId is not null)
	OR ([ScreeningQuestionsTemplateId] = @ScreeningQuestionsTemplateId AND @ScreeningQuestionsTemplateId is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobViews_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobViews_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobViews_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the JobViews table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobViews_Get_List

AS


				
				SELECT
					[JobViewID],
					[SiteID],
					[JobID],
					[ViewDate],
					[TotalView],
					[JobArchiveID],
					[DomainReferral]
				FROM
					[dbo].[JobViews]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobViews_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobViews_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobViews_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the JobViews table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobViews_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [JobViewID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([JobViewID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [JobViewID]'
				SET @SQL = @SQL + ' FROM [dbo].[JobViews]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[JobViewID], O.[SiteID], O.[JobID], O.[ViewDate], O.[TotalView], O.[JobArchiveID], O.[DomainReferral]
				FROM
				    [dbo].[JobViews] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[JobViewID] = PageIndex.[JobViewID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[JobViews]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobViews_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobViews_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobViews_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the JobViews table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobViews_Insert
(

	@JobViewId int    OUTPUT,

	@SiteId int   ,

	@JobId int   ,

	@ViewDate smalldatetime   ,

	@TotalView int   ,

	@JobArchiveId int   ,

	@DomainReferral varchar (255)  
)
AS


				
				INSERT INTO [dbo].[JobViews]
					(
					[SiteID]
					,[JobID]
					,[ViewDate]
					,[TotalView]
					,[JobArchiveID]
					,[DomainReferral]
					)
				VALUES
					(
					@SiteId
					,@JobId
					,@ViewDate
					,@TotalView
					,@JobArchiveId
					,@DomainReferral
					)
				
				-- Get the identity value
				SET @JobViewId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobViews_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobViews_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobViews_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the JobViews table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobViews_Update
(

	@JobViewId int   ,

	@SiteId int   ,

	@JobId int   ,

	@ViewDate smalldatetime   ,

	@TotalView int   ,

	@JobArchiveId int   ,

	@DomainReferral varchar (255)  
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[JobViews]
				SET
					[SiteID] = @SiteId
					,[JobID] = @JobId
					,[ViewDate] = @ViewDate
					,[TotalView] = @TotalView
					,[JobArchiveID] = @JobArchiveId
					,[DomainReferral] = @DomainReferral
				WHERE
[JobViewID] = @JobViewId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobViews_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobViews_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobViews_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the JobViews table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobViews_Delete
(

	@JobViewId int   
)
AS


				DELETE FROM [dbo].[JobViews] WITH (ROWLOCK) 
				WHERE
					[JobViewID] = @JobViewId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobViews_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobViews_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobViews_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobViews table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobViews_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobViewID],
					[SiteID],
					[JobID],
					[ViewDate],
					[TotalView],
					[JobArchiveID],
					[DomainReferral]
				FROM
					[dbo].[JobViews]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobViews_GetByJobArchiveId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobViews_GetByJobArchiveId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobViews_GetByJobArchiveId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobViews table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobViews_GetByJobArchiveId
(

	@JobArchiveId int   
)
AS


				SELECT
					[JobViewID],
					[SiteID],
					[JobID],
					[ViewDate],
					[TotalView],
					[JobArchiveID],
					[DomainReferral]
				FROM
					[dbo].[JobViews]
				WHERE
					[JobArchiveID] = @JobArchiveId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobViews_GetByJobId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobViews_GetByJobId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobViews_GetByJobId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobViews table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobViews_GetByJobId
(

	@JobId int   
)
AS


				SELECT
					[JobViewID],
					[SiteID],
					[JobID],
					[ViewDate],
					[TotalView],
					[JobArchiveID],
					[DomainReferral]
				FROM
					[dbo].[JobViews]
				WHERE
					[JobID] = @JobId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobViews_GetBySiteIdJobIdJobArchiveIdViewDateDomainReferral procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobViews_GetBySiteIdJobIdJobArchiveIdViewDateDomainReferral') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobViews_GetBySiteIdJobIdJobArchiveIdViewDateDomainReferral
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobViews table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobViews_GetBySiteIdJobIdJobArchiveIdViewDateDomainReferral
(

	@SiteId int   ,

	@JobId int   ,

	@JobArchiveId int   ,

	@ViewDate smalldatetime   ,

	@DomainReferral varchar (255)  
)
AS


				SELECT
					[JobViewID],
					[SiteID],
					[JobID],
					[ViewDate],
					[TotalView],
					[JobArchiveID],
					[DomainReferral]
				FROM
					[dbo].[JobViews]
				WHERE
					[SiteID] = @SiteId
					AND [JobID] = @JobId
					AND [JobArchiveID] = @JobArchiveId
					AND [ViewDate] = @ViewDate
					AND [DomainReferral] = @DomainReferral
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobViews_GetByJobViewId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobViews_GetByJobViewId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobViews_GetByJobViewId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobViews table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobViews_GetByJobViewId
(

	@JobViewId int   
)
AS


				SELECT
					[JobViewID],
					[SiteID],
					[JobID],
					[ViewDate],
					[TotalView],
					[JobArchiveID],
					[DomainReferral]
				FROM
					[dbo].[JobViews]
				WHERE
					[JobViewID] = @JobViewId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobViews_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobViews_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobViews_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the JobViews table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobViews_Find
(

	@SearchUsingOR bit   = null ,

	@JobViewId int   = null ,

	@SiteId int   = null ,

	@JobId int   = null ,

	@ViewDate smalldatetime   = null ,

	@TotalView int   = null ,

	@JobArchiveId int   = null ,

	@DomainReferral varchar (255)  = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [JobViewID]
	, [SiteID]
	, [JobID]
	, [ViewDate]
	, [TotalView]
	, [JobArchiveID]
	, [DomainReferral]
    FROM
	[dbo].[JobViews]
    WHERE 
	 ([JobViewID] = @JobViewId OR @JobViewId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([JobID] = @JobId OR @JobId IS NULL)
	AND ([ViewDate] = @ViewDate OR @ViewDate IS NULL)
	AND ([TotalView] = @TotalView OR @TotalView IS NULL)
	AND ([JobArchiveID] = @JobArchiveId OR @JobArchiveId IS NULL)
	AND ([DomainReferral] = @DomainReferral OR @DomainReferral IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [JobViewID]
	, [SiteID]
	, [JobID]
	, [ViewDate]
	, [TotalView]
	, [JobArchiveID]
	, [DomainReferral]
    FROM
	[dbo].[JobViews]
    WHERE 
	 ([JobViewID] = @JobViewId AND @JobViewId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([JobID] = @JobId AND @JobId is not null)
	OR ([ViewDate] = @ViewDate AND @ViewDate is not null)
	OR ([TotalView] = @TotalView AND @TotalView is not null)
	OR ([JobArchiveID] = @JobArchiveId AND @JobArchiveId is not null)
	OR ([DomainReferral] = @DomainReferral AND @DomainReferral is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobsSaved_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobsSaved_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobsSaved_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the JobsSaved table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobsSaved_Get_List

AS


				
				SELECT
					[JobSaveID],
					[JobID],
					[MemberID],
					[LastModified],
					[JobArchiveID]
				FROM
					[dbo].[JobsSaved]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobsSaved_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobsSaved_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobsSaved_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the JobsSaved table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobsSaved_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [JobSaveID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([JobSaveID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [JobSaveID]'
				SET @SQL = @SQL + ' FROM [dbo].[JobsSaved]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[JobSaveID], O.[JobID], O.[MemberID], O.[LastModified], O.[JobArchiveID]
				FROM
				    [dbo].[JobsSaved] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[JobSaveID] = PageIndex.[JobSaveID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[JobsSaved]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobsSaved_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobsSaved_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobsSaved_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the JobsSaved table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobsSaved_Insert
(

	@JobSaveId int    OUTPUT,

	@JobId int   ,

	@MemberId int   ,

	@LastModified datetime   ,

	@JobArchiveId int   
)
AS


				
				INSERT INTO [dbo].[JobsSaved]
					(
					[JobID]
					,[MemberID]
					,[LastModified]
					,[JobArchiveID]
					)
				VALUES
					(
					@JobId
					,@MemberId
					,@LastModified
					,@JobArchiveId
					)
				
				-- Get the identity value
				SET @JobSaveId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobsSaved_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobsSaved_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobsSaved_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the JobsSaved table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobsSaved_Update
(

	@JobSaveId int   ,

	@JobId int   ,

	@MemberId int   ,

	@LastModified datetime   ,

	@JobArchiveId int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[JobsSaved]
				SET
					[JobID] = @JobId
					,[MemberID] = @MemberId
					,[LastModified] = @LastModified
					,[JobArchiveID] = @JobArchiveId
				WHERE
[JobSaveID] = @JobSaveId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobsSaved_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobsSaved_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobsSaved_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the JobsSaved table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobsSaved_Delete
(

	@JobSaveId int   
)
AS


				DELETE FROM [dbo].[JobsSaved] WITH (ROWLOCK) 
				WHERE
					[JobSaveID] = @JobSaveId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobsSaved_GetByJobArchiveId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobsSaved_GetByJobArchiveId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobsSaved_GetByJobArchiveId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobsSaved table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobsSaved_GetByJobArchiveId
(

	@JobArchiveId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobSaveID],
					[JobID],
					[MemberID],
					[LastModified],
					[JobArchiveID]
				FROM
					[dbo].[JobsSaved]
				WHERE
					[JobArchiveID] = @JobArchiveId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobsSaved_GetByJobId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobsSaved_GetByJobId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobsSaved_GetByJobId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobsSaved table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobsSaved_GetByJobId
(

	@JobId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobSaveID],
					[JobID],
					[MemberID],
					[LastModified],
					[JobArchiveID]
				FROM
					[dbo].[JobsSaved]
				WHERE
					[JobID] = @JobId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobsSaved_GetByMemberId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobsSaved_GetByMemberId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobsSaved_GetByMemberId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobsSaved table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobsSaved_GetByMemberId
(

	@MemberId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobSaveID],
					[JobID],
					[MemberID],
					[LastModified],
					[JobArchiveID]
				FROM
					[dbo].[JobsSaved]
				WHERE
					[MemberID] = @MemberId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobsSaved_GetByJobSaveId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobsSaved_GetByJobSaveId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobsSaved_GetByJobSaveId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobsSaved table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobsSaved_GetByJobSaveId
(

	@JobSaveId int   
)
AS


				SELECT
					[JobSaveID],
					[JobID],
					[MemberID],
					[LastModified],
					[JobArchiveID]
				FROM
					[dbo].[JobsSaved]
				WHERE
					[JobSaveID] = @JobSaveId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobsSaved_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobsSaved_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobsSaved_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the JobsSaved table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobsSaved_Find
(

	@SearchUsingOR bit   = null ,

	@JobSaveId int   = null ,

	@JobId int   = null ,

	@MemberId int   = null ,

	@LastModified datetime   = null ,

	@JobArchiveId int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [JobSaveID]
	, [JobID]
	, [MemberID]
	, [LastModified]
	, [JobArchiveID]
    FROM
	[dbo].[JobsSaved]
    WHERE 
	 ([JobSaveID] = @JobSaveId OR @JobSaveId IS NULL)
	AND ([JobID] = @JobId OR @JobId IS NULL)
	AND ([MemberID] = @MemberId OR @MemberId IS NULL)
	AND ([LastModified] = @LastModified OR @LastModified IS NULL)
	AND ([JobArchiveID] = @JobArchiveId OR @JobArchiveId IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [JobSaveID]
	, [JobID]
	, [MemberID]
	, [LastModified]
	, [JobArchiveID]
    FROM
	[dbo].[JobsSaved]
    WHERE 
	 ([JobSaveID] = @JobSaveId AND @JobSaveId is not null)
	OR ([JobID] = @JobId AND @JobId is not null)
	OR ([MemberID] = @MemberId AND @MemberId is not null)
	OR ([LastModified] = @LastModified AND @LastModified is not null)
	OR ([JobArchiveID] = @JobArchiveId AND @JobArchiveId is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobCustomXML_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobCustomXML_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobCustomXML_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the JobCustomXML table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobCustomXML_Get_List

AS


				
				SELECT
					[JobCustomXMLID],
					[SiteID],
					[UniqueCode],
					[CustomXML],
					[CustomType],
					[JobID],
					[JobArchiveID],
					[IsDefault],
					[AdvertiserID],
					[LanguageIDs],
					[Valid]
				FROM
					[dbo].[JobCustomXML]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobCustomXML_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobCustomXML_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobCustomXML_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the JobCustomXML table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobCustomXML_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [JobCustomXMLID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([JobCustomXMLID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [JobCustomXMLID]'
				SET @SQL = @SQL + ' FROM [dbo].[JobCustomXML]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[JobCustomXMLID], O.[SiteID], O.[UniqueCode], O.[CustomXML], O.[CustomType], O.[JobID], O.[JobArchiveID], O.[IsDefault], O.[AdvertiserID], O.[LanguageIDs], O.[Valid]
				FROM
				    [dbo].[JobCustomXML] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[JobCustomXMLID] = PageIndex.[JobCustomXMLID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[JobCustomXML]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobCustomXML_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobCustomXML_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobCustomXML_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the JobCustomXML table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobCustomXML_Insert
(

	@JobCustomXmlid int    OUTPUT,

	@SiteId int   ,

	@UniqueCode nvarchar (100)  ,

	@CustomXml nvarchar (MAX)  ,

	@CustomType int   ,

	@JobId int   ,

	@JobArchiveId int   ,

	@IsDefault bit   ,

	@AdvertiserId int   ,

	@LanguageIds varchar (100)  ,

	@Valid bit   
)
AS


				
				INSERT INTO [dbo].[JobCustomXML]
					(
					[SiteID]
					,[UniqueCode]
					,[CustomXML]
					,[CustomType]
					,[JobID]
					,[JobArchiveID]
					,[IsDefault]
					,[AdvertiserID]
					,[LanguageIDs]
					,[Valid]
					)
				VALUES
					(
					@SiteId
					,@UniqueCode
					,@CustomXml
					,@CustomType
					,@JobId
					,@JobArchiveId
					,@IsDefault
					,@AdvertiserId
					,@LanguageIds
					,@Valid
					)
				
				-- Get the identity value
				SET @JobCustomXmlid = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobCustomXML_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobCustomXML_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobCustomXML_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the JobCustomXML table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobCustomXML_Update
(

	@JobCustomXmlid int   ,

	@SiteId int   ,

	@UniqueCode nvarchar (100)  ,

	@CustomXml nvarchar (MAX)  ,

	@CustomType int   ,

	@JobId int   ,

	@JobArchiveId int   ,

	@IsDefault bit   ,

	@AdvertiserId int   ,

	@LanguageIds varchar (100)  ,

	@Valid bit   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[JobCustomXML]
				SET
					[SiteID] = @SiteId
					,[UniqueCode] = @UniqueCode
					,[CustomXML] = @CustomXml
					,[CustomType] = @CustomType
					,[JobID] = @JobId
					,[JobArchiveID] = @JobArchiveId
					,[IsDefault] = @IsDefault
					,[AdvertiserID] = @AdvertiserId
					,[LanguageIDs] = @LanguageIds
					,[Valid] = @Valid
				WHERE
[JobCustomXMLID] = @JobCustomXmlid 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobCustomXML_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobCustomXML_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobCustomXML_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the JobCustomXML table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobCustomXML_Delete
(

	@JobCustomXmlid int   
)
AS


				DELETE FROM [dbo].[JobCustomXML] WITH (ROWLOCK) 
				WHERE
					[JobCustomXMLID] = @JobCustomXmlid
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobCustomXML_GetByAdvertiserId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobCustomXML_GetByAdvertiserId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobCustomXML_GetByAdvertiserId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobCustomXML table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobCustomXML_GetByAdvertiserId
(

	@AdvertiserId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobCustomXMLID],
					[SiteID],
					[UniqueCode],
					[CustomXML],
					[CustomType],
					[JobID],
					[JobArchiveID],
					[IsDefault],
					[AdvertiserID],
					[LanguageIDs],
					[Valid]
				FROM
					[dbo].[JobCustomXML]
				WHERE
					[AdvertiserID] = @AdvertiserId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobCustomXML_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobCustomXML_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobCustomXML_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobCustomXML table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobCustomXML_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobCustomXMLID],
					[SiteID],
					[UniqueCode],
					[CustomXML],
					[CustomType],
					[JobID],
					[JobArchiveID],
					[IsDefault],
					[AdvertiserID],
					[LanguageIDs],
					[Valid]
				FROM
					[dbo].[JobCustomXML]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobCustomXML_GetByJobCustomXmlid procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobCustomXML_GetByJobCustomXmlid') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobCustomXML_GetByJobCustomXmlid
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobCustomXML table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobCustomXML_GetByJobCustomXmlid
(

	@JobCustomXmlid int   
)
AS


				SELECT
					[JobCustomXMLID],
					[SiteID],
					[UniqueCode],
					[CustomXML],
					[CustomType],
					[JobID],
					[JobArchiveID],
					[IsDefault],
					[AdvertiserID],
					[LanguageIDs],
					[Valid]
				FROM
					[dbo].[JobCustomXML]
				WHERE
					[JobCustomXMLID] = @JobCustomXmlid
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobCustomXML_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobCustomXML_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobCustomXML_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the JobCustomXML table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobCustomXML_Find
(

	@SearchUsingOR bit   = null ,

	@JobCustomXmlid int   = null ,

	@SiteId int   = null ,

	@UniqueCode nvarchar (100)  = null ,

	@CustomXml nvarchar (MAX)  = null ,

	@CustomType int   = null ,

	@JobId int   = null ,

	@JobArchiveId int   = null ,

	@IsDefault bit   = null ,

	@AdvertiserId int   = null ,

	@LanguageIds varchar (100)  = null ,

	@Valid bit   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [JobCustomXMLID]
	, [SiteID]
	, [UniqueCode]
	, [CustomXML]
	, [CustomType]
	, [JobID]
	, [JobArchiveID]
	, [IsDefault]
	, [AdvertiserID]
	, [LanguageIDs]
	, [Valid]
    FROM
	[dbo].[JobCustomXML]
    WHERE 
	 ([JobCustomXMLID] = @JobCustomXmlid OR @JobCustomXmlid IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([UniqueCode] = @UniqueCode OR @UniqueCode IS NULL)
	AND ([CustomXML] = @CustomXml OR @CustomXml IS NULL)
	AND ([CustomType] = @CustomType OR @CustomType IS NULL)
	AND ([JobID] = @JobId OR @JobId IS NULL)
	AND ([JobArchiveID] = @JobArchiveId OR @JobArchiveId IS NULL)
	AND ([IsDefault] = @IsDefault OR @IsDefault IS NULL)
	AND ([AdvertiserID] = @AdvertiserId OR @AdvertiserId IS NULL)
	AND ([LanguageIDs] = @LanguageIds OR @LanguageIds IS NULL)
	AND ([Valid] = @Valid OR @Valid IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [JobCustomXMLID]
	, [SiteID]
	, [UniqueCode]
	, [CustomXML]
	, [CustomType]
	, [JobID]
	, [JobArchiveID]
	, [IsDefault]
	, [AdvertiserID]
	, [LanguageIDs]
	, [Valid]
    FROM
	[dbo].[JobCustomXML]
    WHERE 
	 ([JobCustomXMLID] = @JobCustomXmlid AND @JobCustomXmlid is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([UniqueCode] = @UniqueCode AND @UniqueCode is not null)
	OR ([CustomXML] = @CustomXml AND @CustomXml is not null)
	OR ([CustomType] = @CustomType AND @CustomType is not null)
	OR ([JobID] = @JobId AND @JobId is not null)
	OR ([JobArchiveID] = @JobArchiveId AND @JobArchiveId is not null)
	OR ([IsDefault] = @IsDefault AND @IsDefault is not null)
	OR ([AdvertiserID] = @AdvertiserId AND @AdvertiserId is not null)
	OR ([LanguageIDs] = @LanguageIds AND @LanguageIds is not null)
	OR ([Valid] = @Valid AND @Valid is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobRoles_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobRoles_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobRoles_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the JobRoles table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobRoles_Get_List

AS


				
				SELECT
					[JobRoleID],
					[JobID],
					[JobArchiveID],
					[RoleID]
				FROM
					[dbo].[JobRoles]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobRoles_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobRoles_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobRoles_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the JobRoles table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobRoles_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [JobRoleID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([JobRoleID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [JobRoleID]'
				SET @SQL = @SQL + ' FROM [dbo].[JobRoles]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[JobRoleID], O.[JobID], O.[JobArchiveID], O.[RoleID]
				FROM
				    [dbo].[JobRoles] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[JobRoleID] = PageIndex.[JobRoleID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[JobRoles]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobRoles_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobRoles_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobRoles_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the JobRoles table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobRoles_Insert
(

	@JobRoleId int    OUTPUT,

	@JobId int   ,

	@JobArchiveId int   ,

	@RoleId int   
)
AS


				
				INSERT INTO [dbo].[JobRoles]
					(
					[JobID]
					,[JobArchiveID]
					,[RoleID]
					)
				VALUES
					(
					@JobId
					,@JobArchiveId
					,@RoleId
					)
				
				-- Get the identity value
				SET @JobRoleId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobRoles_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobRoles_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobRoles_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the JobRoles table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobRoles_Update
(

	@JobRoleId int   ,

	@JobId int   ,

	@JobArchiveId int   ,

	@RoleId int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[JobRoles]
				SET
					[JobID] = @JobId
					,[JobArchiveID] = @JobArchiveId
					,[RoleID] = @RoleId
				WHERE
[JobRoleID] = @JobRoleId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobRoles_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobRoles_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobRoles_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the JobRoles table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobRoles_Delete
(

	@JobRoleId int   
)
AS


				DELETE FROM [dbo].[JobRoles] WITH (ROWLOCK) 
				WHERE
					[JobRoleID] = @JobRoleId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobRoles_GetByRoleId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobRoles_GetByRoleId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobRoles_GetByRoleId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobRoles table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobRoles_GetByRoleId
(

	@RoleId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobRoleID],
					[JobID],
					[JobArchiveID],
					[RoleID]
				FROM
					[dbo].[JobRoles]
				WHERE
					[RoleID] = @RoleId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobRoles_GetByJobId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobRoles_GetByJobId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobRoles_GetByJobId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobRoles table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobRoles_GetByJobId
(

	@JobId int   
)
AS


				SELECT
					[JobRoleID],
					[JobID],
					[JobArchiveID],
					[RoleID]
				FROM
					[dbo].[JobRoles]
				WHERE
					[JobID] = @JobId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobRoles_GetByJobArchiveId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobRoles_GetByJobArchiveId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobRoles_GetByJobArchiveId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobRoles table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobRoles_GetByJobArchiveId
(

	@JobArchiveId int   
)
AS


				SELECT
					[JobRoleID],
					[JobID],
					[JobArchiveID],
					[RoleID]
				FROM
					[dbo].[JobRoles]
				WHERE
					[JobArchiveID] = @JobArchiveId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobRoles_GetByJobRoleId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobRoles_GetByJobRoleId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobRoles_GetByJobRoleId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobRoles table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobRoles_GetByJobRoleId
(

	@JobRoleId int   
)
AS


				SELECT
					[JobRoleID],
					[JobID],
					[JobArchiveID],
					[RoleID]
				FROM
					[dbo].[JobRoles]
				WHERE
					[JobRoleID] = @JobRoleId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobRoles_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobRoles_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobRoles_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the JobRoles table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobRoles_Find
(

	@SearchUsingOR bit   = null ,

	@JobRoleId int   = null ,

	@JobId int   = null ,

	@JobArchiveId int   = null ,

	@RoleId int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [JobRoleID]
	, [JobID]
	, [JobArchiveID]
	, [RoleID]
    FROM
	[dbo].[JobRoles]
    WHERE 
	 ([JobRoleID] = @JobRoleId OR @JobRoleId IS NULL)
	AND ([JobID] = @JobId OR @JobId IS NULL)
	AND ([JobArchiveID] = @JobArchiveId OR @JobArchiveId IS NULL)
	AND ([RoleID] = @RoleId OR @RoleId IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [JobRoleID]
	, [JobID]
	, [JobArchiveID]
	, [RoleID]
    FROM
	[dbo].[JobRoles]
    WHERE 
	 ([JobRoleID] = @JobRoleId AND @JobRoleId is not null)
	OR ([JobID] = @JobId AND @JobId is not null)
	OR ([JobArchiveID] = @JobArchiveId AND @JobArchiveId is not null)
	OR ([RoleID] = @RoleId AND @RoleId is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AvailableStatus_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AvailableStatus_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AvailableStatus_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the AvailableStatus table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AvailableStatus_Get_List

AS


				
				SELECT
					[AvailableStatusID],
					[SiteID],
					[AvailableStatusParentID],
					[AvailableStatusName],
					[GlobalTemplate],
					[LastModifiedBy],
					[LastModified],
					[Sequence]
				FROM
					[dbo].[AvailableStatus]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AvailableStatus_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AvailableStatus_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AvailableStatus_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the AvailableStatus table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AvailableStatus_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [AvailableStatusID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([AvailableStatusID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [AvailableStatusID]'
				SET @SQL = @SQL + ' FROM [dbo].[AvailableStatus]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[AvailableStatusID], O.[SiteID], O.[AvailableStatusParentID], O.[AvailableStatusName], O.[GlobalTemplate], O.[LastModifiedBy], O.[LastModified], O.[Sequence]
				FROM
				    [dbo].[AvailableStatus] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[AvailableStatusID] = PageIndex.[AvailableStatusID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[AvailableStatus]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AvailableStatus_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AvailableStatus_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AvailableStatus_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the AvailableStatus table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AvailableStatus_Insert
(

	@AvailableStatusId int    OUTPUT,

	@SiteId int   ,

	@AvailableStatusParentId int   ,

	@AvailableStatusName nvarchar (512)  ,

	@GlobalTemplate bit   ,

	@LastModifiedBy int   ,

	@LastModified datetime   ,

	@Sequence int   
)
AS


				
				INSERT INTO [dbo].[AvailableStatus]
					(
					[SiteID]
					,[AvailableStatusParentID]
					,[AvailableStatusName]
					,[GlobalTemplate]
					,[LastModifiedBy]
					,[LastModified]
					,[Sequence]
					)
				VALUES
					(
					@SiteId
					,@AvailableStatusParentId
					,@AvailableStatusName
					,@GlobalTemplate
					,@LastModifiedBy
					,@LastModified
					,@Sequence
					)
				
				-- Get the identity value
				SET @AvailableStatusId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AvailableStatus_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AvailableStatus_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AvailableStatus_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the AvailableStatus table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AvailableStatus_Update
(

	@AvailableStatusId int   ,

	@SiteId int   ,

	@AvailableStatusParentId int   ,

	@AvailableStatusName nvarchar (512)  ,

	@GlobalTemplate bit   ,

	@LastModifiedBy int   ,

	@LastModified datetime   ,

	@Sequence int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[AvailableStatus]
				SET
					[SiteID] = @SiteId
					,[AvailableStatusParentID] = @AvailableStatusParentId
					,[AvailableStatusName] = @AvailableStatusName
					,[GlobalTemplate] = @GlobalTemplate
					,[LastModifiedBy] = @LastModifiedBy
					,[LastModified] = @LastModified
					,[Sequence] = @Sequence
				WHERE
[AvailableStatusID] = @AvailableStatusId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AvailableStatus_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AvailableStatus_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AvailableStatus_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the AvailableStatus table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AvailableStatus_Delete
(

	@AvailableStatusId int   
)
AS


				DELETE FROM [dbo].[AvailableStatus] WITH (ROWLOCK) 
				WHERE
					[AvailableStatusID] = @AvailableStatusId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AvailableStatus_GetByLastModifiedBy procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AvailableStatus_GetByLastModifiedBy') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AvailableStatus_GetByLastModifiedBy
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the AvailableStatus table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AvailableStatus_GetByLastModifiedBy
(

	@LastModifiedBy int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[AvailableStatusID],
					[SiteID],
					[AvailableStatusParentID],
					[AvailableStatusName],
					[GlobalTemplate],
					[LastModifiedBy],
					[LastModified],
					[Sequence]
				FROM
					[dbo].[AvailableStatus]
				WHERE
					[LastModifiedBy] = @LastModifiedBy
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AvailableStatus_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AvailableStatus_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AvailableStatus_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the AvailableStatus table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AvailableStatus_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[AvailableStatusID],
					[SiteID],
					[AvailableStatusParentID],
					[AvailableStatusName],
					[GlobalTemplate],
					[LastModifiedBy],
					[LastModified],
					[Sequence]
				FROM
					[dbo].[AvailableStatus]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AvailableStatus_GetByAvailableStatusId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AvailableStatus_GetByAvailableStatusId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AvailableStatus_GetByAvailableStatusId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the AvailableStatus table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AvailableStatus_GetByAvailableStatusId
(

	@AvailableStatusId int   
)
AS


				SELECT
					[AvailableStatusID],
					[SiteID],
					[AvailableStatusParentID],
					[AvailableStatusName],
					[GlobalTemplate],
					[LastModifiedBy],
					[LastModified],
					[Sequence]
				FROM
					[dbo].[AvailableStatus]
				WHERE
					[AvailableStatusID] = @AvailableStatusId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.AvailableStatus_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.AvailableStatus_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.AvailableStatus_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the AvailableStatus table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.AvailableStatus_Find
(

	@SearchUsingOR bit   = null ,

	@AvailableStatusId int   = null ,

	@SiteId int   = null ,

	@AvailableStatusParentId int   = null ,

	@AvailableStatusName nvarchar (512)  = null ,

	@GlobalTemplate bit   = null ,

	@LastModifiedBy int   = null ,

	@LastModified datetime   = null ,

	@Sequence int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [AvailableStatusID]
	, [SiteID]
	, [AvailableStatusParentID]
	, [AvailableStatusName]
	, [GlobalTemplate]
	, [LastModifiedBy]
	, [LastModified]
	, [Sequence]
    FROM
	[dbo].[AvailableStatus]
    WHERE 
	 ([AvailableStatusID] = @AvailableStatusId OR @AvailableStatusId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([AvailableStatusParentID] = @AvailableStatusParentId OR @AvailableStatusParentId IS NULL)
	AND ([AvailableStatusName] = @AvailableStatusName OR @AvailableStatusName IS NULL)
	AND ([GlobalTemplate] = @GlobalTemplate OR @GlobalTemplate IS NULL)
	AND ([LastModifiedBy] = @LastModifiedBy OR @LastModifiedBy IS NULL)
	AND ([LastModified] = @LastModified OR @LastModified IS NULL)
	AND ([Sequence] = @Sequence OR @Sequence IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [AvailableStatusID]
	, [SiteID]
	, [AvailableStatusParentID]
	, [AvailableStatusName]
	, [GlobalTemplate]
	, [LastModifiedBy]
	, [LastModified]
	, [Sequence]
    FROM
	[dbo].[AvailableStatus]
    WHERE 
	 ([AvailableStatusID] = @AvailableStatusId AND @AvailableStatusId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([AvailableStatusParentID] = @AvailableStatusParentId AND @AvailableStatusParentId is not null)
	OR ([AvailableStatusName] = @AvailableStatusName AND @AvailableStatusName is not null)
	OR ([GlobalTemplate] = @GlobalTemplate AND @GlobalTemplate is not null)
	OR ([LastModifiedBy] = @LastModifiedBy AND @LastModifiedBy is not null)
	OR ([LastModified] = @LastModified AND @LastModified is not null)
	OR ([Sequence] = @Sequence AND @Sequence is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Invoice_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Invoice_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Invoice_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the Invoice table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Invoice_Get_List

AS


				
				SELECT
					[InvoiceID],
					[AdvertiserUserID],
					[OrderID],
					[JobItemTypeID],
					[TotalNumberOfJobs],
					[TotalAmount],
					[Description],
					[Quantity]
				FROM
					[dbo].[Invoice]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Invoice_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Invoice_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Invoice_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the Invoice table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Invoice_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [InvoiceID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([InvoiceID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [InvoiceID]'
				SET @SQL = @SQL + ' FROM [dbo].[Invoice]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[InvoiceID], O.[AdvertiserUserID], O.[OrderID], O.[JobItemTypeID], O.[TotalNumberOfJobs], O.[TotalAmount], O.[Description], O.[Quantity]
				FROM
				    [dbo].[Invoice] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[InvoiceID] = PageIndex.[InvoiceID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[Invoice]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Invoice_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Invoice_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Invoice_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the Invoice table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Invoice_Insert
(

	@InvoiceId int    OUTPUT,

	@AdvertiserUserId int   ,

	@OrderId int   ,

	@JobItemTypeId int   ,

	@TotalNumberOfJobs int   ,

	@TotalAmount decimal (18, 2)  ,

	@Description nvarchar (255)  ,

	@Quantity int   
)
AS


				
				INSERT INTO [dbo].[Invoice]
					(
					[AdvertiserUserID]
					,[OrderID]
					,[JobItemTypeID]
					,[TotalNumberOfJobs]
					,[TotalAmount]
					,[Description]
					,[Quantity]
					)
				VALUES
					(
					@AdvertiserUserId
					,@OrderId
					,@JobItemTypeId
					,@TotalNumberOfJobs
					,@TotalAmount
					,@Description
					,@Quantity
					)
				
				-- Get the identity value
				SET @InvoiceId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Invoice_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Invoice_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Invoice_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the Invoice table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Invoice_Update
(

	@InvoiceId int   ,

	@AdvertiserUserId int   ,

	@OrderId int   ,

	@JobItemTypeId int   ,

	@TotalNumberOfJobs int   ,

	@TotalAmount decimal (18, 2)  ,

	@Description nvarchar (255)  ,

	@Quantity int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[Invoice]
				SET
					[AdvertiserUserID] = @AdvertiserUserId
					,[OrderID] = @OrderId
					,[JobItemTypeID] = @JobItemTypeId
					,[TotalNumberOfJobs] = @TotalNumberOfJobs
					,[TotalAmount] = @TotalAmount
					,[Description] = @Description
					,[Quantity] = @Quantity
				WHERE
[InvoiceID] = @InvoiceId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Invoice_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Invoice_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Invoice_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the Invoice table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Invoice_Delete
(

	@InvoiceId int   
)
AS


				DELETE FROM [dbo].[Invoice] WITH (ROWLOCK) 
				WHERE
					[InvoiceID] = @InvoiceId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Invoice_GetByAdvertiserUserId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Invoice_GetByAdvertiserUserId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Invoice_GetByAdvertiserUserId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Invoice table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Invoice_GetByAdvertiserUserId
(

	@AdvertiserUserId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[InvoiceID],
					[AdvertiserUserID],
					[OrderID],
					[JobItemTypeID],
					[TotalNumberOfJobs],
					[TotalAmount],
					[Description],
					[Quantity]
				FROM
					[dbo].[Invoice]
				WHERE
					[AdvertiserUserID] = @AdvertiserUserId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Invoice_GetByOrderId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Invoice_GetByOrderId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Invoice_GetByOrderId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Invoice table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Invoice_GetByOrderId
(

	@OrderId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[InvoiceID],
					[AdvertiserUserID],
					[OrderID],
					[JobItemTypeID],
					[TotalNumberOfJobs],
					[TotalAmount],
					[Description],
					[Quantity]
				FROM
					[dbo].[Invoice]
				WHERE
					[OrderID] = @OrderId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Invoice_GetByInvoiceId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Invoice_GetByInvoiceId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Invoice_GetByInvoiceId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the Invoice table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Invoice_GetByInvoiceId
(

	@InvoiceId int   
)
AS


				SELECT
					[InvoiceID],
					[AdvertiserUserID],
					[OrderID],
					[JobItemTypeID],
					[TotalNumberOfJobs],
					[TotalAmount],
					[Description],
					[Quantity]
				FROM
					[dbo].[Invoice]
				WHERE
					[InvoiceID] = @InvoiceId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.Invoice_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.Invoice_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.Invoice_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the Invoice table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.Invoice_Find
(

	@SearchUsingOR bit   = null ,

	@InvoiceId int   = null ,

	@AdvertiserUserId int   = null ,

	@OrderId int   = null ,

	@JobItemTypeId int   = null ,

	@TotalNumberOfJobs int   = null ,

	@TotalAmount decimal (18, 2)  = null ,

	@Description nvarchar (255)  = null ,

	@Quantity int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [InvoiceID]
	, [AdvertiserUserID]
	, [OrderID]
	, [JobItemTypeID]
	, [TotalNumberOfJobs]
	, [TotalAmount]
	, [Description]
	, [Quantity]
    FROM
	[dbo].[Invoice]
    WHERE 
	 ([InvoiceID] = @InvoiceId OR @InvoiceId IS NULL)
	AND ([AdvertiserUserID] = @AdvertiserUserId OR @AdvertiserUserId IS NULL)
	AND ([OrderID] = @OrderId OR @OrderId IS NULL)
	AND ([JobItemTypeID] = @JobItemTypeId OR @JobItemTypeId IS NULL)
	AND ([TotalNumberOfJobs] = @TotalNumberOfJobs OR @TotalNumberOfJobs IS NULL)
	AND ([TotalAmount] = @TotalAmount OR @TotalAmount IS NULL)
	AND ([Description] = @Description OR @Description IS NULL)
	AND ([Quantity] = @Quantity OR @Quantity IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [InvoiceID]
	, [AdvertiserUserID]
	, [OrderID]
	, [JobItemTypeID]
	, [TotalNumberOfJobs]
	, [TotalAmount]
	, [Description]
	, [Quantity]
    FROM
	[dbo].[Invoice]
    WHERE 
	 ([InvoiceID] = @InvoiceId AND @InvoiceId is not null)
	OR ([AdvertiserUserID] = @AdvertiserUserId AND @AdvertiserUserId is not null)
	OR ([OrderID] = @OrderId AND @OrderId is not null)
	OR ([JobItemTypeID] = @JobItemTypeId AND @JobItemTypeId is not null)
	OR ([TotalNumberOfJobs] = @TotalNumberOfJobs AND @TotalNumberOfJobs is not null)
	OR ([TotalAmount] = @TotalAmount AND @TotalAmount is not null)
	OR ([Description] = @Description AND @Description is not null)
	OR ([Quantity] = @Quantity AND @Quantity is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobAlerts_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobAlerts_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobAlerts_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the JobAlerts table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobAlerts_Get_List

AS


				
				SELECT
					[JobAlertID],
					[JobAlertName],
					[LastModified],
					[SearchKeywords],
					[RecurrenceType],
					[DailyFrequency],
					[WeeklyFrequency],
					[WeeklyDayOccurence],
					[DateLastRun],
					[DateNextRun],
					[MemberID],
					[AlertActive],
					[EmailFormat],
					[CustomRecurrenceType],
					[LastResultCount],
					[PrimaryAlert],
					[UnsubscribeValidateID],
					[EditValidateID],
					[ViewValidateID],
					[SiteID],
					[LocationID],
					[AreaIDs],
					[ProfessionID],
					[SearchRoleIDs],
					[WorkTypeIDs],
					[SalaryIDs],
					[DaysPosted],
					[GeneratedSQL],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[CountryID]
				FROM
					[dbo].[JobAlerts]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobAlerts_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobAlerts_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobAlerts_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the JobAlerts table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobAlerts_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [JobAlertID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([JobAlertID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [JobAlertID]'
				SET @SQL = @SQL + ' FROM [dbo].[JobAlerts]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[JobAlertID], O.[JobAlertName], O.[LastModified], O.[SearchKeywords], O.[RecurrenceType], O.[DailyFrequency], O.[WeeklyFrequency], O.[WeeklyDayOccurence], O.[DateLastRun], O.[DateNextRun], O.[MemberID], O.[AlertActive], O.[EmailFormat], O.[CustomRecurrenceType], O.[LastResultCount], O.[PrimaryAlert], O.[UnsubscribeValidateID], O.[EditValidateID], O.[ViewValidateID], O.[SiteID], O.[LocationID], O.[AreaIDs], O.[ProfessionID], O.[SearchRoleIDs], O.[WorkTypeIDs], O.[SalaryIDs], O.[DaysPosted], O.[GeneratedSQL], O.[SalaryLowerBand], O.[SalaryUpperBand], O.[CurrencyID], O.[SalaryTypeID], O.[CountryID]
				FROM
				    [dbo].[JobAlerts] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[JobAlertID] = PageIndex.[JobAlertID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[JobAlerts]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobAlerts_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobAlerts_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobAlerts_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the JobAlerts table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobAlerts_Insert
(

	@JobAlertId int    OUTPUT,

	@JobAlertName nvarchar (510)  ,

	@LastModified datetime   ,

	@SearchKeywords varchar (1000)  ,

	@RecurrenceType int   ,

	@DailyFrequency int   ,

	@WeeklyFrequency int   ,

	@WeeklyDayOccurence int   ,

	@DateLastRun datetime   ,

	@DateNextRun datetime   ,

	@MemberId int   ,

	@AlertActive bit   ,

	@EmailFormat int   ,

	@CustomRecurrenceType int   ,

	@LastResultCount int   ,

	@PrimaryAlert bit   ,

	@UnsubscribeValidateId uniqueidentifier   ,

	@EditValidateId uniqueidentifier   ,

	@ViewValidateId uniqueidentifier   ,

	@SiteId int   ,

	@LocationId varchar (500)  ,

	@AreaIds varchar (255)  ,

	@ProfessionId varchar (500)  ,

	@SearchRoleIds varchar (500)  ,

	@WorkTypeIds varchar (100)  ,

	@SalaryIds varchar (50)  ,

	@DaysPosted int   ,

	@GeneratedSql varchar (8000)  ,

	@SalaryLowerBand numeric (15, 2)  ,

	@SalaryUpperBand numeric (15, 2)  ,

	@CurrencyId int   ,

	@SalaryTypeId int   ,

	@CountryId varchar (500)  
)
AS


				
				INSERT INTO [dbo].[JobAlerts]
					(
					[JobAlertName]
					,[LastModified]
					,[SearchKeywords]
					,[RecurrenceType]
					,[DailyFrequency]
					,[WeeklyFrequency]
					,[WeeklyDayOccurence]
					,[DateLastRun]
					,[DateNextRun]
					,[MemberID]
					,[AlertActive]
					,[EmailFormat]
					,[CustomRecurrenceType]
					,[LastResultCount]
					,[PrimaryAlert]
					,[UnsubscribeValidateID]
					,[EditValidateID]
					,[ViewValidateID]
					,[SiteID]
					,[LocationID]
					,[AreaIDs]
					,[ProfessionID]
					,[SearchRoleIDs]
					,[WorkTypeIDs]
					,[SalaryIDs]
					,[DaysPosted]
					,[GeneratedSQL]
					,[SalaryLowerBand]
					,[SalaryUpperBand]
					,[CurrencyID]
					,[SalaryTypeID]
					,[CountryID]
					)
				VALUES
					(
					@JobAlertName
					,@LastModified
					,@SearchKeywords
					,@RecurrenceType
					,@DailyFrequency
					,@WeeklyFrequency
					,@WeeklyDayOccurence
					,@DateLastRun
					,@DateNextRun
					,@MemberId
					,@AlertActive
					,@EmailFormat
					,@CustomRecurrenceType
					,@LastResultCount
					,@PrimaryAlert
					,@UnsubscribeValidateId
					,@EditValidateId
					,@ViewValidateId
					,@SiteId
					,@LocationId
					,@AreaIds
					,@ProfessionId
					,@SearchRoleIds
					,@WorkTypeIds
					,@SalaryIds
					,@DaysPosted
					,@GeneratedSql
					,@SalaryLowerBand
					,@SalaryUpperBand
					,@CurrencyId
					,@SalaryTypeId
					,@CountryId
					)
				
				-- Get the identity value
				SET @JobAlertId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobAlerts_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobAlerts_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobAlerts_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the JobAlerts table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobAlerts_Update
(

	@JobAlertId int   ,

	@JobAlertName nvarchar (510)  ,

	@LastModified datetime   ,

	@SearchKeywords varchar (1000)  ,

	@RecurrenceType int   ,

	@DailyFrequency int   ,

	@WeeklyFrequency int   ,

	@WeeklyDayOccurence int   ,

	@DateLastRun datetime   ,

	@DateNextRun datetime   ,

	@MemberId int   ,

	@AlertActive bit   ,

	@EmailFormat int   ,

	@CustomRecurrenceType int   ,

	@LastResultCount int   ,

	@PrimaryAlert bit   ,

	@UnsubscribeValidateId uniqueidentifier   ,

	@EditValidateId uniqueidentifier   ,

	@ViewValidateId uniqueidentifier   ,

	@SiteId int   ,

	@LocationId varchar (500)  ,

	@AreaIds varchar (255)  ,

	@ProfessionId varchar (500)  ,

	@SearchRoleIds varchar (500)  ,

	@WorkTypeIds varchar (100)  ,

	@SalaryIds varchar (50)  ,

	@DaysPosted int   ,

	@GeneratedSql varchar (8000)  ,

	@SalaryLowerBand numeric (15, 2)  ,

	@SalaryUpperBand numeric (15, 2)  ,

	@CurrencyId int   ,

	@SalaryTypeId int   ,

	@CountryId varchar (500)  
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[JobAlerts]
				SET
					[JobAlertName] = @JobAlertName
					,[LastModified] = @LastModified
					,[SearchKeywords] = @SearchKeywords
					,[RecurrenceType] = @RecurrenceType
					,[DailyFrequency] = @DailyFrequency
					,[WeeklyFrequency] = @WeeklyFrequency
					,[WeeklyDayOccurence] = @WeeklyDayOccurence
					,[DateLastRun] = @DateLastRun
					,[DateNextRun] = @DateNextRun
					,[MemberID] = @MemberId
					,[AlertActive] = @AlertActive
					,[EmailFormat] = @EmailFormat
					,[CustomRecurrenceType] = @CustomRecurrenceType
					,[LastResultCount] = @LastResultCount
					,[PrimaryAlert] = @PrimaryAlert
					,[UnsubscribeValidateID] = @UnsubscribeValidateId
					,[EditValidateID] = @EditValidateId
					,[ViewValidateID] = @ViewValidateId
					,[SiteID] = @SiteId
					,[LocationID] = @LocationId
					,[AreaIDs] = @AreaIds
					,[ProfessionID] = @ProfessionId
					,[SearchRoleIDs] = @SearchRoleIds
					,[WorkTypeIDs] = @WorkTypeIds
					,[SalaryIDs] = @SalaryIds
					,[DaysPosted] = @DaysPosted
					,[GeneratedSQL] = @GeneratedSql
					,[SalaryLowerBand] = @SalaryLowerBand
					,[SalaryUpperBand] = @SalaryUpperBand
					,[CurrencyID] = @CurrencyId
					,[SalaryTypeID] = @SalaryTypeId
					,[CountryID] = @CountryId
				WHERE
[JobAlertID] = @JobAlertId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobAlerts_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobAlerts_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobAlerts_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the JobAlerts table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobAlerts_Delete
(

	@JobAlertId int   
)
AS


				DELETE FROM [dbo].[JobAlerts] WITH (ROWLOCK) 
				WHERE
					[JobAlertID] = @JobAlertId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobAlerts_GetByCurrencyId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobAlerts_GetByCurrencyId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobAlerts_GetByCurrencyId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobAlerts table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobAlerts_GetByCurrencyId
(

	@CurrencyId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobAlertID],
					[JobAlertName],
					[LastModified],
					[SearchKeywords],
					[RecurrenceType],
					[DailyFrequency],
					[WeeklyFrequency],
					[WeeklyDayOccurence],
					[DateLastRun],
					[DateNextRun],
					[MemberID],
					[AlertActive],
					[EmailFormat],
					[CustomRecurrenceType],
					[LastResultCount],
					[PrimaryAlert],
					[UnsubscribeValidateID],
					[EditValidateID],
					[ViewValidateID],
					[SiteID],
					[LocationID],
					[AreaIDs],
					[ProfessionID],
					[SearchRoleIDs],
					[WorkTypeIDs],
					[SalaryIDs],
					[DaysPosted],
					[GeneratedSQL],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[CountryID]
				FROM
					[dbo].[JobAlerts]
				WHERE
					[CurrencyID] = @CurrencyId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobAlerts_GetByMemberId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobAlerts_GetByMemberId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobAlerts_GetByMemberId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobAlerts table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobAlerts_GetByMemberId
(

	@MemberId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobAlertID],
					[JobAlertName],
					[LastModified],
					[SearchKeywords],
					[RecurrenceType],
					[DailyFrequency],
					[WeeklyFrequency],
					[WeeklyDayOccurence],
					[DateLastRun],
					[DateNextRun],
					[MemberID],
					[AlertActive],
					[EmailFormat],
					[CustomRecurrenceType],
					[LastResultCount],
					[PrimaryAlert],
					[UnsubscribeValidateID],
					[EditValidateID],
					[ViewValidateID],
					[SiteID],
					[LocationID],
					[AreaIDs],
					[ProfessionID],
					[SearchRoleIDs],
					[WorkTypeIDs],
					[SalaryIDs],
					[DaysPosted],
					[GeneratedSQL],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[CountryID]
				FROM
					[dbo].[JobAlerts]
				WHERE
					[MemberID] = @MemberId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobAlerts_GetBySalaryTypeId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobAlerts_GetBySalaryTypeId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobAlerts_GetBySalaryTypeId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobAlerts table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobAlerts_GetBySalaryTypeId
(

	@SalaryTypeId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobAlertID],
					[JobAlertName],
					[LastModified],
					[SearchKeywords],
					[RecurrenceType],
					[DailyFrequency],
					[WeeklyFrequency],
					[WeeklyDayOccurence],
					[DateLastRun],
					[DateNextRun],
					[MemberID],
					[AlertActive],
					[EmailFormat],
					[CustomRecurrenceType],
					[LastResultCount],
					[PrimaryAlert],
					[UnsubscribeValidateID],
					[EditValidateID],
					[ViewValidateID],
					[SiteID],
					[LocationID],
					[AreaIDs],
					[ProfessionID],
					[SearchRoleIDs],
					[WorkTypeIDs],
					[SalaryIDs],
					[DaysPosted],
					[GeneratedSQL],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[CountryID]
				FROM
					[dbo].[JobAlerts]
				WHERE
					[SalaryTypeID] = @SalaryTypeId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobAlerts_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobAlerts_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobAlerts_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobAlerts table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobAlerts_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobAlertID],
					[JobAlertName],
					[LastModified],
					[SearchKeywords],
					[RecurrenceType],
					[DailyFrequency],
					[WeeklyFrequency],
					[WeeklyDayOccurence],
					[DateLastRun],
					[DateNextRun],
					[MemberID],
					[AlertActive],
					[EmailFormat],
					[CustomRecurrenceType],
					[LastResultCount],
					[PrimaryAlert],
					[UnsubscribeValidateID],
					[EditValidateID],
					[ViewValidateID],
					[SiteID],
					[LocationID],
					[AreaIDs],
					[ProfessionID],
					[SearchRoleIDs],
					[WorkTypeIDs],
					[SalaryIDs],
					[DaysPosted],
					[GeneratedSQL],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[CountryID]
				FROM
					[dbo].[JobAlerts]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobAlerts_GetByJobAlertId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobAlerts_GetByJobAlertId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobAlerts_GetByJobAlertId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobAlerts table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobAlerts_GetByJobAlertId
(

	@JobAlertId int   
)
AS


				SELECT
					[JobAlertID],
					[JobAlertName],
					[LastModified],
					[SearchKeywords],
					[RecurrenceType],
					[DailyFrequency],
					[WeeklyFrequency],
					[WeeklyDayOccurence],
					[DateLastRun],
					[DateNextRun],
					[MemberID],
					[AlertActive],
					[EmailFormat],
					[CustomRecurrenceType],
					[LastResultCount],
					[PrimaryAlert],
					[UnsubscribeValidateID],
					[EditValidateID],
					[ViewValidateID],
					[SiteID],
					[LocationID],
					[AreaIDs],
					[ProfessionID],
					[SearchRoleIDs],
					[WorkTypeIDs],
					[SalaryIDs],
					[DaysPosted],
					[GeneratedSQL],
					[SalaryLowerBand],
					[SalaryUpperBand],
					[CurrencyID],
					[SalaryTypeID],
					[CountryID]
				FROM
					[dbo].[JobAlerts]
				WHERE
					[JobAlertID] = @JobAlertId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobAlerts_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobAlerts_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobAlerts_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the JobAlerts table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobAlerts_Find
(

	@SearchUsingOR bit   = null ,

	@JobAlertId int   = null ,

	@JobAlertName nvarchar (510)  = null ,

	@LastModified datetime   = null ,

	@SearchKeywords varchar (1000)  = null ,

	@RecurrenceType int   = null ,

	@DailyFrequency int   = null ,

	@WeeklyFrequency int   = null ,

	@WeeklyDayOccurence int   = null ,

	@DateLastRun datetime   = null ,

	@DateNextRun datetime   = null ,

	@MemberId int   = null ,

	@AlertActive bit   = null ,

	@EmailFormat int   = null ,

	@CustomRecurrenceType int   = null ,

	@LastResultCount int   = null ,

	@PrimaryAlert bit   = null ,

	@UnsubscribeValidateId uniqueidentifier   = null ,

	@EditValidateId uniqueidentifier   = null ,

	@ViewValidateId uniqueidentifier   = null ,

	@SiteId int   = null ,

	@LocationId varchar (500)  = null ,

	@AreaIds varchar (255)  = null ,

	@ProfessionId varchar (500)  = null ,

	@SearchRoleIds varchar (500)  = null ,

	@WorkTypeIds varchar (100)  = null ,

	@SalaryIds varchar (50)  = null ,

	@DaysPosted int   = null ,

	@GeneratedSql varchar (8000)  = null ,

	@SalaryLowerBand numeric (15, 2)  = null ,

	@SalaryUpperBand numeric (15, 2)  = null ,

	@CurrencyId int   = null ,

	@SalaryTypeId int   = null ,

	@CountryId varchar (500)  = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [JobAlertID]
	, [JobAlertName]
	, [LastModified]
	, [SearchKeywords]
	, [RecurrenceType]
	, [DailyFrequency]
	, [WeeklyFrequency]
	, [WeeklyDayOccurence]
	, [DateLastRun]
	, [DateNextRun]
	, [MemberID]
	, [AlertActive]
	, [EmailFormat]
	, [CustomRecurrenceType]
	, [LastResultCount]
	, [PrimaryAlert]
	, [UnsubscribeValidateID]
	, [EditValidateID]
	, [ViewValidateID]
	, [SiteID]
	, [LocationID]
	, [AreaIDs]
	, [ProfessionID]
	, [SearchRoleIDs]
	, [WorkTypeIDs]
	, [SalaryIDs]
	, [DaysPosted]
	, [GeneratedSQL]
	, [SalaryLowerBand]
	, [SalaryUpperBand]
	, [CurrencyID]
	, [SalaryTypeID]
	, [CountryID]
    FROM
	[dbo].[JobAlerts]
    WHERE 
	 ([JobAlertID] = @JobAlertId OR @JobAlertId IS NULL)
	AND ([JobAlertName] = @JobAlertName OR @JobAlertName IS NULL)
	AND ([LastModified] = @LastModified OR @LastModified IS NULL)
	AND ([SearchKeywords] = @SearchKeywords OR @SearchKeywords IS NULL)
	AND ([RecurrenceType] = @RecurrenceType OR @RecurrenceType IS NULL)
	AND ([DailyFrequency] = @DailyFrequency OR @DailyFrequency IS NULL)
	AND ([WeeklyFrequency] = @WeeklyFrequency OR @WeeklyFrequency IS NULL)
	AND ([WeeklyDayOccurence] = @WeeklyDayOccurence OR @WeeklyDayOccurence IS NULL)
	AND ([DateLastRun] = @DateLastRun OR @DateLastRun IS NULL)
	AND ([DateNextRun] = @DateNextRun OR @DateNextRun IS NULL)
	AND ([MemberID] = @MemberId OR @MemberId IS NULL)
	AND ([AlertActive] = @AlertActive OR @AlertActive IS NULL)
	AND ([EmailFormat] = @EmailFormat OR @EmailFormat IS NULL)
	AND ([CustomRecurrenceType] = @CustomRecurrenceType OR @CustomRecurrenceType IS NULL)
	AND ([LastResultCount] = @LastResultCount OR @LastResultCount IS NULL)
	AND ([PrimaryAlert] = @PrimaryAlert OR @PrimaryAlert IS NULL)
	AND ([UnsubscribeValidateID] = @UnsubscribeValidateId OR @UnsubscribeValidateId IS NULL)
	AND ([EditValidateID] = @EditValidateId OR @EditValidateId IS NULL)
	AND ([ViewValidateID] = @ViewValidateId OR @ViewValidateId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([LocationID] = @LocationId OR @LocationId IS NULL)
	AND ([AreaIDs] = @AreaIds OR @AreaIds IS NULL)
	AND ([ProfessionID] = @ProfessionId OR @ProfessionId IS NULL)
	AND ([SearchRoleIDs] = @SearchRoleIds OR @SearchRoleIds IS NULL)
	AND ([WorkTypeIDs] = @WorkTypeIds OR @WorkTypeIds IS NULL)
	AND ([SalaryIDs] = @SalaryIds OR @SalaryIds IS NULL)
	AND ([DaysPosted] = @DaysPosted OR @DaysPosted IS NULL)
	AND ([GeneratedSQL] = @GeneratedSql OR @GeneratedSql IS NULL)
	AND ([SalaryLowerBand] = @SalaryLowerBand OR @SalaryLowerBand IS NULL)
	AND ([SalaryUpperBand] = @SalaryUpperBand OR @SalaryUpperBand IS NULL)
	AND ([CurrencyID] = @CurrencyId OR @CurrencyId IS NULL)
	AND ([SalaryTypeID] = @SalaryTypeId OR @SalaryTypeId IS NULL)
	AND ([CountryID] = @CountryId OR @CountryId IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [JobAlertID]
	, [JobAlertName]
	, [LastModified]
	, [SearchKeywords]
	, [RecurrenceType]
	, [DailyFrequency]
	, [WeeklyFrequency]
	, [WeeklyDayOccurence]
	, [DateLastRun]
	, [DateNextRun]
	, [MemberID]
	, [AlertActive]
	, [EmailFormat]
	, [CustomRecurrenceType]
	, [LastResultCount]
	, [PrimaryAlert]
	, [UnsubscribeValidateID]
	, [EditValidateID]
	, [ViewValidateID]
	, [SiteID]
	, [LocationID]
	, [AreaIDs]
	, [ProfessionID]
	, [SearchRoleIDs]
	, [WorkTypeIDs]
	, [SalaryIDs]
	, [DaysPosted]
	, [GeneratedSQL]
	, [SalaryLowerBand]
	, [SalaryUpperBand]
	, [CurrencyID]
	, [SalaryTypeID]
	, [CountryID]
    FROM
	[dbo].[JobAlerts]
    WHERE 
	 ([JobAlertID] = @JobAlertId AND @JobAlertId is not null)
	OR ([JobAlertName] = @JobAlertName AND @JobAlertName is not null)
	OR ([LastModified] = @LastModified AND @LastModified is not null)
	OR ([SearchKeywords] = @SearchKeywords AND @SearchKeywords is not null)
	OR ([RecurrenceType] = @RecurrenceType AND @RecurrenceType is not null)
	OR ([DailyFrequency] = @DailyFrequency AND @DailyFrequency is not null)
	OR ([WeeklyFrequency] = @WeeklyFrequency AND @WeeklyFrequency is not null)
	OR ([WeeklyDayOccurence] = @WeeklyDayOccurence AND @WeeklyDayOccurence is not null)
	OR ([DateLastRun] = @DateLastRun AND @DateLastRun is not null)
	OR ([DateNextRun] = @DateNextRun AND @DateNextRun is not null)
	OR ([MemberID] = @MemberId AND @MemberId is not null)
	OR ([AlertActive] = @AlertActive AND @AlertActive is not null)
	OR ([EmailFormat] = @EmailFormat AND @EmailFormat is not null)
	OR ([CustomRecurrenceType] = @CustomRecurrenceType AND @CustomRecurrenceType is not null)
	OR ([LastResultCount] = @LastResultCount AND @LastResultCount is not null)
	OR ([PrimaryAlert] = @PrimaryAlert AND @PrimaryAlert is not null)
	OR ([UnsubscribeValidateID] = @UnsubscribeValidateId AND @UnsubscribeValidateId is not null)
	OR ([EditValidateID] = @EditValidateId AND @EditValidateId is not null)
	OR ([ViewValidateID] = @ViewValidateId AND @ViewValidateId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([LocationID] = @LocationId AND @LocationId is not null)
	OR ([AreaIDs] = @AreaIds AND @AreaIds is not null)
	OR ([ProfessionID] = @ProfessionId AND @ProfessionId is not null)
	OR ([SearchRoleIDs] = @SearchRoleIds AND @SearchRoleIds is not null)
	OR ([WorkTypeIDs] = @WorkTypeIds AND @WorkTypeIds is not null)
	OR ([SalaryIDs] = @SalaryIds AND @SalaryIds is not null)
	OR ([DaysPosted] = @DaysPosted AND @DaysPosted is not null)
	OR ([GeneratedSQL] = @GeneratedSql AND @GeneratedSql is not null)
	OR ([SalaryLowerBand] = @SalaryLowerBand AND @SalaryLowerBand is not null)
	OR ([SalaryUpperBand] = @SalaryUpperBand AND @SalaryUpperBand is not null)
	OR ([CurrencyID] = @CurrencyId AND @CurrencyId is not null)
	OR ([SalaryTypeID] = @SalaryTypeId AND @SalaryTypeId is not null)
	OR ([CountryID] = @CountryId AND @CountryId is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.InvoiceItem_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.InvoiceItem_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.InvoiceItem_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the InvoiceItem table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.InvoiceItem_Get_List

AS


				
				SELECT
					[InvoiceItemID],
					[InvoiceID],
					[JobID],
					[JobArchiveID],
					[CreatedDate],
					[AdvertiserUserID]
				FROM
					[dbo].[InvoiceItem]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.InvoiceItem_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.InvoiceItem_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.InvoiceItem_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the InvoiceItem table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.InvoiceItem_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [InvoiceItemID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([InvoiceItemID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [InvoiceItemID]'
				SET @SQL = @SQL + ' FROM [dbo].[InvoiceItem]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[InvoiceItemID], O.[InvoiceID], O.[JobID], O.[JobArchiveID], O.[CreatedDate], O.[AdvertiserUserID]
				FROM
				    [dbo].[InvoiceItem] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[InvoiceItemID] = PageIndex.[InvoiceItemID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[InvoiceItem]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.InvoiceItem_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.InvoiceItem_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.InvoiceItem_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the InvoiceItem table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.InvoiceItem_Insert
(

	@InvoiceItemId int    OUTPUT,

	@InvoiceId int   ,

	@JobId int   ,

	@JobArchiveId int   ,

	@CreatedDate datetime   ,

	@AdvertiserUserId int   
)
AS


				
				INSERT INTO [dbo].[InvoiceItem]
					(
					[InvoiceID]
					,[JobID]
					,[JobArchiveID]
					,[CreatedDate]
					,[AdvertiserUserID]
					)
				VALUES
					(
					@InvoiceId
					,@JobId
					,@JobArchiveId
					,@CreatedDate
					,@AdvertiserUserId
					)
				
				-- Get the identity value
				SET @InvoiceItemId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.InvoiceItem_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.InvoiceItem_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.InvoiceItem_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the InvoiceItem table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.InvoiceItem_Update
(

	@InvoiceItemId int   ,

	@InvoiceId int   ,

	@JobId int   ,

	@JobArchiveId int   ,

	@CreatedDate datetime   ,

	@AdvertiserUserId int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[InvoiceItem]
				SET
					[InvoiceID] = @InvoiceId
					,[JobID] = @JobId
					,[JobArchiveID] = @JobArchiveId
					,[CreatedDate] = @CreatedDate
					,[AdvertiserUserID] = @AdvertiserUserId
				WHERE
[InvoiceItemID] = @InvoiceItemId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.InvoiceItem_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.InvoiceItem_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.InvoiceItem_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the InvoiceItem table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.InvoiceItem_Delete
(

	@InvoiceItemId int   
)
AS


				DELETE FROM [dbo].[InvoiceItem] WITH (ROWLOCK) 
				WHERE
					[InvoiceItemID] = @InvoiceItemId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.InvoiceItem_GetByAdvertiserUserId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.InvoiceItem_GetByAdvertiserUserId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.InvoiceItem_GetByAdvertiserUserId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the InvoiceItem table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.InvoiceItem_GetByAdvertiserUserId
(

	@AdvertiserUserId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[InvoiceItemID],
					[InvoiceID],
					[JobID],
					[JobArchiveID],
					[CreatedDate],
					[AdvertiserUserID]
				FROM
					[dbo].[InvoiceItem]
				WHERE
					[AdvertiserUserID] = @AdvertiserUserId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.InvoiceItem_GetByInvoiceId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.InvoiceItem_GetByInvoiceId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.InvoiceItem_GetByInvoiceId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the InvoiceItem table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.InvoiceItem_GetByInvoiceId
(

	@InvoiceId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[InvoiceItemID],
					[InvoiceID],
					[JobID],
					[JobArchiveID],
					[CreatedDate],
					[AdvertiserUserID]
				FROM
					[dbo].[InvoiceItem]
				WHERE
					[InvoiceID] = @InvoiceId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.InvoiceItem_GetByJobArchiveId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.InvoiceItem_GetByJobArchiveId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.InvoiceItem_GetByJobArchiveId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the InvoiceItem table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.InvoiceItem_GetByJobArchiveId
(

	@JobArchiveId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[InvoiceItemID],
					[InvoiceID],
					[JobID],
					[JobArchiveID],
					[CreatedDate],
					[AdvertiserUserID]
				FROM
					[dbo].[InvoiceItem]
				WHERE
					[JobArchiveID] = @JobArchiveId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.InvoiceItem_GetByJobId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.InvoiceItem_GetByJobId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.InvoiceItem_GetByJobId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the InvoiceItem table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.InvoiceItem_GetByJobId
(

	@JobId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[InvoiceItemID],
					[InvoiceID],
					[JobID],
					[JobArchiveID],
					[CreatedDate],
					[AdvertiserUserID]
				FROM
					[dbo].[InvoiceItem]
				WHERE
					[JobID] = @JobId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.InvoiceItem_GetByInvoiceItemId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.InvoiceItem_GetByInvoiceItemId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.InvoiceItem_GetByInvoiceItemId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the InvoiceItem table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.InvoiceItem_GetByInvoiceItemId
(

	@InvoiceItemId int   
)
AS


				SELECT
					[InvoiceItemID],
					[InvoiceID],
					[JobID],
					[JobArchiveID],
					[CreatedDate],
					[AdvertiserUserID]
				FROM
					[dbo].[InvoiceItem]
				WHERE
					[InvoiceItemID] = @InvoiceItemId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.InvoiceItem_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.InvoiceItem_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.InvoiceItem_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the InvoiceItem table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.InvoiceItem_Find
(

	@SearchUsingOR bit   = null ,

	@InvoiceItemId int   = null ,

	@InvoiceId int   = null ,

	@JobId int   = null ,

	@JobArchiveId int   = null ,

	@CreatedDate datetime   = null ,

	@AdvertiserUserId int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [InvoiceItemID]
	, [InvoiceID]
	, [JobID]
	, [JobArchiveID]
	, [CreatedDate]
	, [AdvertiserUserID]
    FROM
	[dbo].[InvoiceItem]
    WHERE 
	 ([InvoiceItemID] = @InvoiceItemId OR @InvoiceItemId IS NULL)
	AND ([InvoiceID] = @InvoiceId OR @InvoiceId IS NULL)
	AND ([JobID] = @JobId OR @JobId IS NULL)
	AND ([JobArchiveID] = @JobArchiveId OR @JobArchiveId IS NULL)
	AND ([CreatedDate] = @CreatedDate OR @CreatedDate IS NULL)
	AND ([AdvertiserUserID] = @AdvertiserUserId OR @AdvertiserUserId IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [InvoiceItemID]
	, [InvoiceID]
	, [JobID]
	, [JobArchiveID]
	, [CreatedDate]
	, [AdvertiserUserID]
    FROM
	[dbo].[InvoiceItem]
    WHERE 
	 ([InvoiceItemID] = @InvoiceItemId AND @InvoiceItemId is not null)
	OR ([InvoiceID] = @InvoiceId AND @InvoiceId is not null)
	OR ([JobID] = @JobId AND @JobId is not null)
	OR ([JobArchiveID] = @JobArchiveId AND @JobArchiveId is not null)
	OR ([CreatedDate] = @CreatedDate AND @CreatedDate is not null)
	OR ([AdvertiserUserID] = @AdvertiserUserId AND @AdvertiserUserId is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobApplication_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobApplication_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobApplication_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the JobApplication table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobApplication_Get_List

AS


				
				SELECT
					[JobApplicationID],
					[ApplicationDate],
					[JobID],
					[MemberID],
					[MemberResumeFile],
					[MemberCoverLetterFile],
					[ApplicationStatus],
					[JobAppValidateID],
					[SiteID_Referral],
					[URL_Referral],
					[ApplicantGrade],
					[LastViewedDate],
					[FirstName],
					[Surname],
					[EmailAddress],
					[MobilePhone],
					[MemberNote],
					[AdvertiserNote],
					[JobArchiveID],
					[Draft],
					[JobApplicationTypeID],
					[ExternalXMLFilename],
					[CustomQuestionnaireXML],
					[ExternalPDFFilename],
					[FileDownloaded],
					[AppliedWith],
					[ScreeningQuestionaireXML],
					[ScreeningQuestionsGuid]
				FROM
					[dbo].[JobApplication]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobApplication_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobApplication_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobApplication_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the JobApplication table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobApplication_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [JobApplicationID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([JobApplicationID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [JobApplicationID]'
				SET @SQL = @SQL + ' FROM [dbo].[JobApplication]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[JobApplicationID], O.[ApplicationDate], O.[JobID], O.[MemberID], O.[MemberResumeFile], O.[MemberCoverLetterFile], O.[ApplicationStatus], O.[JobAppValidateID], O.[SiteID_Referral], O.[URL_Referral], O.[ApplicantGrade], O.[LastViewedDate], O.[FirstName], O.[Surname], O.[EmailAddress], O.[MobilePhone], O.[MemberNote], O.[AdvertiserNote], O.[JobArchiveID], O.[Draft], O.[JobApplicationTypeID], O.[ExternalXMLFilename], O.[CustomQuestionnaireXML], O.[ExternalPDFFilename], O.[FileDownloaded], O.[AppliedWith], O.[ScreeningQuestionaireXML], O.[ScreeningQuestionsGuid]
				FROM
				    [dbo].[JobApplication] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[JobApplicationID] = PageIndex.[JobApplicationID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[JobApplication]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobApplication_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobApplication_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobApplication_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the JobApplication table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobApplication_Insert
(

	@JobApplicationId int    OUTPUT,

	@ApplicationDate smalldatetime   ,

	@JobId int   ,

	@MemberId int   ,

	@MemberResumeFile varchar (255)  ,

	@MemberCoverLetterFile varchar (255)  ,

	@ApplicationStatus int   ,

	@JobAppValidateId uniqueidentifier    OUTPUT,

	@SiteIdReferral int   ,

	@UrlReferral varchar (255)  ,

	@ApplicantGrade int   ,

	@LastViewedDate datetime   ,

	@FirstName nvarchar (255)  ,

	@Surname nvarchar (255)  ,

	@EmailAddress varchar (255)  ,

	@MobilePhone char (40)  ,

	@MemberNote nvarchar (MAX)  ,

	@AdvertiserNote nvarchar (MAX)  ,

	@JobArchiveId int   ,

	@Draft bit   ,

	@JobApplicationTypeId int   ,

	@ExternalXmlFilename varchar (255)  ,

	@CustomQuestionnaireXml nvarchar (MAX)  ,

	@ExternalPdfFilename varchar (255)  ,

	@FileDownloaded bit   ,

	@AppliedWith varchar (255)  ,

	@ScreeningQuestionaireXml nvarchar (MAX)  ,

	@ScreeningQuestionsGuid uniqueidentifier   
)
AS


				
				INSERT INTO [dbo].[JobApplication]
					(
					[ApplicationDate]
					,[JobID]
					,[MemberID]
					,[MemberResumeFile]
					,[MemberCoverLetterFile]
					,[ApplicationStatus]
					,[JobAppValidateID]
					,[SiteID_Referral]
					,[URL_Referral]
					,[ApplicantGrade]
					,[LastViewedDate]
					,[FirstName]
					,[Surname]
					,[EmailAddress]
					,[MobilePhone]
					,[MemberNote]
					,[AdvertiserNote]
					,[JobArchiveID]
					,[Draft]
					,[JobApplicationTypeID]
					,[ExternalXMLFilename]
					,[CustomQuestionnaireXML]
					,[ExternalPDFFilename]
					,[FileDownloaded]
					,[AppliedWith]
					,[ScreeningQuestionaireXML]
					,[ScreeningQuestionsGuid]
					)
				VALUES
					(
					@ApplicationDate
					,@JobId
					,@MemberId
					,@MemberResumeFile
					,@MemberCoverLetterFile
					,@ApplicationStatus
					,@JobAppValidateId
					,@SiteIdReferral
					,@UrlReferral
					,@ApplicantGrade
					,@LastViewedDate
					,@FirstName
					,@Surname
					,@EmailAddress
					,@MobilePhone
					,@MemberNote
					,@AdvertiserNote
					,@JobArchiveId
					,@Draft
					,@JobApplicationTypeId
					,@ExternalXmlFilename
					,@CustomQuestionnaireXml
					,@ExternalPdfFilename
					,@FileDownloaded
					,@AppliedWith
					,@ScreeningQuestionaireXml
					,@ScreeningQuestionsGuid
					)
				
				-- Get the identity value
				SET @JobApplicationId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobApplication_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobApplication_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobApplication_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the JobApplication table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobApplication_Update
(

	@JobApplicationId int   ,

	@ApplicationDate smalldatetime   ,

	@JobId int   ,

	@MemberId int   ,

	@MemberResumeFile varchar (255)  ,

	@MemberCoverLetterFile varchar (255)  ,

	@ApplicationStatus int   ,

	@JobAppValidateId uniqueidentifier   ,

	@SiteIdReferral int   ,

	@UrlReferral varchar (255)  ,

	@ApplicantGrade int   ,

	@LastViewedDate datetime   ,

	@FirstName nvarchar (255)  ,

	@Surname nvarchar (255)  ,

	@EmailAddress varchar (255)  ,

	@MobilePhone char (40)  ,

	@MemberNote nvarchar (MAX)  ,

	@AdvertiserNote nvarchar (MAX)  ,

	@JobArchiveId int   ,

	@Draft bit   ,

	@JobApplicationTypeId int   ,

	@ExternalXmlFilename varchar (255)  ,

	@CustomQuestionnaireXml nvarchar (MAX)  ,

	@ExternalPdfFilename varchar (255)  ,

	@FileDownloaded bit   ,

	@AppliedWith varchar (255)  ,

	@ScreeningQuestionaireXml nvarchar (MAX)  ,

	@ScreeningQuestionsGuid uniqueidentifier   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[JobApplication]
				SET
					[ApplicationDate] = @ApplicationDate
					,[JobID] = @JobId
					,[MemberID] = @MemberId
					,[MemberResumeFile] = @MemberResumeFile
					,[MemberCoverLetterFile] = @MemberCoverLetterFile
					,[ApplicationStatus] = @ApplicationStatus
					,[JobAppValidateID] = @JobAppValidateId
					,[SiteID_Referral] = @SiteIdReferral
					,[URL_Referral] = @UrlReferral
					,[ApplicantGrade] = @ApplicantGrade
					,[LastViewedDate] = @LastViewedDate
					,[FirstName] = @FirstName
					,[Surname] = @Surname
					,[EmailAddress] = @EmailAddress
					,[MobilePhone] = @MobilePhone
					,[MemberNote] = @MemberNote
					,[AdvertiserNote] = @AdvertiserNote
					,[JobArchiveID] = @JobArchiveId
					,[Draft] = @Draft
					,[JobApplicationTypeID] = @JobApplicationTypeId
					,[ExternalXMLFilename] = @ExternalXmlFilename
					,[CustomQuestionnaireXML] = @CustomQuestionnaireXml
					,[ExternalPDFFilename] = @ExternalPdfFilename
					,[FileDownloaded] = @FileDownloaded
					,[AppliedWith] = @AppliedWith
					,[ScreeningQuestionaireXML] = @ScreeningQuestionaireXml
					,[ScreeningQuestionsGuid] = @ScreeningQuestionsGuid
				WHERE
[JobApplicationID] = @JobApplicationId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobApplication_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobApplication_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobApplication_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the JobApplication table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobApplication_Delete
(

	@JobApplicationId int   
)
AS


				DELETE FROM [dbo].[JobApplication] WITH (ROWLOCK) 
				WHERE
					[JobApplicationID] = @JobApplicationId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobApplication_GetBySiteIdReferral procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobApplication_GetBySiteIdReferral') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobApplication_GetBySiteIdReferral
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobApplication table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobApplication_GetBySiteIdReferral
(

	@SiteIdReferral int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobApplicationID],
					[ApplicationDate],
					[JobID],
					[MemberID],
					[MemberResumeFile],
					[MemberCoverLetterFile],
					[ApplicationStatus],
					[JobAppValidateID],
					[SiteID_Referral],
					[URL_Referral],
					[ApplicantGrade],
					[LastViewedDate],
					[FirstName],
					[Surname],
					[EmailAddress],
					[MobilePhone],
					[MemberNote],
					[AdvertiserNote],
					[JobArchiveID],
					[Draft],
					[JobApplicationTypeID],
					[ExternalXMLFilename],
					[CustomQuestionnaireXML],
					[ExternalPDFFilename],
					[FileDownloaded],
					[AppliedWith],
					[ScreeningQuestionaireXML],
					[ScreeningQuestionsGuid]
				FROM
					[dbo].[JobApplication]
				WHERE
					[SiteID_Referral] = @SiteIdReferral
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobApplication_GetByJobArchiveId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobApplication_GetByJobArchiveId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobApplication_GetByJobArchiveId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobApplication table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobApplication_GetByJobArchiveId
(

	@JobArchiveId int   
)
AS


				SELECT
					[JobApplicationID],
					[ApplicationDate],
					[JobID],
					[MemberID],
					[MemberResumeFile],
					[MemberCoverLetterFile],
					[ApplicationStatus],
					[JobAppValidateID],
					[SiteID_Referral],
					[URL_Referral],
					[ApplicantGrade],
					[LastViewedDate],
					[FirstName],
					[Surname],
					[EmailAddress],
					[MobilePhone],
					[MemberNote],
					[AdvertiserNote],
					[JobArchiveID],
					[Draft],
					[JobApplicationTypeID],
					[ExternalXMLFilename],
					[CustomQuestionnaireXML],
					[ExternalPDFFilename],
					[FileDownloaded],
					[AppliedWith],
					[ScreeningQuestionaireXML],
					[ScreeningQuestionsGuid]
				FROM
					[dbo].[JobApplication]
				WHERE
					[JobArchiveID] = @JobArchiveId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobApplication_GetByJobId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobApplication_GetByJobId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobApplication_GetByJobId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobApplication table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobApplication_GetByJobId
(

	@JobId int   
)
AS


				SELECT
					[JobApplicationID],
					[ApplicationDate],
					[JobID],
					[MemberID],
					[MemberResumeFile],
					[MemberCoverLetterFile],
					[ApplicationStatus],
					[JobAppValidateID],
					[SiteID_Referral],
					[URL_Referral],
					[ApplicantGrade],
					[LastViewedDate],
					[FirstName],
					[Surname],
					[EmailAddress],
					[MobilePhone],
					[MemberNote],
					[AdvertiserNote],
					[JobArchiveID],
					[Draft],
					[JobApplicationTypeID],
					[ExternalXMLFilename],
					[CustomQuestionnaireXML],
					[ExternalPDFFilename],
					[FileDownloaded],
					[AppliedWith],
					[ScreeningQuestionaireXML],
					[ScreeningQuestionsGuid]
				FROM
					[dbo].[JobApplication]
				WHERE
					[JobID] = @JobId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobApplication_GetByMemberId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobApplication_GetByMemberId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobApplication_GetByMemberId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobApplication table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobApplication_GetByMemberId
(

	@MemberId int   
)
AS


				SELECT
					[JobApplicationID],
					[ApplicationDate],
					[JobID],
					[MemberID],
					[MemberResumeFile],
					[MemberCoverLetterFile],
					[ApplicationStatus],
					[JobAppValidateID],
					[SiteID_Referral],
					[URL_Referral],
					[ApplicantGrade],
					[LastViewedDate],
					[FirstName],
					[Surname],
					[EmailAddress],
					[MobilePhone],
					[MemberNote],
					[AdvertiserNote],
					[JobArchiveID],
					[Draft],
					[JobApplicationTypeID],
					[ExternalXMLFilename],
					[CustomQuestionnaireXML],
					[ExternalPDFFilename],
					[FileDownloaded],
					[AppliedWith],
					[ScreeningQuestionaireXML],
					[ScreeningQuestionsGuid]
				FROM
					[dbo].[JobApplication]
				WHERE
					[MemberID] = @MemberId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobApplication_GetByJobApplicationId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobApplication_GetByJobApplicationId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobApplication_GetByJobApplicationId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobApplication table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobApplication_GetByJobApplicationId
(

	@JobApplicationId int   
)
AS


				SELECT
					[JobApplicationID],
					[ApplicationDate],
					[JobID],
					[MemberID],
					[MemberResumeFile],
					[MemberCoverLetterFile],
					[ApplicationStatus],
					[JobAppValidateID],
					[SiteID_Referral],
					[URL_Referral],
					[ApplicantGrade],
					[LastViewedDate],
					[FirstName],
					[Surname],
					[EmailAddress],
					[MobilePhone],
					[MemberNote],
					[AdvertiserNote],
					[JobArchiveID],
					[Draft],
					[JobApplicationTypeID],
					[ExternalXMLFilename],
					[CustomQuestionnaireXML],
					[ExternalPDFFilename],
					[FileDownloaded],
					[AppliedWith],
					[ScreeningQuestionaireXML],
					[ScreeningQuestionsGuid]
				FROM
					[dbo].[JobApplication]
				WHERE
					[JobApplicationID] = @JobApplicationId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobApplication_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobApplication_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobApplication_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the JobApplication table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobApplication_Find
(

	@SearchUsingOR bit   = null ,

	@JobApplicationId int   = null ,

	@ApplicationDate smalldatetime   = null ,

	@JobId int   = null ,

	@MemberId int   = null ,

	@MemberResumeFile varchar (255)  = null ,

	@MemberCoverLetterFile varchar (255)  = null ,

	@ApplicationStatus int   = null ,

	@JobAppValidateId uniqueidentifier   = null ,

	@SiteIdReferral int   = null ,

	@UrlReferral varchar (255)  = null ,

	@ApplicantGrade int   = null ,

	@LastViewedDate datetime   = null ,

	@FirstName nvarchar (255)  = null ,

	@Surname nvarchar (255)  = null ,

	@EmailAddress varchar (255)  = null ,

	@MobilePhone char (40)  = null ,

	@MemberNote nvarchar (MAX)  = null ,

	@AdvertiserNote nvarchar (MAX)  = null ,

	@JobArchiveId int   = null ,

	@Draft bit   = null ,

	@JobApplicationTypeId int   = null ,

	@ExternalXmlFilename varchar (255)  = null ,

	@CustomQuestionnaireXml nvarchar (MAX)  = null ,

	@ExternalPdfFilename varchar (255)  = null ,

	@FileDownloaded bit   = null ,

	@AppliedWith varchar (255)  = null ,

	@ScreeningQuestionaireXml nvarchar (MAX)  = null ,

	@ScreeningQuestionsGuid uniqueidentifier   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [JobApplicationID]
	, [ApplicationDate]
	, [JobID]
	, [MemberID]
	, [MemberResumeFile]
	, [MemberCoverLetterFile]
	, [ApplicationStatus]
	, [JobAppValidateID]
	, [SiteID_Referral]
	, [URL_Referral]
	, [ApplicantGrade]
	, [LastViewedDate]
	, [FirstName]
	, [Surname]
	, [EmailAddress]
	, [MobilePhone]
	, [MemberNote]
	, [AdvertiserNote]
	, [JobArchiveID]
	, [Draft]
	, [JobApplicationTypeID]
	, [ExternalXMLFilename]
	, [CustomQuestionnaireXML]
	, [ExternalPDFFilename]
	, [FileDownloaded]
	, [AppliedWith]
	, [ScreeningQuestionaireXML]
	, [ScreeningQuestionsGuid]
    FROM
	[dbo].[JobApplication]
    WHERE 
	 ([JobApplicationID] = @JobApplicationId OR @JobApplicationId IS NULL)
	AND ([ApplicationDate] = @ApplicationDate OR @ApplicationDate IS NULL)
	AND ([JobID] = @JobId OR @JobId IS NULL)
	AND ([MemberID] = @MemberId OR @MemberId IS NULL)
	AND ([MemberResumeFile] = @MemberResumeFile OR @MemberResumeFile IS NULL)
	AND ([MemberCoverLetterFile] = @MemberCoverLetterFile OR @MemberCoverLetterFile IS NULL)
	AND ([ApplicationStatus] = @ApplicationStatus OR @ApplicationStatus IS NULL)
	AND ([JobAppValidateID] = @JobAppValidateId OR @JobAppValidateId IS NULL)
	AND ([SiteID_Referral] = @SiteIdReferral OR @SiteIdReferral IS NULL)
	AND ([URL_Referral] = @UrlReferral OR @UrlReferral IS NULL)
	AND ([ApplicantGrade] = @ApplicantGrade OR @ApplicantGrade IS NULL)
	AND ([LastViewedDate] = @LastViewedDate OR @LastViewedDate IS NULL)
	AND ([FirstName] = @FirstName OR @FirstName IS NULL)
	AND ([Surname] = @Surname OR @Surname IS NULL)
	AND ([EmailAddress] = @EmailAddress OR @EmailAddress IS NULL)
	AND ([MobilePhone] = @MobilePhone OR @MobilePhone IS NULL)
	AND ([MemberNote] = @MemberNote OR @MemberNote IS NULL)
	AND ([AdvertiserNote] = @AdvertiserNote OR @AdvertiserNote IS NULL)
	AND ([JobArchiveID] = @JobArchiveId OR @JobArchiveId IS NULL)
	AND ([Draft] = @Draft OR @Draft IS NULL)
	AND ([JobApplicationTypeID] = @JobApplicationTypeId OR @JobApplicationTypeId IS NULL)
	AND ([ExternalXMLFilename] = @ExternalXmlFilename OR @ExternalXmlFilename IS NULL)
	AND ([CustomQuestionnaireXML] = @CustomQuestionnaireXml OR @CustomQuestionnaireXml IS NULL)
	AND ([ExternalPDFFilename] = @ExternalPdfFilename OR @ExternalPdfFilename IS NULL)
	AND ([FileDownloaded] = @FileDownloaded OR @FileDownloaded IS NULL)
	AND ([AppliedWith] = @AppliedWith OR @AppliedWith IS NULL)
	AND ([ScreeningQuestionaireXML] = @ScreeningQuestionaireXml OR @ScreeningQuestionaireXml IS NULL)
	AND ([ScreeningQuestionsGuid] = @ScreeningQuestionsGuid OR @ScreeningQuestionsGuid IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [JobApplicationID]
	, [ApplicationDate]
	, [JobID]
	, [MemberID]
	, [MemberResumeFile]
	, [MemberCoverLetterFile]
	, [ApplicationStatus]
	, [JobAppValidateID]
	, [SiteID_Referral]
	, [URL_Referral]
	, [ApplicantGrade]
	, [LastViewedDate]
	, [FirstName]
	, [Surname]
	, [EmailAddress]
	, [MobilePhone]
	, [MemberNote]
	, [AdvertiserNote]
	, [JobArchiveID]
	, [Draft]
	, [JobApplicationTypeID]
	, [ExternalXMLFilename]
	, [CustomQuestionnaireXML]
	, [ExternalPDFFilename]
	, [FileDownloaded]
	, [AppliedWith]
	, [ScreeningQuestionaireXML]
	, [ScreeningQuestionsGuid]
    FROM
	[dbo].[JobApplication]
    WHERE 
	 ([JobApplicationID] = @JobApplicationId AND @JobApplicationId is not null)
	OR ([ApplicationDate] = @ApplicationDate AND @ApplicationDate is not null)
	OR ([JobID] = @JobId AND @JobId is not null)
	OR ([MemberID] = @MemberId AND @MemberId is not null)
	OR ([MemberResumeFile] = @MemberResumeFile AND @MemberResumeFile is not null)
	OR ([MemberCoverLetterFile] = @MemberCoverLetterFile AND @MemberCoverLetterFile is not null)
	OR ([ApplicationStatus] = @ApplicationStatus AND @ApplicationStatus is not null)
	OR ([JobAppValidateID] = @JobAppValidateId AND @JobAppValidateId is not null)
	OR ([SiteID_Referral] = @SiteIdReferral AND @SiteIdReferral is not null)
	OR ([URL_Referral] = @UrlReferral AND @UrlReferral is not null)
	OR ([ApplicantGrade] = @ApplicantGrade AND @ApplicantGrade is not null)
	OR ([LastViewedDate] = @LastViewedDate AND @LastViewedDate is not null)
	OR ([FirstName] = @FirstName AND @FirstName is not null)
	OR ([Surname] = @Surname AND @Surname is not null)
	OR ([EmailAddress] = @EmailAddress AND @EmailAddress is not null)
	OR ([MobilePhone] = @MobilePhone AND @MobilePhone is not null)
	OR ([MemberNote] = @MemberNote AND @MemberNote is not null)
	OR ([AdvertiserNote] = @AdvertiserNote AND @AdvertiserNote is not null)
	OR ([JobArchiveID] = @JobArchiveId AND @JobArchiveId is not null)
	OR ([Draft] = @Draft AND @Draft is not null)
	OR ([JobApplicationTypeID] = @JobApplicationTypeId AND @JobApplicationTypeId is not null)
	OR ([ExternalXMLFilename] = @ExternalXmlFilename AND @ExternalXmlFilename is not null)
	OR ([CustomQuestionnaireXML] = @CustomQuestionnaireXml AND @CustomQuestionnaireXml is not null)
	OR ([ExternalPDFFilename] = @ExternalPdfFilename AND @ExternalPdfFilename is not null)
	OR ([FileDownloaded] = @FileDownloaded AND @FileDownloaded is not null)
	OR ([AppliedWith] = @AppliedWith AND @AppliedWith is not null)
	OR ([ScreeningQuestionaireXML] = @ScreeningQuestionaireXml AND @ScreeningQuestionaireXml is not null)
	OR ([ScreeningQuestionsGuid] = @ScreeningQuestionsGuid AND @ScreeningQuestionsGuid is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobArea_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobArea_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobArea_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the JobArea table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobArea_Get_List

AS


				
				SELECT
					[JobAreaID],
					[JobID],
					[JobArchiveID],
					[AreaID]
				FROM
					[dbo].[JobArea]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobArea_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobArea_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobArea_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the JobArea table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobArea_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [JobAreaID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([JobAreaID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [JobAreaID]'
				SET @SQL = @SQL + ' FROM [dbo].[JobArea]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[JobAreaID], O.[JobID], O.[JobArchiveID], O.[AreaID]
				FROM
				    [dbo].[JobArea] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[JobAreaID] = PageIndex.[JobAreaID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[JobArea]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobArea_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobArea_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobArea_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the JobArea table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobArea_Insert
(

	@JobAreaId int    OUTPUT,

	@JobId int   ,

	@JobArchiveId int   ,

	@AreaId int   
)
AS


				
				INSERT INTO [dbo].[JobArea]
					(
					[JobID]
					,[JobArchiveID]
					,[AreaID]
					)
				VALUES
					(
					@JobId
					,@JobArchiveId
					,@AreaId
					)
				
				-- Get the identity value
				SET @JobAreaId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobArea_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobArea_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobArea_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the JobArea table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobArea_Update
(

	@JobAreaId int   ,

	@JobId int   ,

	@JobArchiveId int   ,

	@AreaId int   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[JobArea]
				SET
					[JobID] = @JobId
					,[JobArchiveID] = @JobArchiveId
					,[AreaID] = @AreaId
				WHERE
[JobAreaID] = @JobAreaId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobArea_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobArea_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobArea_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the JobArea table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobArea_Delete
(

	@JobAreaId int   
)
AS


				DELETE FROM [dbo].[JobArea] WITH (ROWLOCK) 
				WHERE
					[JobAreaID] = @JobAreaId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobArea_GetByAreaId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobArea_GetByAreaId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobArea_GetByAreaId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobArea table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobArea_GetByAreaId
(

	@AreaId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobAreaID],
					[JobID],
					[JobArchiveID],
					[AreaID]
				FROM
					[dbo].[JobArea]
				WHERE
					[AreaID] = @AreaId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobArea_GetByJobArchiveId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobArea_GetByJobArchiveId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobArea_GetByJobArchiveId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobArea table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobArea_GetByJobArchiveId
(

	@JobArchiveId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobAreaID],
					[JobID],
					[JobArchiveID],
					[AreaID]
				FROM
					[dbo].[JobArea]
				WHERE
					[JobArchiveID] = @JobArchiveId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobArea_GetByJobId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobArea_GetByJobId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobArea_GetByJobId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobArea table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobArea_GetByJobId
(

	@JobId int   
)
AS


				SELECT
					[JobAreaID],
					[JobID],
					[JobArchiveID],
					[AreaID]
				FROM
					[dbo].[JobArea]
				WHERE
					[JobID] = @JobId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobArea_GetByJobAreaId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobArea_GetByJobAreaId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobArea_GetByJobAreaId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobArea table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobArea_GetByJobAreaId
(

	@JobAreaId int   
)
AS


				SELECT
					[JobAreaID],
					[JobID],
					[JobArchiveID],
					[AreaID]
				FROM
					[dbo].[JobArea]
				WHERE
					[JobAreaID] = @JobAreaId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobArea_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobArea_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobArea_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the JobArea table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobArea_Find
(

	@SearchUsingOR bit   = null ,

	@JobAreaId int   = null ,

	@JobId int   = null ,

	@JobArchiveId int   = null ,

	@AreaId int   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [JobAreaID]
	, [JobID]
	, [JobArchiveID]
	, [AreaID]
    FROM
	[dbo].[JobArea]
    WHERE 
	 ([JobAreaID] = @JobAreaId OR @JobAreaId IS NULL)
	AND ([JobID] = @JobId OR @JobId IS NULL)
	AND ([JobArchiveID] = @JobArchiveId OR @JobArchiveId IS NULL)
	AND ([AreaID] = @AreaId OR @AreaId IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [JobAreaID]
	, [JobID]
	, [JobArchiveID]
	, [AreaID]
    FROM
	[dbo].[JobArea]
    WHERE 
	 ([JobAreaID] = @JobAreaId AND @JobAreaId is not null)
	OR ([JobID] = @JobId AND @JobId is not null)
	OR ([JobArchiveID] = @JobArchiveId AND @JobArchiveId is not null)
	OR ([AreaID] = @AreaId AND @AreaId is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobApplicationNotes_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobApplicationNotes_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobApplicationNotes_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the JobApplicationNotes table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobApplicationNotes_Get_List

AS


				
				SELECT
					[JobApplicationNoteID],
					[AdvertiserUserID],
					[MemberID],
					[JobApplicationID],
					[Note]
				FROM
					[dbo].[JobApplicationNotes]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobApplicationNotes_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobApplicationNotes_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobApplicationNotes_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the JobApplicationNotes table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobApplicationNotes_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [JobApplicationNoteID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([JobApplicationNoteID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [JobApplicationNoteID]'
				SET @SQL = @SQL + ' FROM [dbo].[JobApplicationNotes]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[JobApplicationNoteID], O.[AdvertiserUserID], O.[MemberID], O.[JobApplicationID], O.[Note]
				FROM
				    [dbo].[JobApplicationNotes] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[JobApplicationNoteID] = PageIndex.[JobApplicationNoteID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[JobApplicationNotes]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobApplicationNotes_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobApplicationNotes_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobApplicationNotes_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the JobApplicationNotes table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobApplicationNotes_Insert
(

	@JobApplicationNoteId int    OUTPUT,

	@AdvertiserUserId int   ,

	@MemberId int   ,

	@JobApplicationId int   ,

	@Note ntext   
)
AS


				
				INSERT INTO [dbo].[JobApplicationNotes]
					(
					[AdvertiserUserID]
					,[MemberID]
					,[JobApplicationID]
					,[Note]
					)
				VALUES
					(
					@AdvertiserUserId
					,@MemberId
					,@JobApplicationId
					,@Note
					)
				
				-- Get the identity value
				SET @JobApplicationNoteId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobApplicationNotes_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobApplicationNotes_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobApplicationNotes_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the JobApplicationNotes table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobApplicationNotes_Update
(

	@JobApplicationNoteId int   ,

	@AdvertiserUserId int   ,

	@MemberId int   ,

	@JobApplicationId int   ,

	@Note ntext   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[JobApplicationNotes]
				SET
					[AdvertiserUserID] = @AdvertiserUserId
					,[MemberID] = @MemberId
					,[JobApplicationID] = @JobApplicationId
					,[Note] = @Note
				WHERE
[JobApplicationNoteID] = @JobApplicationNoteId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobApplicationNotes_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobApplicationNotes_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobApplicationNotes_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the JobApplicationNotes table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobApplicationNotes_Delete
(

	@JobApplicationNoteId int   
)
AS


				DELETE FROM [dbo].[JobApplicationNotes] WITH (ROWLOCK) 
				WHERE
					[JobApplicationNoteID] = @JobApplicationNoteId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobApplicationNotes_GetByAdvertiserUserId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobApplicationNotes_GetByAdvertiserUserId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobApplicationNotes_GetByAdvertiserUserId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobApplicationNotes table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobApplicationNotes_GetByAdvertiserUserId
(

	@AdvertiserUserId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobApplicationNoteID],
					[AdvertiserUserID],
					[MemberID],
					[JobApplicationID],
					[Note]
				FROM
					[dbo].[JobApplicationNotes]
				WHERE
					[AdvertiserUserID] = @AdvertiserUserId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobApplicationNotes_GetByJobApplicationId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobApplicationNotes_GetByJobApplicationId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobApplicationNotes_GetByJobApplicationId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobApplicationNotes table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobApplicationNotes_GetByJobApplicationId
(

	@JobApplicationId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobApplicationNoteID],
					[AdvertiserUserID],
					[MemberID],
					[JobApplicationID],
					[Note]
				FROM
					[dbo].[JobApplicationNotes]
				WHERE
					[JobApplicationID] = @JobApplicationId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobApplicationNotes_GetByMemberId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobApplicationNotes_GetByMemberId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobApplicationNotes_GetByMemberId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobApplicationNotes table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobApplicationNotes_GetByMemberId
(

	@MemberId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobApplicationNoteID],
					[AdvertiserUserID],
					[MemberID],
					[JobApplicationID],
					[Note]
				FROM
					[dbo].[JobApplicationNotes]
				WHERE
					[MemberID] = @MemberId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobApplicationNotes_GetByJobApplicationNoteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobApplicationNotes_GetByJobApplicationNoteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobApplicationNotes_GetByJobApplicationNoteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobApplicationNotes table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobApplicationNotes_GetByJobApplicationNoteId
(

	@JobApplicationNoteId int   
)
AS


				SELECT
					[JobApplicationNoteID],
					[AdvertiserUserID],
					[MemberID],
					[JobApplicationID],
					[Note]
				FROM
					[dbo].[JobApplicationNotes]
				WHERE
					[JobApplicationNoteID] = @JobApplicationNoteId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobApplicationNotes_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobApplicationNotes_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobApplicationNotes_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the JobApplicationNotes table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobApplicationNotes_Find
(

	@SearchUsingOR bit   = null ,

	@JobApplicationNoteId int   = null ,

	@AdvertiserUserId int   = null ,

	@MemberId int   = null ,

	@JobApplicationId int   = null ,

	@Note ntext   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [JobApplicationNoteID]
	, [AdvertiserUserID]
	, [MemberID]
	, [JobApplicationID]
	, [Note]
    FROM
	[dbo].[JobApplicationNotes]
    WHERE 
	 ([JobApplicationNoteID] = @JobApplicationNoteId OR @JobApplicationNoteId IS NULL)
	AND ([AdvertiserUserID] = @AdvertiserUserId OR @AdvertiserUserId IS NULL)
	AND ([MemberID] = @MemberId OR @MemberId IS NULL)
	AND ([JobApplicationID] = @JobApplicationId OR @JobApplicationId IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [JobApplicationNoteID]
	, [AdvertiserUserID]
	, [MemberID]
	, [JobApplicationID]
	, [Note]
    FROM
	[dbo].[JobApplicationNotes]
    WHERE 
	 ([JobApplicationNoteID] = @JobApplicationNoteId AND @JobApplicationNoteId is not null)
	OR ([AdvertiserUserID] = @AdvertiserUserId AND @AdvertiserUserId is not null)
	OR ([MemberID] = @MemberId AND @MemberId is not null)
	OR ([JobApplicationID] = @JobApplicationId AND @JobApplicationId is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobItemsType_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobItemsType_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobItemsType_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the JobItemsType table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobItemsType_Get_List

AS


				
				SELECT
					[JobItemTypeID],
					[SiteID],
					[JobItemTypeParentID],
					[JobItemTypeDescription],
					[LastModifiedBy],
					[LastModified],
					[TotalAmount],
					[DaysActive],
					[Sequence],
					[Valid],
					[DiscountAmount],
					[TotalNumberOfJobs],
					[ShortDescription]
				FROM
					[dbo].[JobItemsType]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobItemsType_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobItemsType_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobItemsType_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the JobItemsType table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobItemsType_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [JobItemTypeID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([JobItemTypeID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [JobItemTypeID]'
				SET @SQL = @SQL + ' FROM [dbo].[JobItemsType]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[JobItemTypeID], O.[SiteID], O.[JobItemTypeParentID], O.[JobItemTypeDescription], O.[LastModifiedBy], O.[LastModified], O.[TotalAmount], O.[DaysActive], O.[Sequence], O.[Valid], O.[DiscountAmount], O.[TotalNumberOfJobs], O.[ShortDescription]
				FROM
				    [dbo].[JobItemsType] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[JobItemTypeID] = PageIndex.[JobItemTypeID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[JobItemsType]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobItemsType_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobItemsType_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobItemsType_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the JobItemsType table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobItemsType_Insert
(

	@JobItemTypeId int    OUTPUT,

	@SiteId int   ,

	@JobItemTypeParentId int   ,

	@JobItemTypeDescription nvarchar (255)  ,

	@LastModifiedBy int   ,

	@LastModified datetime   ,

	@TotalAmount decimal (18, 2)  ,

	@DaysActive int   ,

	@Sequence int   ,

	@Valid bit   ,

	@DiscountAmount decimal (18, 2)  ,

	@TotalNumberOfJobs int   ,

	@ShortDescription nvarchar (2048)  
)
AS


				
				INSERT INTO [dbo].[JobItemsType]
					(
					[SiteID]
					,[JobItemTypeParentID]
					,[JobItemTypeDescription]
					,[LastModifiedBy]
					,[LastModified]
					,[TotalAmount]
					,[DaysActive]
					,[Sequence]
					,[Valid]
					,[DiscountAmount]
					,[TotalNumberOfJobs]
					,[ShortDescription]
					)
				VALUES
					(
					@SiteId
					,@JobItemTypeParentId
					,@JobItemTypeDescription
					,@LastModifiedBy
					,@LastModified
					,@TotalAmount
					,@DaysActive
					,@Sequence
					,@Valid
					,@DiscountAmount
					,@TotalNumberOfJobs
					,@ShortDescription
					)
				
				-- Get the identity value
				SET @JobItemTypeId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobItemsType_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobItemsType_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobItemsType_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the JobItemsType table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobItemsType_Update
(

	@JobItemTypeId int   ,

	@SiteId int   ,

	@JobItemTypeParentId int   ,

	@JobItemTypeDescription nvarchar (255)  ,

	@LastModifiedBy int   ,

	@LastModified datetime   ,

	@TotalAmount decimal (18, 2)  ,

	@DaysActive int   ,

	@Sequence int   ,

	@Valid bit   ,

	@DiscountAmount decimal (18, 2)  ,

	@TotalNumberOfJobs int   ,

	@ShortDescription nvarchar (2048)  
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[JobItemsType]
				SET
					[SiteID] = @SiteId
					,[JobItemTypeParentID] = @JobItemTypeParentId
					,[JobItemTypeDescription] = @JobItemTypeDescription
					,[LastModifiedBy] = @LastModifiedBy
					,[LastModified] = @LastModified
					,[TotalAmount] = @TotalAmount
					,[DaysActive] = @DaysActive
					,[Sequence] = @Sequence
					,[Valid] = @Valid
					,[DiscountAmount] = @DiscountAmount
					,[TotalNumberOfJobs] = @TotalNumberOfJobs
					,[ShortDescription] = @ShortDescription
				WHERE
[JobItemTypeID] = @JobItemTypeId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobItemsType_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobItemsType_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobItemsType_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the JobItemsType table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobItemsType_Delete
(

	@JobItemTypeId int   
)
AS


				DELETE FROM [dbo].[JobItemsType] WITH (ROWLOCK) 
				WHERE
					[JobItemTypeID] = @JobItemTypeId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobItemsType_GetByLastModifiedBy procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobItemsType_GetByLastModifiedBy') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobItemsType_GetByLastModifiedBy
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobItemsType table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobItemsType_GetByLastModifiedBy
(

	@LastModifiedBy int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobItemTypeID],
					[SiteID],
					[JobItemTypeParentID],
					[JobItemTypeDescription],
					[LastModifiedBy],
					[LastModified],
					[TotalAmount],
					[DaysActive],
					[Sequence],
					[Valid],
					[DiscountAmount],
					[TotalNumberOfJobs],
					[ShortDescription]
				FROM
					[dbo].[JobItemsType]
				WHERE
					[LastModifiedBy] = @LastModifiedBy
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobItemsType_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobItemsType_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobItemsType_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobItemsType table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobItemsType_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobItemTypeID],
					[SiteID],
					[JobItemTypeParentID],
					[JobItemTypeDescription],
					[LastModifiedBy],
					[LastModified],
					[TotalAmount],
					[DaysActive],
					[Sequence],
					[Valid],
					[DiscountAmount],
					[TotalNumberOfJobs],
					[ShortDescription]
				FROM
					[dbo].[JobItemsType]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobItemsType_GetByJobItemTypeId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobItemsType_GetByJobItemTypeId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobItemsType_GetByJobItemTypeId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobItemsType table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobItemsType_GetByJobItemTypeId
(

	@JobItemTypeId int   
)
AS


				SELECT
					[JobItemTypeID],
					[SiteID],
					[JobItemTypeParentID],
					[JobItemTypeDescription],
					[LastModifiedBy],
					[LastModified],
					[TotalAmount],
					[DaysActive],
					[Sequence],
					[Valid],
					[DiscountAmount],
					[TotalNumberOfJobs],
					[ShortDescription]
				FROM
					[dbo].[JobItemsType]
				WHERE
					[JobItemTypeID] = @JobItemTypeId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobItemsType_GetByAdvertiserIdFromAdvertiserJobPricing procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobItemsType_GetByAdvertiserIdFromAdvertiserJobPricing') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobItemsType_GetByAdvertiserIdFromAdvertiserJobPricing
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records through a junction table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobItemsType_GetByAdvertiserIdFromAdvertiserJobPricing
(

	@AdvertiserId int   
)
AS


SELECT dbo.[JobItemsType].[JobItemTypeID]
       ,dbo.[JobItemsType].[SiteID]
       ,dbo.[JobItemsType].[JobItemTypeParentID]
       ,dbo.[JobItemsType].[JobItemTypeDescription]
       ,dbo.[JobItemsType].[LastModifiedBy]
       ,dbo.[JobItemsType].[LastModified]
       ,dbo.[JobItemsType].[TotalAmount]
       ,dbo.[JobItemsType].[DaysActive]
       ,dbo.[JobItemsType].[Sequence]
       ,dbo.[JobItemsType].[Valid]
       ,dbo.[JobItemsType].[DiscountAmount]
       ,dbo.[JobItemsType].[TotalNumberOfJobs]
       ,dbo.[JobItemsType].[ShortDescription]
  FROM dbo.[JobItemsType]
 WHERE EXISTS (SELECT 1
                 FROM dbo.[AdvertiserJobPricing] 
                WHERE dbo.[AdvertiserJobPricing].[AdvertiserID] = @AdvertiserId
                  AND dbo.[AdvertiserJobPricing].[JobItemsTypeID] = dbo.[JobItemsType].[JobItemTypeID]
                  )
				SELECT @@ROWCOUNT			
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobItemsType_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobItemsType_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobItemsType_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the JobItemsType table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobItemsType_Find
(

	@SearchUsingOR bit   = null ,

	@JobItemTypeId int   = null ,

	@SiteId int   = null ,

	@JobItemTypeParentId int   = null ,

	@JobItemTypeDescription nvarchar (255)  = null ,

	@LastModifiedBy int   = null ,

	@LastModified datetime   = null ,

	@TotalAmount decimal (18, 2)  = null ,

	@DaysActive int   = null ,

	@Sequence int   = null ,

	@Valid bit   = null ,

	@DiscountAmount decimal (18, 2)  = null ,

	@TotalNumberOfJobs int   = null ,

	@ShortDescription nvarchar (2048)  = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [JobItemTypeID]
	, [SiteID]
	, [JobItemTypeParentID]
	, [JobItemTypeDescription]
	, [LastModifiedBy]
	, [LastModified]
	, [TotalAmount]
	, [DaysActive]
	, [Sequence]
	, [Valid]
	, [DiscountAmount]
	, [TotalNumberOfJobs]
	, [ShortDescription]
    FROM
	[dbo].[JobItemsType]
    WHERE 
	 ([JobItemTypeID] = @JobItemTypeId OR @JobItemTypeId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([JobItemTypeParentID] = @JobItemTypeParentId OR @JobItemTypeParentId IS NULL)
	AND ([JobItemTypeDescription] = @JobItemTypeDescription OR @JobItemTypeDescription IS NULL)
	AND ([LastModifiedBy] = @LastModifiedBy OR @LastModifiedBy IS NULL)
	AND ([LastModified] = @LastModified OR @LastModified IS NULL)
	AND ([TotalAmount] = @TotalAmount OR @TotalAmount IS NULL)
	AND ([DaysActive] = @DaysActive OR @DaysActive IS NULL)
	AND ([Sequence] = @Sequence OR @Sequence IS NULL)
	AND ([Valid] = @Valid OR @Valid IS NULL)
	AND ([DiscountAmount] = @DiscountAmount OR @DiscountAmount IS NULL)
	AND ([TotalNumberOfJobs] = @TotalNumberOfJobs OR @TotalNumberOfJobs IS NULL)
	AND ([ShortDescription] = @ShortDescription OR @ShortDescription IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [JobItemTypeID]
	, [SiteID]
	, [JobItemTypeParentID]
	, [JobItemTypeDescription]
	, [LastModifiedBy]
	, [LastModified]
	, [TotalAmount]
	, [DaysActive]
	, [Sequence]
	, [Valid]
	, [DiscountAmount]
	, [TotalNumberOfJobs]
	, [ShortDescription]
    FROM
	[dbo].[JobItemsType]
    WHERE 
	 ([JobItemTypeID] = @JobItemTypeId AND @JobItemTypeId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([JobItemTypeParentID] = @JobItemTypeParentId AND @JobItemTypeParentId is not null)
	OR ([JobItemTypeDescription] = @JobItemTypeDescription AND @JobItemTypeDescription is not null)
	OR ([LastModifiedBy] = @LastModifiedBy AND @LastModifiedBy is not null)
	OR ([LastModified] = @LastModified AND @LastModified is not null)
	OR ([TotalAmount] = @TotalAmount AND @TotalAmount is not null)
	OR ([DaysActive] = @DaysActive AND @DaysActive is not null)
	OR ([Sequence] = @Sequence AND @Sequence is not null)
	OR ([Valid] = @Valid AND @Valid is not null)
	OR ([DiscountAmount] = @DiscountAmount AND @DiscountAmount is not null)
	OR ([TotalNumberOfJobs] = @TotalNumberOfJobs AND @TotalNumberOfJobs is not null)
	OR ([ShortDescription] = @ShortDescription AND @ShortDescription is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobApplicationType_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobApplicationType_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobApplicationType_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the JobApplicationType table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobApplicationType_Get_List

AS


				
				SELECT
					[JobApplicationTypeID],
					[JobApplicationTypeParentID],
					[SiteID],
					[JobApplicationTypeName],
					[JobApplicationTypeUrl],
					[GlobalTemplate]
				FROM
					[dbo].[JobApplicationType]
					
				SELECT @@ROWCOUNT
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobApplicationType_GetPaged procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobApplicationType_GetPaged') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobApplicationType_GetPaged
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the JobApplicationType table passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobApplicationType_GetPaged
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  ,

	@PageIndex int   ,

	@PageSize int   
)
AS


				
				BEGIN
				DECLARE @PageLowerBound int
				DECLARE @PageUpperBound int
				
				-- Set the page bounds
				SET @PageLowerBound = @PageSize * @PageIndex
				SET @PageUpperBound = @PageLowerBound + @PageSize

				-- Create a temp table to store the select results
				CREATE TABLE #PageIndex
				(
				    [IndexId] int IDENTITY (1, 1) NOT NULL,
				    [JobApplicationTypeID] int 
				)
				
				-- Insert into the temp table
				DECLARE @SQL AS nvarchar(4000)
				SET @SQL = 'INSERT INTO #PageIndex ([JobApplicationTypeID])'
				SET @SQL = @SQL + ' SELECT'
				IF @PageSize > 0
				BEGIN
					SET @SQL = @SQL + ' TOP ' + CONVERT(nvarchar, @PageUpperBound)
				END
				SET @SQL = @SQL + ' [JobApplicationTypeID]'
				SET @SQL = @SQL + ' FROM [dbo].[JobApplicationType]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				IF LEN(@OrderBy) > 0
				BEGIN
					SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
				END
				
				-- Populate the temp table
				EXEC sp_executesql @SQL

				-- Return paged results
				SELECT O.[JobApplicationTypeID], O.[JobApplicationTypeParentID], O.[SiteID], O.[JobApplicationTypeName], O.[JobApplicationTypeUrl], O.[GlobalTemplate]
				FROM
				    [dbo].[JobApplicationType] O,
				    #PageIndex PageIndex
				WHERE
				    PageIndex.IndexId > @PageLowerBound
					AND O.[JobApplicationTypeID] = PageIndex.[JobApplicationTypeID]
				ORDER BY
				    PageIndex.IndexId
				
				-- get row count
				SET @SQL = 'SELECT COUNT(*) AS TotalRowCount'
				SET @SQL = @SQL + ' FROM [dbo].[JobApplicationType]'
				IF LEN(@WhereClause) > 0
				BEGIN
					SET @SQL = @SQL + ' WHERE ' + @WhereClause
				END
				EXEC sp_executesql @SQL
			
				END
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobApplicationType_Insert procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobApplicationType_Insert') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobApplicationType_Insert
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Inserts a record into the JobApplicationType table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobApplicationType_Insert
(

	@JobApplicationTypeId int    OUTPUT,

	@JobApplicationTypeParentId int   ,

	@SiteId int   ,

	@JobApplicationTypeName varchar (255)  ,

	@JobApplicationTypeUrl varchar (255)  ,

	@GlobalTemplate bit   
)
AS


				
				INSERT INTO [dbo].[JobApplicationType]
					(
					[JobApplicationTypeParentID]
					,[SiteID]
					,[JobApplicationTypeName]
					,[JobApplicationTypeUrl]
					,[GlobalTemplate]
					)
				VALUES
					(
					@JobApplicationTypeParentId
					,@SiteId
					,@JobApplicationTypeName
					,@JobApplicationTypeUrl
					,@GlobalTemplate
					)
				
				-- Get the identity value
				SET @JobApplicationTypeId = SCOPE_IDENTITY()
									
							
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobApplicationType_Update procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobApplicationType_Update') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobApplicationType_Update
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Updates a record in the JobApplicationType table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobApplicationType_Update
(

	@JobApplicationTypeId int   ,

	@JobApplicationTypeParentId int   ,

	@SiteId int   ,

	@JobApplicationTypeName varchar (255)  ,

	@JobApplicationTypeUrl varchar (255)  ,

	@GlobalTemplate bit   
)
AS


				
				
				-- Modify the updatable columns
				UPDATE
					[dbo].[JobApplicationType]
				SET
					[JobApplicationTypeParentID] = @JobApplicationTypeParentId
					,[SiteID] = @SiteId
					,[JobApplicationTypeName] = @JobApplicationTypeName
					,[JobApplicationTypeUrl] = @JobApplicationTypeUrl
					,[GlobalTemplate] = @GlobalTemplate
				WHERE
[JobApplicationTypeID] = @JobApplicationTypeId 
				
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobApplicationType_Delete procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobApplicationType_Delete') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobApplicationType_Delete
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Deletes a record in the JobApplicationType table
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobApplicationType_Delete
(

	@JobApplicationTypeId int   
)
AS


				DELETE FROM [dbo].[JobApplicationType] WITH (ROWLOCK) 
				WHERE
					[JobApplicationTypeID] = @JobApplicationTypeId
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobApplicationType_GetBySiteId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobApplicationType_GetBySiteId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobApplicationType_GetBySiteId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobApplicationType table through a foreign key
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobApplicationType_GetBySiteId
(

	@SiteId int   
)
AS


				SET ANSI_NULLS OFF
				
				SELECT
					[JobApplicationTypeID],
					[JobApplicationTypeParentID],
					[SiteID],
					[JobApplicationTypeName],
					[JobApplicationTypeUrl],
					[GlobalTemplate]
				FROM
					[dbo].[JobApplicationType]
				WHERE
					[SiteID] = @SiteId
				
				SELECT @@ROWCOUNT
				SET ANSI_NULLS ON
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobApplicationType_GetByJobApplicationTypeId procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobApplicationType_GetByJobApplicationTypeId') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobApplicationType_GetByJobApplicationTypeId
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Select records from the JobApplicationType table through an index
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobApplicationType_GetByJobApplicationTypeId
(

	@JobApplicationTypeId int   
)
AS


				SELECT
					[JobApplicationTypeID],
					[JobApplicationTypeParentID],
					[SiteID],
					[JobApplicationTypeName],
					[JobApplicationTypeUrl],
					[GlobalTemplate]
				FROM
					[dbo].[JobApplicationType]
				WHERE
					[JobApplicationTypeID] = @JobApplicationTypeId
				SELECT @@ROWCOUNT
					
			

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.JobApplicationType_Find procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.JobApplicationType_Find') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.JobApplicationType_Find
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Finds records in the JobApplicationType table passing nullable parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.JobApplicationType_Find
(

	@SearchUsingOR bit   = null ,

	@JobApplicationTypeId int   = null ,

	@JobApplicationTypeParentId int   = null ,

	@SiteId int   = null ,

	@JobApplicationTypeName varchar (255)  = null ,

	@JobApplicationTypeUrl varchar (255)  = null ,

	@GlobalTemplate bit   = null 
)
AS


				
  IF ISNULL(@SearchUsingOR, 0) <> 1
  BEGIN
    SELECT
	  [JobApplicationTypeID]
	, [JobApplicationTypeParentID]
	, [SiteID]
	, [JobApplicationTypeName]
	, [JobApplicationTypeUrl]
	, [GlobalTemplate]
    FROM
	[dbo].[JobApplicationType]
    WHERE 
	 ([JobApplicationTypeID] = @JobApplicationTypeId OR @JobApplicationTypeId IS NULL)
	AND ([JobApplicationTypeParentID] = @JobApplicationTypeParentId OR @JobApplicationTypeParentId IS NULL)
	AND ([SiteID] = @SiteId OR @SiteId IS NULL)
	AND ([JobApplicationTypeName] = @JobApplicationTypeName OR @JobApplicationTypeName IS NULL)
	AND ([JobApplicationTypeUrl] = @JobApplicationTypeUrl OR @JobApplicationTypeUrl IS NULL)
	AND ([GlobalTemplate] = @GlobalTemplate OR @GlobalTemplate IS NULL)
						
  END
  ELSE
  BEGIN
    SELECT
	  [JobApplicationTypeID]
	, [JobApplicationTypeParentID]
	, [SiteID]
	, [JobApplicationTypeName]
	, [JobApplicationTypeUrl]
	, [GlobalTemplate]
    FROM
	[dbo].[JobApplicationType]
    WHERE 
	 ([JobApplicationTypeID] = @JobApplicationTypeId AND @JobApplicationTypeId is not null)
	OR ([JobApplicationTypeParentID] = @JobApplicationTypeParentId AND @JobApplicationTypeParentId is not null)
	OR ([SiteID] = @SiteId AND @SiteId is not null)
	OR ([JobApplicationTypeName] = @JobApplicationTypeName AND @JobApplicationTypeName is not null)
	OR ([JobApplicationTypeUrl] = @JobApplicationTypeUrl AND @JobApplicationTypeUrl is not null)
	OR ([GlobalTemplate] = @GlobalTemplate AND @GlobalTemplate is not null)
	SELECT @@ROWCOUNT			
  END
				

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.ViewJobs_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.ViewJobs_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.ViewJobs_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the ViewJobs view
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.ViewJobs_Get_List

AS


                    
                    SELECT
                        [JobID],
                        [SiteID],
                        [WorkTypeID],
                        [JobName],
                        [Description],
                        [FullDescription],
                        [WebServiceProcessed],
                        [ApplicationEmailAddress],
                        [RefNo],
                        [Visible],
                        [DatePosted],
                        [ExpiryDate],
                        [Expired],
                        [JobItemPrice],
                        [Billed],
                        [LastModified],
                        [ShowSalaryDetails],
                        [ShowSalaryRange],
                        [SalaryText],
                        [AdvertiserID],
                        [LastModifiedByAdvertiserUserId],
                        [LastModifiedByAdminUserId],
                        [JobItemTypeID],
                        [ApplicationMethod],
                        [ApplicationURL],
                        [UploadMethod],
                        [Tags],
                        [JobTemplateID],
                        [SearchField],
                        [AdvertiserJobTemplateLogoID],
                        [CompanyName],
                        [HashValue],
                        [RequireLogonForExternalApplications],
                        [ShowLocationDetails],
                        [PublicTransport],
                        [Address],
                        [ContactDetails],
                        [JobContactPhone],
                        [JobContactName],
                        [QualificationsRecognised],
                        [ResidentOnly],
                        [DocumentLink],
                        [BulletPoint1],
                        [BulletPoint2],
                        [BulletPoint3],
                        [HotJob],
                        [AdvertiserCompanyName],
                        [BusinessNumber],
                        [StreetAddress1],
                        [StreetAddress2],
                        [WebAddress],
                        [Profile],
                        [RequireLogonForExternalApplication],
                        [AdvertiserLogo],
                        [AdvertiserLogoURL],
                        [SiteWorkTypeName],
                        [CurrencySymbol],
                        [SalaryUpperBand],
                        [SalaryLowerBand],
                        [SalaryTypeID],
                        [JobTemplateHTML],
                        [SalaryTypeName],
                        [SiteAreaName],
                        [SiteLocationName],
                        [SiteRoleName],
                        [SiteRoleCanonicalUrl],
                        [SiteProfessionName],
                        [SiteProfessionCanonicalUrl],
                        [JobFriendlyName],
                        [ProfessionID],
                        [RoleID],
                        [LocationID],
                        [AreaID],
                        [SalaryDisplay]
                    FROM
                        [dbo].[ViewJobs]
                        
                    SELECT @@ROWCOUNT			
                

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.ViewJobs_Get procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.ViewJobs_Get') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.ViewJobs_Get
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the ViewJobs view passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.ViewJobs_Get
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  
)
AS


                    
                    BEGIN
    
                    -- Build the sql query
                    DECLARE @SQL AS nvarchar(4000)
                    SET @SQL = ' SELECT * FROM [dbo].[ViewJobs]'
                    IF LEN(@WhereClause) > 0
                    BEGIN
                        SET @SQL = @SQL + ' WHERE ' + @WhereClause
                    END
                    IF LEN(@OrderBy) > 0
                    BEGIN
                        SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
                    END
                    
                    -- Execution the query
                    EXEC sp_executesql @SQL
                    
                    -- Return total count
                    SELECT @@ROWCOUNT AS TotalRowCount
                    
                    END
                

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.ViewJobsArchive_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.ViewJobsArchive_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.ViewJobsArchive_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the ViewJobsArchive view
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.ViewJobsArchive_Get_List

AS


                    
                    SELECT
                        [JobID],
                        [SiteID],
                        [WorkTypeID],
                        [JobName],
                        [Description],
                        [FullDescription],
                        [WebServiceProcessed],
                        [ApplicationEmailAddress],
                        [RefNo],
                        [Visible],
                        [DatePosted],
                        [ExpiryDate],
                        [Expired],
                        [JobItemPrice],
                        [Billed],
                        [LastModified],
                        [ShowSalaryDetails],
                        [ShowSalaryRange],
                        [SalaryText],
                        [AdvertiserID],
                        [LastModifiedByAdvertiserUserId],
                        [LastModifiedByAdminUserId],
                        [JobItemTypeID],
                        [ApplicationMethod],
                        [ApplicationURL],
                        [UploadMethod],
                        [Tags],
                        [JobTemplateID],
                        [SearchField],
                        [AdvertiserJobTemplateLogoID],
                        [CompanyName],
                        [HashValue],
                        [RequireLogonForExternalApplications],
                        [ShowLocationDetails],
                        [PublicTransport],
                        [Address],
                        [ContactDetails],
                        [JobContactPhone],
                        [JobContactName],
                        [QualificationsRecognised],
                        [ResidentOnly],
                        [DocumentLink],
                        [BulletPoint1],
                        [BulletPoint2],
                        [BulletPoint3],
                        [HotJob],
                        [AdvertiserCompanyName],
                        [BusinessNumber],
                        [StreetAddress1],
                        [StreetAddress2],
                        [WebAddress],
                        [Profile],
                        [RequireLogonForExternalApplication],
                        [AdvertiserLogo],
                        [AdvertiserLogoURL],
                        [SiteWorkTypeName],
                        [CurrencySymbol],
                        [SalaryUpperBand],
                        [SalaryLowerBand],
                        [SalaryTypeID],
                        [JobTemplateHTML],
                        [SalaryTypeName],
                        [SiteAreaName],
                        [SiteLocationName],
                        [SiteRoleName],
                        [SiteProfessionName],
                        [JobFriendlyName],
                        [ProfessionID],
                        [RoleID],
                        [LocationID],
                        [AreaID],
                        [SalaryDisplay]
                    FROM
                        [dbo].[ViewJobsArchive]
                        
                    SELECT @@ROWCOUNT			
                

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.ViewJobsArchive_Get procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.ViewJobsArchive_Get') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.ViewJobsArchive_Get
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the ViewJobsArchive view passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.ViewJobsArchive_Get
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  
)
AS


                    
                    BEGIN
    
                    -- Build the sql query
                    DECLARE @SQL AS nvarchar(4000)
                    SET @SQL = ' SELECT * FROM [dbo].[ViewJobsArchive]'
                    IF LEN(@WhereClause) > 0
                    BEGIN
                        SET @SQL = @SQL + ' WHERE ' + @WhereClause
                    END
                    IF LEN(@OrderBy) > 0
                    BEGIN
                        SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
                    END
                    
                    -- Execution the query
                    EXEC sp_executesql @SQL
                    
                    -- Return total count
                    SELECT @@ROWCOUNT AS TotalRowCount
                    
                    END
                

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.ViewJobSearch_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.ViewJobSearch_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.ViewJobSearch_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the ViewJobSearch view
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.ViewJobSearch_Get_List

AS


                    
                    SELECT
                        [JobId],
                        [SiteID],
                        [JobName],
                        [Description],
                        [FullDescription],
                        [DatePosted],
                        [Visible],
                        [Expired],
                        [ShowSalaryDetails],
                        [ShowSalaryRange],
                        [SalaryText],
                        [AdvertiserID],
                        [ApplicationMethod],
                        [ApplicationURL],
                        [AdvertiserJobTemplateLogoID],
                        [CompanyName],
                        [ShowLocationDetails],
                        [BulletPoint1],
                        [BulletPoint2],
                        [BulletPoint3],
                        [HotJob],
                        [ApplicationEmailAddress],
                        [ExpiryDate],
                        [ContactDetails],
                        [RefNo],
                        [AdvertiserName],
                        [CurrencySymbol],
                        [SalaryUpperBand],
                        [SalaryLowerBand],
                        [SalaryTypeID],
                        [SalaryTypeName],
                        [WorkTypeName],
                        [CountryID],
                        [LocationID],
                        [AreaID],
                        [CountryName],
                        [LocationName],
                        [AreaName],
                        [ProfessionID],
                        [RoleID],
                        [SiteProfessionName],
                        [SiteRoleName],
                        [BreadCrumbNavigation],
                        [WorkTypeID],
                        [JobFriendlyName],
                        [SalaryDisplay],
                        [JobItemTypeID],
                        [JobLatitude],
                        [JobLongitude],
                        [AddressStatus],
                        [HasAdvertiserLogo],
                        [CustomXML],
                        [Address],
                        [PublicTransport]
                    FROM
                        [dbo].[ViewJobSearch]
                        
                    SELECT @@ROWCOUNT			
                

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.ViewJobSearch_Get procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.ViewJobSearch_Get') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.ViewJobSearch_Get
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the ViewJobSearch view passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.ViewJobSearch_Get
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  
)
AS


                    
                    BEGIN
    
                    -- Build the sql query
                    DECLARE @SQL AS nvarchar(4000)
                    SET @SQL = ' SELECT * FROM [dbo].[ViewJobSearch]'
                    IF LEN(@WhereClause) > 0
                    BEGIN
                        SET @SQL = @SQL + ' WHERE ' + @WhereClause
                    END
                    IF LEN(@OrderBy) > 0
                    BEGIN
                        SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
                    END
                    
                    -- Execution the query
                    EXEC sp_executesql @SQL
                    
                    -- Return total count
                    SELECT @@ROWCOUNT AS TotalRowCount
                    
                    END
                

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.ViewSalary_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.ViewSalary_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.ViewSalary_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the ViewSalary view
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.ViewSalary_Get_List

AS


                    
                    SELECT
                        [SalaryID],
                        [SalaryTypeId],
                        [SalaryTypeName],
                        [Amount],
                        [IsFrom],
                        [CurrencyID],
                        [CurrencySymbol],
                        [SalaryDisplay],
                        [SiteID]
                    FROM
                        [dbo].[ViewSalary]
                        
                    SELECT @@ROWCOUNT			
                

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.ViewSalary_Get procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.ViewSalary_Get') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.ViewSalary_Get
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the ViewSalary view passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.ViewSalary_Get
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  
)
AS


                    
                    BEGIN
    
                    -- Build the sql query
                    DECLARE @SQL AS nvarchar(4000)
                    SET @SQL = ' SELECT * FROM [dbo].[ViewSalary]'
                    IF LEN(@WhereClause) > 0
                    BEGIN
                        SET @SQL = @SQL + ' WHERE ' + @WhereClause
                    END
                    IF LEN(@OrderBy) > 0
                    BEGIN
                        SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
                    END
                    
                    -- Execution the query
                    EXEC sp_executesql @SQL
                    
                    -- Return total count
                    SELECT @@ROWCOUNT AS TotalRowCount
                    
                    END
                

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.ViewSiteAdvertisers_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.ViewSiteAdvertisers_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.ViewSiteAdvertisers_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the ViewSiteAdvertisers view
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.ViewSiteAdvertisers_Get_List

AS


                    
                    SELECT
                        [AdvertiserID],
                        [SiteID]
                    FROM
                        [dbo].[ViewSiteAdvertisers]
                        
                    SELECT @@ROWCOUNT			
                

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.ViewSiteAdvertisers_Get procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.ViewSiteAdvertisers_Get') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.ViewSiteAdvertisers_Get
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the ViewSiteAdvertisers view passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.ViewSiteAdvertisers_Get
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  
)
AS


                    
                    BEGIN
    
                    -- Build the sql query
                    DECLARE @SQL AS nvarchar(4000)
                    SET @SQL = ' SELECT * FROM [dbo].[ViewSiteAdvertisers]'
                    IF LEN(@WhereClause) > 0
                    BEGIN
                        SET @SQL = @SQL + ' WHERE ' + @WhereClause
                    END
                    IF LEN(@OrderBy) > 0
                    BEGIN
                        SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
                    END
                    
                    -- Execution the query
                    EXEC sp_executesql @SQL
                    
                    -- Return total count
                    SELECT @@ROWCOUNT AS TotalRowCount
                    
                    END
                

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.ViewSiteAreaLocationCountry_Get_List procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.ViewSiteAreaLocationCountry_Get_List') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.ViewSiteAreaLocationCountry_Get_List
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets all records from the ViewSiteAreaLocationCountry view
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.ViewSiteAreaLocationCountry_Get_List

AS


                    
                    SELECT
                        [AreaID],
                        [SiteLocationID],
                        [LocationID],
                        [SiteAreaID],
                        [SiteAreaName],
                        [SiteLocationName],
                        [SiteID],
                        [SiteLocationSiteId],
                        [SiteCountrySiteId],
                        [CountryID],
                        [SiteCountryName],
                        [Currency]
                    FROM
                        [dbo].[ViewSiteAreaLocationCountry]
                        
                    SELECT @@ROWCOUNT			
                

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO

	

-- Drop the dbo.ViewSiteAreaLocationCountry_Get procedure
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'dbo.ViewSiteAreaLocationCountry_Get') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE dbo.ViewSiteAreaLocationCountry_Get
GO

/*
----------------------------------------------------------------------------------------------------

-- Created By:  ()
-- Purpose: Gets records from the ViewSiteAreaLocationCountry view passing page index and page count parameters
----------------------------------------------------------------------------------------------------
*/


CREATE PROCEDURE dbo.ViewSiteAreaLocationCountry_Get
(

	@WhereClause varchar (2000)  ,

	@OrderBy varchar (2000)  
)
AS


                    
                    BEGIN
    
                    -- Build the sql query
                    DECLARE @SQL AS nvarchar(4000)
                    SET @SQL = ' SELECT * FROM [dbo].[ViewSiteAreaLocationCountry]'
                    IF LEN(@WhereClause) > 0
                    BEGIN
                        SET @SQL = @SQL + ' WHERE ' + @WhereClause
                    END
                    IF LEN(@OrderBy) > 0
                    BEGIN
                        SET @SQL = @SQL + ' ORDER BY ' + @OrderBy
                    END
                    
                    -- Execution the query
                    EXEC sp_executesql @SQL
                    
                    -- Return total count
                    SELECT @@ROWCOUNT AS TotalRowCount
                    
                    END
                

GO
SET QUOTED_IDENTIFIER ON 
GO
SET NOCOUNT ON
GO
SET ANSI_NULLS OFF 
GO


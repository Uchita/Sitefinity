@model Telerik.Sitefinity.Frontend.Identity.Mvc.Models.LoginStatus.LoginStatusViewModel

@using Telerik.Sitefinity.Frontend.Mvc.Helpers;
@using Telerik.Sitefinity.Modules.Pages;
@using Telerik.Sitefinity.Mvc.Proxy;

@{
    var SignOutUrl = string.Concat(Url.Action("SignOut"), string.Format("?{0}={1}", MvcControllerProxy.ControllerKey, ViewData[MvcControllerProxy.ControllerKey]));
}

<div class="o-loginstatus @Model.CssClass">
    <div class="o-loginstatus__loggedin" data-sf-role="sf-logged-in-view" style="display: none">
        <div class="o-loginstatus__loggedin-imagewrp">
            <img class="o-loginstatus__loggedin-imagewrpimg" data-sf-role="sf-logged-in-avatar" alt="User avatar" role="img" />
        </div>
        <div class="o-loginstatus__loggedin-info">
            <a href="@(Model.ProfilePageUrl ?? "#")" data-sf-role="sf-logged-in-name" role="link"></a>
            <p data-sf-role="sf-logged-in-email"></p>
            <a class="btn btn-secondary" href="@SignOutUrl" role="link">@Html.Resource("Logout")</a>
        </div>
    </div>

    <div class="o-loginstatus__loggedout" data-sf-role="sf-logged-out-view" style="display: none">

        <button class="btn btn-secondary" data-sf-role="login-status-button" role="button">@Html.Resource("Login")</button>
        <a href="@(Model.RegistrationPageUrl ?? "#")" role="link">@Html.Resource("RegisterNow")</a>

    </div>
</div>

<input type="hidden" data-sf-role="sf-status-json-endpoint-url" value="@Model.StatusServiceUrl" />
<input type="hidden" data-sf-role="sf-logout-redirect-url" value="@Model.LogoutPageUrl" />
<input type="hidden" data-sf-role="sf-login-redirect-url" value="@Model.LoginPageUrl" />
<input type="hidden" data-sf-role="sf-is-design-mode-value" value="@ViewBag.IsDesignMode.ToString()" />
<input type="hidden" data-sf-role="sf-allow-windows-sts-login" value="@Model.AllowWindowsStsLogin.ToString()" />

@Html.Script(Url.WidgetContent("Mvc/Scripts/LoginStatus/login-status.js"), "bottom", false)